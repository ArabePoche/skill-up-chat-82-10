var TS=t=>{throw TypeError(t)};var qy=(t,e,r)=>e.has(t)||TS("Cannot "+r);var de=(t,e,r)=>(qy(t,e,"read from private field"),r?r.call(t):e.get(t)),ut=(t,e,r)=>e.has(t)?TS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ze=(t,e,r,n)=>(qy(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),At=(t,e,r)=>(qy(t,e,"access private method"),r);var Ug=(t,e,r,n)=>({set _(s){Ze(t,e,s,r)},get _(){return de(t,e,n)}});function iR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var _i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function I4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function aR(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var z4={exports:{}},$x={},$4={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tp=Symbol.for("react.element"),oR=Symbol.for("react.portal"),lR=Symbol.for("react.fragment"),cR=Symbol.for("react.strict_mode"),uR=Symbol.for("react.profiler"),dR=Symbol.for("react.provider"),hR=Symbol.for("react.context"),fR=Symbol.for("react.forward_ref"),mR=Symbol.for("react.suspense"),pR=Symbol.for("react.memo"),gR=Symbol.for("react.lazy"),LS=Symbol.iterator;function vR(t){return t===null||typeof t!="object"?null:(t=LS&&t[LS]||t["@@iterator"],typeof t=="function"?t:null)}var B4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q4=Object.assign,U4={};function Yh(t,e,r){this.props=t,this.context=e,this.refs=U4,this.updater=r||B4}Yh.prototype.isReactComponent={};Yh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function V4(){}V4.prototype=Yh.prototype;function y5(t,e,r){this.props=t,this.context=e,this.refs=U4,this.updater=r||B4}var b5=y5.prototype=new V4;b5.constructor=y5;q4(b5,Yh.prototype);b5.isPureReactComponent=!0;var OS=Array.isArray,W4=Object.prototype.hasOwnProperty,w5={current:null},H4={key:!0,ref:!0,__self:!0,__source:!0};function G4(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)W4.call(e,n)&&!H4.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Tp,type:t,key:i,ref:a,props:s,_owner:w5.current}}function xR(t,e){return{$$typeof:Tp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _5(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tp}function yR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var MS=/\/+/g;function Uy(t,e){return typeof t=="object"&&t!==null&&t.key!=null?yR(""+t.key):e.toString(36)}function ev(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Tp:case oR:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+Uy(a,0):n,OS(s)?(r="",t!=null&&(r=t.replace(MS,"$&/")+"/"),ev(s,e,r,"",function(u){return u})):s!=null&&(_5(s)&&(s=xR(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(MS,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",OS(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+Uy(i,l);a+=ev(i,e,r,c,s)}else if(c=vR(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+Uy(i,l++),a+=ev(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Vg(t,e,r){if(t==null)return t;var n=[],s=0;return ev(t,n,"","",function(i){return e.call(r,i,s++)}),n}function bR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ds={current:null},tv={transition:null},wR={ReactCurrentDispatcher:ds,ReactCurrentBatchConfig:tv,ReactCurrentOwner:w5};function Y4(){throw Error("act(...) is not supported in production builds of React.")}Dt.Children={map:Vg,forEach:function(t,e,r){Vg(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Vg(t,function(){e++}),e},toArray:function(t){return Vg(t,function(e){return e})||[]},only:function(t){if(!_5(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Dt.Component=Yh;Dt.Fragment=lR;Dt.Profiler=uR;Dt.PureComponent=y5;Dt.StrictMode=cR;Dt.Suspense=mR;Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wR;Dt.act=Y4;Dt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=q4({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=w5.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)W4.call(e,c)&&!H4.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Tp,type:t.type,key:s,ref:i,props:n,_owner:a}};Dt.createContext=function(t){return t={$$typeof:hR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dR,_context:t},t.Consumer=t};Dt.createElement=G4;Dt.createFactory=function(t){var e=G4.bind(null,t);return e.type=t,e};Dt.createRef=function(){return{current:null}};Dt.forwardRef=function(t){return{$$typeof:fR,render:t}};Dt.isValidElement=_5;Dt.lazy=function(t){return{$$typeof:gR,_payload:{_status:-1,_result:t},_init:bR}};Dt.memo=function(t,e){return{$$typeof:pR,type:t,compare:e===void 0?null:e}};Dt.startTransition=function(t){var e=tv.transition;tv.transition={};try{t()}finally{tv.transition=e}};Dt.unstable_act=Y4;Dt.useCallback=function(t,e){return ds.current.useCallback(t,e)};Dt.useContext=function(t){return ds.current.useContext(t)};Dt.useDebugValue=function(){};Dt.useDeferredValue=function(t){return ds.current.useDeferredValue(t)};Dt.useEffect=function(t,e){return ds.current.useEffect(t,e)};Dt.useId=function(){return ds.current.useId()};Dt.useImperativeHandle=function(t,e,r){return ds.current.useImperativeHandle(t,e,r)};Dt.useInsertionEffect=function(t,e){return ds.current.useInsertionEffect(t,e)};Dt.useLayoutEffect=function(t,e){return ds.current.useLayoutEffect(t,e)};Dt.useMemo=function(t,e){return ds.current.useMemo(t,e)};Dt.useReducer=function(t,e,r){return ds.current.useReducer(t,e,r)};Dt.useRef=function(t){return ds.current.useRef(t)};Dt.useState=function(t){return ds.current.useState(t)};Dt.useSyncExternalStore=function(t,e,r){return ds.current.useSyncExternalStore(t,e,r)};Dt.useTransition=function(){return ds.current.useTransition()};Dt.version="18.3.1";$4.exports=Dt;var y=$4.exports;const Fe=I4(y),Lp=iR({__proto__:null,default:Fe},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _R=y,jR=Symbol.for("react.element"),SR=Symbol.for("react.fragment"),CR=Object.prototype.hasOwnProperty,NR=_R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kR={key:!0,ref:!0,__self:!0,__source:!0};function X4(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)CR.call(e,n)&&!kR.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:jR,type:t,key:i,ref:a,props:s,_owner:NR.current}}$x.Fragment=SR;$x.jsx=X4;$x.jsxs=X4;z4.exports=$x;var o=z4.exports,lb={},K4={exports:{}},ri={},Q4={exports:{}},J4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,B){var X=R.length;R.push(B);e:for(;0<X;){var ie=X-1>>>1,M=R[ie];if(0<s(M,B))R[ie]=B,R[X]=M,X=ie;else break e}}function r(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var B=R[0],X=R.pop();if(X!==B){R[0]=X;e:for(var ie=0,M=R.length,W=M>>>1;ie<W;){var K=2*(ie+1)-1,ne=R[K],se=K+1,le=R[se];if(0>s(ne,X))se<M&&0>s(le,ne)?(R[ie]=le,R[se]=X,ie=se):(R[ie]=ne,R[K]=X,ie=K);else if(se<M&&0>s(le,X))R[ie]=le,R[se]=X,ie=se;else break e}}return B}function s(R,B){var X=R.sortIndex-B.sortIndex;return X!==0?X:R.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(R){for(var B=r(u);B!==null;){if(B.callback===null)n(u);else if(B.startTime<=R)n(u),B.sortIndex=B.expirationTime,e(c,B);else break;B=r(u)}}function S(R){if(v=!1,_(R),!p)if(r(c)!==null)p=!0,H(N);else{var B=r(u);B!==null&&Q(S,B.startTime-R)}}function N(R,B){p=!1,v&&(v=!1,x(A),A=-1),m=!0;var X=f;try{for(_(B),h=r(c);h!==null&&(!(h.expirationTime>B)||R&&!T());){var ie=h.callback;if(typeof ie=="function"){h.callback=null,f=h.priorityLevel;var M=ie(h.expirationTime<=B);B=t.unstable_now(),typeof M=="function"?h.callback=M:h===r(c)&&n(c),_(B)}else n(c);h=r(c)}if(h!==null)var W=!0;else{var K=r(u);K!==null&&Q(S,K.startTime-B),W=!1}return W}finally{h=null,f=X,m=!1}}var E=!1,P=null,A=-1,F=5,Y=-1;function T(){return!(t.unstable_now()-Y<F)}function O(){if(P!==null){var R=t.unstable_now();Y=R;var B=!0;try{B=P(!0,R)}finally{B?U():(E=!1,P=null)}}else E=!1}var U;if(typeof w=="function")U=function(){w(O)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Z=q.port2;q.port1.onmessage=O,U=function(){Z.postMessage(null)}}else U=function(){b(O,0)};function H(R){P=R,E||(E=!0,U())}function Q(R,B){A=b(function(){R(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,H(N))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(R){switch(f){case 1:case 2:case 3:var B=3;break;default:B=f}var X=f;f=B;try{return R()}finally{f=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,B){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var X=f;f=R;try{return B()}finally{f=X}},t.unstable_scheduleCallback=function(R,B,X){var ie=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ie+X:ie):X=ie,R){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=X+M,R={id:d++,callback:B,priorityLevel:R,startTime:X,expirationTime:M,sortIndex:-1},X>ie?(R.sortIndex=X,e(u,R),r(c)===null&&R===r(u)&&(v?(x(A),A=-1):v=!0,Q(S,X-ie))):(R.sortIndex=M,e(c,R),p||m||(p=!0,H(N))),R},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(R){var B=f;return function(){var X=f;f=B;try{return R.apply(this,arguments)}finally{f=X}}}})(J4);Q4.exports=J4;var ER=Q4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR=y,Qs=ER;function Ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z4=new Set,Um={};function ku(t,e){Ph(t,e),Ph(t+"Capture",e)}function Ph(t,e){for(Um[t]=e,t=0;t<e.length;t++)Z4.add(e[t])}var Ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cb=Object.prototype.hasOwnProperty,AR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,RS={},DS={};function TR(t){return cb.call(DS,t)?!0:cb.call(RS,t)?!1:AR.test(t)?DS[t]=!0:(RS[t]=!0,!1)}function LR(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OR(t,e,r,n){if(e===null||typeof e>"u"||LR(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hs(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){On[t]=new hs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];On[e]=new hs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){On[t]=new hs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){On[t]=new hs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){On[t]=new hs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){On[t]=new hs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){On[t]=new hs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){On[t]=new hs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){On[t]=new hs(t,5,!1,t.toLowerCase(),null,!1,!1)});var j5=/[\-:]([a-z])/g;function S5(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(j5,S5);On[e]=new hs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(j5,S5);On[e]=new hs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(j5,S5);On[e]=new hs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){On[t]=new hs(t,1,!1,t.toLowerCase(),null,!1,!1)});On.xlinkHref=new hs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){On[t]=new hs(t,1,!1,t.toLowerCase(),null,!0,!0)});function C5(t,e,r,n){var s=On.hasOwnProperty(e)?On[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OR(e,r,s,n)&&(r=null),n||s===null?TR(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Yo=PR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wg=Symbol.for("react.element"),Ad=Symbol.for("react.portal"),Td=Symbol.for("react.fragment"),N5=Symbol.for("react.strict_mode"),ub=Symbol.for("react.profiler"),e3=Symbol.for("react.provider"),t3=Symbol.for("react.context"),k5=Symbol.for("react.forward_ref"),db=Symbol.for("react.suspense"),hb=Symbol.for("react.suspense_list"),E5=Symbol.for("react.memo"),Sl=Symbol.for("react.lazy"),r3=Symbol.for("react.offscreen"),FS=Symbol.iterator;function Zf(t){return t===null||typeof t!="object"?null:(t=FS&&t[FS]||t["@@iterator"],typeof t=="function"?t:null)}var Mr=Object.assign,Vy;function pm(t){if(Vy===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Vy=e&&e[1]||""}return`
`+Vy+t}var Wy=!1;function Hy(t,e){if(!t||Wy)return"";Wy=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Wy=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?pm(t):""}function MR(t){switch(t.tag){case 5:return pm(t.type);case 16:return pm("Lazy");case 13:return pm("Suspense");case 19:return pm("SuspenseList");case 0:case 2:case 15:return t=Hy(t.type,!1),t;case 11:return t=Hy(t.type.render,!1),t;case 1:return t=Hy(t.type,!0),t;default:return""}}function fb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Td:return"Fragment";case Ad:return"Portal";case ub:return"Profiler";case N5:return"StrictMode";case db:return"Suspense";case hb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case t3:return(t.displayName||"Context")+".Consumer";case e3:return(t._context.displayName||"Context")+".Provider";case k5:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case E5:return e=t.displayName||null,e!==null?e:fb(t.type)||"Memo";case Sl:e=t._payload,t=t._init;try{return fb(t(e))}catch{}}return null}function RR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fb(e);case 8:return e===N5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function n3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function DR(t){var e=n3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Hg(t){t._valueTracker||(t._valueTracker=DR(t))}function s3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=n3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Av(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function mb(t,e){var r=e.checked;return Mr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function IS(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Zl(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function i3(t,e){e=e.checked,e!=null&&C5(t,"checked",e,!1)}function pb(t,e){i3(t,e);var r=Zl(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?gb(t,e.type,r):e.hasOwnProperty("defaultValue")&&gb(t,e.type,Zl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zS(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function gb(t,e,r){(e!=="number"||Av(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var gm=Array.isArray;function Qd(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Zl(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function vb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return Mr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $S(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Ie(92));if(gm(r)){if(1<r.length)throw Error(Ie(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Zl(r)}}function a3(t,e){var r=Zl(e.value),n=Zl(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function BS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function o3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?o3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gg,l3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gg=Gg||document.createElement("div"),Gg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vm(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var jm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys(jm).forEach(function(t){FR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jm[e]=jm[t]})});function c3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||jm.hasOwnProperty(t)&&jm[t]?(""+e).trim():e+"px"}function u3(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=c3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var IR=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yb(t,e){if(e){if(IR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ie(62))}}function bb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function P5(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _b=null,Jd=null,Zd=null;function qS(t){if(t=Rp(t)){if(typeof _b!="function")throw Error(Ie(280));var e=t.stateNode;e&&(e=Wx(e),_b(t.stateNode,t.type,e))}}function d3(t){Jd?Zd?Zd.push(t):Zd=[t]:Jd=t}function h3(){if(Jd){var t=Jd,e=Zd;if(Zd=Jd=null,qS(t),e)for(t=0;t<e.length;t++)qS(e[t])}}function f3(t,e){return t(e)}function m3(){}var Gy=!1;function p3(t,e,r){if(Gy)return t(e,r);Gy=!0;try{return f3(t,e,r)}finally{Gy=!1,(Jd!==null||Zd!==null)&&(m3(),h3())}}function Wm(t,e){var r=t.stateNode;if(r===null)return null;var n=Wx(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Ie(231,e,typeof r));return r}var jb=!1;if(Ro)try{var em={};Object.defineProperty(em,"passive",{get:function(){jb=!0}}),window.addEventListener("test",em,em),window.removeEventListener("test",em,em)}catch{jb=!1}function zR(t,e,r,n,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Sm=!1,Tv=null,Lv=!1,Sb=null,$R={onError:function(t){Sm=!0,Tv=t}};function BR(t,e,r,n,s,i,a,l,c){Sm=!1,Tv=null,zR.apply($R,arguments)}function qR(t,e,r,n,s,i,a,l,c){if(BR.apply(this,arguments),Sm){if(Sm){var u=Tv;Sm=!1,Tv=null}else throw Error(Ie(198));Lv||(Lv=!0,Sb=u)}}function Eu(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function g3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function US(t){if(Eu(t)!==t)throw Error(Ie(188))}function UR(t){var e=t.alternate;if(!e){if(e=Eu(t),e===null)throw Error(Ie(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return US(s),t;if(i===n)return US(s),e;i=i.sibling}throw Error(Ie(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(Ie(189))}}if(r.alternate!==n)throw Error(Ie(190))}if(r.tag!==3)throw Error(Ie(188));return r.stateNode.current===r?t:e}function v3(t){return t=UR(t),t!==null?x3(t):null}function x3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=x3(t);if(e!==null)return e;t=t.sibling}return null}var y3=Qs.unstable_scheduleCallback,VS=Qs.unstable_cancelCallback,VR=Qs.unstable_shouldYield,WR=Qs.unstable_requestPaint,Gr=Qs.unstable_now,HR=Qs.unstable_getCurrentPriorityLevel,A5=Qs.unstable_ImmediatePriority,b3=Qs.unstable_UserBlockingPriority,Ov=Qs.unstable_NormalPriority,GR=Qs.unstable_LowPriority,w3=Qs.unstable_IdlePriority,Bx=null,Ua=null;function YR(t){if(Ua&&typeof Ua.onCommitFiberRoot=="function")try{Ua.onCommitFiberRoot(Bx,t,void 0,(t.current.flags&128)===128)}catch{}}var ra=Math.clz32?Math.clz32:QR,XR=Math.log,KR=Math.LN2;function QR(t){return t>>>=0,t===0?32:31-(XR(t)/KR|0)|0}var Yg=64,Xg=4194304;function vm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mv(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=vm(l):(i&=a,i!==0&&(n=vm(i)))}else a=r&~s,a!==0?n=vm(a):i!==0&&(n=vm(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ra(e),s=1<<r,n|=t[r],e&=~s;return n}function JR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZR(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-ra(i),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=JR(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Cb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _3(){var t=Yg;return Yg<<=1,!(Yg&4194240)&&(Yg=64),t}function Yy(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Op(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ra(e),t[e]=r}function eD(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-ra(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function T5(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ra(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var lr=0;function j3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var S3,L5,C3,N3,k3,Nb=!1,Kg=[],Ul=null,Vl=null,Wl=null,Hm=new Map,Gm=new Map,kl=[],tD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WS(t,e){switch(t){case"focusin":case"focusout":Ul=null;break;case"dragenter":case"dragleave":Vl=null;break;case"mouseover":case"mouseout":Wl=null;break;case"pointerover":case"pointerout":Hm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gm.delete(e.pointerId)}}function tm(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Rp(e),e!==null&&L5(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function rD(t,e,r,n,s){switch(e){case"focusin":return Ul=tm(Ul,t,e,r,n,s),!0;case"dragenter":return Vl=tm(Vl,t,e,r,n,s),!0;case"mouseover":return Wl=tm(Wl,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Hm.set(i,tm(Hm.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Gm.set(i,tm(Gm.get(i)||null,t,e,r,n,s)),!0}return!1}function E3(t){var e=Gc(t.target);if(e!==null){var r=Eu(e);if(r!==null){if(e=r.tag,e===13){if(e=g3(r),e!==null){t.blockedOn=e,k3(t.priority,function(){C3(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function rv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=kb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);wb=n,r.target.dispatchEvent(n),wb=null}else return e=Rp(r),e!==null&&L5(e),t.blockedOn=r,!1;e.shift()}return!0}function HS(t,e,r){rv(t)&&r.delete(e)}function nD(){Nb=!1,Ul!==null&&rv(Ul)&&(Ul=null),Vl!==null&&rv(Vl)&&(Vl=null),Wl!==null&&rv(Wl)&&(Wl=null),Hm.forEach(HS),Gm.forEach(HS)}function rm(t,e){t.blockedOn===e&&(t.blockedOn=null,Nb||(Nb=!0,Qs.unstable_scheduleCallback(Qs.unstable_NormalPriority,nD)))}function Ym(t){function e(s){return rm(s,t)}if(0<Kg.length){rm(Kg[0],t);for(var r=1;r<Kg.length;r++){var n=Kg[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ul!==null&&rm(Ul,t),Vl!==null&&rm(Vl,t),Wl!==null&&rm(Wl,t),Hm.forEach(e),Gm.forEach(e),r=0;r<kl.length;r++)n=kl[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<kl.length&&(r=kl[0],r.blockedOn===null);)E3(r),r.blockedOn===null&&kl.shift()}var eh=Yo.ReactCurrentBatchConfig,Rv=!0;function sD(t,e,r,n){var s=lr,i=eh.transition;eh.transition=null;try{lr=1,O5(t,e,r,n)}finally{lr=s,eh.transition=i}}function iD(t,e,r,n){var s=lr,i=eh.transition;eh.transition=null;try{lr=4,O5(t,e,r,n)}finally{lr=s,eh.transition=i}}function O5(t,e,r,n){if(Rv){var s=kb(t,e,r,n);if(s===null)s2(t,e,n,Dv,r),WS(t,n);else if(rD(s,t,e,r,n))n.stopPropagation();else if(WS(t,n),e&4&&-1<tD.indexOf(t)){for(;s!==null;){var i=Rp(s);if(i!==null&&S3(i),i=kb(t,e,r,n),i===null&&s2(t,e,n,Dv,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else s2(t,e,n,null,r)}}var Dv=null;function kb(t,e,r,n){if(Dv=null,t=P5(n),t=Gc(t),t!==null)if(e=Eu(t),e===null)t=null;else if(r=e.tag,r===13){if(t=g3(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dv=t,null}function P3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HR()){case A5:return 1;case b3:return 4;case Ov:case GR:return 16;case w3:return 536870912;default:return 16}default:return 16}}var $l=null,M5=null,nv=null;function A3(){if(nv)return nv;var t,e=M5,r=e.length,n,s="value"in $l?$l.value:$l.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return nv=s.slice(t,1<n?1-n:void 0)}function sv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Qg(){return!0}function GS(){return!1}function ni(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Qg:GS,this.isPropagationStopped=GS,this}return Mr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Qg)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Qg)},persist:function(){},isPersistent:Qg}),e}var Xh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},R5=ni(Xh),Mp=Mr({},Xh,{view:0,detail:0}),aD=ni(Mp),Xy,Ky,nm,qx=Mr({},Mp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:D5,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nm&&(nm&&t.type==="mousemove"?(Xy=t.screenX-nm.screenX,Ky=t.screenY-nm.screenY):Ky=Xy=0,nm=t),Xy)},movementY:function(t){return"movementY"in t?t.movementY:Ky}}),YS=ni(qx),oD=Mr({},qx,{dataTransfer:0}),lD=ni(oD),cD=Mr({},Mp,{relatedTarget:0}),Qy=ni(cD),uD=Mr({},Xh,{animationName:0,elapsedTime:0,pseudoElement:0}),dD=ni(uD),hD=Mr({},Xh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fD=ni(hD),mD=Mr({},Xh,{data:0}),XS=ni(mD),pD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vD[t])?!!e[t]:!1}function D5(){return xD}var yD=Mr({},Mp,{key:function(t){if(t.key){var e=pD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?gD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:D5,charCode:function(t){return t.type==="keypress"?sv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bD=ni(yD),wD=Mr({},qx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),KS=ni(wD),_D=Mr({},Mp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:D5}),jD=ni(_D),SD=Mr({},Xh,{propertyName:0,elapsedTime:0,pseudoElement:0}),CD=ni(SD),ND=Mr({},qx,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kD=ni(ND),ED=[9,13,27,32],F5=Ro&&"CompositionEvent"in window,Cm=null;Ro&&"documentMode"in document&&(Cm=document.documentMode);var PD=Ro&&"TextEvent"in window&&!Cm,T3=Ro&&(!F5||Cm&&8<Cm&&11>=Cm),QS=" ",JS=!1;function L3(t,e){switch(t){case"keyup":return ED.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ld=!1;function AD(t,e){switch(t){case"compositionend":return O3(e);case"keypress":return e.which!==32?null:(JS=!0,QS);case"textInput":return t=e.data,t===QS&&JS?null:t;default:return null}}function TD(t,e){if(Ld)return t==="compositionend"||!F5&&L3(t,e)?(t=A3(),nv=M5=$l=null,Ld=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T3&&e.locale!=="ko"?null:e.data;default:return null}}var LD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!LD[t.type]:e==="textarea"}function M3(t,e,r,n){d3(n),e=Fv(e,"onChange"),0<e.length&&(r=new R5("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Nm=null,Xm=null;function OD(t){W3(t,0)}function Ux(t){var e=Rd(t);if(s3(e))return t}function MD(t,e){if(t==="change")return e}var R3=!1;if(Ro){var Jy;if(Ro){var Zy="oninput"in document;if(!Zy){var eC=document.createElement("div");eC.setAttribute("oninput","return;"),Zy=typeof eC.oninput=="function"}Jy=Zy}else Jy=!1;R3=Jy&&(!document.documentMode||9<document.documentMode)}function tC(){Nm&&(Nm.detachEvent("onpropertychange",D3),Xm=Nm=null)}function D3(t){if(t.propertyName==="value"&&Ux(Xm)){var e=[];M3(e,Xm,t,P5(t)),p3(OD,e)}}function RD(t,e,r){t==="focusin"?(tC(),Nm=e,Xm=r,Nm.attachEvent("onpropertychange",D3)):t==="focusout"&&tC()}function DD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ux(Xm)}function FD(t,e){if(t==="click")return Ux(e)}function ID(t,e){if(t==="input"||t==="change")return Ux(e)}function zD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ia=typeof Object.is=="function"?Object.is:zD;function Km(t,e){if(ia(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!cb.call(e,s)||!ia(t[s],e[s]))return!1}return!0}function rC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nC(t,e){var r=rC(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=rC(r)}}function F3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?F3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function I3(){for(var t=window,e=Av();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Av(t.document)}return e}function I5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $D(t){var e=I3(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&F3(r.ownerDocument.documentElement,r)){if(n!==null&&I5(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=nC(r,i);var a=nC(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BD=Ro&&"documentMode"in document&&11>=document.documentMode,Od=null,Eb=null,km=null,Pb=!1;function sC(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Pb||Od==null||Od!==Av(n)||(n=Od,"selectionStart"in n&&I5(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),km&&Km(km,n)||(km=n,n=Fv(Eb,"onSelect"),0<n.length&&(e=new R5("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Od)))}function Jg(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Md={animationend:Jg("Animation","AnimationEnd"),animationiteration:Jg("Animation","AnimationIteration"),animationstart:Jg("Animation","AnimationStart"),transitionend:Jg("Transition","TransitionEnd")},e2={},z3={};Ro&&(z3=document.createElement("div").style,"AnimationEvent"in window||(delete Md.animationend.animation,delete Md.animationiteration.animation,delete Md.animationstart.animation),"TransitionEvent"in window||delete Md.transitionend.transition);function Vx(t){if(e2[t])return e2[t];if(!Md[t])return t;var e=Md[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in z3)return e2[t]=e[r];return t}var $3=Vx("animationend"),B3=Vx("animationiteration"),q3=Vx("animationstart"),U3=Vx("transitionend"),V3=new Map,iC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mc(t,e){V3.set(t,e),ku(e,[t])}for(var t2=0;t2<iC.length;t2++){var r2=iC[t2],qD=r2.toLowerCase(),UD=r2[0].toUpperCase()+r2.slice(1);mc(qD,"on"+UD)}mc($3,"onAnimationEnd");mc(B3,"onAnimationIteration");mc(q3,"onAnimationStart");mc("dblclick","onDoubleClick");mc("focusin","onFocus");mc("focusout","onBlur");mc(U3,"onTransitionEnd");Ph("onMouseEnter",["mouseout","mouseover"]);Ph("onMouseLeave",["mouseout","mouseover"]);Ph("onPointerEnter",["pointerout","pointerover"]);Ph("onPointerLeave",["pointerout","pointerover"]);ku("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ku("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ku("onBeforeInput",["compositionend","keypress","textInput","paste"]);ku("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VD=new Set("cancel close invalid load scroll toggle".split(" ").concat(xm));function aC(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,qR(n,e,void 0,t),t.currentTarget=null}function W3(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;aC(s,l,u),i=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;aC(s,l,u),i=c}}}if(Lv)throw t=Sb,Lv=!1,Sb=null,t}function _r(t,e){var r=e[Mb];r===void 0&&(r=e[Mb]=new Set);var n=t+"__bubble";r.has(n)||(H3(e,t,2,!1),r.add(n))}function n2(t,e,r){var n=0;e&&(n|=4),H3(r,t,n,e)}var Zg="_reactListening"+Math.random().toString(36).slice(2);function Qm(t){if(!t[Zg]){t[Zg]=!0,Z4.forEach(function(r){r!=="selectionchange"&&(VD.has(r)||n2(r,!1,t),n2(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Zg]||(e[Zg]=!0,n2("selectionchange",!1,e))}}function H3(t,e,r,n){switch(P3(e)){case 1:var s=sD;break;case 4:s=iD;break;default:s=O5}r=s.bind(null,e,r,t),s=void 0,!jb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function s2(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Gc(l),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}l=l.parentNode}}n=n.return}p3(function(){var u=i,d=P5(r),h=[];e:{var f=V3.get(t);if(f!==void 0){var m=R5,p=t;switch(t){case"keypress":if(sv(r)===0)break e;case"keydown":case"keyup":m=bD;break;case"focusin":p="focus",m=Qy;break;case"focusout":p="blur",m=Qy;break;case"beforeblur":case"afterblur":m=Qy;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=YS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=jD;break;case $3:case B3:case q3:m=dD;break;case U3:m=CD;break;case"scroll":m=aD;break;case"wheel":m=kD;break;case"copy":case"cut":case"paste":m=fD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=KS}var v=(e&4)!==0,b=!v&&t==="scroll",x=v?f!==null?f+"Capture":null:f;v=[];for(var w=u,_;w!==null;){_=w;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,x!==null&&(S=Wm(w,x),S!=null&&v.push(Jm(w,S,_)))),b)break;w=w.return}0<v.length&&(f=new m(f,p,null,r,d),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&r!==wb&&(p=r.relatedTarget||r.fromElement)&&(Gc(p)||p[Do]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=r.relatedTarget||r.toElement,m=u,p=p?Gc(p):null,p!==null&&(b=Eu(p),p!==b||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=u),m!==p)){if(v=YS,S="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=KS,S="onPointerLeave",x="onPointerEnter",w="pointer"),b=m==null?f:Rd(m),_=p==null?f:Rd(p),f=new v(S,w+"leave",m,r,d),f.target=b,f.relatedTarget=_,S=null,Gc(d)===u&&(v=new v(x,w+"enter",p,r,d),v.target=_,v.relatedTarget=b,S=v),b=S,m&&p)t:{for(v=m,x=p,w=0,_=v;_;_=hd(_))w++;for(_=0,S=x;S;S=hd(S))_++;for(;0<w-_;)v=hd(v),w--;for(;0<_-w;)x=hd(x),_--;for(;w--;){if(v===x||x!==null&&v===x.alternate)break t;v=hd(v),x=hd(x)}v=null}else v=null;m!==null&&oC(h,f,m,v,!1),p!==null&&b!==null&&oC(h,b,p,v,!0)}}e:{if(f=u?Rd(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var N=MD;else if(ZS(f))if(R3)N=ID;else{N=DD;var E=RD}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=FD);if(N&&(N=N(t,u))){M3(h,N,r,d);break e}E&&E(t,f,u),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&gb(f,"number",f.value)}switch(E=u?Rd(u):window,t){case"focusin":(ZS(E)||E.contentEditable==="true")&&(Od=E,Eb=u,km=null);break;case"focusout":km=Eb=Od=null;break;case"mousedown":Pb=!0;break;case"contextmenu":case"mouseup":case"dragend":Pb=!1,sC(h,r,d);break;case"selectionchange":if(BD)break;case"keydown":case"keyup":sC(h,r,d)}var P;if(F5)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Ld?L3(t,r)&&(A="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(T3&&r.locale!=="ko"&&(Ld||A!=="onCompositionStart"?A==="onCompositionEnd"&&Ld&&(P=A3()):($l=d,M5="value"in $l?$l.value:$l.textContent,Ld=!0)),E=Fv(u,A),0<E.length&&(A=new XS(A,t,null,r,d),h.push({event:A,listeners:E}),P?A.data=P:(P=O3(r),P!==null&&(A.data=P)))),(P=PD?AD(t,r):TD(t,r))&&(u=Fv(u,"onBeforeInput"),0<u.length&&(d=new XS("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=P))}W3(h,e)})}function Jm(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Fv(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Wm(t,r),i!=null&&n.unshift(Jm(t,i,s)),i=Wm(t,e),i!=null&&n.push(Jm(t,i,s))),t=t.return}return n}function hd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function oC(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Wm(r,i),c!=null&&a.unshift(Jm(r,c,l))):s||(c=Wm(r,i),c!=null&&a.push(Jm(r,c,l)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var WD=/\r\n?/g,HD=/\u0000|\uFFFD/g;function lC(t){return(typeof t=="string"?t:""+t).replace(WD,`
`).replace(HD,"")}function e0(t,e,r){if(e=lC(e),lC(t)!==e&&r)throw Error(Ie(425))}function Iv(){}var Ab=null,Tb=null;function Lb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ob=typeof setTimeout=="function"?setTimeout:void 0,GD=typeof clearTimeout=="function"?clearTimeout:void 0,cC=typeof Promise=="function"?Promise:void 0,YD=typeof queueMicrotask=="function"?queueMicrotask:typeof cC<"u"?function(t){return cC.resolve(null).then(t).catch(XD)}:Ob;function XD(t){setTimeout(function(){throw t})}function i2(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Ym(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ym(e)}function Hl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Kh=Math.random().toString(36).slice(2),Ra="__reactFiber$"+Kh,Zm="__reactProps$"+Kh,Do="__reactContainer$"+Kh,Mb="__reactEvents$"+Kh,KD="__reactListeners$"+Kh,QD="__reactHandles$"+Kh;function Gc(t){var e=t[Ra];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Do]||r[Ra]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=uC(t);t!==null;){if(r=t[Ra])return r;t=uC(t)}return e}t=r,r=t.parentNode}return null}function Rp(t){return t=t[Ra]||t[Do],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rd(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ie(33))}function Wx(t){return t[Zm]||null}var Rb=[],Dd=-1;function pc(t){return{current:t}}function Cr(t){0>Dd||(t.current=Rb[Dd],Rb[Dd]=null,Dd--)}function xr(t,e){Dd++,Rb[Dd]=t.current,t.current=e}var ec={},Kn=pc(ec),Ns=pc(!1),fu=ec;function Ah(t,e){var r=t.type.contextTypes;if(!r)return ec;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ks(t){return t=t.childContextTypes,t!=null}function zv(){Cr(Ns),Cr(Kn)}function dC(t,e,r){if(Kn.current!==ec)throw Error(Ie(168));xr(Kn,e),xr(Ns,r)}function G3(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Ie(108,RR(t)||"Unknown",s));return Mr({},r,n)}function $v(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ec,fu=Kn.current,xr(Kn,t),xr(Ns,Ns.current),!0}function hC(t,e,r){var n=t.stateNode;if(!n)throw Error(Ie(169));r?(t=G3(t,e,fu),n.__reactInternalMemoizedMergedChildContext=t,Cr(Ns),Cr(Kn),xr(Kn,t)):Cr(Ns),xr(Ns,r)}var _o=null,Hx=!1,a2=!1;function Y3(t){_o===null?_o=[t]:_o.push(t)}function JD(t){Hx=!0,Y3(t)}function gc(){if(!a2&&_o!==null){a2=!0;var t=0,e=lr;try{var r=_o;for(lr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}_o=null,Hx=!1}catch(s){throw _o!==null&&(_o=_o.slice(t+1)),y3(A5,gc),s}finally{lr=e,a2=!1}}return null}var Fd=[],Id=0,Bv=null,qv=0,gi=[],vi=0,mu=null,Co=1,No="";function Ic(t,e){Fd[Id++]=qv,Fd[Id++]=Bv,Bv=t,qv=e}function X3(t,e,r){gi[vi++]=Co,gi[vi++]=No,gi[vi++]=mu,mu=t;var n=Co;t=No;var s=32-ra(n)-1;n&=~(1<<s),r+=1;var i=32-ra(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Co=1<<32-ra(e)+s|r<<s|n,No=i+t}else Co=1<<i|r<<s|n,No=t}function z5(t){t.return!==null&&(Ic(t,1),X3(t,1,0))}function $5(t){for(;t===Bv;)Bv=Fd[--Id],Fd[Id]=null,qv=Fd[--Id],Fd[Id]=null;for(;t===mu;)mu=gi[--vi],gi[vi]=null,No=gi[--vi],gi[vi]=null,Co=gi[--vi],gi[vi]=null}var Xs=null,Gs=null,Nr=!1,Qi=null;function K3(t,e){var r=bi(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function fC(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xs=t,Gs=Hl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xs=t,Gs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=mu!==null?{id:Co,overflow:No}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=bi(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Xs=t,Gs=null,!0):!1;default:return!1}}function Db(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fb(t){if(Nr){var e=Gs;if(e){var r=e;if(!fC(t,e)){if(Db(t))throw Error(Ie(418));e=Hl(r.nextSibling);var n=Xs;e&&fC(t,e)?K3(n,r):(t.flags=t.flags&-4097|2,Nr=!1,Xs=t)}}else{if(Db(t))throw Error(Ie(418));t.flags=t.flags&-4097|2,Nr=!1,Xs=t}}}function mC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xs=t}function t0(t){if(t!==Xs)return!1;if(!Nr)return mC(t),Nr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Lb(t.type,t.memoizedProps)),e&&(e=Gs)){if(Db(t))throw Q3(),Error(Ie(418));for(;e;)K3(t,e),e=Hl(e.nextSibling)}if(mC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Gs=Hl(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Gs=null}}else Gs=Xs?Hl(t.stateNode.nextSibling):null;return!0}function Q3(){for(var t=Gs;t;)t=Hl(t.nextSibling)}function Th(){Gs=Xs=null,Nr=!1}function B5(t){Qi===null?Qi=[t]:Qi.push(t)}var ZD=Yo.ReactCurrentBatchConfig;function sm(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ie(309));var n=r.stateNode}if(!n)throw Error(Ie(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ie(284));if(!r._owner)throw Error(Ie(290,t))}return t}function r0(t,e){throw t=Object.prototype.toString.call(e),Error(Ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pC(t){var e=t._init;return e(t._payload)}function J3(t){function e(x,w){if(t){var _=x.deletions;_===null?(x.deletions=[w],x.flags|=16):_.push(w)}}function r(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function n(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function s(x,w){return x=Kl(x,w),x.index=0,x.sibling=null,x}function i(x,w,_){return x.index=_,t?(_=x.alternate,_!==null?(_=_.index,_<w?(x.flags|=2,w):_):(x.flags|=2,w)):(x.flags|=1048576,w)}function a(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,w,_,S){return w===null||w.tag!==6?(w=f2(_,x.mode,S),w.return=x,w):(w=s(w,_),w.return=x,w)}function c(x,w,_,S){var N=_.type;return N===Td?d(x,w,_.props.children,S,_.key):w!==null&&(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Sl&&pC(N)===w.type)?(S=s(w,_.props),S.ref=sm(x,w,_),S.return=x,S):(S=dv(_.type,_.key,_.props,null,x.mode,S),S.ref=sm(x,w,_),S.return=x,S)}function u(x,w,_,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=m2(_,x.mode,S),w.return=x,w):(w=s(w,_.children||[]),w.return=x,w)}function d(x,w,_,S,N){return w===null||w.tag!==7?(w=cu(_,x.mode,S,N),w.return=x,w):(w=s(w,_),w.return=x,w)}function h(x,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=f2(""+w,x.mode,_),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wg:return _=dv(w.type,w.key,w.props,null,x.mode,_),_.ref=sm(x,null,w),_.return=x,_;case Ad:return w=m2(w,x.mode,_),w.return=x,w;case Sl:var S=w._init;return h(x,S(w._payload),_)}if(gm(w)||Zf(w))return w=cu(w,x.mode,_,null),w.return=x,w;r0(x,w)}return null}function f(x,w,_,S){var N=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return N!==null?null:l(x,w,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Wg:return _.key===N?c(x,w,_,S):null;case Ad:return _.key===N?u(x,w,_,S):null;case Sl:return N=_._init,f(x,w,N(_._payload),S)}if(gm(_)||Zf(_))return N!==null?null:d(x,w,_,S,null);r0(x,_)}return null}function m(x,w,_,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(_)||null,l(w,x,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wg:return x=x.get(S.key===null?_:S.key)||null,c(w,x,S,N);case Ad:return x=x.get(S.key===null?_:S.key)||null,u(w,x,S,N);case Sl:var E=S._init;return m(x,w,_,E(S._payload),N)}if(gm(S)||Zf(S))return x=x.get(_)||null,d(w,x,S,N,null);r0(w,S)}return null}function p(x,w,_,S){for(var N=null,E=null,P=w,A=w=0,F=null;P!==null&&A<_.length;A++){P.index>A?(F=P,P=null):F=P.sibling;var Y=f(x,P,_[A],S);if(Y===null){P===null&&(P=F);break}t&&P&&Y.alternate===null&&e(x,P),w=i(Y,w,A),E===null?N=Y:E.sibling=Y,E=Y,P=F}if(A===_.length)return r(x,P),Nr&&Ic(x,A),N;if(P===null){for(;A<_.length;A++)P=h(x,_[A],S),P!==null&&(w=i(P,w,A),E===null?N=P:E.sibling=P,E=P);return Nr&&Ic(x,A),N}for(P=n(x,P);A<_.length;A++)F=m(P,x,A,_[A],S),F!==null&&(t&&F.alternate!==null&&P.delete(F.key===null?A:F.key),w=i(F,w,A),E===null?N=F:E.sibling=F,E=F);return t&&P.forEach(function(T){return e(x,T)}),Nr&&Ic(x,A),N}function v(x,w,_,S){var N=Zf(_);if(typeof N!="function")throw Error(Ie(150));if(_=N.call(_),_==null)throw Error(Ie(151));for(var E=N=null,P=w,A=w=0,F=null,Y=_.next();P!==null&&!Y.done;A++,Y=_.next()){P.index>A?(F=P,P=null):F=P.sibling;var T=f(x,P,Y.value,S);if(T===null){P===null&&(P=F);break}t&&P&&T.alternate===null&&e(x,P),w=i(T,w,A),E===null?N=T:E.sibling=T,E=T,P=F}if(Y.done)return r(x,P),Nr&&Ic(x,A),N;if(P===null){for(;!Y.done;A++,Y=_.next())Y=h(x,Y.value,S),Y!==null&&(w=i(Y,w,A),E===null?N=Y:E.sibling=Y,E=Y);return Nr&&Ic(x,A),N}for(P=n(x,P);!Y.done;A++,Y=_.next())Y=m(P,x,A,Y.value,S),Y!==null&&(t&&Y.alternate!==null&&P.delete(Y.key===null?A:Y.key),w=i(Y,w,A),E===null?N=Y:E.sibling=Y,E=Y);return t&&P.forEach(function(O){return e(x,O)}),Nr&&Ic(x,A),N}function b(x,w,_,S){if(typeof _=="object"&&_!==null&&_.type===Td&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Wg:e:{for(var N=_.key,E=w;E!==null;){if(E.key===N){if(N=_.type,N===Td){if(E.tag===7){r(x,E.sibling),w=s(E,_.props.children),w.return=x,x=w;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Sl&&pC(N)===E.type){r(x,E.sibling),w=s(E,_.props),w.ref=sm(x,E,_),w.return=x,x=w;break e}r(x,E);break}else e(x,E);E=E.sibling}_.type===Td?(w=cu(_.props.children,x.mode,S,_.key),w.return=x,x=w):(S=dv(_.type,_.key,_.props,null,x.mode,S),S.ref=sm(x,w,_),S.return=x,x=S)}return a(x);case Ad:e:{for(E=_.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){r(x,w.sibling),w=s(w,_.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else e(x,w);w=w.sibling}w=m2(_,x.mode,S),w.return=x,x=w}return a(x);case Sl:return E=_._init,b(x,w,E(_._payload),S)}if(gm(_))return p(x,w,_,S);if(Zf(_))return v(x,w,_,S);r0(x,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(r(x,w.sibling),w=s(w,_),w.return=x,x=w):(r(x,w),w=f2(_,x.mode,S),w.return=x,x=w),a(x)):r(x,w)}return b}var Lh=J3(!0),Z3=J3(!1),Uv=pc(null),Vv=null,zd=null,q5=null;function U5(){q5=zd=Vv=null}function V5(t){var e=Uv.current;Cr(Uv),t._currentValue=e}function Ib(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function th(t,e){Vv=t,q5=zd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cs=!0),t.firstContext=null)}function ji(t){var e=t._currentValue;if(q5!==t)if(t={context:t,memoizedValue:e,next:null},zd===null){if(Vv===null)throw Error(Ie(308));zd=t,Vv.dependencies={lanes:0,firstContext:t}}else zd=zd.next=t;return e}var Yc=null;function W5(t){Yc===null?Yc=[t]:Yc.push(t)}function eE(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,W5(e)):(r.next=s.next,s.next=r),e.interleaved=r,Fo(t,n)}function Fo(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Cl=!1;function H5(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ao(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Yt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Fo(t,r)}return s=n.interleaved,s===null?(e.next=e,W5(n)):(e.next=s.next,s.next=e),n.interleaved=e,Fo(t,r)}function iv(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,T5(t,r)}}function gC(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Wv(t,e,r,n){var s=t.updateQueue;Cl=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,v=l;switch(f=e,m=r,v.tag){case 1:if(p=v.payload,typeof p=="function"){h=p.call(m,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,f=typeof p=="function"?p.call(m,h,f):p,f==null)break e;h=Mr({},h,f);break e;case 2:Cl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,a|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);gu|=a,t.lanes=a,t.memoizedState=h}}function vC(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ie(191,s));s.call(n)}}}var Dp={},Va=pc(Dp),ep=pc(Dp),tp=pc(Dp);function Xc(t){if(t===Dp)throw Error(Ie(174));return t}function G5(t,e){switch(xr(tp,e),xr(ep,t),xr(Va,Dp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xb(e,t)}Cr(Va),xr(Va,e)}function Oh(){Cr(Va),Cr(ep),Cr(tp)}function rE(t){Xc(tp.current);var e=Xc(Va.current),r=xb(e,t.type);e!==r&&(xr(ep,t),xr(Va,r))}function Y5(t){ep.current===t&&(Cr(Va),Cr(ep))}var Tr=pc(0);function Hv(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var o2=[];function X5(){for(var t=0;t<o2.length;t++)o2[t]._workInProgressVersionPrimary=null;o2.length=0}var av=Yo.ReactCurrentDispatcher,l2=Yo.ReactCurrentBatchConfig,pu=0,Lr=null,cn=null,bn=null,Gv=!1,Em=!1,rp=0,eF=0;function Fn(){throw Error(Ie(321))}function K5(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ia(t[r],e[r]))return!1;return!0}function Q5(t,e,r,n,s,i){if(pu=i,Lr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,av.current=t===null||t.memoizedState===null?sF:iF,t=r(n,s),Em){i=0;do{if(Em=!1,rp=0,25<=i)throw Error(Ie(301));i+=1,bn=cn=null,e.updateQueue=null,av.current=aF,t=r(n,s)}while(Em)}if(av.current=Yv,e=cn!==null&&cn.next!==null,pu=0,bn=cn=Lr=null,Gv=!1,e)throw Error(Ie(300));return t}function J5(){var t=rp!==0;return rp=0,t}function Aa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?Lr.memoizedState=bn=t:bn=bn.next=t,bn}function Si(){if(cn===null){var t=Lr.alternate;t=t!==null?t.memoizedState:null}else t=cn.next;var e=bn===null?Lr.memoizedState:bn.next;if(e!==null)bn=e,cn=t;else{if(t===null)throw Error(Ie(310));cn=t,t={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},bn===null?Lr.memoizedState=bn=t:bn=bn.next=t}return bn}function np(t,e){return typeof e=="function"?e(t):e}function c2(t){var e=Si(),r=e.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=t;var n=cn,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((pu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=n):c=c.next=h,Lr.lanes|=d,gu|=d}u=u.next}while(u!==null&&u!==i);c===null?a=n:c.next=l,ia(n,e.memoizedState)||(Cs=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Lr.lanes|=i,gu|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function u2(t){var e=Si(),r=e.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);ia(i,e.memoizedState)||(Cs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function nE(){}function sE(t,e){var r=Lr,n=Si(),s=e(),i=!ia(n.memoizedState,s);if(i&&(n.memoizedState=s,Cs=!0),n=n.queue,Z5(oE.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||bn!==null&&bn.memoizedState.tag&1){if(r.flags|=2048,sp(9,aE.bind(null,r,n,s,e),void 0,null),_n===null)throw Error(Ie(349));pu&30||iE(r,e,s)}return s}function iE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Lr.updateQueue,e===null?(e={lastEffect:null,stores:null},Lr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function aE(t,e,r,n){e.value=r,e.getSnapshot=n,lE(e)&&cE(t)}function oE(t,e,r){return r(function(){lE(e)&&cE(t)})}function lE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ia(t,r)}catch{return!0}}function cE(t){var e=Fo(t,1);e!==null&&na(e,t,1,-1)}function xC(t){var e=Aa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:np,lastRenderedState:t},e.queue=t,t=t.dispatch=nF.bind(null,Lr,t),[e.memoizedState,t]}function sp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Lr.updateQueue,e===null?(e={lastEffect:null,stores:null},Lr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function uE(){return Si().memoizedState}function ov(t,e,r,n){var s=Aa();Lr.flags|=t,s.memoizedState=sp(1|e,r,void 0,n===void 0?null:n)}function Gx(t,e,r,n){var s=Si();n=n===void 0?null:n;var i=void 0;if(cn!==null){var a=cn.memoizedState;if(i=a.destroy,n!==null&&K5(n,a.deps)){s.memoizedState=sp(e,r,i,n);return}}Lr.flags|=t,s.memoizedState=sp(1|e,r,i,n)}function yC(t,e){return ov(8390656,8,t,e)}function Z5(t,e){return Gx(2048,8,t,e)}function dE(t,e){return Gx(4,2,t,e)}function hE(t,e){return Gx(4,4,t,e)}function fE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mE(t,e,r){return r=r!=null?r.concat([t]):null,Gx(4,4,fE.bind(null,e,t),r)}function e_(){}function pE(t,e){var r=Si();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&K5(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function gE(t,e){var r=Si();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&K5(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function vE(t,e,r){return pu&21?(ia(r,e)||(r=_3(),Lr.lanes|=r,gu|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cs=!0),t.memoizedState=r)}function tF(t,e){var r=lr;lr=r!==0&&4>r?r:4,t(!0);var n=l2.transition;l2.transition={};try{t(!1),e()}finally{lr=r,l2.transition=n}}function xE(){return Si().memoizedState}function rF(t,e,r){var n=Xl(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},yE(t))bE(e,r);else if(r=eE(t,e,r,n),r!==null){var s=as();na(r,t,n,s),wE(r,e,n)}}function nF(t,e,r){var n=Xl(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(yE(t))bE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,ia(l,a)){var c=e.interleaved;c===null?(s.next=s,W5(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=eE(t,e,s,n),r!==null&&(s=as(),na(r,t,n,s),wE(r,e,n))}}function yE(t){var e=t.alternate;return t===Lr||e!==null&&e===Lr}function bE(t,e){Em=Gv=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function wE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,T5(t,r)}}var Yv={readContext:ji,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useInsertionEffect:Fn,useLayoutEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useMutableSource:Fn,useSyncExternalStore:Fn,useId:Fn,unstable_isNewReconciler:!1},sF={readContext:ji,useCallback:function(t,e){return Aa().memoizedState=[t,e===void 0?null:e],t},useContext:ji,useEffect:yC,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,ov(4194308,4,fE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return ov(4194308,4,t,e)},useInsertionEffect:function(t,e){return ov(4,2,t,e)},useMemo:function(t,e){var r=Aa();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Aa();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=rF.bind(null,Lr,t),[n.memoizedState,t]},useRef:function(t){var e=Aa();return t={current:t},e.memoizedState=t},useState:xC,useDebugValue:e_,useDeferredValue:function(t){return Aa().memoizedState=t},useTransition:function(){var t=xC(!1),e=t[0];return t=tF.bind(null,t[1]),Aa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Lr,s=Aa();if(Nr){if(r===void 0)throw Error(Ie(407));r=r()}else{if(r=e(),_n===null)throw Error(Ie(349));pu&30||iE(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,yC(oE.bind(null,n,i,t),[t]),n.flags|=2048,sp(9,aE.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=Aa(),e=_n.identifierPrefix;if(Nr){var r=No,n=Co;r=(n&~(1<<32-ra(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=rp++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=eF++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iF={readContext:ji,useCallback:pE,useContext:ji,useEffect:Z5,useImperativeHandle:mE,useInsertionEffect:dE,useLayoutEffect:hE,useMemo:gE,useReducer:c2,useRef:uE,useState:function(){return c2(np)},useDebugValue:e_,useDeferredValue:function(t){var e=Si();return vE(e,cn.memoizedState,t)},useTransition:function(){var t=c2(np)[0],e=Si().memoizedState;return[t,e]},useMutableSource:nE,useSyncExternalStore:sE,useId:xE,unstable_isNewReconciler:!1},aF={readContext:ji,useCallback:pE,useContext:ji,useEffect:Z5,useImperativeHandle:mE,useInsertionEffect:dE,useLayoutEffect:hE,useMemo:gE,useReducer:u2,useRef:uE,useState:function(){return u2(np)},useDebugValue:e_,useDeferredValue:function(t){var e=Si();return cn===null?e.memoizedState=t:vE(e,cn.memoizedState,t)},useTransition:function(){var t=u2(np)[0],e=Si().memoizedState;return[t,e]},useMutableSource:nE,useSyncExternalStore:sE,useId:xE,unstable_isNewReconciler:!1};function Wi(t,e){if(t&&t.defaultProps){e=Mr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function zb(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Mr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Yx={isMounted:function(t){return(t=t._reactInternals)?Eu(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=as(),s=Xl(t),i=Ao(n,s);i.payload=e,r!=null&&(i.callback=r),e=Gl(t,i,s),e!==null&&(na(e,t,s,n),iv(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=as(),s=Xl(t),i=Ao(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Gl(t,i,s),e!==null&&(na(e,t,s,n),iv(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=as(),n=Xl(t),s=Ao(r,n);s.tag=2,e!=null&&(s.callback=e),e=Gl(t,s,n),e!==null&&(na(e,t,n,r),iv(e,t,n))}};function bC(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!Km(r,n)||!Km(s,i):!0}function _E(t,e,r){var n=!1,s=ec,i=e.contextType;return typeof i=="object"&&i!==null?i=ji(i):(s=ks(e)?fu:Kn.current,n=e.contextTypes,i=(n=n!=null)?Ah(t,s):ec),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yx,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function wC(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Yx.enqueueReplaceState(e,e.state,null)}function $b(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},H5(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ji(i):(i=ks(e)?fu:Kn.current,s.context=Ah(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zb(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Yx.enqueueReplaceState(s,s.state,null),Wv(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mh(t,e){try{var r="",n=e;do r+=MR(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function d2(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Bb(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var oF=typeof WeakMap=="function"?WeakMap:Map;function jE(t,e,r){r=Ao(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Kv||(Kv=!0,Qb=n),Bb(t,e)},r}function SE(t,e,r){r=Ao(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Bb(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Bb(t,e),typeof n!="function"&&(Yl===null?Yl=new Set([this]):Yl.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function _C(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new oF;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=wF.bind(null,t,e,r),e.then(t,t))}function jC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function SC(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ao(-1,1),e.tag=2,Gl(r,e,1))),r.lanes|=1),t)}var lF=Yo.ReactCurrentOwner,Cs=!1;function ss(t,e,r,n){e.child=t===null?Z3(e,null,r,n):Lh(e,t.child,r,n)}function CC(t,e,r,n,s){r=r.render;var i=e.ref;return th(e,s),n=Q5(t,e,r,n,i,s),r=J5(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Io(t,e,s)):(Nr&&r&&z5(e),e.flags|=1,ss(t,e,n,s),e.child)}function NC(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!l_(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,CE(t,e,i,n,s)):(t=dv(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Km,r(a,n)&&t.ref===e.ref)return Io(t,e,s)}return e.flags|=1,t=Kl(i,n),t.ref=e.ref,t.return=e,e.child=t}function CE(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Km(i,n)&&t.ref===e.ref)if(Cs=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Cs=!0);else return e.lanes=t.lanes,Io(t,e,s)}return qb(t,e,r,n,s)}function NE(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Bd,Vs),Vs|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xr(Bd,Vs),Vs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,xr(Bd,Vs),Vs|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,xr(Bd,Vs),Vs|=n;return ss(t,e,s,r),e.child}function kE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function qb(t,e,r,n,s){var i=ks(r)?fu:Kn.current;return i=Ah(e,i),th(e,s),r=Q5(t,e,r,n,i,s),n=J5(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Io(t,e,s)):(Nr&&n&&z5(e),e.flags|=1,ss(t,e,r,s),e.child)}function kC(t,e,r,n,s){if(ks(r)){var i=!0;$v(e)}else i=!1;if(th(e,s),e.stateNode===null)lv(t,e),_E(e,r,n),$b(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=ji(u):(u=ks(r)?fu:Kn.current,u=Ah(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==u)&&wC(e,a,n,u),Cl=!1;var f=e.memoizedState;a.state=f,Wv(e,n,a,s),c=e.memoizedState,l!==n||f!==c||Ns.current||Cl?(typeof d=="function"&&(zb(e,r,d,n),c=e.memoizedState),(l=Cl||bC(e,r,l,n,f,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),a.props=n,a.state=c,a.context=u,n=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,tE(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Wi(e.type,l),a.props=u,h=e.pendingProps,f=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=ji(c):(c=ks(r)?fu:Kn.current,c=Ah(e,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||f!==c)&&wC(e,a,n,c),Cl=!1,f=e.memoizedState,a.state=f,Wv(e,n,a,s);var p=e.memoizedState;l!==h||f!==p||Ns.current||Cl?(typeof m=="function"&&(zb(e,r,m,n),p=e.memoizedState),(u=Cl||bC(e,r,u,n,f,p,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,p,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,p,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),a.props=n,a.state=p,a.context=c,n=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Ub(t,e,r,n,i,s)}function Ub(t,e,r,n,s,i){kE(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&hC(e,r,!1),Io(t,e,i);n=e.stateNode,lF.current=e;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Lh(e,t.child,null,i),e.child=Lh(e,null,l,i)):ss(t,e,l,i),e.memoizedState=n.state,s&&hC(e,r,!0),e.child}function EE(t){var e=t.stateNode;e.pendingContext?dC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dC(t,e.context,!1),G5(t,e.containerInfo)}function EC(t,e,r,n,s){return Th(),B5(s),e.flags|=256,ss(t,e,r,n),e.child}var Vb={dehydrated:null,treeContext:null,retryLane:0};function Wb(t){return{baseLanes:t,cachePool:null,transitions:null}}function PE(t,e,r){var n=e.pendingProps,s=Tr.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),xr(Tr,s&1),t===null)return Fb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Qx(a,n,0,null),t=cu(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Wb(r),e.memoizedState=Vb,t):t_(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return cF(t,e,a,n,l,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Kl(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Kl(l,i):(i=cu(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Wb(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Vb,n}return i=t.child,t=i.sibling,n=Kl(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function t_(t,e){return e=Qx({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function n0(t,e,r,n){return n!==null&&B5(n),Lh(e,t.child,null,r),t=t_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cF(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=d2(Error(Ie(422))),n0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Qx({mode:"visible",children:n.children},s,0,null),i=cu(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Lh(e,t.child,null,a),e.child.memoizedState=Wb(a),e.memoizedState=Vb,i);if(!(e.mode&1))return n0(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Ie(419)),n=d2(i,n,void 0),n0(t,e,a,n)}if(l=(a&t.childLanes)!==0,Cs||l){if(n=_n,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Fo(t,s),na(n,t,s,-1))}return o_(),n=d2(Error(Ie(421))),n0(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=_F.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Gs=Hl(s.nextSibling),Xs=e,Nr=!0,Qi=null,t!==null&&(gi[vi++]=Co,gi[vi++]=No,gi[vi++]=mu,Co=t.id,No=t.overflow,mu=e),e=t_(e,n.children),e.flags|=4096,e)}function PC(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Ib(t.return,e,r)}function h2(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function AE(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(ss(t,e,n.children,r),n=Tr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&PC(t,r,e);else if(t.tag===19)PC(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(xr(Tr,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Hv(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),h2(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Hv(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}h2(e,!0,r,null,i);break;case"together":h2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Io(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),gu|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ie(153));if(e.child!==null){for(t=e.child,r=Kl(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Kl(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function uF(t,e,r){switch(e.tag){case 3:EE(e),Th();break;case 5:rE(e);break;case 1:ks(e.type)&&$v(e);break;case 4:G5(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;xr(Uv,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(xr(Tr,Tr.current&1),e.flags|=128,null):r&e.child.childLanes?PE(t,e,r):(xr(Tr,Tr.current&1),t=Io(t,e,r),t!==null?t.sibling:null);xr(Tr,Tr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return AE(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),xr(Tr,Tr.current),n)break;return null;case 22:case 23:return e.lanes=0,NE(t,e,r)}return Io(t,e,r)}var TE,Hb,LE,OE;TE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Hb=function(){};LE=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Xc(Va.current);var i=null;switch(r){case"input":s=mb(t,s),n=mb(t,n),i=[];break;case"select":s=Mr({},s,{value:void 0}),n=Mr({},n,{value:void 0}),i=[];break;case"textarea":s=vb(t,s),n=vb(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Iv)}yb(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Um.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Um.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&_r("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};OE=function(t,e,r,n){r!==n&&(e.flags|=4)};function im(t,e){if(!Nr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function In(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function dF(t,e,r){var n=e.pendingProps;switch($5(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(e),null;case 1:return ks(e.type)&&zv(),In(e),null;case 3:return n=e.stateNode,Oh(),Cr(Ns),Cr(Kn),X5(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(t0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qi!==null&&(ew(Qi),Qi=null))),Hb(t,e),In(e),null;case 5:Y5(e);var s=Xc(tp.current);if(r=e.type,t!==null&&e.stateNode!=null)LE(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ie(166));return In(e),null}if(t=Xc(Va.current),t0(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Ra]=e,n[Zm]=i,t=(e.mode&1)!==0,r){case"dialog":_r("cancel",n),_r("close",n);break;case"iframe":case"object":case"embed":_r("load",n);break;case"video":case"audio":for(s=0;s<xm.length;s++)_r(xm[s],n);break;case"source":_r("error",n);break;case"img":case"image":case"link":_r("error",n),_r("load",n);break;case"details":_r("toggle",n);break;case"input":IS(n,i),_r("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},_r("invalid",n);break;case"textarea":$S(n,i),_r("invalid",n)}yb(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&e0(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&e0(n.textContent,l,t),s=["children",""+l]):Um.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&_r("scroll",n)}switch(r){case"input":Hg(n),zS(n,i,!0);break;case"textarea":Hg(n),BS(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Iv)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=o3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Ra]=e,t[Zm]=n,TE(t,e,!1,!1),e.stateNode=t;e:{switch(a=bb(r,n),r){case"dialog":_r("cancel",t),_r("close",t),s=n;break;case"iframe":case"object":case"embed":_r("load",t),s=n;break;case"video":case"audio":for(s=0;s<xm.length;s++)_r(xm[s],t);s=n;break;case"source":_r("error",t),s=n;break;case"img":case"image":case"link":_r("error",t),_r("load",t),s=n;break;case"details":_r("toggle",t),s=n;break;case"input":IS(t,n),s=mb(t,n),_r("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Mr({},n,{value:void 0}),_r("invalid",t);break;case"textarea":$S(t,n),s=vb(t,n),_r("invalid",t);break;default:s=n}yb(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?u3(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&l3(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Vm(t,c):typeof c=="number"&&Vm(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Um.hasOwnProperty(i)?c!=null&&i==="onScroll"&&_r("scroll",t):c!=null&&C5(t,i,c,a))}switch(r){case"input":Hg(t),zS(t,n,!1);break;case"textarea":Hg(t),BS(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Zl(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Qd(t,!!n.multiple,i,!1):n.defaultValue!=null&&Qd(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Iv)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return In(e),null;case 6:if(t&&e.stateNode!=null)OE(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ie(166));if(r=Xc(tp.current),Xc(Va.current),t0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ra]=e,(i=n.nodeValue!==r)&&(t=Xs,t!==null))switch(t.tag){case 3:e0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&e0(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ra]=e,e.stateNode=n}return In(e),null;case 13:if(Cr(Tr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nr&&Gs!==null&&e.mode&1&&!(e.flags&128))Q3(),Th(),e.flags|=98560,i=!1;else if(i=t0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Ie(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ie(317));i[Ra]=e}else Th(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;In(e),i=!1}else Qi!==null&&(ew(Qi),Qi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Tr.current&1?dn===0&&(dn=3):o_())),e.updateQueue!==null&&(e.flags|=4),In(e),null);case 4:return Oh(),Hb(t,e),t===null&&Qm(e.stateNode.containerInfo),In(e),null;case 10:return V5(e.type._context),In(e),null;case 17:return ks(e.type)&&zv(),In(e),null;case 19:if(Cr(Tr),i=e.memoizedState,i===null)return In(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)im(i,!1);else{if(dn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Hv(t),a!==null){for(e.flags|=128,im(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return xr(Tr,Tr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Gr()>Rh&&(e.flags|=128,n=!0,im(i,!1),e.lanes=4194304)}else{if(!n)if(t=Hv(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),im(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Nr)return In(e),null}else 2*Gr()-i.renderingStartTime>Rh&&r!==1073741824&&(e.flags|=128,n=!0,im(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Gr(),e.sibling=null,r=Tr.current,xr(Tr,n?r&1|2:r&1),e):(In(e),null);case 22:case 23:return a_(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Vs&1073741824&&(In(e),e.subtreeFlags&6&&(e.flags|=8192)):In(e),null;case 24:return null;case 25:return null}throw Error(Ie(156,e.tag))}function hF(t,e){switch($5(e),e.tag){case 1:return ks(e.type)&&zv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oh(),Cr(Ns),Cr(Kn),X5(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Y5(e),null;case 13:if(Cr(Tr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ie(340));Th()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Cr(Tr),null;case 4:return Oh(),null;case 10:return V5(e.type._context),null;case 22:case 23:return a_(),null;case 24:return null;default:return null}}var s0=!1,Gn=!1,fF=typeof WeakSet=="function"?WeakSet:Set,tt=null;function $d(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){$r(t,e,n)}else r.current=null}function Gb(t,e,r){try{r()}catch(n){$r(t,e,n)}}var AC=!1;function mF(t,e){if(Ab=Rv,t=I3(),I5(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(l=a+s),h!==i||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===r&&++u===s&&(l=a),f===i&&++d===n&&(c=a),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tb={focusedElem:t,selectionRange:r},Rv=!1,tt=e;tt!==null;)if(e=tt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,tt=t;else for(;tt!==null;){e=tt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,b=p.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?v:Wi(e.type,v),b);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(S){$r(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,tt=t;break}tt=e.return}return p=AC,AC=!1,p}function Pm(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Gb(e,r,i)}s=s.next}while(s!==n)}}function Xx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Yb(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ME(t){var e=t.alternate;e!==null&&(t.alternate=null,ME(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ra],delete e[Zm],delete e[Mb],delete e[KD],delete e[QD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function RE(t){return t.tag===5||t.tag===3||t.tag===4}function TC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||RE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xb(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Iv));else if(n!==4&&(t=t.child,t!==null))for(Xb(t,e,r),t=t.sibling;t!==null;)Xb(t,e,r),t=t.sibling}function Kb(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Kb(t,e,r),t=t.sibling;t!==null;)Kb(t,e,r),t=t.sibling}var kn=null,Yi=!1;function fl(t,e,r){for(r=r.child;r!==null;)DE(t,e,r),r=r.sibling}function DE(t,e,r){if(Ua&&typeof Ua.onCommitFiberUnmount=="function")try{Ua.onCommitFiberUnmount(Bx,r)}catch{}switch(r.tag){case 5:Gn||$d(r,e);case 6:var n=kn,s=Yi;kn=null,fl(t,e,r),kn=n,Yi=s,kn!==null&&(Yi?(t=kn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kn.removeChild(r.stateNode));break;case 18:kn!==null&&(Yi?(t=kn,r=r.stateNode,t.nodeType===8?i2(t.parentNode,r):t.nodeType===1&&i2(t,r),Ym(t)):i2(kn,r.stateNode));break;case 4:n=kn,s=Yi,kn=r.stateNode.containerInfo,Yi=!0,fl(t,e,r),kn=n,Yi=s;break;case 0:case 11:case 14:case 15:if(!Gn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Gb(r,e,a),s=s.next}while(s!==n)}fl(t,e,r);break;case 1:if(!Gn&&($d(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){$r(r,e,l)}fl(t,e,r);break;case 21:fl(t,e,r);break;case 22:r.mode&1?(Gn=(n=Gn)||r.memoizedState!==null,fl(t,e,r),Gn=n):fl(t,e,r);break;default:fl(t,e,r)}}function LC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new fF),e.forEach(function(n){var s=jF.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ii(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:kn=l.stateNode,Yi=!1;break e;case 3:kn=l.stateNode.containerInfo,Yi=!0;break e;case 4:kn=l.stateNode.containerInfo,Yi=!0;break e}l=l.return}if(kn===null)throw Error(Ie(160));DE(i,a,s),kn=null,Yi=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){$r(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)FE(e,t),e=e.sibling}function FE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ii(e,t),Ea(t),n&4){try{Pm(3,t,t.return),Xx(3,t)}catch(v){$r(t,t.return,v)}try{Pm(5,t,t.return)}catch(v){$r(t,t.return,v)}}break;case 1:Ii(e,t),Ea(t),n&512&&r!==null&&$d(r,r.return);break;case 5:if(Ii(e,t),Ea(t),n&512&&r!==null&&$d(r,r.return),t.flags&32){var s=t.stateNode;try{Vm(s,"")}catch(v){$r(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&i3(s,i),bb(l,a);var u=bb(l,i);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?u3(s,h):d==="dangerouslySetInnerHTML"?l3(s,h):d==="children"?Vm(s,h):C5(s,d,h,u)}switch(l){case"input":pb(s,i);break;case"textarea":a3(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Qd(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Qd(s,!!i.multiple,i.defaultValue,!0):Qd(s,!!i.multiple,i.multiple?[]:"",!1))}s[Zm]=i}catch(v){$r(t,t.return,v)}}break;case 6:if(Ii(e,t),Ea(t),n&4){if(t.stateNode===null)throw Error(Ie(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){$r(t,t.return,v)}}break;case 3:if(Ii(e,t),Ea(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ym(e.containerInfo)}catch(v){$r(t,t.return,v)}break;case 4:Ii(e,t),Ea(t);break;case 13:Ii(e,t),Ea(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(s_=Gr())),n&4&&LC(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Gn=(u=Gn)||d,Ii(e,t),Gn=u):Ii(e,t),Ea(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(tt=t,d=t.child;d!==null;){for(h=tt=d;tt!==null;){switch(f=tt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Pm(4,f,f.return);break;case 1:$d(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){$r(n,r,v)}}break;case 5:$d(f,f.return);break;case 22:if(f.memoizedState!==null){MC(h);continue}}m!==null?(m.return=f,tt=m):MC(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=c3("display",a))}catch(v){$r(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){$r(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ii(e,t),Ea(t),n&4&&LC(t);break;case 21:break;default:Ii(e,t),Ea(t)}}function Ea(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(RE(r)){var n=r;break e}r=r.return}throw Error(Ie(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Vm(s,""),n.flags&=-33);var i=TC(t);Kb(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=TC(t);Xb(t,l,a);break;default:throw Error(Ie(161))}}catch(c){$r(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function pF(t,e,r){tt=t,IE(t)}function IE(t,e,r){for(var n=(t.mode&1)!==0;tt!==null;){var s=tt,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||s0;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Gn;l=s0;var u=Gn;if(s0=a,(Gn=c)&&!u)for(tt=s;tt!==null;)a=tt,c=a.child,a.tag===22&&a.memoizedState!==null?RC(s):c!==null?(c.return=a,tt=c):RC(s);for(;i!==null;)tt=i,IE(i),i=i.sibling;tt=s,s0=l,Gn=u}OC(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,tt=i):OC(t)}}function OC(t){for(;tt!==null;){var e=tt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gn||Xx(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Gn)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Wi(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&vC(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}vC(e,a,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ym(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}Gn||e.flags&512&&Yb(e)}catch(f){$r(e,e.return,f)}}if(e===t){tt=null;break}if(r=e.sibling,r!==null){r.return=e.return,tt=r;break}tt=e.return}}function MC(t){for(;tt!==null;){var e=tt;if(e===t){tt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,tt=r;break}tt=e.return}}function RC(t){for(;tt!==null;){var e=tt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Xx(4,e)}catch(c){$r(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){$r(e,s,c)}}var i=e.return;try{Yb(e)}catch(c){$r(e,i,c)}break;case 5:var a=e.return;try{Yb(e)}catch(c){$r(e,a,c)}}}catch(c){$r(e,e.return,c)}if(e===t){tt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,tt=l;break}tt=e.return}}var gF=Math.ceil,Xv=Yo.ReactCurrentDispatcher,r_=Yo.ReactCurrentOwner,wi=Yo.ReactCurrentBatchConfig,Yt=0,_n=null,sn=null,Ln=0,Vs=0,Bd=pc(0),dn=0,ip=null,gu=0,Kx=0,n_=0,Am=null,js=null,s_=0,Rh=1/0,bo=null,Kv=!1,Qb=null,Yl=null,i0=!1,Bl=null,Qv=0,Tm=0,Jb=null,cv=-1,uv=0;function as(){return Yt&6?Gr():cv!==-1?cv:cv=Gr()}function Xl(t){return t.mode&1?Yt&2&&Ln!==0?Ln&-Ln:ZD.transition!==null?(uv===0&&(uv=_3()),uv):(t=lr,t!==0||(t=window.event,t=t===void 0?16:P3(t.type)),t):1}function na(t,e,r,n){if(50<Tm)throw Tm=0,Jb=null,Error(Ie(185));Op(t,r,n),(!(Yt&2)||t!==_n)&&(t===_n&&(!(Yt&2)&&(Kx|=r),dn===4&&El(t,Ln)),Es(t,n),r===1&&Yt===0&&!(e.mode&1)&&(Rh=Gr()+500,Hx&&gc()))}function Es(t,e){var r=t.callbackNode;ZR(t,e);var n=Mv(t,t===_n?Ln:0);if(n===0)r!==null&&VS(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&VS(r),e===1)t.tag===0?JD(DC.bind(null,t)):Y3(DC.bind(null,t)),YD(function(){!(Yt&6)&&gc()}),r=null;else{switch(j3(n)){case 1:r=A5;break;case 4:r=b3;break;case 16:r=Ov;break;case 536870912:r=w3;break;default:r=Ov}r=HE(r,zE.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function zE(t,e){if(cv=-1,uv=0,Yt&6)throw Error(Ie(327));var r=t.callbackNode;if(rh()&&t.callbackNode!==r)return null;var n=Mv(t,t===_n?Ln:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Jv(t,n);else{e=n;var s=Yt;Yt|=2;var i=BE();(_n!==t||Ln!==e)&&(bo=null,Rh=Gr()+500,lu(t,e));do try{yF();break}catch(l){$E(t,l)}while(!0);U5(),Xv.current=i,Yt=s,sn!==null?e=0:(_n=null,Ln=0,e=dn)}if(e!==0){if(e===2&&(s=Cb(t),s!==0&&(n=s,e=Zb(t,s))),e===1)throw r=ip,lu(t,0),El(t,n),Es(t,Gr()),r;if(e===6)El(t,n);else{if(s=t.current.alternate,!(n&30)&&!vF(s)&&(e=Jv(t,n),e===2&&(i=Cb(t),i!==0&&(n=i,e=Zb(t,i))),e===1))throw r=ip,lu(t,0),El(t,n),Es(t,Gr()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Ie(345));case 2:zc(t,js,bo);break;case 3:if(El(t,n),(n&130023424)===n&&(e=s_+500-Gr(),10<e)){if(Mv(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){as(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ob(zc.bind(null,t,js,bo),e);break}zc(t,js,bo);break;case 4:if(El(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-ra(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Gr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gF(n/1960))-n,10<n){t.timeoutHandle=Ob(zc.bind(null,t,js,bo),n);break}zc(t,js,bo);break;case 5:zc(t,js,bo);break;default:throw Error(Ie(329))}}}return Es(t,Gr()),t.callbackNode===r?zE.bind(null,t):null}function Zb(t,e){var r=Am;return t.current.memoizedState.isDehydrated&&(lu(t,e).flags|=256),t=Jv(t,e),t!==2&&(e=js,js=r,e!==null&&ew(e)),t}function ew(t){js===null?js=t:js.push.apply(js,t)}function vF(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!ia(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function El(t,e){for(e&=~n_,e&=~Kx,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ra(e),n=1<<r;t[r]=-1,e&=~n}}function DC(t){if(Yt&6)throw Error(Ie(327));rh();var e=Mv(t,0);if(!(e&1))return Es(t,Gr()),null;var r=Jv(t,e);if(t.tag!==0&&r===2){var n=Cb(t);n!==0&&(e=n,r=Zb(t,n))}if(r===1)throw r=ip,lu(t,0),El(t,e),Es(t,Gr()),r;if(r===6)throw Error(Ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zc(t,js,bo),Es(t,Gr()),null}function i_(t,e){var r=Yt;Yt|=1;try{return t(e)}finally{Yt=r,Yt===0&&(Rh=Gr()+500,Hx&&gc())}}function vu(t){Bl!==null&&Bl.tag===0&&!(Yt&6)&&rh();var e=Yt;Yt|=1;var r=wi.transition,n=lr;try{if(wi.transition=null,lr=1,t)return t()}finally{lr=n,wi.transition=r,Yt=e,!(Yt&6)&&gc()}}function a_(){Vs=Bd.current,Cr(Bd)}function lu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,GD(r)),sn!==null)for(r=sn.return;r!==null;){var n=r;switch($5(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&zv();break;case 3:Oh(),Cr(Ns),Cr(Kn),X5();break;case 5:Y5(n);break;case 4:Oh();break;case 13:Cr(Tr);break;case 19:Cr(Tr);break;case 10:V5(n.type._context);break;case 22:case 23:a_()}r=r.return}if(_n=t,sn=t=Kl(t.current,null),Ln=Vs=e,dn=0,ip=null,n_=Kx=gu=0,js=Am=null,Yc!==null){for(e=0;e<Yc.length;e++)if(r=Yc[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Yc=null}return t}function $E(t,e){do{var r=sn;try{if(U5(),av.current=Yv,Gv){for(var n=Lr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Gv=!1}if(pu=0,bn=cn=Lr=null,Em=!1,rp=0,r_.current=null,r===null||r.return===null){dn=1,ip=e,sn=null;break}e:{var i=t,a=r.return,l=r,c=e;if(e=Ln,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=jC(a);if(m!==null){m.flags&=-257,SC(m,a,l,i,e),m.mode&1&&_C(i,u,e),e=m,c=u;var p=e.updateQueue;if(p===null){var v=new Set;v.add(c),e.updateQueue=v}else p.add(c);break e}else{if(!(e&1)){_C(i,u,e),o_();break e}c=Error(Ie(426))}}else if(Nr&&l.mode&1){var b=jC(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),SC(b,a,l,i,e),B5(Mh(c,l));break e}}i=c=Mh(c,l),dn!==4&&(dn=2),Am===null?Am=[i]:Am.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=jE(i,c,e);gC(i,x);break e;case 1:l=c;var w=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Yl===null||!Yl.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=SE(i,l,e);gC(i,S);break e}}i=i.return}while(i!==null)}UE(r)}catch(N){e=N,sn===r&&r!==null&&(sn=r=r.return);continue}break}while(!0)}function BE(){var t=Xv.current;return Xv.current=Yv,t===null?Yv:t}function o_(){(dn===0||dn===3||dn===2)&&(dn=4),_n===null||!(gu&268435455)&&!(Kx&268435455)||El(_n,Ln)}function Jv(t,e){var r=Yt;Yt|=2;var n=BE();(_n!==t||Ln!==e)&&(bo=null,lu(t,e));do try{xF();break}catch(s){$E(t,s)}while(!0);if(U5(),Yt=r,Xv.current=n,sn!==null)throw Error(Ie(261));return _n=null,Ln=0,dn}function xF(){for(;sn!==null;)qE(sn)}function yF(){for(;sn!==null&&!VR();)qE(sn)}function qE(t){var e=WE(t.alternate,t,Vs);t.memoizedProps=t.pendingProps,e===null?UE(t):sn=e,r_.current=null}function UE(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=hF(r,e),r!==null){r.flags&=32767,sn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dn=6,sn=null;return}}else if(r=dF(r,e,Vs),r!==null){sn=r;return}if(e=e.sibling,e!==null){sn=e;return}sn=e=t}while(e!==null);dn===0&&(dn=5)}function zc(t,e,r){var n=lr,s=wi.transition;try{wi.transition=null,lr=1,bF(t,e,r,n)}finally{wi.transition=s,lr=n}return null}function bF(t,e,r,n){do rh();while(Bl!==null);if(Yt&6)throw Error(Ie(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Ie(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(eD(t,i),t===_n&&(sn=_n=null,Ln=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||i0||(i0=!0,HE(Ov,function(){return rh(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=wi.transition,wi.transition=null;var a=lr;lr=1;var l=Yt;Yt|=4,r_.current=null,mF(t,r),FE(r,t),$D(Tb),Rv=!!Ab,Tb=Ab=null,t.current=r,pF(r),WR(),Yt=l,lr=a,wi.transition=i}else t.current=r;if(i0&&(i0=!1,Bl=t,Qv=s),i=t.pendingLanes,i===0&&(Yl=null),YR(r.stateNode),Es(t,Gr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Kv)throw Kv=!1,t=Qb,Qb=null,t;return Qv&1&&t.tag!==0&&rh(),i=t.pendingLanes,i&1?t===Jb?Tm++:(Tm=0,Jb=t):Tm=0,gc(),null}function rh(){if(Bl!==null){var t=j3(Qv),e=wi.transition,r=lr;try{if(wi.transition=null,lr=16>t?16:t,Bl===null)var n=!1;else{if(t=Bl,Bl=null,Qv=0,Yt&6)throw Error(Ie(331));var s=Yt;for(Yt|=4,tt=t.current;tt!==null;){var i=tt,a=i.child;if(tt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(tt=u;tt!==null;){var d=tt;switch(d.tag){case 0:case 11:case 15:Pm(8,d,i)}var h=d.child;if(h!==null)h.return=d,tt=h;else for(;tt!==null;){d=tt;var f=d.sibling,m=d.return;if(ME(d),d===u){tt=null;break}if(f!==null){f.return=m,tt=f;break}tt=m}}}var p=i.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var b=v.sibling;v.sibling=null,v=b}while(v!==null)}}tt=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,tt=a;else e:for(;tt!==null;){if(i=tt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Pm(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,tt=x;break e}tt=i.return}}var w=t.current;for(tt=w;tt!==null;){a=tt;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,tt=_;else e:for(a=w;tt!==null;){if(l=tt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Xx(9,l)}}catch(N){$r(l,l.return,N)}if(l===a){tt=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,tt=S;break e}tt=l.return}}if(Yt=s,gc(),Ua&&typeof Ua.onPostCommitFiberRoot=="function")try{Ua.onPostCommitFiberRoot(Bx,t)}catch{}n=!0}return n}finally{lr=r,wi.transition=e}}return!1}function FC(t,e,r){e=Mh(r,e),e=jE(t,e,1),t=Gl(t,e,1),e=as(),t!==null&&(Op(t,1,e),Es(t,e))}function $r(t,e,r){if(t.tag===3)FC(t,t,r);else for(;e!==null;){if(e.tag===3){FC(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Yl===null||!Yl.has(n))){t=Mh(r,t),t=SE(e,t,1),e=Gl(e,t,1),t=as(),e!==null&&(Op(e,1,t),Es(e,t));break}}e=e.return}}function wF(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=as(),t.pingedLanes|=t.suspendedLanes&r,_n===t&&(Ln&r)===r&&(dn===4||dn===3&&(Ln&130023424)===Ln&&500>Gr()-s_?lu(t,0):n_|=r),Es(t,e)}function VE(t,e){e===0&&(t.mode&1?(e=Xg,Xg<<=1,!(Xg&130023424)&&(Xg=4194304)):e=1);var r=as();t=Fo(t,e),t!==null&&(Op(t,e,r),Es(t,r))}function _F(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),VE(t,r)}function jF(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ie(314))}n!==null&&n.delete(e),VE(t,r)}var WE;WE=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ns.current)Cs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Cs=!1,uF(t,e,r);Cs=!!(t.flags&131072)}else Cs=!1,Nr&&e.flags&1048576&&X3(e,qv,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;lv(t,e),t=e.pendingProps;var s=Ah(e,Kn.current);th(e,r),s=Q5(null,e,n,t,s,r);var i=J5();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ks(n)?(i=!0,$v(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,H5(e),s.updater=Yx,e.stateNode=s,s._reactInternals=e,$b(e,n,t,r),e=Ub(null,e,n,!0,i,r)):(e.tag=0,Nr&&i&&z5(e),ss(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(lv(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=CF(n),t=Wi(n,t),s){case 0:e=qb(null,e,n,t,r);break e;case 1:e=kC(null,e,n,t,r);break e;case 11:e=CC(null,e,n,t,r);break e;case 14:e=NC(null,e,n,Wi(n.type,t),r);break e}throw Error(Ie(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wi(n,s),qb(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wi(n,s),kC(t,e,n,s,r);case 3:e:{if(EE(e),t===null)throw Error(Ie(387));n=e.pendingProps,i=e.memoizedState,s=i.element,tE(t,e),Wv(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mh(Error(Ie(423)),e),e=EC(t,e,n,r,s);break e}else if(n!==s){s=Mh(Error(Ie(424)),e),e=EC(t,e,n,r,s);break e}else for(Gs=Hl(e.stateNode.containerInfo.firstChild),Xs=e,Nr=!0,Qi=null,r=Z3(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Th(),n===s){e=Io(t,e,r);break e}ss(t,e,n,r)}e=e.child}return e;case 5:return rE(e),t===null&&Fb(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Lb(n,s)?a=null:i!==null&&Lb(n,i)&&(e.flags|=32),kE(t,e),ss(t,e,a,r),e.child;case 6:return t===null&&Fb(e),null;case 13:return PE(t,e,r);case 4:return G5(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Lh(e,null,n,r):ss(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wi(n,s),CC(t,e,n,s,r);case 7:return ss(t,e,e.pendingProps,r),e.child;case 8:return ss(t,e,e.pendingProps.children,r),e.child;case 12:return ss(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,xr(Uv,n._currentValue),n._currentValue=a,i!==null)if(ia(i.value,a)){if(i.children===s.children&&!Ns.current){e=Io(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Ao(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ib(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Ie(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Ib(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}ss(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,th(e,r),s=ji(s),n=n(s),e.flags|=1,ss(t,e,n,r),e.child;case 14:return n=e.type,s=Wi(n,e.pendingProps),s=Wi(n.type,s),NC(t,e,n,s,r);case 15:return CE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Wi(n,s),lv(t,e),e.tag=1,ks(n)?(t=!0,$v(e)):t=!1,th(e,r),_E(e,n,s),$b(e,n,s,r),Ub(null,e,n,!0,t,r);case 19:return AE(t,e,r);case 22:return NE(t,e,r)}throw Error(Ie(156,e.tag))};function HE(t,e){return y3(t,e)}function SF(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bi(t,e,r,n){return new SF(t,e,r,n)}function l_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CF(t){if(typeof t=="function")return l_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===k5)return 11;if(t===E5)return 14}return 2}function Kl(t,e){var r=t.alternate;return r===null?(r=bi(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function dv(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")l_(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Td:return cu(r.children,s,i,e);case N5:a=8,s|=8;break;case ub:return t=bi(12,r,e,s|2),t.elementType=ub,t.lanes=i,t;case db:return t=bi(13,r,e,s),t.elementType=db,t.lanes=i,t;case hb:return t=bi(19,r,e,s),t.elementType=hb,t.lanes=i,t;case r3:return Qx(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case e3:a=10;break e;case t3:a=9;break e;case k5:a=11;break e;case E5:a=14;break e;case Sl:a=16,n=null;break e}throw Error(Ie(130,t==null?t:typeof t,""))}return e=bi(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function cu(t,e,r,n){return t=bi(7,t,n,e),t.lanes=r,t}function Qx(t,e,r,n){return t=bi(22,t,n,e),t.elementType=r3,t.lanes=r,t.stateNode={isHidden:!1},t}function f2(t,e,r){return t=bi(6,t,null,e),t.lanes=r,t}function m2(t,e,r){return e=bi(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function NF(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yy(0),this.expirationTimes=Yy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yy(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function c_(t,e,r,n,s,i,a,l,c){return t=new NF(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=bi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},H5(i),t}function kF(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ad,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function GE(t){if(!t)return ec;t=t._reactInternals;e:{if(Eu(t)!==t||t.tag!==1)throw Error(Ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ks(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ie(171))}if(t.tag===1){var r=t.type;if(ks(r))return G3(t,r,e)}return e}function YE(t,e,r,n,s,i,a,l,c){return t=c_(r,n,!0,t,s,i,a,l,c),t.context=GE(null),r=t.current,n=as(),s=Xl(r),i=Ao(n,s),i.callback=e??null,Gl(r,i,s),t.current.lanes=s,Op(t,s,n),Es(t,n),t}function Jx(t,e,r,n){var s=e.current,i=as(),a=Xl(s);return r=GE(r),e.context===null?e.context=r:e.pendingContext=r,e=Ao(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Gl(s,e,a),t!==null&&(na(t,s,a,i),iv(t,s,a)),a}function Zv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function IC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function u_(t,e){IC(t,e),(t=t.alternate)&&IC(t,e)}function EF(){return null}var XE=typeof reportError=="function"?reportError:function(t){console.error(t)};function d_(t){this._internalRoot=t}Zx.prototype.render=d_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ie(409));Jx(t,e,null,null)};Zx.prototype.unmount=d_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vu(function(){Jx(null,t,null,null)}),e[Do]=null}};function Zx(t){this._internalRoot=t}Zx.prototype.unstable_scheduleHydration=function(t){if(t){var e=N3();t={blockedOn:null,target:t,priority:e};for(var r=0;r<kl.length&&e!==0&&e<kl[r].priority;r++);kl.splice(r,0,t),r===0&&E3(t)}};function h_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function e1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zC(){}function PF(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Zv(a);i.call(u)}}var a=YE(e,n,t,0,null,!1,!1,"",zC);return t._reactRootContainer=a,t[Do]=a.current,Qm(t.nodeType===8?t.parentNode:t),vu(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Zv(c);l.call(u)}}var c=c_(t,0,!1,null,null,!1,!1,"",zC);return t._reactRootContainer=c,t[Do]=c.current,Qm(t.nodeType===8?t.parentNode:t),vu(function(){Jx(e,c,r,n)}),c}function t1(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Zv(a);l.call(c)}}Jx(e,a,t,s)}else a=PF(r,e,t,s,n);return Zv(a)}S3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=vm(e.pendingLanes);r!==0&&(T5(e,r|1),Es(e,Gr()),!(Yt&6)&&(Rh=Gr()+500,gc()))}break;case 13:vu(function(){var n=Fo(t,1);if(n!==null){var s=as();na(n,t,1,s)}}),u_(t,1)}};L5=function(t){if(t.tag===13){var e=Fo(t,134217728);if(e!==null){var r=as();na(e,t,134217728,r)}u_(t,134217728)}};C3=function(t){if(t.tag===13){var e=Xl(t),r=Fo(t,e);if(r!==null){var n=as();na(r,t,e,n)}u_(t,e)}};N3=function(){return lr};k3=function(t,e){var r=lr;try{return lr=t,e()}finally{lr=r}};_b=function(t,e,r){switch(e){case"input":if(pb(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Wx(n);if(!s)throw Error(Ie(90));s3(n),pb(n,s)}}}break;case"textarea":a3(t,r);break;case"select":e=r.value,e!=null&&Qd(t,!!r.multiple,e,!1)}};f3=i_;m3=vu;var AF={usingClientEntryPoint:!1,Events:[Rp,Rd,Wx,d3,h3,i_]},am={findFiberByHostInstance:Gc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TF={bundleType:am.bundleType,version:am.version,rendererPackageName:am.rendererPackageName,rendererConfig:am.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=v3(t),t===null?null:t.stateNode},findFiberByHostInstance:am.findFiberByHostInstance||EF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var a0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!a0.isDisabled&&a0.supportsFiber)try{Bx=a0.inject(TF),Ua=a0}catch{}}ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AF;ri.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h_(e))throw Error(Ie(200));return kF(t,e,null,r)};ri.createRoot=function(t,e){if(!h_(t))throw Error(Ie(299));var r=!1,n="",s=XE;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=c_(t,1,!1,null,null,r,!1,n,s),t[Do]=e.current,Qm(t.nodeType===8?t.parentNode:t),new d_(e)};ri.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ie(188)):(t=Object.keys(t).join(","),Error(Ie(268,t)));return t=v3(e),t=t===null?null:t.stateNode,t};ri.flushSync=function(t){return vu(t)};ri.hydrate=function(t,e,r){if(!e1(e))throw Error(Ie(200));return t1(null,t,e,!0,r)};ri.hydrateRoot=function(t,e,r){if(!h_(t))throw Error(Ie(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=XE;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=YE(e,null,t,1,r??null,s,!1,i,a),t[Do]=e.current,Qm(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Zx(e)};ri.render=function(t,e,r){if(!e1(e))throw Error(Ie(200));return t1(null,t,e,!1,r)};ri.unmountComponentAtNode=function(t){if(!e1(t))throw Error(Ie(40));return t._reactRootContainer?(vu(function(){t1(null,null,t,!1,function(){t._reactRootContainer=null,t[Do]=null})}),!0):!1};ri.unstable_batchedUpdates=i_;ri.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!e1(r))throw Error(Ie(200));if(t==null||t._reactInternals===void 0)throw Error(Ie(38));return t1(t,e,r,!1,n)};ri.version="18.3.1-next-f1338f8080-20240426";function KE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KE)}catch(t){console.error(t)}}KE(),K4.exports=ri;var Qh=K4.exports;const QE=I4(Qh);var $C=Qh;lb.createRoot=$C.createRoot,lb.hydrateRoot=$C.hydrateRoot;var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.parse=IF;f_.serialize=zF;const LF=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,OF=/^[\u0021-\u003A\u003C-\u007E]*$/,MF=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,RF=/^[\u0020-\u003A\u003D-\u007E]*$/,DF=Object.prototype.toString,FF=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function IF(t,e){const r=new FF,n=t.length;if(n<2)return r;const s=(e==null?void 0:e.decode)||$F;let i=0;do{const a=t.indexOf("=",i);if(a===-1)break;const l=t.indexOf(";",i),c=l===-1?n:l;if(a>c){i=t.lastIndexOf(";",a-1)+1;continue}const u=BC(t,i,a),d=qC(t,a,u),h=t.slice(u,d);if(r[h]===void 0){let f=BC(t,a+1,c),m=qC(t,c,f);const p=s(t.slice(f,m));r[h]=p}i=c+1}while(i<n);return r}function BC(t,e,r){do{const n=t.charCodeAt(e);if(n!==32&&n!==9)return e}while(++e<r);return r}function qC(t,e,r){for(;e>r;){const n=t.charCodeAt(--e);if(n!==32&&n!==9)return e+1}return r}function zF(t,e,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!LF.test(t))throw new TypeError(`argument name is invalid: ${t}`);const s=n(e);if(!OF.test(s))throw new TypeError(`argument val is invalid: ${e}`);let i=t+"="+s;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!MF.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!RF.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!BF(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function $F(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function BF(t){return DF.call(t)==="[object Date]"}var UC="popstate";function qF(t={}){function e(n,s){let{pathname:i,search:a,hash:l}=n.location;return tw("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:ap(s)}return VF(e,r,null,t)}function kr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function aa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UF(){return Math.random().toString(36).substring(2,10)}function VC(t,e){return{usr:t.state,key:t.key,idx:e}}function tw(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Jh(e):e,state:r,key:e&&e.key||n||UF()}}function ap({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Jh(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function VF(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,l="POP",c=null,u=d();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function d(){return(a.state||{idx:null}).idx}function h(){l="POP";let b=d(),x=b==null?null:b-u;u=b,c&&c({action:l,location:v.location,delta:x})}function f(b,x){l="PUSH";let w=tw(v.location,b,x);u=d()+1;let _=VC(w,u),S=v.createHref(w);try{a.pushState(_,"",S)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(S)}i&&c&&c({action:l,location:v.location,delta:1})}function m(b,x){l="REPLACE";let w=tw(v.location,b,x);u=d();let _=VC(w,u),S=v.createHref(w);a.replaceState(_,"",S),i&&c&&c({action:l,location:v.location,delta:0})}function p(b){return WF(b)}let v={get action(){return l},get location(){return t(s,a)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(UC,h),c=b,()=>{s.removeEventListener(UC,h),c=null}},createHref(b){return e(s,b)},createURL:p,encodeLocation(b){let x=p(b);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:m,go(b){return a.go(b)}};return v}function WF(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),kr(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:ap(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function JE(t,e,r="/"){return HF(t,e,r,!1)}function HF(t,e,r,n){let s=typeof e=="string"?Jh(e):e,i=zo(s.pathname||"/",r);if(i==null)return null;let a=ZE(t);GF(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=s7(i);l=r7(a[c],u,n)}return l}function ZE(t,e=[],r=[],n=""){let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(kr(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let u=To([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(kr(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),ZE(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:e7(u,i.index),routesMeta:d})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of eP(i.path))s(i,a,c)}),e}function eP(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=eP(n.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function GF(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:t7(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var YF=/^:[\w-]+$/,XF=3,KF=2,QF=1,JF=10,ZF=-2,WC=t=>t==="*";function e7(t,e){let r=t.split("/"),n=r.length;return r.some(WC)&&(n+=ZF),e&&(n+=KF),r.filter(s=>!WC(s)).reduce((s,i)=>s+(YF.test(i)?XF:i===""?QF:JF),n)}function t7(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function r7(t,e,r=!1){let{routesMeta:n}=t,s={},i="/",a=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=ex({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&r&&!n[n.length-1].route.index&&(h=ex({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:To([i,h.pathname]),pathnameBase:l7(To([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=To([i,h.pathnameBase]))}return a}function ex(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=n7(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:h},f)=>{if(d==="*"){let p=l[f]||"";a=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const m=l[f];return h&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:t}}function n7(t,e=!1,r=!0){aa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function s7(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return aa(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function zo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function i7(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Jh(t):t;return{pathname:r?r.startsWith("/")?r:a7(r,e):e,search:c7(n),hash:u7(s)}}function a7(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function p2(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function o7(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function m_(t){let e=o7(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function p_(t,e,r,n=!1){let s;typeof t=="string"?s=Jh(t):(s={...t},kr(!s.pathname||!s.pathname.includes("?"),p2("?","pathname","search",s)),kr(!s.pathname||!s.pathname.includes("#"),p2("#","pathname","hash",s)),kr(!s.search||!s.search.includes("#"),p2("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=i7(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var To=t=>t.join("/").replace(/\/\/+/g,"/"),l7=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),c7=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,u7=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function d7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var tP=["POST","PUT","PATCH","DELETE"];new Set(tP);var h7=["GET",...tP];new Set(h7);var Zh=y.createContext(null);Zh.displayName="DataRouter";var r1=y.createContext(null);r1.displayName="DataRouterState";var rP=y.createContext({isTransitioning:!1});rP.displayName="ViewTransition";var f7=y.createContext(new Map);f7.displayName="Fetchers";var m7=y.createContext(null);m7.displayName="Await";var ha=y.createContext(null);ha.displayName="Navigation";var Fp=y.createContext(null);Fp.displayName="Location";var fa=y.createContext({outlet:null,matches:[],isDataRoute:!1});fa.displayName="Route";var g_=y.createContext(null);g_.displayName="RouteError";function p7(t,{relative:e}={}){kr(ef(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=y.useContext(ha),{hash:s,pathname:i,search:a}=Ip(t,{relative:e}),l=i;return r!=="/"&&(l=i==="/"?r:To([r,i])),n.createHref({pathname:l,search:a,hash:s})}function ef(){return y.useContext(Fp)!=null}function ma(){return kr(ef(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(Fp).location}var nP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sP(t){y.useContext(ha).static||y.useLayoutEffect(t)}function Mn(){let{isDataRoute:t}=y.useContext(fa);return t?E7():g7()}function g7(){kr(ef(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(Zh),{basename:e,navigator:r}=y.useContext(ha),{matches:n}=y.useContext(fa),{pathname:s}=ma(),i=JSON.stringify(m_(n)),a=y.useRef(!1);return sP(()=>{a.current=!0}),y.useCallback((c,u={})=>{if(aa(a.current,nP),!a.current)return;if(typeof c=="number"){r.go(c);return}let d=p_(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:To([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,i,s,t])}y.createContext(null);function n1(){let{matches:t}=y.useContext(fa),e=t[t.length-1];return e?e.params:{}}function Ip(t,{relative:e}={}){let{matches:r}=y.useContext(fa),{pathname:n}=ma(),s=JSON.stringify(m_(r));return y.useMemo(()=>p_(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function v7(t,e){return iP(t,e)}function iP(t,e,r,n){var x;kr(ef(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=y.useContext(ha),{matches:i}=y.useContext(fa),a=i[i.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let w=d&&d.path||"";aP(c,!d||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let h=ma(),f;if(e){let w=typeof e=="string"?Jh(e):e;kr(u==="/"||((x=w.pathname)==null?void 0:x.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=h;let m=f.pathname||"/",p=m;if(u!=="/"){let w=u.replace(/^\//,"").split("/");p="/"+m.replace(/^\//,"").split("/").slice(w.length).join("/")}let v=JE(t,{pathname:p});aa(d||v!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),aa(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=_7(v&&v.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:To([u,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:To([u,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n);return e&&b?y.createElement(Fp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},b):b}function x7(){let t=k7(),e=d7(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=y.createElement(y.Fragment,null,y.createElement("p",null,"💿 Hey developer 👋"),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:i},"ErrorBoundary")," or"," ",y.createElement("code",{style:i},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),r?y.createElement("pre",{style:s},r):null,a)}var y7=y.createElement(x7,null),b7=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?y.createElement(fa.Provider,{value:this.props.routeContext},y.createElement(g_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function w7({routeContext:t,match:e,children:r}){let n=y.useContext(Zh);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(fa.Provider,{value:t},r)}function _7(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);kr(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let a=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:h}=r,f=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||f){a=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,u,d)=>{let h,f=!1,m=null,p=null;r&&(h=i&&u.route.id?i[u.route.id]:void 0,m=u.route.errorElement||y7,a&&(l<0&&d===0?(aP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,p=null):l===d&&(f=!0,p=u.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,d+1)),b=()=>{let x;return h?x=m:f?x=p:u.route.Component?x=y.createElement(u.route.Component,null):u.route.element?x=u.route.element:x=c,y.createElement(w7,{match:u,routeContext:{outlet:c,matches:v,isDataRoute:r!=null},children:x})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?y.createElement(b7,{location:r.location,revalidation:r.revalidation,component:m,error:h,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}function v_(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function j7(t){let e=y.useContext(Zh);return kr(e,v_(t)),e}function S7(t){let e=y.useContext(r1);return kr(e,v_(t)),e}function C7(t){let e=y.useContext(fa);return kr(e,v_(t)),e}function x_(t){let e=C7(t),r=e.matches[e.matches.length-1];return kr(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function N7(){return x_("useRouteId")}function k7(){var n;let t=y.useContext(g_),e=S7("useRouteError"),r=x_("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function E7(){let{router:t}=j7("useNavigate"),e=x_("useNavigate"),r=y.useRef(!1);return sP(()=>{r.current=!0}),y.useCallback(async(s,i={})=>{aa(r.current,nP),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var HC={};function aP(t,e,r){!e&&!HC[t]&&(HC[t]=!0,aa(!1,r))}y.memo(P7);function P7({routes:t,future:e,state:r}){return iP(t,void 0,r,e)}function A7({to:t,replace:e,state:r,relative:n}){kr(ef(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=y.useContext(ha);aa(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=y.useContext(fa),{pathname:a}=ma(),l=Mn(),c=p_(t,m_(i),a,n==="path"),u=JSON.stringify(c);return y.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function es(t){kr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function T7({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:i=!1}){kr(!ef(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),l=y.useMemo(()=>({basename:a,navigator:s,static:i,future:{}}),[a,s,i]);typeof r=="string"&&(r=Jh(r));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=r,m=y.useMemo(()=>{let p=zo(c,a);return p==null?null:{location:{pathname:p,search:u,hash:d,state:h,key:f},navigationType:n}},[a,c,u,d,h,f,n]);return aa(m!=null,`<Router basename="${a}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:y.createElement(ha.Provider,{value:l},y.createElement(Fp.Provider,{children:e,value:m}))}function L7({children:t,location:e}){return v7(rw(t),e)}function rw(t,e=[]){let r=[];return y.Children.forEach(t,(n,s)=>{if(!y.isValidElement(n))return;let i=[...e,s];if(n.type===y.Fragment){r.push.apply(r,rw(n.props.children,i));return}kr(n.type===es,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),kr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=rw(n.props.children,i)),r.push(a)}),r}var hv="get",fv="application/x-www-form-urlencoded";function s1(t){return t!=null&&typeof t.tagName=="string"}function O7(t){return s1(t)&&t.tagName.toLowerCase()==="button"}function M7(t){return s1(t)&&t.tagName.toLowerCase()==="form"}function R7(t){return s1(t)&&t.tagName.toLowerCase()==="input"}function D7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function F7(t,e){return t.button===0&&(!e||e==="_self")&&!D7(t)}var o0=null;function I7(){if(o0===null)try{new FormData(document.createElement("form"),0),o0=!1}catch{o0=!0}return o0}var z7=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function g2(t){return t!=null&&!z7.has(t)?(aa(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fv}"`),null):t}function $7(t,e){let r,n,s,i,a;if(M7(t)){let l=t.getAttribute("action");n=l?zo(l,e):null,r=t.getAttribute("method")||hv,s=g2(t.getAttribute("enctype"))||fv,i=new FormData(t)}else if(O7(t)||R7(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?zo(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||hv,s=g2(t.getAttribute("formenctype"))||g2(l.getAttribute("enctype"))||fv,i=new FormData(l,t),!I7()){let{name:u,type:d,value:h}=t;if(d==="image"){let f=u?`${u}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else u&&i.append(u,h)}}else{if(s1(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=hv,n=null,s=fv,a=t}return i&&s==="text/plain"&&(a=i,i=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:i,body:a}}function y_(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function B7(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function q7(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function U7(t,e,r){let n=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await B7(i,r);return a.links?a.links():[]}return[]}));return G7(n.flat(1).filter(q7).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function GC(t,e,r,n,s,i){let a=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,u)=>a(c,u)||l(c,u)):i==="data"?e.filter((c,u)=>{var h;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(a(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((h=r[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function V7(t,e,{includeHydrateFallback:r}={}){return W7(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function W7(t){return[...new Set(t)]}function H7(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function G7(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let i=JSON.stringify(H7(s));return r.has(i)||(r.add(i),n.push({key:i,link:s})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Y7=new Set([100,101,204,205]);function X7(t,e){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname="_root.data":e&&zo(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function oP(){let t=y.useContext(Zh);return y_(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function K7(){let t=y.useContext(r1);return y_(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var b_=y.createContext(void 0);b_.displayName="FrameworkContext";function lP(){let t=y.useContext(b_);return y_(t,"You must render this element inside a <HydratedRouter> element"),t}function Q7(t,e){let r=y.useContext(b_),[n,s]=y.useState(!1),[i,a]=y.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=e,f=y.useRef(null);y.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let v=x=>{x.forEach(w=>{a(w.isIntersecting)})},b=new IntersectionObserver(v,{threshold:.5});return f.current&&b.observe(f.current),()=>{b.disconnect()}}},[t]),y.useEffect(()=>{if(n){let v=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(v)}}},[n]);let m=()=>{s(!0)},p=()=>{s(!1),a(!1)};return r?t!=="intent"?[i,f,{}]:[i,f,{onFocus:om(l,m),onBlur:om(c,p),onMouseEnter:om(u,m),onMouseLeave:om(d,p),onTouchStart:om(h,m)}]:[!1,f,{}]}function om(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function J7({page:t,...e}){let{router:r}=oP(),n=y.useMemo(()=>JE(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?y.createElement(eI,{page:t,matches:n,...e}):null}function Z7(t){let{manifest:e,routeModules:r}=lP(),[n,s]=y.useState([]);return y.useEffect(()=>{let i=!1;return U7(t,e,r).then(a=>{i||s(a)}),()=>{i=!0}},[t,e,r]),n}function eI({page:t,matches:e,...r}){let n=ma(),{manifest:s,routeModules:i}=lP(),{basename:a}=oP(),{loaderData:l,matches:c}=K7(),u=y.useMemo(()=>GC(t,e,c,s,n,"data"),[t,e,c,s,n]),d=y.useMemo(()=>GC(t,e,c,s,n,"assets"),[t,e,c,s,n]),h=y.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let p=new Set,v=!1;if(e.forEach(x=>{var _;let w=s.routes[x.route.id];!w||!w.hasLoader||(!u.some(S=>S.route.id===x.route.id)&&x.route.id in l&&((_=i[x.route.id])!=null&&_.shouldRevalidate)||w.hasClientLoader?v=!0:p.add(x.route.id))}),p.size===0)return[];let b=X7(t,a);return v&&p.size>0&&b.searchParams.set("_routes",e.filter(x=>p.has(x.route.id)).map(x=>x.route.id).join(",")),[b.pathname+b.search]},[a,l,n,s,u,e,t,i]),f=y.useMemo(()=>V7(d,s),[d,s]),m=Z7(d);return y.createElement(y.Fragment,null,h.map(p=>y.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...r})),f.map(p=>y.createElement("link",{key:p,rel:"modulepreload",href:p,...r})),m.map(({key:p,link:v})=>y.createElement("link",{key:p,...v})))}function tI(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var cP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{cP&&(window.__reactRouterVersion="7.6.3")}catch{}function rI({basename:t,children:e,window:r}){let n=y.useRef();n.current==null&&(n.current=qF({window:r,v5Compat:!0}));let s=n.current,[i,a]=y.useState({action:s.action,location:s.location}),l=y.useCallback(c=>{y.startTransition(()=>a(c))},[a]);return y.useLayoutEffect(()=>s.listen(l),[s,l]),y.createElement(T7,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var uP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dP=y.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h,...f},m){let{basename:p}=y.useContext(ha),v=typeof u=="string"&&uP.test(u),b,x=!1;if(typeof u=="string"&&v&&(b=u,cP))try{let F=new URL(window.location.href),Y=u.startsWith("//")?new URL(F.protocol+u):new URL(u),T=zo(Y.pathname,p);Y.origin===F.origin&&T!=null?u=T+Y.search+Y.hash:x=!0}catch{aa(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=p7(u,{relative:s}),[_,S,N]=Q7(n,f),E=aI(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function P(F){e&&e(F),F.defaultPrevented||E(F)}let A=y.createElement("a",{...f,...N,href:b||w,onClick:x||i?e:P,ref:tI(m,S),target:c,"data-discover":!v&&r==="render"?"true":void 0});return _&&!v?y.createElement(y.Fragment,null,A,y.createElement(J7,{page:w})):A});dP.displayName="Link";var nI=y.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:i,to:a,viewTransition:l,children:c,...u},d){let h=Ip(a,{relative:u.relative}),f=ma(),m=y.useContext(r1),{navigator:p,basename:v}=y.useContext(ha),b=m!=null&&dI(h)&&l===!0,x=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,w=f.pathname,_=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(w=w.toLowerCase(),_=_?_.toLowerCase():null,x=x.toLowerCase()),_&&v&&(_=zo(_,v)||_);const S=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let N=w===x||!s&&w.startsWith(x)&&w.charAt(S)==="/",E=_!=null&&(_===x||!s&&_.startsWith(x)&&_.charAt(x.length)==="/"),P={isActive:N,isPending:E,isTransitioning:b},A=N?e:void 0,F;typeof n=="function"?F=n(P):F=[n,N?"active":null,E?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let Y=typeof i=="function"?i(P):i;return y.createElement(dP,{...u,"aria-current":A,className:F,ref:d,style:Y,to:a,viewTransition:l},typeof c=="function"?c(P):c)});nI.displayName="NavLink";var sI=y.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:i,method:a=hv,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,...f},m)=>{let p=cI(),v=uI(l,{relative:u}),b=a.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&uP.test(l),w=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let S=_.nativeEvent.submitter,N=(S==null?void 0:S.getAttribute("formmethod"))||a;p(S||_.currentTarget,{fetcherKey:e,method:N,navigate:r,replace:s,state:i,relative:u,preventScrollReset:d,viewTransition:h})};return y.createElement("form",{ref:m,method:b,action:v,onSubmit:n?c:w,...f,"data-discover":!x&&t==="render"?"true":void 0})});sI.displayName="Form";function iI(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hP(t){let e=y.useContext(Zh);return kr(e,iI(t)),e}function aI(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:i,viewTransition:a}={}){let l=Mn(),c=ma(),u=Ip(t,{relative:i});return y.useCallback(d=>{if(F7(d,e)){d.preventDefault();let h=r!==void 0?r:ap(c)===ap(u);l(t,{replace:h,state:n,preventScrollReset:s,relative:i,viewTransition:a})}},[c,l,u,r,n,e,t,s,i,a])}var oI=0,lI=()=>`__${String(++oI)}__`;function cI(){let{router:t}=hP("useSubmit"),{basename:e}=y.useContext(ha),r=N7();return y.useCallback(async(n,s={})=>{let{action:i,method:a,encType:l,formData:c,body:u}=$7(n,e);if(s.navigate===!1){let d=s.fetcherKey||lI();await t.fetch(d,r,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function uI(t,{relative:e}={}){let{basename:r}=y.useContext(ha),n=y.useContext(fa);kr(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Ip(t||".",{relative:e})},a=ma();if(t==null){i.search=a.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let d=l.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:To([r,i.pathname])),ap(i)}function dI(t,e={}){let r=y.useContext(rP);kr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=hP("useViewTransitionState"),s=Ip(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=zo(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=zo(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ex(s.pathname,a)!=null||ex(s.pathname,i)!=null}[...Y7];var tf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},xu=typeof window>"u"||"Deno"in globalThis;function pi(){}function hI(t,e){return typeof t=="function"?t(e):t}function nw(t){return typeof t=="number"&&t>=0&&t!==1/0}function fP(t,e){return Math.max(t+(e||0)-Date.now(),0)}function nh(t,e){return typeof t=="function"?t(e):t}function Ji(t,e){return typeof t=="function"?t(e):t}function YC(t,e){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:a,stale:l}=t;if(a){if(n){if(e.queryHash!==w_(a,e.options))return!1}else if(!op(e.queryKey,a))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||i&&!i(e))}function XC(t,e){const{exact:r,status:n,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(r){if(yu(e.options.mutationKey)!==yu(i))return!1}else if(!op(e.options.mutationKey,i))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function w_(t,e){return((e==null?void 0:e.queryKeyHashFn)||yu)(t)}function yu(t){return JSON.stringify(t,(e,r)=>sw(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function op(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!op(t[r],e[r])):!1}function mP(t,e){if(t===e)return t;const r=KC(t)&&KC(e);if(r||sw(t)&&sw(e)){const n=r?t:Object.keys(t),s=n.length,i=r?e:Object.keys(e),a=i.length,l=r?[]:{};let c=0;for(let u=0;u<a;u++){const d=r?u:i[u];(!r&&n.includes(d)||r)&&t[d]===void 0&&e[d]===void 0?(l[d]=void 0,c++):(l[d]=mP(t[d],e[d]),l[d]===t[d]&&t[d]!==void 0&&c++)}return s===a&&c===s?t:l}return e}function tx(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function KC(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function sw(t){if(!QC(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!QC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function QC(t){return Object.prototype.toString.call(t)==="[object Object]"}function fI(t){return new Promise(e=>{setTimeout(e,t)})}function iw(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?mP(t,e):e}function mI(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function pI(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var __=Symbol();function pP(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===__?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var tu,Tl,gh,E4,gI=(E4=class extends tf{constructor(){super();ut(this,tu);ut(this,Tl);ut(this,gh);Ze(this,gh,e=>{if(!xu&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){de(this,Tl)||this.setEventListener(de(this,gh))}onUnsubscribe(){var e;this.hasListeners()||((e=de(this,Tl))==null||e.call(this),Ze(this,Tl,void 0))}setEventListener(e){var r;Ze(this,gh,e),(r=de(this,Tl))==null||r.call(this),Ze(this,Tl,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){de(this,tu)!==e&&(Ze(this,tu,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof de(this,tu)=="boolean"?de(this,tu):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},tu=new WeakMap,Tl=new WeakMap,gh=new WeakMap,E4),j_=new gI,vh,Ll,xh,P4,vI=(P4=class extends tf{constructor(){super();ut(this,vh,!0);ut(this,Ll);ut(this,xh);Ze(this,xh,e=>{if(!xu&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){de(this,Ll)||this.setEventListener(de(this,xh))}onUnsubscribe(){var e;this.hasListeners()||((e=de(this,Ll))==null||e.call(this),Ze(this,Ll,void 0))}setEventListener(e){var r;Ze(this,xh,e),(r=de(this,Ll))==null||r.call(this),Ze(this,Ll,e(this.setOnline.bind(this)))}setOnline(e){de(this,vh)!==e&&(Ze(this,vh,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return de(this,vh)}},vh=new WeakMap,Ll=new WeakMap,xh=new WeakMap,P4),rx=new vI;function aw(){let t,e;const r=new Promise((s,i)=>{t=s,e=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),t(s)},r.reject=s=>{n({status:"rejected",reason:s}),e(s)},r}function xI(t){return Math.min(1e3*2**t,3e4)}function gP(t){return(t??"online")==="online"?rx.isOnline():!0}var vP=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function v2(t){return t instanceof vP}function xP(t){let e=!1,r=0,n=!1,s;const i=aw(),a=v=>{var b;n||(f(new vP(v)),(b=t.abort)==null||b.call(t))},l=()=>{e=!0},c=()=>{e=!1},u=()=>j_.isFocused()&&(t.networkMode==="always"||rx.isOnline())&&t.canRun(),d=()=>gP(t.networkMode)&&t.canRun(),h=v=>{var b;n||(n=!0,(b=t.onSuccess)==null||b.call(t,v),s==null||s(),i.resolve(v))},f=v=>{var b;n||(n=!0,(b=t.onError)==null||b.call(t,v),s==null||s(),i.reject(v))},m=()=>new Promise(v=>{var b;s=x=>{(n||u())&&v(x)},(b=t.onPause)==null||b.call(t)}).then(()=>{var v;s=void 0,n||(v=t.onContinue)==null||v.call(t)}),p=()=>{if(n)return;let v;const b=r===0?t.initialPromise:void 0;try{v=b??t.fn()}catch(x){v=Promise.reject(x)}Promise.resolve(v).then(h).catch(x=>{var E;if(n)return;const w=t.retry??(xu?0:3),_=t.retryDelay??xI,S=typeof _=="function"?_(r,x):_,N=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,x);if(e||!N){f(x);return}r++,(E=t.onFail)==null||E.call(t,r,x),fI(S).then(()=>u()?void 0:m()).then(()=>{e?f(x):p()})})};return{promise:i,cancel:a,continue:()=>(s==null||s(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?p():m().then(p),i)}}function yI(){let t=[],e=0,r=l=>{l()},n=l=>{l()},s=l=>setTimeout(l,0);const i=l=>{e?t.push(l):s(()=>{r(l)})},a=()=>{const l=t;t=[],l.length&&s(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||a()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var un=yI(),ru,A4,yP=(A4=class{constructor(){ut(this,ru)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),nw(this.gcTime)&&Ze(this,ru,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(xu?1/0:5*60*1e3))}clearGcTimeout(){de(this,ru)&&(clearTimeout(de(this,ru)),Ze(this,ru,void 0))}},ru=new WeakMap,A4),yh,bh,mi,Wn,kp,nu,Gi,vo,T4,bI=(T4=class extends yP{constructor(e){super();ut(this,Gi);ut(this,yh);ut(this,bh);ut(this,mi);ut(this,Wn);ut(this,kp);ut(this,nu);Ze(this,nu,!1),Ze(this,kp,e.defaultOptions),this.setOptions(e.options),this.observers=[],Ze(this,mi,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Ze(this,yh,wI(this.options)),this.state=e.state??de(this,yh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=de(this,Wn))==null?void 0:e.promise}setOptions(e){this.options={...de(this,kp),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&de(this,mi).remove(this)}setData(e,r){const n=iw(this.state.data,e,this.options);return At(this,Gi,vo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){At(this,Gi,vo).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var n,s;const r=(n=de(this,Wn))==null?void 0:n.promise;return(s=de(this,Wn))==null||s.cancel(e),r?r.then(pi).catch(pi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(de(this,yh))}isActive(){return this.observers.some(e=>Ji(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===__||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!fP(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=de(this,Wn))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=de(this,Wn))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),de(this,mi).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(de(this,Wn)&&(de(this,nu)?de(this,Wn).cancel({revert:!0}):de(this,Wn).cancelRetry()),this.scheduleGc()),de(this,mi).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||At(this,Gi,vo).call(this,{type:"invalidate"})}fetch(e,r){var c,u,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(de(this,Wn))return de(this,Wn).continueRetry(),de(this,Wn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const n=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(Ze(this,nu,!0),n.signal)})},i=()=>{const h=pP(this.options,r),f={queryKey:this.queryKey,meta:this.meta};return s(f),Ze(this,nu,!1),this.options.persister?this.options.persister(h,f,this):h(f)},a={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};s(a),(c=this.options.behavior)==null||c.onFetch(a,this),Ze(this,bh,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=a.fetchOptions)==null?void 0:u.meta))&&At(this,Gi,vo).call(this,{type:"fetch",meta:(d=a.fetchOptions)==null?void 0:d.meta});const l=h=>{var f,m,p,v;v2(h)&&h.silent||At(this,Gi,vo).call(this,{type:"error",error:h}),v2(h)||((m=(f=de(this,mi).config).onError)==null||m.call(f,h,this),(v=(p=de(this,mi).config).onSettled)==null||v.call(p,this.state.data,h,this)),this.scheduleGc()};return Ze(this,Wn,xP({initialPromise:r==null?void 0:r.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:h=>{var f,m,p,v;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(b){l(b);return}(m=(f=de(this,mi).config).onSuccess)==null||m.call(f,h,this),(v=(p=de(this,mi).config).onSettled)==null||v.call(p,h,this.state.error,this),this.scheduleGc()},onError:l,onFail:(h,f)=>{At(this,Gi,vo).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{At(this,Gi,vo).call(this,{type:"pause"})},onContinue:()=>{At(this,Gi,vo).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),de(this,Wn).start()}},yh=new WeakMap,bh=new WeakMap,mi=new WeakMap,Wn=new WeakMap,kp=new WeakMap,nu=new WeakMap,Gi=new WeakSet,vo=function(e){const r=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...bP(n.data,this.options),fetchMeta:e.meta??null};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return v2(s)&&s.revert&&de(this,bh)?{...de(this,bh),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),un.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),de(this,mi).notify({query:this,type:"updated",action:e})})},T4);function bP(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gP(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function wI(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ta,L4,_I=(L4=class extends tf{constructor(e={}){super();ut(this,Ta);this.config=e,Ze(this,Ta,new Map)}build(e,r,n){const s=r.queryKey,i=r.queryHash??w_(s,r);let a=this.get(i);return a||(a=new bI({cache:this,queryKey:s,queryHash:i,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(a)),a}add(e){de(this,Ta).has(e.queryHash)||(de(this,Ta).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=de(this,Ta).get(e.queryHash);r&&(e.destroy(),r===e&&de(this,Ta).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){un.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return de(this,Ta).get(e)}getAll(){return[...de(this,Ta).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>YC(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>YC(e,n)):r}notify(e){un.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){un.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){un.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ta=new WeakMap,L4),La,rs,su,Oa,wl,O4,jI=(O4=class extends yP{constructor(e){super();ut(this,Oa);ut(this,La);ut(this,rs);ut(this,su);this.mutationId=e.mutationId,Ze(this,rs,e.mutationCache),Ze(this,La,[]),this.state=e.state||wP(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){de(this,La).includes(e)||(de(this,La).push(e),this.clearGcTimeout(),de(this,rs).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Ze(this,La,de(this,La).filter(r=>r!==e)),this.scheduleGc(),de(this,rs).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){de(this,La).length||(this.state.status==="pending"?this.scheduleGc():de(this,rs).remove(this))}continue(){var e;return((e=de(this,su))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var s,i,a,l,c,u,d,h,f,m,p,v,b,x,w,_,S,N,E,P;Ze(this,su,xP({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(A,F)=>{At(this,Oa,wl).call(this,{type:"failed",failureCount:A,error:F})},onPause:()=>{At(this,Oa,wl).call(this,{type:"pause"})},onContinue:()=>{At(this,Oa,wl).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>de(this,rs).canRun(this)}));const r=this.state.status==="pending",n=!de(this,su).canStart();try{if(!r){At(this,Oa,wl).call(this,{type:"pending",variables:e,isPaused:n}),await((i=(s=de(this,rs).config).onMutate)==null?void 0:i.call(s,e,this));const F=await((l=(a=this.options).onMutate)==null?void 0:l.call(a,e));F!==this.state.context&&At(this,Oa,wl).call(this,{type:"pending",context:F,variables:e,isPaused:n})}const A=await de(this,su).start();return await((u=(c=de(this,rs).config).onSuccess)==null?void 0:u.call(c,A,e,this.state.context,this)),await((h=(d=this.options).onSuccess)==null?void 0:h.call(d,A,e,this.state.context)),await((m=(f=de(this,rs).config).onSettled)==null?void 0:m.call(f,A,null,this.state.variables,this.state.context,this)),await((v=(p=this.options).onSettled)==null?void 0:v.call(p,A,null,e,this.state.context)),At(this,Oa,wl).call(this,{type:"success",data:A}),A}catch(A){try{throw await((x=(b=de(this,rs).config).onError)==null?void 0:x.call(b,A,e,this.state.context,this)),await((_=(w=this.options).onError)==null?void 0:_.call(w,A,e,this.state.context)),await((N=(S=de(this,rs).config).onSettled)==null?void 0:N.call(S,void 0,A,this.state.variables,this.state.context,this)),await((P=(E=this.options).onSettled)==null?void 0:P.call(E,void 0,A,e,this.state.context)),A}finally{At(this,Oa,wl).call(this,{type:"error",error:A})}}finally{de(this,rs).runNext(this)}}},La=new WeakMap,rs=new WeakMap,su=new WeakMap,Oa=new WeakSet,wl=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),un.batch(()=>{de(this,La).forEach(n=>{n.onMutationUpdate(e)}),de(this,rs).notify({mutation:this,type:"updated",action:e})})},O4);function wP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var qs,Ep,M4,SI=(M4=class extends tf{constructor(e={}){super();ut(this,qs);ut(this,Ep);this.config=e,Ze(this,qs,new Map),Ze(this,Ep,Date.now())}build(e,r,n){const s=new jI({mutationCache:this,mutationId:++Ug(this,Ep)._,options:e.defaultMutationOptions(r),state:n});return this.add(s),s}add(e){const r=l0(e),n=de(this,qs).get(r)??[];n.push(e),de(this,qs).set(r,n),this.notify({type:"added",mutation:e})}remove(e){var n;const r=l0(e);if(de(this,qs).has(r)){const s=(n=de(this,qs).get(r))==null?void 0:n.filter(i=>i!==e);s&&(s.length===0?de(this,qs).delete(r):de(this,qs).set(r,s))}this.notify({type:"removed",mutation:e})}canRun(e){var n;const r=(n=de(this,qs).get(l0(e)))==null?void 0:n.find(s=>s.state.status==="pending");return!r||r===e}runNext(e){var n;const r=(n=de(this,qs).get(l0(e)))==null?void 0:n.find(s=>s!==e&&s.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){un.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...de(this,qs).values()].flat()}find(e){const r={exact:!0,...e};return this.getAll().find(n=>XC(r,n))}findAll(e={}){return this.getAll().filter(r=>XC(e,r))}notify(e){un.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return un.batch(()=>Promise.all(e.map(r=>r.continue().catch(pi))))}},qs=new WeakMap,Ep=new WeakMap,M4);function l0(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function nx(t){return{onFetch:(e,r)=>{var d,h,f,m,p;const n=e.options,s=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=e.state.data)==null?void 0:m.pages)||[],a=((p=e.state.data)==null?void 0:p.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const b=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},x=pP(e.options,e.fetchOptions),w=async(_,S,N)=>{if(v)return Promise.reject();if(S==null&&_.pages.length)return Promise.resolve(_);const E={queryKey:e.queryKey,pageParam:S,direction:N?"backward":"forward",meta:e.options.meta};b(E);const P=await x(E),{maxPages:A}=e.options,F=N?pI:mI;return{pages:F(_.pages,P,A),pageParams:F(_.pageParams,S,A)}};if(s&&i.length){const _=s==="backward",S=_?_P:ow,N={pages:i,pageParams:a},E=S(n,N);l=await w(N,E,_)}else{const _=t??i.length;do{const S=c===0?a[0]??n.initialPageParam:ow(n,l);if(c>0&&S==null)break;l=await w(l,S),c++}while(c<_)}return l};e.options.persister?e.fetchFn=()=>{var v,b;return(b=(v=e.options).persister)==null?void 0:b.call(v,u,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=u}}}function ow(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function _P(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}function CI(t,e){return e?ow(t,e)!=null:!1}function NI(t,e){return!e||!t.getPreviousPageParam?!1:_P(t,e)!=null}var Ir,Ol,Ml,wh,_h,Rl,jh,Sh,R4,kI=(R4=class{constructor(t={}){ut(this,Ir);ut(this,Ol);ut(this,Ml);ut(this,wh);ut(this,_h);ut(this,Rl);ut(this,jh);ut(this,Sh);Ze(this,Ir,t.queryCache||new _I),Ze(this,Ol,t.mutationCache||new SI),Ze(this,Ml,t.defaultOptions||{}),Ze(this,wh,new Map),Ze(this,_h,new Map),Ze(this,Rl,0)}mount(){Ug(this,Rl)._++,de(this,Rl)===1&&(Ze(this,jh,j_.subscribe(async t=>{t&&(await this.resumePausedMutations(),de(this,Ir).onFocus())})),Ze(this,Sh,rx.subscribe(async t=>{t&&(await this.resumePausedMutations(),de(this,Ir).onOnline())})))}unmount(){var t,e;Ug(this,Rl)._--,de(this,Rl)===0&&((t=de(this,jh))==null||t.call(this),Ze(this,jh,void 0),(e=de(this,Sh))==null||e.call(this),Ze(this,Sh,void 0))}isFetching(t){return de(this,Ir).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return de(this,Ol).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=de(this,Ir).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const r=this.defaultQueryOptions(t),n=de(this,Ir).build(this,r);return t.revalidateIfStale&&n.isStaleByTime(nh(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(e)}}getQueriesData(t){return de(this,Ir).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),s=de(this,Ir).get(n.queryHash),i=s==null?void 0:s.state.data,a=hI(e,i);if(a!==void 0)return de(this,Ir).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(t,e,r){return un.batch(()=>de(this,Ir).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=de(this,Ir).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=de(this,Ir);un.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=de(this,Ir),n={type:"active",...t};return un.batch(()=>(r.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries(n,e)))}cancelQueries(t={},e={}){const r={revert:!0,...e},n=un.batch(()=>de(this,Ir).findAll(t).map(s=>s.cancel(r)));return Promise.all(n).then(pi).catch(pi)}invalidateQueries(t={},e={}){return un.batch(()=>{if(de(this,Ir).findAll(t).forEach(n=>{n.invalidate()}),t.refetchType==="none")return Promise.resolve();const r={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(r,e)})}refetchQueries(t={},e){const r={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},n=un.batch(()=>de(this,Ir).findAll(t).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(pi)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(pi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=de(this,Ir).build(this,e);return r.isStaleByTime(nh(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(pi).catch(pi)}fetchInfiniteQuery(t){return t.behavior=nx(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(pi).catch(pi)}ensureInfiniteQueryData(t){return t.behavior=nx(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return rx.isOnline()?de(this,Ol).resumePausedMutations():Promise.resolve()}getQueryCache(){return de(this,Ir)}getMutationCache(){return de(this,Ol)}getDefaultOptions(){return de(this,Ml)}setDefaultOptions(t){Ze(this,Ml,t)}setQueryDefaults(t,e){de(this,wh).set(yu(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...de(this,wh).values()];let r={};return e.forEach(n=>{op(t,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(t,e){de(this,_h).set(yu(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...de(this,_h).values()];let r={};return e.forEach(n=>{op(t,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...de(this,Ml).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=w_(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===__&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...de(this,Ml).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){de(this,Ir).clear(),de(this,Ol).clear()}},Ir=new WeakMap,Ol=new WeakMap,Ml=new WeakMap,wh=new WeakMap,_h=new WeakMap,Rl=new WeakMap,jh=new WeakMap,Sh=new WeakMap,R4),bs,zt,Pp,ns,iu,Ch,Dl,Ma,Ap,Nh,kh,au,ou,Fl,Eh,nr,ym,lw,cw,uw,dw,hw,fw,mw,SP,D4,jP=(D4=class extends tf{constructor(e,r){super();ut(this,nr);ut(this,bs);ut(this,zt);ut(this,Pp);ut(this,ns);ut(this,iu);ut(this,Ch);ut(this,Dl);ut(this,Ma);ut(this,Ap);ut(this,Nh);ut(this,kh);ut(this,au);ut(this,ou);ut(this,Fl);ut(this,Eh,new Set);this.options=r,Ze(this,bs,e),Ze(this,Ma,null),Ze(this,Dl,aw()),this.options.experimental_prefetchInRender||de(this,Dl).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(de(this,zt).addObserver(this),JC(de(this,zt),this.options)?At(this,nr,ym).call(this):this.updateResult(),At(this,nr,dw).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return pw(de(this,zt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return pw(de(this,zt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,At(this,nr,hw).call(this),At(this,nr,fw).call(this),de(this,zt).removeObserver(this)}setOptions(e,r){const n=this.options,s=de(this,zt);if(this.options=de(this,bs).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ji(this.options.enabled,de(this,zt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");At(this,nr,mw).call(this),de(this,zt).setOptions(this.options),n._defaulted&&!tx(this.options,n)&&de(this,bs).getQueryCache().notify({type:"observerOptionsUpdated",query:de(this,zt),observer:this});const i=this.hasListeners();i&&ZC(de(this,zt),s,this.options,n)&&At(this,nr,ym).call(this),this.updateResult(r),i&&(de(this,zt)!==s||Ji(this.options.enabled,de(this,zt))!==Ji(n.enabled,de(this,zt))||nh(this.options.staleTime,de(this,zt))!==nh(n.staleTime,de(this,zt)))&&At(this,nr,lw).call(this);const a=At(this,nr,cw).call(this);i&&(de(this,zt)!==s||Ji(this.options.enabled,de(this,zt))!==Ji(n.enabled,de(this,zt))||a!==de(this,Fl))&&At(this,nr,uw).call(this,a)}getOptimisticResult(e){const r=de(this,bs).getQueryCache().build(de(this,bs),e),n=this.createResult(r,e);return PI(this,n)&&(Ze(this,ns,n),Ze(this,Ch,this.options),Ze(this,iu,de(this,zt).state)),n}getCurrentResult(){return de(this,ns)}trackResult(e,r){const n={};return Object.keys(e).forEach(s=>{Object.defineProperty(n,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),r==null||r(s),e[s])})}),n}trackProp(e){de(this,Eh).add(e)}getCurrentQuery(){return de(this,zt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=de(this,bs).defaultQueryOptions(e),n=de(this,bs).getQueryCache().build(de(this,bs),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(e){return At(this,nr,ym).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),de(this,ns)))}createResult(e,r){var A;const n=de(this,zt),s=this.options,i=de(this,ns),a=de(this,iu),l=de(this,Ch),u=e!==n?e.state:de(this,Pp),{state:d}=e;let h={...d},f=!1,m;if(r._optimisticResults){const F=this.hasListeners(),Y=!F&&JC(e,r),T=F&&ZC(e,n,r,s);(Y||T)&&(h={...h,...bP(d.data,e.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:v,status:b}=h;if(r.select&&h.data!==void 0)if(i&&h.data===(a==null?void 0:a.data)&&r.select===de(this,Ap))m=de(this,Nh);else try{Ze(this,Ap,r.select),m=r.select(h.data),m=iw(i==null?void 0:i.data,m,r),Ze(this,Nh,m),Ze(this,Ma,null)}catch(F){Ze(this,Ma,F)}else m=h.data;if(r.placeholderData!==void 0&&m===void 0&&b==="pending"){let F;if(i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData))F=i.data;else if(F=typeof r.placeholderData=="function"?r.placeholderData((A=de(this,kh))==null?void 0:A.state.data,de(this,kh)):r.placeholderData,r.select&&F!==void 0)try{F=r.select(F),Ze(this,Ma,null)}catch(Y){Ze(this,Ma,Y)}F!==void 0&&(b="success",m=iw(i==null?void 0:i.data,F,r),f=!0)}de(this,Ma)&&(p=de(this,Ma),m=de(this,Nh),v=Date.now(),b="error");const x=h.fetchStatus==="fetching",w=b==="pending",_=b==="error",S=w&&x,N=m!==void 0,P={status:b,fetchStatus:h.fetchStatus,isPending:w,isSuccess:b==="success",isError:_,isInitialLoading:S,isLoading:S,data:m,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:x,isRefetching:x&&!w,isLoadingError:_&&!N,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&N,isStale:S_(e,r),refetch:this.refetch,promise:de(this,Dl)};if(this.options.experimental_prefetchInRender){const F=O=>{P.status==="error"?O.reject(P.error):P.data!==void 0&&O.resolve(P.data)},Y=()=>{const O=Ze(this,Dl,P.promise=aw());F(O)},T=de(this,Dl);switch(T.status){case"pending":e.queryHash===n.queryHash&&F(T);break;case"fulfilled":(P.status==="error"||P.data!==T.value)&&Y();break;case"rejected":(P.status!=="error"||P.error!==T.reason)&&Y();break}}return P}updateResult(e){const r=de(this,ns),n=this.createResult(de(this,zt),this.options);if(Ze(this,iu,de(this,zt).state),Ze(this,Ch,this.options),de(this,iu).data!==void 0&&Ze(this,kh,de(this,zt)),tx(n,r))return;Ze(this,ns,n);const s={},i=()=>{if(!r)return!0;const{notifyOnChangeProps:a}=this.options,l=typeof a=="function"?a():a;if(l==="all"||!l&&!de(this,Eh).size)return!0;const c=new Set(l??de(this,Eh));return this.options.throwOnError&&c.add("error"),Object.keys(de(this,ns)).some(u=>{const d=u;return de(this,ns)[d]!==r[d]&&c.has(d)})};(e==null?void 0:e.listeners)!==!1&&i()&&(s.listeners=!0),At(this,nr,SP).call(this,{...s,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&At(this,nr,dw).call(this)}},bs=new WeakMap,zt=new WeakMap,Pp=new WeakMap,ns=new WeakMap,iu=new WeakMap,Ch=new WeakMap,Dl=new WeakMap,Ma=new WeakMap,Ap=new WeakMap,Nh=new WeakMap,kh=new WeakMap,au=new WeakMap,ou=new WeakMap,Fl=new WeakMap,Eh=new WeakMap,nr=new WeakSet,ym=function(e){At(this,nr,mw).call(this);let r=de(this,zt).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(pi)),r},lw=function(){At(this,nr,hw).call(this);const e=nh(this.options.staleTime,de(this,zt));if(xu||de(this,ns).isStale||!nw(e))return;const n=fP(de(this,ns).dataUpdatedAt,e)+1;Ze(this,au,setTimeout(()=>{de(this,ns).isStale||this.updateResult()},n))},cw=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(de(this,zt)):this.options.refetchInterval)??!1},uw=function(e){At(this,nr,fw).call(this),Ze(this,Fl,e),!(xu||Ji(this.options.enabled,de(this,zt))===!1||!nw(de(this,Fl))||de(this,Fl)===0)&&Ze(this,ou,setInterval(()=>{(this.options.refetchIntervalInBackground||j_.isFocused())&&At(this,nr,ym).call(this)},de(this,Fl)))},dw=function(){At(this,nr,lw).call(this),At(this,nr,uw).call(this,At(this,nr,cw).call(this))},hw=function(){de(this,au)&&(clearTimeout(de(this,au)),Ze(this,au,void 0))},fw=function(){de(this,ou)&&(clearInterval(de(this,ou)),Ze(this,ou,void 0))},mw=function(){const e=de(this,bs).getQueryCache().build(de(this,bs),this.options);if(e===de(this,zt))return;const r=de(this,zt);Ze(this,zt,e),Ze(this,Pp,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},SP=function(e){un.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(de(this,ns))}),de(this,bs).getQueryCache().notify({query:de(this,zt),type:"observerResultsUpdated"})})},D4);function EI(t,e){return Ji(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function JC(t,e){return EI(t,e)||t.state.data!==void 0&&pw(t,e,e.refetchOnMount)}function pw(t,e,r){if(Ji(e.enabled,t)!==!1){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&S_(t,e)}return!1}function ZC(t,e,r,n){return(t!==e||Ji(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&S_(t,r)}function S_(t,e){return Ji(e.enabled,t)!==!1&&t.isStaleByTime(nh(e.staleTime,t))}function PI(t,e){return!tx(t.getCurrentResult(),e)}var AI=class extends jP{constructor(t,e){super(t,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,e){super.setOptions({...t,behavior:nx()},e)}getOptimisticResult(t){return t.behavior=nx(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,e){var p,v;const{state:r}=t,n=super.createResult(t,e),{isFetching:s,isRefetching:i,isError:a,isRefetchError:l}=n,c=(v=(p=r.fetchMeta)==null?void 0:p.fetchMore)==null?void 0:v.direction,u=a&&c==="forward",d=s&&c==="forward",h=a&&c==="backward",f=s&&c==="backward";return{...n,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:CI(e,r.data),hasPreviousPage:NI(e,r.data),isFetchNextPageError:u,isFetchingNextPage:d,isFetchPreviousPageError:h,isFetchingPreviousPage:f,isRefetchError:l&&!u&&!h,isRefetching:i&&!d&&!f}}},Il,zl,ws,So,Mo,mv,gw,F4,TI=(F4=class extends tf{constructor(r,n){super();ut(this,Mo);ut(this,Il);ut(this,zl);ut(this,ws);ut(this,So);Ze(this,Il,r),this.setOptions(n),this.bindMethods(),At(this,Mo,mv).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=de(this,Il).defaultMutationOptions(r),tx(this.options,n)||de(this,Il).getMutationCache().notify({type:"observerOptionsUpdated",mutation:de(this,ws),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&yu(n.mutationKey)!==yu(this.options.mutationKey)?this.reset():((s=de(this,ws))==null?void 0:s.state.status)==="pending"&&de(this,ws).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=de(this,ws))==null||r.removeObserver(this)}onMutationUpdate(r){At(this,Mo,mv).call(this),At(this,Mo,gw).call(this,r)}getCurrentResult(){return de(this,zl)}reset(){var r;(r=de(this,ws))==null||r.removeObserver(this),Ze(this,ws,void 0),At(this,Mo,mv).call(this),At(this,Mo,gw).call(this)}mutate(r,n){var s;return Ze(this,So,n),(s=de(this,ws))==null||s.removeObserver(this),Ze(this,ws,de(this,Il).getMutationCache().build(de(this,Il),this.options)),de(this,ws).addObserver(this),de(this,ws).execute(r)}},Il=new WeakMap,zl=new WeakMap,ws=new WeakMap,So=new WeakMap,Mo=new WeakSet,mv=function(){var n;const r=((n=de(this,ws))==null?void 0:n.state)??wP();Ze(this,zl,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},gw=function(r){un.batch(()=>{var n,s,i,a,l,c,u,d;if(de(this,So)&&this.hasListeners()){const h=de(this,zl).variables,f=de(this,zl).context;(r==null?void 0:r.type)==="success"?((s=(n=de(this,So)).onSuccess)==null||s.call(n,r.data,h,f),(a=(i=de(this,So)).onSettled)==null||a.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((c=(l=de(this,So)).onError)==null||c.call(l,r.error,h,f),(d=(u=de(this,So)).onSettled)==null||d.call(u,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(de(this,zl))})})},F4),CP=y.createContext(void 0),br=t=>{const e=y.useContext(CP);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},LI=({client:t,children:e})=>(y.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),o.jsx(CP.Provider,{value:t,children:e})),NP=y.createContext(!1),OI=()=>y.useContext(NP);NP.Provider;function MI(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var RI=y.createContext(MI()),DI=()=>y.useContext(RI);function kP(t,e){return typeof t=="function"?t(...e):!!t}function EP(){}var FI=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},II=t=>{y.useEffect(()=>{t.clearReset()},[t])},zI=({result:t,errorResetBoundary:e,throwOnError:r,query:n})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&kP(r,[t.error,n]),$I=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},BI=(t,e)=>t.isLoading&&t.isFetching&&!e,qI=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,eN=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function PP(t,e,r){var d,h,f,m,p;const n=br(),s=OI(),i=DI(),a=n.defaultQueryOptions(t);(h=(d=n.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||h.call(d,a),a._optimisticResults=s?"isRestoring":"optimistic",$I(a),FI(a,i),II(i);const l=!n.getQueryCache().get(a.queryHash),[c]=y.useState(()=>new e(n,a)),u=c.getOptimisticResult(a);if(y.useSyncExternalStore(y.useCallback(v=>{const b=s?()=>{}:c.subscribe(un.batchCalls(v));return c.updateResult(),b},[c,s]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),y.useEffect(()=>{c.setOptions(a,{listeners:!1})},[a,c]),qI(a,u))throw eN(a,c,i);if(zI({result:u,errorResetBoundary:i,throwOnError:a.throwOnError,query:n.getQueryCache().get(a.queryHash)}))throw u.error;if((m=(f=n.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||m.call(f,a,u),a.experimental_prefetchInRender&&!xu&&BI(u,s)){const v=l?eN(a,c,i):(p=n.getQueryCache().get(a.queryHash))==null?void 0:p.promise;v==null||v.catch(EP).finally(()=>{c.updateResult()})}return a.notifyOnChangeProps?u:c.trackResult(u)}function Nt(t,e){return PP(t,jP)}function Vt(t,e){const r=br(),[n]=y.useState(()=>new TI(r,t));y.useEffect(()=>{n.setOptions(t)},[n,t]);const s=y.useSyncExternalStore(y.useCallback(a=>n.subscribe(un.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=y.useCallback((a,l)=>{n.mutate(a,l).catch(EP)},[n]);if(s.error&&kP(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}function UI(t,e){return PP(t,AI)}var VI=t=>{switch(t){case"success":return GI;case"info":return XI;case"warning":return YI;case"error":return KI;default:return null}},WI=Array(12).fill(0),HI=({visible:t})=>Fe.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},Fe.createElement("div",{className:"sonner-spinner"},WI.map((e,r)=>Fe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),GI=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),YI=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),XI=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),KI=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),QI=()=>{let[t,e]=Fe.useState(document.hidden);return Fe.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},vw=1,JI=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;let{message:n,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:vw++,a=this.toasts.find(c=>c.id===i),l=e.dismissible===void 0?!0:e.dismissible;return a?this.toasts=this.toasts.map(c=>c.id===i?(this.publish({...c,...e,id:i,title:n}),{...c,...e,id:i,dismissible:l,title:n}):c):this.addToast({title:n,...s,dismissible:l,id:i}),i},this.dismiss=e=>(e||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:e,dismiss:!0})),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let s=e instanceof Promise?e:e(),i=n!==void 0;return s.then(async a=>{if(ez(a)&&!a.ok){i=!1;let l=typeof r.error=="function"?await r.error(`HTTP error! status: ${a.status}`):r.error,c=typeof r.description=="function"?await r.description(`HTTP error! status: ${a.status}`):r.description;this.create({id:n,type:"error",message:l,description:c})}else if(r.success!==void 0){i=!1;let l=typeof r.success=="function"?await r.success(a):r.success,c=typeof r.description=="function"?await r.description(a):r.description;this.create({id:n,type:"success",message:l,description:c})}}).catch(async a=>{if(r.error!==void 0){i=!1;let l=typeof r.error=="function"?await r.error(a):r.error,c=typeof r.description=="function"?await r.description(a):r.description;this.create({id:n,type:"error",message:l,description:c})}}).finally(()=>{var a;i&&(this.dismiss(n),n=void 0),(a=r.finally)==null||a.call(r)}),n},this.custom=(e,r)=>{let n=(r==null?void 0:r.id)||vw++;return this.create({jsx:e(n),id:n,...r}),n},this.subscribers=[],this.toasts=[]}},Us=new JI,ZI=(t,e)=>{let r=(e==null?void 0:e.id)||vw++;return Us.addToast({title:t,...e,id:r}),r},ez=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",tz=ZI,rz=()=>Us.toasts,me=Object.assign(tz,{success:Us.success,info:Us.info,warning:Us.warning,error:Us.error,custom:Us.custom,message:Us.message,promise:Us.promise,dismiss:Us.dismiss,loading:Us.loading},{getHistory:rz});function nz(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}nz(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function c0(t){return t.label!==void 0}var sz=3,iz="32px",az=4e3,oz=356,lz=14,cz=20,uz=200;function dz(...t){return t.filter(Boolean).join(" ")}var hz=t=>{var e,r,n,s,i,a,l,c,u,d;let{invert:h,toast:f,unstyled:m,interacting:p,setHeights:v,visibleToasts:b,heights:x,index:w,toasts:_,expanded:S,removeToast:N,defaultRichColors:E,closeButton:P,style:A,cancelButtonStyle:F,actionButtonStyle:Y,className:T="",descriptionClassName:O="",duration:U,position:q,gap:Z,loadingIcon:H,expandByDefault:Q,classNames:R,icons:B,closeButtonAriaLabel:X="Close toast",pauseWhenPageIsHidden:ie,cn:M}=t,[W,K]=Fe.useState(!1),[ne,se]=Fe.useState(!1),[le,ye]=Fe.useState(!1),[oe,ve]=Fe.useState(!1),[Se,Ae]=Fe.useState(0),[Ee,$e]=Fe.useState(0),je=Fe.useRef(null),te=Fe.useRef(null),it=w===0,Qe=w+1<=b,Te=f.type,ze=f.dismissible!==!1,qe=f.className||"",Ue=f.descriptionClassName||"",nt=Fe.useMemo(()=>x.findIndex(Ge=>Ge.toastId===f.id)||0,[x,f.id]),pt=Fe.useMemo(()=>{var Ge;return(Ge=f.closeButton)!=null?Ge:P},[f.closeButton,P]),yt=Fe.useMemo(()=>f.duration||U||az,[f.duration,U]),jt=Fe.useRef(0),Et=Fe.useRef(0),Kt=Fe.useRef(0),ot=Fe.useRef(null),[Pt,He]=q.split("-"),an=Fe.useMemo(()=>x.reduce((Ge,Ht,ft)=>ft>=nt?Ge:Ge+Ht.height,0),[x,nt]),It=QI(),Rs=f.invert||h,Qt=Te==="loading";Et.current=Fe.useMemo(()=>nt*Z+an,[nt,an]),Fe.useEffect(()=>{K(!0)},[]),Fe.useLayoutEffect(()=>{if(!W)return;let Ge=te.current,Ht=Ge.style.height;Ge.style.height="auto";let ft=Ge.getBoundingClientRect().height;Ge.style.height=Ht,$e(ft),v(Rr=>Rr.find(Jr=>Jr.toastId===f.id)?Rr.map(Jr=>Jr.toastId===f.id?{...Jr,height:ft}:Jr):[{toastId:f.id,height:ft,position:f.position},...Rr])},[W,f.title,f.description,v,f.id]);let Wt=Fe.useCallback(()=>{se(!0),Ae(Et.current),v(Ge=>Ge.filter(Ht=>Ht.toastId!==f.id)),setTimeout(()=>{N(f)},uz)},[f,N,v,Et]);Fe.useEffect(()=>{if(f.promise&&Te==="loading"||f.duration===1/0||f.type==="loading")return;let Ge,Ht=yt;return S||p||ie&&It?(()=>{if(Kt.current<jt.current){let ft=new Date().getTime()-jt.current;Ht=Ht-ft}Kt.current=new Date().getTime()})():Ht!==1/0&&(jt.current=new Date().getTime(),Ge=setTimeout(()=>{var ft;(ft=f.onAutoClose)==null||ft.call(f,f),Wt()},Ht)),()=>clearTimeout(Ge)},[S,p,Q,f,yt,Wt,f.promise,Te,ie,It]),Fe.useEffect(()=>{let Ge=te.current;if(Ge){let Ht=Ge.getBoundingClientRect().height;return $e(Ht),v(ft=>[{toastId:f.id,height:Ht,position:f.position},...ft]),()=>v(ft=>ft.filter(Rr=>Rr.toastId!==f.id))}},[v,f.id]),Fe.useEffect(()=>{f.delete&&Wt()},[Wt,f.delete]);function si(){return B!=null&&B.loading?Fe.createElement("div",{className:"sonner-loader","data-visible":Te==="loading"},B.loading):H?Fe.createElement("div",{className:"sonner-loader","data-visible":Te==="loading"},H):Fe.createElement(HI,{visible:Te==="loading"})}return Fe.createElement("li",{"aria-live":f.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:te,className:M(T,qe,R==null?void 0:R.toast,(e=f==null?void 0:f.classNames)==null?void 0:e.toast,R==null?void 0:R.default,R==null?void 0:R[Te],(r=f==null?void 0:f.classNames)==null?void 0:r[Te]),"data-sonner-toast":"","data-rich-colors":(n=f.richColors)!=null?n:E,"data-styled":!(f.jsx||f.unstyled||m),"data-mounted":W,"data-promise":!!f.promise,"data-removed":ne,"data-visible":Qe,"data-y-position":Pt,"data-x-position":He,"data-index":w,"data-front":it,"data-swiping":le,"data-dismissible":ze,"data-type":Te,"data-invert":Rs,"data-swipe-out":oe,"data-expanded":!!(S||Q&&W),style:{"--index":w,"--toasts-before":w,"--z-index":_.length-w,"--offset":`${ne?Se:Et.current}px`,"--initial-height":Q?"auto":`${Ee}px`,...A,...f.style},onPointerDown:Ge=>{Qt||!ze||(je.current=new Date,Ae(Et.current),Ge.target.setPointerCapture(Ge.pointerId),Ge.target.tagName!=="BUTTON"&&(ye(!0),ot.current={x:Ge.clientX,y:Ge.clientY}))},onPointerUp:()=>{var Ge,Ht,ft,Rr;if(oe||!ze)return;ot.current=null;let Jr=Number(((Ge=te.current)==null?void 0:Ge.style.getPropertyValue("--swipe-amount").replace("px",""))||0),dr=new Date().getTime()-((Ht=je.current)==null?void 0:Ht.getTime()),gt=Math.abs(Jr)/dr;if(Math.abs(Jr)>=cz||gt>.11){Ae(Et.current),(ft=f.onDismiss)==null||ft.call(f,f),Wt(),ve(!0);return}(Rr=te.current)==null||Rr.style.setProperty("--swipe-amount","0px"),ye(!1)},onPointerMove:Ge=>{var Ht;if(!ot.current||!ze)return;let ft=Ge.clientY-ot.current.y,Rr=Ge.clientX-ot.current.x,Jr=(Pt==="top"?Math.min:Math.max)(0,ft),dr=Ge.pointerType==="touch"?10:2;Math.abs(Jr)>dr?(Ht=te.current)==null||Ht.style.setProperty("--swipe-amount",`${ft}px`):Math.abs(Rr)>dr&&(ot.current=null)}},pt&&!f.jsx?Fe.createElement("button",{"aria-label":X,"data-disabled":Qt,"data-close-button":!0,onClick:Qt||!ze?()=>{}:()=>{var Ge;Wt(),(Ge=f.onDismiss)==null||Ge.call(f,f)},className:M(R==null?void 0:R.closeButton,(s=f==null?void 0:f.classNames)==null?void 0:s.closeButton)},Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Fe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Fe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,f.jsx||Fe.isValidElement(f.title)?f.jsx||f.title:Fe.createElement(Fe.Fragment,null,Te||f.icon||f.promise?Fe.createElement("div",{"data-icon":"",className:M(R==null?void 0:R.icon,(i=f==null?void 0:f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||si():null,f.type!=="loading"?f.icon||(B==null?void 0:B[Te])||VI(Te):null):null,Fe.createElement("div",{"data-content":"",className:M(R==null?void 0:R.content,(a=f==null?void 0:f.classNames)==null?void 0:a.content)},Fe.createElement("div",{"data-title":"",className:M(R==null?void 0:R.title,(l=f==null?void 0:f.classNames)==null?void 0:l.title)},f.title),f.description?Fe.createElement("div",{"data-description":"",className:M(O,Ue,R==null?void 0:R.description,(c=f==null?void 0:f.classNames)==null?void 0:c.description)},f.description):null),Fe.isValidElement(f.cancel)?f.cancel:f.cancel&&c0(f.cancel)?Fe.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||F,onClick:Ge=>{var Ht,ft;c0(f.cancel)&&ze&&((ft=(Ht=f.cancel).onClick)==null||ft.call(Ht,Ge),Wt())},className:M(R==null?void 0:R.cancelButton,(u=f==null?void 0:f.classNames)==null?void 0:u.cancelButton)},f.cancel.label):null,Fe.isValidElement(f.action)?f.action:f.action&&c0(f.action)?Fe.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||Y,onClick:Ge=>{var Ht,ft;c0(f.action)&&(Ge.defaultPrevented||((ft=(Ht=f.action).onClick)==null||ft.call(Ht,Ge),Wt()))},className:M(R==null?void 0:R.actionButton,(d=f==null?void 0:f.classNames)==null?void 0:d.actionButton)},f.action.label):null))};function tN(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var fz=t=>{let{invert:e,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:s,closeButton:i,className:a,offset:l,theme:c="light",richColors:u,duration:d,style:h,visibleToasts:f=sz,toastOptions:m,dir:p=tN(),gap:v=lz,loadingIcon:b,icons:x,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:_,cn:S=dz}=t,[N,E]=Fe.useState([]),P=Fe.useMemo(()=>Array.from(new Set([r].concat(N.filter(ie=>ie.position).map(ie=>ie.position)))),[N,r]),[A,F]=Fe.useState([]),[Y,T]=Fe.useState(!1),[O,U]=Fe.useState(!1),[q,Z]=Fe.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),H=Fe.useRef(null),Q=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=Fe.useRef(null),B=Fe.useRef(!1),X=Fe.useCallback(ie=>{var M;(M=N.find(W=>W.id===ie.id))!=null&&M.delete||Us.dismiss(ie.id),E(W=>W.filter(({id:K})=>K!==ie.id))},[N]);return Fe.useEffect(()=>Us.subscribe(ie=>{if(ie.dismiss){E(M=>M.map(W=>W.id===ie.id?{...W,delete:!0}:W));return}setTimeout(()=>{QE.flushSync(()=>{E(M=>{let W=M.findIndex(K=>K.id===ie.id);return W!==-1?[...M.slice(0,W),{...M[W],...ie},...M.slice(W+1)]:[ie,...M]})})})}),[]),Fe.useEffect(()=>{if(c!=="system"){Z(c);return}c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:ie})=>{Z(ie?"dark":"light")})},[c]),Fe.useEffect(()=>{N.length<=1&&T(!1)},[N]),Fe.useEffect(()=>{let ie=M=>{var W,K;n.every(ne=>M[ne]||M.code===ne)&&(T(!0),(W=H.current)==null||W.focus()),M.code==="Escape"&&(document.activeElement===H.current||(K=H.current)!=null&&K.contains(document.activeElement))&&T(!1)};return document.addEventListener("keydown",ie),()=>document.removeEventListener("keydown",ie)},[n]),Fe.useEffect(()=>{if(H.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,B.current=!1)}},[H.current]),N.length?Fe.createElement("section",{"aria-label":`${w} ${Q}`,tabIndex:-1},P.map((ie,M)=>{var W;let[K,ne]=ie.split("-");return Fe.createElement("ol",{key:ie,dir:p==="auto"?tN():p,tabIndex:-1,ref:H,className:a,"data-sonner-toaster":!0,"data-theme":q,"data-y-position":K,"data-x-position":ne,style:{"--front-toast-height":`${((W=A[0])==null?void 0:W.height)||0}px`,"--offset":typeof l=="number"?`${l}px`:l||iz,"--width":`${oz}px`,"--gap":`${v}px`,...h},onBlur:se=>{B.current&&!se.currentTarget.contains(se.relatedTarget)&&(B.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||B.current||(B.current=!0,R.current=se.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{O||T(!1)},onPointerDown:se=>{se.target instanceof HTMLElement&&se.target.dataset.dismissible==="false"||U(!0)},onPointerUp:()=>U(!1)},N.filter(se=>!se.position&&M===0||se.position===ie).map((se,le)=>{var ye,oe;return Fe.createElement(hz,{key:se.id,icons:x,index:le,toast:se,defaultRichColors:u,duration:(ye=m==null?void 0:m.duration)!=null?ye:d,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:e,visibleToasts:f,closeButton:(oe=m==null?void 0:m.closeButton)!=null?oe:i,interacting:O,position:ie,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:X,toasts:N.filter(ve=>ve.position==se.position),heights:A.filter(ve=>ve.position==se.position),setHeights:F,expandByDefault:s,gap:v,loadingIcon:b,expanded:Y,pauseWhenPageIsHidden:_,cn:S})}))})):null};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AP=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...l},c)=>y.createElement("svg",{ref:c,...pz,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:AP("lucide",s),...l},[...a.map(([u,d])=>y.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=(t,e)=>{const r=y.forwardRef(({className:n,...s},i)=>y.createElement(gz,{ref:i,iconNode:e,className:AP(`lucide-${mz(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=Pe("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=Pe("AlignCenter",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=Pe("AlignLeft",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=Pe("AlignRight",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=Pe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=Pe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=Pe("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=Pe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=Pe("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=Pe("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=Pe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=Pe("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=Pe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=Pe("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Pe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=Pe("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=Pe("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=Pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=Pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=Pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=Pe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=Pe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=Pe("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=Pe("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Pe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=Pe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=Pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=Pe("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=Pe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=Pe("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=Pe("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=Pe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=Pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=Pe("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=Pe("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=Pe("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=Pe("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=Pe("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=Pe("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=Pe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Pe("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=Pe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=Pe("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=Pe("FlipHorizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=Pe("FlipVertical",[["path",{d:"M21 8V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v3",key:"14bfxa"}],["path",{d:"M21 16v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3",key:"14rx03"}],["path",{d:"M4 12H2",key:"rhcxmi"}],["path",{d:"M10 12H8",key:"s88cx1"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=Pe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=Pe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=Pe("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=Pe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=Pe("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=Pe("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=Pe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=Pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=Pe("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=Pe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=Pe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=Pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=Pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=Pe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=Pe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=Pe("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=Pe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Pe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=Pe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=Pe("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=Pe("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=Pe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=Pe("MonitorPlay",[["path",{d:"M10 7.75a.75.75 0 0 1 1.142-.638l3.664 2.249a.75.75 0 0 1 0 1.278l-3.664 2.25a.75.75 0 0 1-1.142-.64z",key:"1pctta"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=Pe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=Pe("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=Pe("Move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=Pe("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=Pe("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=Pe("PaintBucket",[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=Pe("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=Pe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Pe("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=Pe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=Pe("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=Pe("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=Pe("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Pe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=Pe("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=Pe("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=Pe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=Pe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=Pe("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=Pe("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=Pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=Pe("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=Pe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=Pe("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=Pe("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Pe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=Pe("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=Pe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=Pe("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=Pe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=Pe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=Pe("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=Pe("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=Pe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=Pe("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=Pe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=Pe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=Pe("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=Pe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=Pe("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=Pe("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=Pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=Pe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=Pe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Pe("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=Pe("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=Pe("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=Pe("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=Pe("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=Pe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=Pe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=Pe("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function m9(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function GP(...t){return e=>t.forEach(r=>m9(r,e))}function Lt(...t){return y.useCallback(GP(...t),t)}var ei=y.forwardRef((t,e)=>{const{children:r,...n}=t,s=y.Children.toArray(r),i=s.find(p9);if(i){const a=i.props.children,l=s.map(c=>c===i?y.Children.count(a)>1?y.Children.only(null):y.isValidElement(a)?a.props.children:null:c);return o.jsx(bw,{...n,ref:e,children:y.isValidElement(a)?y.cloneElement(a,void 0,l):null})}return o.jsx(bw,{...n,ref:e,children:r})});ei.displayName="Slot";var bw=y.forwardRef((t,e)=>{const{children:r,...n}=t;if(y.isValidElement(r)){const s=v9(r);return y.cloneElement(r,{...g9(n,r.props),ref:e?GP(e,s):s})}return y.Children.count(r)>1?y.Children.only(null):null});bw.displayName="SlotClone";var YP=({children:t})=>o.jsx(o.Fragment,{children:t});function p9(t){return y.isValidElement(t)&&t.type===YP}function g9(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{i(...l),s(...l)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function v9(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function XP(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=XP(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function KP(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=XP(t))&&(n&&(n+=" "),n+=e);return n}const iN=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,aN=KP,af=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return aN(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],h=i==null?void 0:i[u];if(d===null)return null;const f=iN(d)||iN(h);return s[u][f]}),l=r&&Object.entries(r).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(p=>{let[v,b]=p;return Array.isArray(b)?b.includes({...i,...l}[v]):{...i,...l}[v]===b})?[...u,h,f]:u},[]);return aN(t,a,c,r==null?void 0:r.class,r==null?void 0:r.className)},M_="-",x9=t=>{const e=b9(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:a=>{const l=a.split(M_);return l[0]===""&&l.length!==1&&l.shift(),QP(l,e)||y9(a)},getConflictingClassGroupIds:(a,l)=>{const c=r[a]||[];return l&&n[a]?[...c,...n[a]]:c}}},QP=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),s=n?QP(t.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(M_);return(a=e.validators.find(({validator:l})=>l(i)))==null?void 0:a.classGroupId},oN=/^\[(.+)\]$/,y9=t=>{if(oN.test(t)){const e=oN.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},b9=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return _9(Object.entries(t.classGroups),r).forEach(([i,a])=>{ww(a,n,i,e)}),n},ww=(t,e,r,n)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:lN(e,s);i.classGroupId=r;return}if(typeof s=="function"){if(w9(s)){ww(s(n),e,r,n);return}e.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,a])=>{ww(a,lN(e,i),r,n)})})},lN=(t,e)=>{let r=t;return e.split(M_).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},w9=t=>t.isThemeGetter,_9=(t,e)=>e?t.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,l])=>[e+a,l])):i);return[r,s]}):t,j9=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const s=(i,a)=>{r.set(i,a),e++,e>t&&(e=0,n=r,r=new Map)};return{get(i){let a=r.get(i);if(a!==void 0)return a;if((a=n.get(i))!==void 0)return s(i,a),a},set(i,a){r.has(i)?r.set(i,a):s(i,a)}}},JP="!",S9=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,s=e[0],i=e.length,a=l=>{const c=[];let u=0,d=0,h;for(let b=0;b<l.length;b++){let x=l[b];if(u===0){if(x===s&&(n||l.slice(b,b+i)===e)){c.push(l.slice(d,b)),d=b+i;continue}if(x==="/"){h=b;continue}}x==="["?u++:x==="]"&&u--}const f=c.length===0?l:l.substring(d),m=f.startsWith(JP),p=m?f.substring(1):f,v=h&&h>d?h-d:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:v}};return r?l=>r({className:l,parseClassName:a}):a},C9=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},N9=t=>({cache:j9(t.cacheSize),parseClassName:S9(t),...x9(t)}),k9=/\s+/,E9=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],a=t.trim().split(k9);let l="";for(let c=a.length-1;c>=0;c-=1){const u=a[c],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=r(u);let p=!!m,v=n(p?f.substring(0,m):f);if(!v){if(!p){l=u+(l.length>0?" "+l:l);continue}if(v=n(f),!v){l=u+(l.length>0?" "+l:l);continue}p=!1}const b=C9(d).join(":"),x=h?b+JP:b,w=x+v;if(i.includes(w))continue;i.push(w);const _=s(v,p);for(let S=0;S<_.length;++S){const N=_[S];i.push(x+N)}l=u+(l.length>0?" "+l:l)}return l};function P9(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=ZP(e))&&(n&&(n+=" "),n+=r);return n}const ZP=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=ZP(t[n]))&&(r&&(r+=" "),r+=e);return r};function A9(t,...e){let r,n,s,i=a;function a(c){const u=e.reduce((d,h)=>h(d),t());return r=N9(u),n=r.cache.get,s=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=E9(c,r);return s(c,d),d}return function(){return i(P9.apply(null,arguments))}}const wr=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},e6=/^\[(?:([a-z-]+):)?(.+)\]$/i,T9=/^\d+\/\d+$/,L9=new Set(["px","full","screen"]),O9=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,M9=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,R9=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,D9=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,F9=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,po=t=>sh(t)||L9.has(t)||T9.test(t),ml=t=>of(t,"length",W9),sh=t=>!!t&&!Number.isNaN(Number(t)),y2=t=>of(t,"number",sh),lm=t=>!!t&&Number.isInteger(Number(t)),I9=t=>t.endsWith("%")&&sh(t.slice(0,-1)),kt=t=>e6.test(t),pl=t=>O9.test(t),z9=new Set(["length","size","percentage"]),$9=t=>of(t,z9,t6),B9=t=>of(t,"position",t6),q9=new Set(["image","url"]),U9=t=>of(t,q9,G9),V9=t=>of(t,"",H9),cm=()=>!0,of=(t,e,r)=>{const n=e6.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},W9=t=>M9.test(t)&&!R9.test(t),t6=()=>!1,H9=t=>D9.test(t),G9=t=>F9.test(t),Y9=()=>{const t=wr("colors"),e=wr("spacing"),r=wr("blur"),n=wr("brightness"),s=wr("borderColor"),i=wr("borderRadius"),a=wr("borderSpacing"),l=wr("borderWidth"),c=wr("contrast"),u=wr("grayscale"),d=wr("hueRotate"),h=wr("invert"),f=wr("gap"),m=wr("gradientColorStops"),p=wr("gradientColorStopPositions"),v=wr("inset"),b=wr("margin"),x=wr("opacity"),w=wr("padding"),_=wr("saturate"),S=wr("scale"),N=wr("sepia"),E=wr("skew"),P=wr("space"),A=wr("translate"),F=()=>["auto","contain","none"],Y=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto",kt,e],O=()=>[kt,e],U=()=>["",po,ml],q=()=>["auto",sh,kt],Z=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],R=()=>["start","end","center","between","around","evenly","stretch"],B=()=>["","0",kt],X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ie=()=>[sh,kt];return{cacheSize:500,separator:":",theme:{colors:[cm],spacing:[po,ml],blur:["none","",pl,kt],brightness:ie(),borderColor:[t],borderRadius:["none","","full",pl,kt],borderSpacing:O(),borderWidth:U(),contrast:ie(),grayscale:B(),hueRotate:ie(),invert:B(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[I9,ml],inset:T(),margin:T(),opacity:ie(),padding:O(),saturate:ie(),scale:ie(),sepia:B(),skew:ie(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",kt]}],container:["container"],columns:[{columns:[pl]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Z(),kt]}],overflow:[{overflow:Y()}],"overflow-x":[{"overflow-x":Y()}],"overflow-y":[{"overflow-y":Y()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lm,kt]}],basis:[{basis:T()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",kt]}],grow:[{grow:B()}],shrink:[{shrink:B()}],order:[{order:["first","last","none",lm,kt]}],"grid-cols":[{"grid-cols":[cm]}],"col-start-end":[{col:["auto",{span:["full",lm,kt]},kt]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[cm]}],"row-start-end":[{row:["auto",{span:[lm,kt]},kt]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",kt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",kt]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...R()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...R(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...R(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",kt,e]}],"min-w":[{"min-w":[kt,e,"min","max","fit"]}],"max-w":[{"max-w":[kt,e,"none","full","min","max","fit","prose",{screen:[pl]},pl]}],h:[{h:[kt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[kt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[kt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[kt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",pl,ml]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",y2]}],"font-family":[{font:[cm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",kt]}],"line-clamp":[{"line-clamp":["none",sh,y2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",po,kt]}],"list-image":[{"list-image":["none",kt]}],"list-style-type":[{list:["none","disc","decimal",kt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",po,ml]}],"underline-offset":[{"underline-offset":["auto",po,kt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Z(),B9]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",$9]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},U9]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:H()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[po,kt]}],"outline-w":[{outline:[po,ml]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:U()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[po,ml]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",pl,V9]}],"shadow-color":[{shadow:[cm]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...Q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",pl,kt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[_]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",kt]}],duration:[{duration:ie()}],ease:[{ease:["linear","in","out","in-out",kt]}],delay:[{delay:ie()}],animate:[{animate:["none","spin","ping","pulse","bounce",kt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[lm,kt]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",kt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",kt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",kt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[po,ml,y2]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},X9=A9(Y9);function Be(...t){return X9(KP(t))}const K9=af("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),J=y.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...s},i)=>{const a=n?ei:"button";return o.jsx(a,{className:Be(K9({variant:e,size:r,className:t})),ref:i,...s})});J.displayName="Button";const Mt=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Be("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Mt.displayName="Card";const er=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Be("flex flex-col space-y-1.5 p-6",t),...e}));er.displayName="CardHeader";const ur=y.forwardRef(({className:t,...e},r)=>o.jsx("h3",{ref:r,className:Be("text-2xl font-semibold leading-none tracking-tight",t),...e}));ur.displayName="CardTitle";const r6=y.forwardRef(({className:t,...e},r)=>o.jsx("p",{ref:r,className:Be("text-sm text-muted-foreground",t),...e}));r6.displayName="CardDescription";const Rt=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Be("p-6 pt-0",t),...e}));Rt.displayName="CardContent";const R_=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Be("flex items-center p-6 pt-0",t),...e}));R_.displayName="CardFooter";const Q9=af("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function yr({className:t,variant:e,...r}){return o.jsx("div",{className:Be(Q9({variant:e}),t),...r})}const J9="modulepreload",Z9=function(t){return"/"+t},cN={},sc=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Z9(c),c in cN)return;cN[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":J9,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},e$=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sc(async()=>{const{default:n}=await Promise.resolve().then(()=>lf);return{default:n}},[]).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class D_ extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class t$ extends D_{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class uN extends D_{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dN extends D_{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var _w;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(_w||(_w={}));var r$=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class n${constructor(e,{headers:r={},customFetch:n,region:s=_w.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=e$(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return r$(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(l["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(l["Content-Type"]="application/json",d=JSON.stringify(a)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(v=>{throw new t$(v)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new uN(h);if(!h.ok)throw new dN(h);let m=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return m==="application/json"?p=yield h.json():m==="application/octet-stream"?p=yield h.blob():m==="text/event-stream"?p=h:m==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof dN||s instanceof uN?s.context:void 0}}})}}var Ss={},F_={},a1={},$p={},o1={},l1={},s$=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},zh=s$();const i$=zh.fetch,n6=zh.fetch.bind(zh),s6=zh.Headers,a$=zh.Request,o$=zh.Response,lf=Object.freeze(Object.defineProperty({__proto__:null,Headers:s6,Request:a$,Response:o$,default:n6,fetch:i$},Symbol.toStringTag,{value:"Module"})),l$=aR(lf);var c1={};Object.defineProperty(c1,"__esModule",{value:!0});let c$=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};c1.default=c$;var i6=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(l1,"__esModule",{value:!0});const u$=i6(l$),d$=i6(c1);let h$=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=u$.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=Object.assign({},this.headers),this.headers[e]=r,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,c;let u=null,d=null,h=null,f=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),b=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&b&&b.length>1&&(h=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,m="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const v=await i.text();try{u=JSON.parse(v),Array.isArray(u)&&i.status===404&&(d=[],u=null,f=200,m="OK")}catch{i.status===404&&v===""?(f=204,m="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,m="OK"),u&&this.shouldThrowOnError)throw new d$.default(u)}return{error:u,data:d,count:h,status:f,statusText:m}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,l,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,r)}returns(){return this}overrideTypes(){return this}};l1.default=h$;var f$=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(o1,"__esModule",{value:!0});const m$=f$(l1);let p$=class extends m$.default{select(e){let r=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var l;const c=[e?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};o1.default=p$;var g$=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($p,"__esModule",{value:!0});const v$=g$(o1);let x$=class extends v$.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${a}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};$p.default=x$;var y$=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(a1,"__esModule",{value:!0});const um=y$($p);let b$=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=r,this.schema=n,this.fetch=s}select(e,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new um.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new um.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const a="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new um.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new um.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new um.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};a1.default=b$;var u1={},d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.version=void 0;d1.version="0.0.0-automated";Object.defineProperty(u1,"__esModule",{value:!0});u1.DEFAULT_HEADERS=void 0;const w$=d1;u1.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${w$.version}`};var a6=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(F_,"__esModule",{value:!0});const _$=a6(a1),j$=a6($p),S$=u1;let C$=class o6{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},S$.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new _$.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o6(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:i}={}){let a;const l=new URL(`${this.url}/rpc/${e}`);let c;n||s?(a=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(a="POST",c=r);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new j$.default({method:a,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};F_.default=C$;var cf=_i&&_i.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.PostgrestError=Ss.PostgrestBuilder=Ss.PostgrestTransformBuilder=Ss.PostgrestFilterBuilder=Ss.PostgrestQueryBuilder=Ss.PostgrestClient=void 0;const l6=cf(F_);Ss.PostgrestClient=l6.default;const c6=cf(a1);Ss.PostgrestQueryBuilder=c6.default;const u6=cf($p);Ss.PostgrestFilterBuilder=u6.default;const d6=cf(o1);Ss.PostgrestTransformBuilder=d6.default;const h6=cf(l1);Ss.PostgrestBuilder=h6.default;const f6=cf(c1);Ss.PostgrestError=f6.default;var N$=Ss.default={PostgrestClient:l6.default,PostgrestQueryBuilder:c6.default,PostgrestFilterBuilder:u6.default,PostgrestTransformBuilder:d6.default,PostgrestBuilder:h6.default,PostgrestError:f6.default};const{PostgrestClient:k$,PostgrestQueryBuilder:Bne,PostgrestFilterBuilder:qne,PostgrestTransformBuilder:Une,PostgrestBuilder:Vne,PostgrestError:Wne}=N$;function E$(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const P$=E$(),A$="2.11.15",T$=`realtime-js/${A$}`,L$="1.0.0",m6=1e4,O$=1e3;var Lm;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Lm||(Lm={}));var Vn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Vn||(Vn={}));var Xi;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Xi||(Xi={}));var jw;(function(t){t.websocket="websocket"})(jw||(jw={}));var Uc;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Uc||(Uc={}));class M${constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(e.slice(a,a+s));a=a+s;const c=n.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class p6{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gr;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(gr||(gr={}));const hN=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,a)=>(i[a]=R$(a,t,e,s),i),{})},R$=(t,e,r,n)=>{const s=e.find(l=>l.name===t),i=s==null?void 0:s.type,a=r[t];return i&&!n.includes(i)?g6(i,a):Sw(a)},g6=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return z$(e,r)}switch(t){case gr.bool:return D$(e);case gr.float4:case gr.float8:case gr.int2:case gr.int4:case gr.int8:case gr.numeric:case gr.oid:return F$(e);case gr.json:case gr.jsonb:return I$(e);case gr.timestamp:return $$(e);case gr.abstime:case gr.date:case gr.daterange:case gr.int4range:case gr.int8range:case gr.money:case gr.reltime:case gr.text:case gr.time:case gr.timestamptz:case gr.timetz:case gr.tsrange:case gr.tstzrange:return Sw(e);default:return Sw(e)}},Sw=t=>t,D$=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},F$=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},I$=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},z$=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const a=t.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>g6(e,l))}return t},$$=t=>typeof t=="string"?t.replace(" ","T"):t,v6=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class b2{constructor(e,r,n={},s=m6){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var fN;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(fN||(fN={}));class Om{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Om.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=Om.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Om.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),a=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const f=d.map(b=>b.presence_ref),m=h.map(b=>b.presence_ref),p=d.filter(b=>m.indexOf(b.presence_ref)<0),v=h.filter(b=>f.indexOf(b.presence_ref)<0);p.length>0&&(l[u]=p),v.length>0&&(c[u]=v)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(m=>m.presence_ref),f=d.filter(m=>h.indexOf(m.presence_ref)<0);e[l].unshift(...f)}n(l,d,c)}),this.map(a,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,s(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var mN;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(mN||(mN={}));var pN;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(pN||(pN={}));var wo;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(wo||(wo={}));class I_{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Vn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new b2(this,Xi.join,this.params,this.timeout),this.rejoinTimer=new p6(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Xi.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Om(this),this.broadcastEndpointURL=v6(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Vn.closed){const{config:{broadcast:i,presence:a,private:l}}=this.params;this._onError(d=>e==null?void 0:e(wo.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(wo.CLOSED));const c={},u={broadcast:i,presence:a,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){e==null||e(wo.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,m=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,p=[];for(let v=0;v<m;v++){const b=f[v],{filter:{event:x,schema:w,table:_,filter:S}}=b,N=d&&d[v];if(N&&N.event===x&&N.schema===w&&N.table===_&&N.filter===S)p.push(Object.assign(Object.assign({},b),{id:N.id}));else{this.unsubscribe(),this.state=Vn.errored,e==null||e(wo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(wo.SUBSCRIBED);return}}).receive("error",d=>{this.state=Vn.errored,e==null||e(wo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(wo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Vn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Xi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new b2(this,Xi.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new b2(this,e,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Xi;if(n&&[l,c,u,d].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var p,v,b;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((b=(v=m.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===a}).map(m=>m.callback(f,n)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var p,v,b,x,w,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const S=m.id,N=(p=m.filter)===null||p===void 0?void 0:p.event;return S&&((v=r.ids)===null||v===void 0?void 0:v.includes(S))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const S=(w=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:v,table:b,commit_timestamp:x,type:w,errors:_}=p;f=Object.assign(Object.assign({},{schema:v,table:b,commit_timestamp:x,eventType:w,new:{},old:{},errors:_}),this._getPayloadRecords(p))}m.callback(f,n)})}_isClosed(){return this.state===Vn.closed}_isJoined(){return this.state===Vn.joined}_isJoining(){return this.state===Vn.joining}_isLeaving(){return this.state===Vn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&I_.isEqual(s.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Xi.close,{},e)}_onError(e){this._on(Xi.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=hN(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=hN(e.columns,e.old_record)),r}}const gN=()=>{},B$=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class q${constructor(e,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=m6,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gN,this.ref=0,this.logger=gN,this.conn=null,this.sendBuffer=[],this.serializer=new M$,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...l)=>sc(async()=>{const{default:c}=await Promise.resolve().then(()=>lf);return{default:c}},void 0).then(({default:c})=>c(...l)):a=fetch,(...l)=>a(...l)},this.endPoint=`${e}/${jw.websocket}`,this.httpEndpoint=v6(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,a)=>a(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new p6(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=P$),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:L$}))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Lm.connecting:return Uc.Connecting;case Lm.open:return Uc.Open;case Lm.closing:return Uc.Closing;default:return Uc.Closed}}isConnected(){return this.connectionState()===Uc.Open}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new I_(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let r=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:T$};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Xi.access_token,{access_token:r})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(O$,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:s,payload:i,ref:a}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(n)).forEach(l=>l._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Xi.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([B$],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class z_ extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function yn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class U$ extends z_{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Cw extends z_{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var V$=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const x6=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sc(async()=>{const{default:n}=await Promise.resolve().then(()=>lf);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},W$=()=>V$(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield sc(()=>Promise.resolve().then(()=>lf),void 0)).Response:Response}),Nw=t=>{if(Array.isArray(t))return t.map(r=>Nw(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Nw(n)}),e};var Au=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const w2=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),H$=(t,e,r)=>Au(void 0,void 0,void 0,function*(){const n=yield W$();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{e(new U$(w2(s),t.status||500))}).catch(s=>{e(new Cw(w2(s),s))}):e(new Cw(w2(t),t))}),G$=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Bp(t,e,r,n,s,i){return Au(this,void 0,void 0,function*(){return new Promise((a,l)=>{t(r,G$(e,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>H$(c,l,n))})})}function cx(t,e,r,n){return Au(this,void 0,void 0,function*(){return Bp(t,"GET",e,r,n)})}function Nl(t,e,r,n,s){return Au(this,void 0,void 0,function*(){return Bp(t,"POST",e,n,s,r)})}function Y$(t,e,r,n,s){return Au(this,void 0,void 0,function*(){return Bp(t,"PUT",e,n,s,r)})}function X$(t,e,r,n){return Au(this,void 0,void 0,function*(){return Bp(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function y6(t,e,r,n,s){return Au(this,void 0,void 0,function*(){return Bp(t,"DELETE",e,n,s,r)})}var ys=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const K$={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Q${constructor(e,r={},n,s){this.url=e,this.headers=r,this.bucketId=n,this.fetch=x6(s)}uploadOrUpdate(e,r,n,s){return ys(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},vN),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:e,body:i,headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{})),f=yield h.json();return h.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(yn(i))return{data:null,error:i};throw i}})}upload(e,r,n){return ys(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return ys(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:vN.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(c){if(yn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return ys(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Nl(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new z_("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(n){if(yn(n))return{data:null,error:n};throw n}})}update(e,r,n){return ys(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return ys(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(yn(s))return{data:null,error:s};throw s}})}copy(e,r,n){return ys(this,void 0,void 0,function*(){try{return{data:{path:(yield Nl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(yn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return ys(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Nl(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(yn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return ys(this,void 0,void 0,function*(){try{const s=yield Nl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(yn(s))return{data:null,error:s};throw s}})}download(e,r){return ys(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield cx(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(yn(l))return{data:null,error:l};throw l}})}info(e){return ys(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield cx(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Nw(n),error:null}}catch(n){if(yn(n))return{data:null,error:n};throw n}})}exists(e){return ys(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield X$(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(yn(n)&&n instanceof Cw){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return ys(this,void 0,void 0,function*(){try{return{data:yield y6(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(yn(r))return{data:null,error:r};throw r}})}list(e,r,n){return ys(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},K$),r),{prefix:e||""});return{data:yield Nl(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(yn(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const J$="2.7.1",Z$={"X-Client-Info":`storage-js/${J$}`};var fd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class eB{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},Z$),r),this.fetch=x6(n)}listBuckets(){return fd(this,void 0,void 0,function*(){try{return{data:yield cx(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(yn(e))return{data:null,error:e};throw e}})}getBucket(e){return fd(this,void 0,void 0,function*(){try{return{data:yield cx(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(yn(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return fd(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(yn(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return fd(this,void 0,void 0,function*(){try{return{data:yield Y$(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(yn(n))return{data:null,error:n};throw n}})}emptyBucket(e){return fd(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(yn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return fd(this,void 0,void 0,function*(){try{return{data:yield y6(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(yn(r))return{data:null,error:r};throw r}})}}class tB extends eB{constructor(e,r={},n){super(e,r,n)}from(e){return new Q$(this.url,this.headers,e,this.fetch)}}const rB="2.50.3";let bm="";typeof Deno<"u"?bm="deno":typeof document<"u"?bm="web":typeof navigator<"u"&&navigator.product==="ReactNative"?bm="react-native":bm="node";const nB={"X-Client-Info":`supabase-js-${bm}/${rB}`},sB={headers:nB},iB={schema:"public"},aB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oB={};var lB=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const cB=t=>{let e;return t?e=t:typeof fetch>"u"?e=n6:e=fetch,(...r)=>e(...r)},uB=()=>typeof Headers>"u"?s6:Headers,dB=(t,e,r)=>{const n=cB(r),s=uB();return(i,a)=>lB(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},a),{headers:u}))})};var hB=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};function fB(t){return t.endsWith("/")?t:t+"/"}function mB(t,e){var r,n;const{db:s,auth:i,realtime:a,global:l}=t,{db:c,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),a),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>hB(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}const b6="2.70.0",Nd=30*1e3,kw=3,_2=kw*Nd,pB="http://localhost:9999",gB="supabase.auth.token",vB={"X-Client-Info":`gotrue-js/${b6}`},Ew="X-Supabase-Api-Version",w6={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yB=6e5;class $_ extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ct(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class bB extends $_{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function wB(t){return Ct(t)&&t.name==="AuthApiError"}class _6 extends $_{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class bc extends $_{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class _l extends bc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _B(t){return Ct(t)&&t.name==="AuthSessionMissingError"}class u0 extends bc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class d0 extends bc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class h0 extends bc{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jB(t){return Ct(t)&&t.name==="AuthImplicitGrantRedirectError"}class xN extends bc{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pw extends bc{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function j2(t){return Ct(t)&&t.name==="AuthRetryableFetchError"}class yN extends bc{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Mm extends bc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ux="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),bN=` 	
\r=`.split(""),SB=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<bN.length;e+=1)t[bN[e].charCodeAt(0)]=-2;for(let e=0;e<ux.length;e+=1)t[ux[e].charCodeAt(0)]=e;return t})();function wN(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ux[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(ux[n]),e.queuedBits-=6}}function j6(t,e,r){const n=SB[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function _N(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{kB(a,n,r)};for(let a=0;a<t.length;a+=1)j6(t.charCodeAt(a),s,i);return e.join("")}function CB(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function NB(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}CB(n,e)}}function kB(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function EB(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)j6(t.charCodeAt(s),r,n);return new Uint8Array(e)}function PB(t){const e=[];return NB(t,r=>e.push(r)),new Uint8Array(e)}function AB(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>wN(s,r,n)),wN(null,r,n),e.join("")}function TB(t){return Math.round(Date.now()/1e3)+t}function LB(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const qi=()=>typeof window<"u"&&typeof document<"u",Fc={tested:!1,writable:!1},Rm=()=>{if(!qi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fc.tested)return Fc.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Fc.tested=!0,Fc.writable=!0}catch{Fc.tested=!0,Fc.writable=!1}return Fc.writable};function OB(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const S6=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>sc(async()=>{const{default:n}=await Promise.resolve().then(()=>lf);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},MB=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",C6=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},f0=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},m0=async(t,e)=>{await t.removeItem(e)};class h1{constructor(){this.promise=new h1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}h1.promiseConstructor=Promise;function S2(t){const e=t.split(".");if(e.length!==3)throw new Mm("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!xB.test(e[n]))throw new Mm("JWT not in base64url format");return{header:JSON.parse(_N(e[0])),payload:JSON.parse(_N(e[1])),signature:EB(e[2]),raw:{header:e[0],payload:e[1]}}}async function RB(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function DB(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function FB(t){return("0"+t.toString(16)).substr(-2)}function IB(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,FB).join("")}async function zB(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function $B(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await zB(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function md(t,e,r=!1){const n=IB();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await C6(t,`${e}-code-verifier`,s);const i=await $B(n);return[i,n===i?"plain":"s256"]}const BB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function qB(t){const e=t.headers.get(Ew);if(!e||!e.match(BB))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function UB(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function VB(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const WB=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function pd(t){if(!WB.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var HB=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const $c=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),GB=[502,503,504];async function jN(t){var e;if(!MB(t))throw new Pw($c(t),0);if(GB.includes(t.status))throw new Pw($c(t),t.status);let r;try{r=await t.json()}catch(i){throw new _6($c(i),i)}let n;const s=qB(t);if(s&&s.getTime()>=w6["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new yN($c(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new _l}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new yN($c(r),t.status,r.weak_password.reasons);throw new bB($c(r),t.status||500,n)}const YB=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ot(t,e,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Ew]||(i[Ew]=w6["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await XB(t,e,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function XB(t,e,r,n,s,i){const a=YB(e,n,s,i);let l;try{l=await t(r,Object.assign({},a))}catch(c){throw console.error(c),new Pw($c(c),0)}if(l.ok||await jN(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await jN(c)}}function xo(t){var e;let r=null;ZB(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=TB(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function SN(t){const e=xo(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Pl(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function KB(t){return{data:t,error:null}}function QB(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,a=HB(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function JB(t){return t}function ZB(t){return t.access_token&&t.refresh_token&&t.expires_in}const C2=["global","local","others"];var eq=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class tq{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=S6(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=C2[0]){if(C2.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${C2.join(", ")}`);try{return await Ot(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ct(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Ot(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Pl})}catch(n){if(Ct(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=eq(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Ot(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:QB,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ct(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Ot(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Pl})}catch(r){if(Ct(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Ot(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:JB});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(p=>{const v=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(p.split(";")[1].split("=")[1]);u[`${b}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ct(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){pd(e);try{return await Ot(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Pl})}catch(r){if(Ct(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){pd(e);try{return await Ot(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Pl})}catch(n){if(Ct(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){pd(e);try{return await Ot(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Pl})}catch(n){if(Ct(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){pd(e.userId);try{const{data:r,error:n}=await Ot(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Ct(r))return{data:null,error:r};throw r}}async _deleteFactor(e){pd(e.userId),pd(e.id);try{return{data:await Ot(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Ct(r))return{data:null,error:r};throw r}}}const rq={getItem:t=>Rm()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Rm()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Rm()&&globalThis.localStorage.removeItem(t)}};function CN(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function nq(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const gd={debug:!!(globalThis&&Rm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class N6 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class sq extends N6{}async function iq(t,e,r){gd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),gd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){gd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{gd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw gd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new sq(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(gd.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}nq();const aq={url:pB,storageKey:gB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function NN(t,e,r){return await r()}class dp{constructor(e){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dp.nextInstanceID,dp.nextInstanceID+=1,this.instanceID>0&&qi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},aq),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new tq({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=S6(s.fetch),this.lock=s.lock||NN,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:qi()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=iq:this.lock=NN,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Rm()?this.storage=rq:(this.memoryStorage={},this.storage=CN(this.memoryStorage)):(this.memoryStorage={},this.storage=CN(this.memoryStorage)),qi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${b6}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=OB(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),qi()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),jB(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ct(r)?{error:r}:{error:new _6("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:xo}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await md(this.storage,this.storageKey)),i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:p},xform:xo})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:xo})}else throw new d0("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:a,options:l}=e;r=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:SN})}else if("phone"in e){const{phone:i,password:a,options:l}=e;r=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:SN})}else throw new d0("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new u0}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Ct(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,i,a,l,c,u,d,h,f,m;let p,v;if("message"in e)p=e.message,v=e.signature;else{const{chain:b,wallet:x,statement:w,options:_}=e;let S;if(qi())if(typeof x=="object")S=x;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))S=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=x}const N=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const E=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),w?{statement:w}:null));let P;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")P=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)P=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)p=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),v=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${N.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(d=_==null?void 0:_.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const E=await S.signMessage(new TextEncoder().encode(p),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=E}}try{const{data:b,error:x}=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:AB(v)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:xo});if(x)throw x;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new u0}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:x})}catch(b){if(Ct(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(e){const r=await f0(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:xo});if(await m0(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new u0}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=e,l=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:xo}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new u0}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Ct(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,a;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await md(this.storage,this.storageKey));const{error:h}=await Ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await Ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new d0("You must provide either an email or phone number.")}catch(l){if(Ct(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await Ot(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:xo});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Ct(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await md(this.storage,this.storageKey)),await Ot(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:KB})}catch(i){if(Ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new _l;const{error:s}=await Ot(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Ct(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:a}=await Ot(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:a,error:l}=await Ot(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new d0("You must provide either an email or phone number and a type")}catch(r){if(Ct(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await f0(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<_2:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Pl}):await this._useSession(async r=>{var n,s,i;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _l}:await Ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Pl})})}catch(r){if(Ct(r))return _B(r)&&(await this._removeSession(),await m0(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new _l;const a=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await md(this.storage,this.storageKey));const{data:u,error:d}=await Ot(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Pl});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Ct(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new _l;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=S2(e.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ct(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:l}=r;if(l)throw l;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new _l;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ct(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!qi())throw new h0("No browser detected.");if(e.error||e.error_description||e.error_code)throw new h0(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new h0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xN("No code detected.");const{data:w,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!a||!u)throw new h0("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const m=f-d;m*1e3<=Nd&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const p=f-h;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,d);const{data:v,error:b}=await this._getUser(i);if(b)throw b;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(n){if(Ct(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await f0(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(wB(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await m0(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=LB(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await md(this.storage,this.storageKey,!0));try{return await Ot(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(Ct(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ot(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return qi()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ct(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Ot(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ct(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await DB(async s=>(s>0&&await RB(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ot(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:xo})),(s,i)=>{const a=200*Math.pow(2,s);return i&&j2(i)&&Date.now()+a-n<Nd})}catch(n){if(this._debug(r,"error",n),Ct(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),qi()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await f0(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<_2;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${_2}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),j2(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new _l;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new h1;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new _l;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Ct(i)){const a={session:null,error:i};return j2(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await C6(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await m0(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Nd);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Nd);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Nd}ms, refresh threshold is ${kw} ticks`),s<=kw&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof N6)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await md(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ot(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ct(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await Ot(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Ct(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:l}=await Ot(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(r){if(Ct(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Ot(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ct(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=S2(s.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n||(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+yB>Date.now()))return n;const{data:s,error:i}=await Ot(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Mm("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(a=>a.kid===e),!n)throw new Mm("No matching signing key found in JWKS");return n}async getClaims(e,r={keys:[]}){try{let n=e;if(!n){const{data:m,error:p}=await this.getSession();if(p||!m.session)return{data:null,error:p};n=m.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:c}}=S2(n);if(UB(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:s,signature:a},error:null}}const u=VB(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,a,PB(`${l}.${c}`)))throw new Mm("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Ct(n))return{data:null,error:n};throw n}}}dp.nextInstanceID=0;const oq=dp;class lq extends oq{constructor(e){super(e)}}var cq=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(d){try{u(n.next(d))}catch(h){a(h)}}function c(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class uq{constructor(e,r,n){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=fB(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:iB,realtime:oB,auth:Object.assign(Object.assign({},aB),{storageKey:u}),global:sB},h=mB(n??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=dB(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new k$(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new n$(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new tB(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return cq(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:a,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lq({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,flowType:a,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new q$(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dq=(t,e,r)=>new uq(t,e,r),hq="https://jiasafdbfqqhhdazoybu.supabase.co",fq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImppYXNhZmRiZnFxaGhkYXpveWJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5MTQ5MTAsImV4cCI6MjA2NTQ5MDkxMH0.TXPwCkGAZRrn83pTsZHr2QFZwX03nBWdNPJN0s_jLKQ",ae=dq(hq,fq,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),k6=y.createContext(void 0),mq=({children:t})=>{const[e,r]=y.useState(null),[n,s]=y.useState(null),[i,a]=y.useState(!0),{data:l}=Nt({queryKey:["profile",e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id))return null;const{data:d,error:h}=await ae.from("profiles").select("*").eq("id",e.id).single();return h?(console.error("Error fetching profile:",h),null):d},enabled:!!(e!=null&&e.id)});y.useEffect(()=>{const{data:{subscription:d}}=ae.auth.onAuthStateChange((h,f)=>{console.log("Auth state changed:",h,f),s(f),r((f==null?void 0:f.user)??null),a(!1)});return ae.auth.getSession().then(({data:{session:h}})=>{s(h),r((h==null?void 0:h.user)??null),a(!1)}),()=>d.unsubscribe()},[]);const c=async()=>{try{a(!0);const d=[];for(let m=0;m<localStorage.length;m++){const p=localStorage.key(m);p&&(p.startsWith("supabase.auth.")||p.includes("sb-")||p.startsWith("sb:"))&&d.push(p)}d.forEach(m=>localStorage.removeItem(m));for(let m=0;m<sessionStorage.length;m++){const p=sessionStorage.key(m);p&&(p.startsWith("supabase.auth.")||p.includes("sb-")||p.startsWith("sb:"))&&sessionStorage.removeItem(p)}const h=ae.auth.signOut({scope:"global"}),f=new Promise((m,p)=>setTimeout(()=>p(new Error("Sign out timeout")),5e3));await Promise.race([h,f]),r(null),s(null),window.location.reload()}catch(d){console.error("Erreur lors de la déconnexion:",d),r(null),s(null),localStorage.clear(),sessionStorage.clear(),window.location.reload()}finally{a(!1)}},u=c;return o.jsx(k6.Provider,{value:{user:e,session:n,profile:l,loading:i,signOut:c,logout:u},children:t})},st=()=>{const t=y.useContext(k6);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},pq=()=>{const t=br();return Vt({mutationFn:async({formationId:e,userId:r,planType:n="free"})=>{console.log("Creating enrollment request for:",{formationId:e,userId:r,planType:n});const{data:s,error:i}=await ae.from("enrollment_requests").select("id, status").eq("user_id",r).eq("formation_id",e).maybeSingle();if(i)throw console.error("Error checking existing enrollment:",i),i;if(s){if(s.status==="approved")throw new Error("Vous êtes déjà inscrit à cette formation");if(s.status==="pending")throw new Error("Votre demande d'inscription est en cours de traitement")}const{data:a}=await ae.from("user_subscriptions").select("id, plan_type").eq("user_id",r).eq("formation_id",e).maybeSingle();if(!a){const{error:u}=await ae.from("user_subscriptions").insert({user_id:r,formation_id:e,plan_type:n});if(u)throw console.error("Subscription creation error:",u),new Error("Erreur lors de la création de l'abonnement")}const{data:l,error:c}=await ae.from("enrollment_requests").insert({user_id:r,formation_id:e,status:"pending",plan_type:n}).select().single();if(c)throw console.error("Enrollment request error:",c),c;return console.log("Enrollment request created:",l),l},onSuccess:()=>{t.invalidateQueries({queryKey:["enrollment-requests"]}),t.invalidateQueries({queryKey:["students-by-formation"]}),t.invalidateQueries({queryKey:["notifications"]}),me.success("Demande d'inscription envoyée avec succès !")},onError:e=>{console.error("Erreur lors de l'inscription:",e),me.error(e.message||"Erreur lors de l'inscription. Veuillez réessayer.")}})},gq=()=>{const t=br();return Vt({mutationFn:async({formationId:e,planType:r,justification:n})=>{const{data:{user:s}}=await ae.auth.getUser();if(!s)throw new Error("Non authentifié");const{data:i}=await ae.from("profiles").select("first_name, last_name, phone").eq("id",s.id).single(),{data:a}=await ae.from("formations").select("title").eq("id",e).single(),l=i?`${i.first_name||""} ${i.last_name||""}`.trim():"Un élève",c=(a==null?void 0:a.title)||"une formation",u=(i==null?void 0:i.phone)||"Non renseigné",{data:d}=await ae.from("notifications").select("id").eq("user_id",s.id).eq("formation_id",e).eq("type","plan_change_request").eq("is_read",!1).maybeSingle();if(d){const{error:h}=await ae.from("notifications").update({requested_plan_type:r,message:`${l} a demandé à passer au plan "${r}" pour la formation "${c}".${n?`

Justification : ${n}`:""}

Téléphone : ${u}`,updated_at:new Date().toISOString()}).eq("id",d.id);if(h)throw h;return{updated:!0}}else{const{data:h,error:f}=await ae.from("notifications").insert({user_id:s.id,formation_id:e,type:"plan_change_request",title:"Demande de changement de plan",message:`${l} a demandé à passer au plan "${r}" pour la formation "${c}".${n?`

Justification : ${n}`:""}

Téléphone : ${u}`,requested_plan_type:r,is_for_all_admins:!0,is_read:!1}).select().single();if(f)throw f;return h}},onSuccess:()=>{t.invalidateQueries({queryKey:["notifications"]}),me.success("Demande de changement de plan envoyée avec succès !")},onError:e=>{console.error("Erreur lors de la demande de changement:",e),me.error("Erreur lors de l'envoi de la demande. Veuillez réessayer.")}})},E6=()=>{const t=pq(),[e,r]=y.useState(new Set),n=y.useCallback(async(i,a,l="free")=>{if(e.has(i)){console.log("Inscription déjà en cours pour la formation:",i);return}console.log("Starting enrollment process for:",{formationId:i,userId:a,planType:l}),r(c=>new Set(c).add(i));try{return await t.mutateAsync({formationId:i,userId:a,planType:l})}finally{r(c=>{const u=new Set(c);return u.delete(i),u})}},[t,e]),s=y.useCallback(i=>e.has(i),[e]);return{enroll:n,isFormationPending:s,isPending:t.isPending,isSuccess:t.isSuccess,error:t.error}},B_=t=>{const e=br(),{data:r,isLoading:n,error:s}=Nt({queryKey:["formation-pricing",t],queryFn:async()=>{if(!t)return[];const{data:d,error:h}=await ae.from("formation_pricing_options").select("*").eq("formation_id",t).order("plan_type");if(h)throw console.error("Error fetching pricing options:",h),h;return d},enabled:!!t}),i=Vt({mutationFn:async d=>{console.log("Saving pricing options:",d);const{error:h}=await ae.from("formation_pricing_options").delete().eq("formation_id",t);if(h)throw console.error("Delete error:",h),h;const f=d.map(v=>{const b={formation_id:t,plan_type:v.plan_type,price_monthly:v.price_monthly??null,price_yearly:v.price_yearly??null,allow_discussion:v.allow_discussion,allow_exercises:v.allow_exercises,allow_calls:v.allow_calls,call_type:v.call_type||"none",allowed_call_days:v.allowed_call_days||[],allowed_response_days:v.allowed_response_days||[],message_limit_per_day:v.message_limit_per_day??null,time_limit_minutes_per_day:v.time_limit_minutes_per_day??null,time_limit_minutes_per_week:v.time_limit_minutes_per_week??null,lesson_access:v.lesson_access||[],is_active:v.is_active};return console.log("Prepared insert data:",b),b});console.log("Data to insert:",f);const{data:m,error:p}=await ae.from("formation_pricing_options").insert(f).select();if(p)throw console.error("Insert error:",p),p;return console.log("Successfully inserted:",m),m},onSuccess:()=>{e.invalidateQueries({queryKey:["formation-pricing",t]}),me.success("Options de tarification sauvegardées avec succès")},onError:d=>{console.error("Error saving pricing options:",d),me.error("Erreur lors de la sauvegarde des options de tarification")}}),a=async d=>{try{return"free"}catch(h){return console.error("Error getting user plan:",h),"free"}},l=(d,h)=>{const f=r==null?void 0:r.find(m=>m.plan_type===d&&m.is_active);if(!f)return!1;switch(h){case"discussion":return f.allow_discussion;case"exercises":return f.allow_exercises;case"calls":return f.allow_calls;default:return!1}},c=d=>{const h=r==null?void 0:r.find(f=>f.plan_type===d&&f.is_active);return h?{messageLimit:h.message_limit_per_day,timeLimit:{daily:h.time_limit_minutes_per_day,weekly:h.time_limit_minutes_per_week},allowedCallDays:h.allowed_call_days,allowedResponseDays:h.allowed_response_days,accessibleLessons:h.lesson_access,callType:h.call_type}:null},u=d=>{switch(d){case"discussion":return"Discuter avec les profs";case"exercises":return"Exercices";case"calls":return"Appels";default:return d}};return{pricingOptions:r,isLoading:n,error:s,savePricingOptions:i.mutate,isSaving:i.isPending,getUserPlan:a,checkUserAccess:l,getUserLimits:c,getFeatureDisplayText:u}},q_=t=>{const{user:e}=st(),r=br(),{data:n,isLoading:s}=Nt({queryKey:["user-subscription",e==null?void 0:e.id,t],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return null;const{data:a,error:l}=await ae.from("user_subscriptions").select("*").eq("user_id",e.id).eq("formation_id",t).maybeSingle();return l?(console.error("Error fetching user subscription:",l),null):a},enabled:!!(e!=null&&e.id)&&!!t}),i=Vt({mutationFn:async({planType:a})=>{if(!(e!=null&&e.id))throw new Error("User not authenticated");const{data:l}=await ae.from("user_subscriptions").select("id").eq("user_id",e.id).eq("formation_id",t).maybeSingle();if(l){const{data:c,error:u}=await ae.from("user_subscriptions").update({plan_type:a}).eq("user_id",e.id).eq("formation_id",t).select().single();if(u)throw u;return c}else{const{data:c,error:u}=await ae.from("user_subscriptions").insert({user_id:e.id,formation_id:t,plan_type:a}).select().single();if(u)throw u;return c}},onSuccess:()=>{r.invalidateQueries({queryKey:["user-subscription"]}),r.invalidateQueries({queryKey:["formation-pricing"]}),r.invalidateQueries({queryKey:["subscription-limits"]}),me.success("Abonnement mis à jour avec succès")},onError:a=>{console.error("Error creating/updating subscription:",a),me.error("Erreur lors de la mise à jour de l'abonnement")}});return{subscription:n,isLoading:s,createSubscription:i.mutate,isCreating:i.isPending}};function ct(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function vq(t,e){const r=y.createContext(e),n=i=>{const{children:a,...l}=i,c=y.useMemo(()=>l,Object.values(l));return o.jsx(r.Provider,{value:c,children:a})};n.displayName=t+"Provider";function s(i){const a=y.useContext(r);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[n,s]}function Ko(t,e=[]){let r=[];function n(i,a){const l=y.createContext(a),c=r.length;r=[...r,a];const u=h=>{var x;const{scope:f,children:m,...p}=h,v=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,b=y.useMemo(()=>p,Object.values(p));return o.jsx(v.Provider,{value:b,children:m})};u.displayName=i+"Provider";function d(h,f){var v;const m=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,p=y.useContext(m);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=r.map(a=>y.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[n,xq(s,...e)]}function xq(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}var jn=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},yq=Lp.useId||(()=>{}),bq=0;function Ql(t){const[e,r]=y.useState(yq());return jn(()=>{r(n=>n??String(bq++))},[t]),e?`radix-${e}`:""}function An(t){const e=y.useRef(t);return y.useEffect(()=>{e.current=t}),y.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function ic({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,s]=wq({defaultProp:e,onChange:r}),i=t!==void 0,a=i?t:n,l=An(r),c=y.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[a,c]}function wq({defaultProp:t,onChange:e}){const r=y.useState(t),[n]=r,s=y.useRef(n),i=An(e);return y.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}var _q=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],vt=_q.reduce((t,e)=>{const r=y.forwardRef((n,s)=>{const{asChild:i,...a}=n,l=i?ei:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(l,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function jq(t,e){t&&Qh.flushSync(()=>t.dispatchEvent(e))}function Sq(t,e=globalThis==null?void 0:globalThis.document){const r=An(t);y.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var Cq="DismissableLayer",Aw="dismissableLayer.update",Nq="dismissableLayer.pointerDownOutside",kq="dismissableLayer.focusOutside",kN,P6=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qp=y.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...c}=t,u=y.useContext(P6),[d,h]=y.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=y.useState({}),p=Lt(e,P=>h(P)),v=Array.from(u.layers),[b]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=v.indexOf(b),w=d?v.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=x,N=Aq(P=>{const A=P.target,F=[...u.branches].some(Y=>Y.contains(A));!S||F||(s==null||s(P),a==null||a(P),P.defaultPrevented||l==null||l())},f),E=Tq(P=>{const A=P.target;[...u.branches].some(Y=>Y.contains(A))||(i==null||i(P),a==null||a(P),P.defaultPrevented||l==null||l())},f);return Sq(P=>{w===u.layers.size-1&&(n==null||n(P),!P.defaultPrevented&&l&&(P.preventDefault(),l()))},f),y.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(kN=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),EN(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=kN)}},[d,f,r,u]),y.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),EN())},[d,u]),y.useEffect(()=>{const P=()=>m({});return document.addEventListener(Aw,P),()=>document.removeEventListener(Aw,P)},[]),o.jsx(vt.div,{...c,ref:p,style:{pointerEvents:_?S?"auto":"none":void 0,...t.style},onFocusCapture:ct(t.onFocusCapture,E.onFocusCapture),onBlurCapture:ct(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:ct(t.onPointerDownCapture,N.onPointerDownCapture)})});qp.displayName=Cq;var Eq="DismissableLayerBranch",Pq=y.forwardRef((t,e)=>{const r=y.useContext(P6),n=y.useRef(null),s=Lt(e,n);return y.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),o.jsx(vt.div,{...t,ref:s})});Pq.displayName=Eq;function Aq(t,e=globalThis==null?void 0:globalThis.document){const r=An(t),n=y.useRef(!1),s=y.useRef(()=>{});return y.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){A6(Nq,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);n.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function Tq(t,e=globalThis==null?void 0:globalThis.document){const r=An(t),n=y.useRef(!1);return y.useEffect(()=>{const s=i=>{i.target&&!n.current&&A6(kq,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function EN(){const t=new CustomEvent(Aw);document.dispatchEvent(t)}function A6(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?jq(s,i):s.dispatchEvent(i)}var N2="focusScope.autoFocusOnMount",k2="focusScope.autoFocusOnUnmount",PN={bubbles:!1,cancelable:!0},Lq="FocusScope",f1=y.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=t,[l,c]=y.useState(null),u=An(s),d=An(i),h=y.useRef(null),f=Lt(e,v=>c(v)),m=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(n){let v=function(_){if(m.paused||!l)return;const S=_.target;l.contains(S)?h.current=S:jl(h.current,{select:!0})},b=function(_){if(m.paused||!l)return;const S=_.relatedTarget;S!==null&&(l.contains(S)||jl(h.current,{select:!0}))},x=function(_){if(document.activeElement===document.body)for(const N of _)N.removedNodes.length>0&&jl(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",b);const w=new MutationObserver(x);return l&&w.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",b),w.disconnect()}}},[n,l,m.paused]),y.useEffect(()=>{if(l){TN.add(m);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(N2,PN);l.addEventListener(N2,u),l.dispatchEvent(x),x.defaultPrevented||(Oq(Iq(T6(l)),{select:!0}),document.activeElement===v&&jl(l))}return()=>{l.removeEventListener(N2,u),setTimeout(()=>{const x=new CustomEvent(k2,PN);l.addEventListener(k2,d),l.dispatchEvent(x),x.defaultPrevented||jl(v??document.body,{select:!0}),l.removeEventListener(k2,d),TN.remove(m)},0)}}},[l,u,d,m]);const p=y.useCallback(v=>{if(!r&&!n||m.paused)return;const b=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(b&&x){const w=v.currentTarget,[_,S]=Mq(w);_&&S?!v.shiftKey&&x===S?(v.preventDefault(),r&&jl(_,{select:!0})):v.shiftKey&&x===_&&(v.preventDefault(),r&&jl(S,{select:!0})):x===w&&v.preventDefault()}},[r,n,m.paused]);return o.jsx(vt.div,{tabIndex:-1,...a,ref:f,onKeyDown:p})});f1.displayName=Lq;function Oq(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(jl(n,{select:e}),document.activeElement!==r)return}function Mq(t){const e=T6(t),r=AN(e,t),n=AN(e.reverse(),t);return[r,n]}function T6(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function AN(t,e){for(const r of t)if(!Rq(r,{upTo:e}))return r}function Rq(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Dq(t){return t instanceof HTMLInputElement&&"select"in t}function jl(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Dq(t)&&e&&t.select()}}var TN=Fq();function Fq(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=LN(t,e),t.unshift(e)},remove(e){var r;t=LN(t,e),(r=t[0])==null||r.resume()}}}function LN(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function Iq(t){return t.filter(e=>e.tagName!=="A")}var zq="Portal",m1=y.forwardRef((t,e)=>{var l;const{container:r,...n}=t,[s,i]=y.useState(!1);jn(()=>i(!0),[]);const a=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return a?QE.createPortal(o.jsx(vt.div,{...n,ref:e}),a):null});m1.displayName=zq;function $q(t,e){return y.useReducer((r,n)=>e[r][n]??r,t)}var ki=t=>{const{present:e,children:r}=t,n=Bq(e),s=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),i=Lt(n.ref,qq(s));return typeof r=="function"||n.isPresent?y.cloneElement(s,{ref:i}):null};ki.displayName="Presence";function Bq(t){const[e,r]=y.useState(),n=y.useRef({}),s=y.useRef(t),i=y.useRef("none"),a=t?"mounted":"unmounted",[l,c]=$q(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=p0(n.current);i.current=l==="mounted"?u:"none"},[l]),jn(()=>{const u=n.current,d=s.current;if(d!==t){const f=i.current,m=p0(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),jn(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const v=p0(n.current).includes(m.animationName);if(m.target===e&&v&&(c("ANIMATION_END"),!s.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},f=m=>{m.target===e&&(i.current=p0(n.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function p0(t){return(t==null?void 0:t.animationName)||"none"}function qq(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var E2=0;function U_(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??ON()),document.body.insertAdjacentElement("beforeend",t[1]??ON()),E2++,()=>{E2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),E2--}},[])}function ON(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Da=function(){return Da=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Da.apply(this,arguments)};function L6(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Uq(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var pv="right-scroll-bar-position",gv="width-before-scroll-bar",Vq="with-scroll-bars-hidden",Wq="--removed-body-scroll-bar-size";function P2(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Hq(t,e){var r=y.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var Gq=typeof window<"u"?y.useLayoutEffect:y.useEffect,MN=new WeakMap;function Yq(t,e){var r=Hq(null,function(n){return t.forEach(function(s){return P2(s,n)})});return Gq(function(){var n=MN.get(r);if(n){var s=new Set(n),i=new Set(t),a=r.current;s.forEach(function(l){i.has(l)||P2(l,null)}),i.forEach(function(l){s.has(l)||P2(l,a)})}MN.set(r,t)},[t]),r}function Xq(t){return t}function Kq(t,e){e===void 0&&(e=Xq);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var a=e(i,n);return r.push(a),function(){r=r.filter(function(l){return l!==a})}},assignSyncMedium:function(i){for(n=!0;r.length;){var a=r;r=[],a.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var a=[];if(r.length){var l=r;r=[],l.forEach(i),a=r}var c=function(){var d=a;a=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){a.push(d),u()},filter:function(d){return a=a.filter(d),r}}}};return s}function Qq(t){t===void 0&&(t={});var e=Kq(null);return e.options=Da({async:!0,ssr:!1},t),e}var O6=function(t){var e=t.sideCar,r=L6(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return y.createElement(n,Da({},r))};O6.isSideCarExport=!0;function Jq(t,e){return t.useMedium(e),O6}var M6=Qq(),A2=function(){},p1=y.forwardRef(function(t,e){var r=y.useRef(null),n=y.useState({onScrollCapture:A2,onWheelCapture:A2,onTouchMoveCapture:A2}),s=n[0],i=n[1],a=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,p=t.inert,v=t.allowPinchZoom,b=t.as,x=b===void 0?"div":b,w=t.gapMode,_=L6(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=f,N=Yq([r,e]),E=Da(Da({},_),s);return y.createElement(y.Fragment,null,d&&y.createElement(S,{sideCar:M6,removeScrollBar:u,shards:h,noIsolation:m,inert:p,setCallbacks:i,allowPinchZoom:!!v,lockRef:r,gapMode:w}),a?y.cloneElement(y.Children.only(l),Da(Da({},E),{ref:N})):y.createElement(x,Da({},E,{className:c,ref:N}),l))});p1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};p1.classNames={fullWidth:gv,zeroRight:pv};var Zq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function eU(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Zq();return e&&t.setAttribute("nonce",e),t}function tU(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function rU(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var nU=function(){var t=0,e=null;return{add:function(r){t==0&&(e=eU())&&(tU(e,r),rU(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},sU=function(){var t=nU();return function(e,r){y.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},R6=function(){var t=sU(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},iU={left:0,top:0,right:0,gap:0},T2=function(t){return parseInt(t||"",10)||0},aU=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[T2(r),T2(n),T2(s)]},oU=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return iU;var e=aU(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},lU=R6(),ih="data-scroll-locked",cU=function(t,e,r,n){var s=t.left,i=t.top,a=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(Vq,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(ih,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(pv,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(gv,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(pv," .").concat(pv,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(gv," .").concat(gv,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ih,`] {
    `).concat(Wq,": ").concat(l,`px;
  }
`)},RN=function(){var t=parseInt(document.body.getAttribute(ih)||"0",10);return isFinite(t)?t:0},uU=function(){y.useEffect(function(){return document.body.setAttribute(ih,(RN()+1).toString()),function(){var t=RN()-1;t<=0?document.body.removeAttribute(ih):document.body.setAttribute(ih,t.toString())}},[])},dU=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;uU();var i=y.useMemo(function(){return oU(s)},[s]);return y.createElement(lU,{styles:cU(i,!e,s,r?"":"!important")})},Tw=!1;if(typeof window<"u")try{var g0=Object.defineProperty({},"passive",{get:function(){return Tw=!0,!0}});window.addEventListener("test",g0,g0),window.removeEventListener("test",g0,g0)}catch{Tw=!1}var vd=Tw?{passive:!1}:!1,hU=function(t){return t.tagName==="TEXTAREA"},D6=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!hU(t)&&r[e]==="visible")},fU=function(t){return D6(t,"overflowY")},mU=function(t){return D6(t,"overflowX")},DN=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=F6(t,n);if(s){var i=I6(t,n),a=i[1],l=i[2];if(a>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},pU=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},gU=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},F6=function(t,e){return t==="v"?fU(e):mU(e)},I6=function(t,e){return t==="v"?pU(e):gU(e)},vU=function(t,e){return t==="h"&&e==="rtl"?-1:1},xU=function(t,e,r,n,s){var i=vU(t,window.getComputedStyle(e).direction),a=i*n,l=r.target,c=e.contains(l),u=!1,d=a>0,h=0,f=0;do{var m=I6(t,l),p=m[0],v=m[1],b=m[2],x=v-b-i*p;(p||x)&&F6(t,l)&&(h+=x,f+=p),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(Math.abs(h)<1||!s)||!d&&(Math.abs(f)<1||!s))&&(u=!0),u},v0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},FN=function(t){return[t.deltaX,t.deltaY]},IN=function(t){return t&&"current"in t?t.current:t},yU=function(t,e){return t[0]===e[0]&&t[1]===e[1]},bU=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},wU=0,xd=[];function _U(t){var e=y.useRef([]),r=y.useRef([0,0]),n=y.useRef(),s=y.useState(wU++)[0],i=y.useState(R6)[0],a=y.useRef(t);y.useEffect(function(){a.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var v=Uq([t.lockRef.current],(t.shards||[]).map(IN),!0).filter(Boolean);return v.forEach(function(b){return b.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=y.useCallback(function(v,b){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!a.current.allowPinchZoom;var x=v0(v),w=r.current,_="deltaX"in v?v.deltaX:w[0]-x[0],S="deltaY"in v?v.deltaY:w[1]-x[1],N,E=v.target,P=Math.abs(_)>Math.abs(S)?"h":"v";if("touches"in v&&P==="h"&&E.type==="range")return!1;var A=DN(P,E);if(!A)return!0;if(A?N=P:(N=P==="v"?"h":"v",A=DN(P,E)),!A)return!1;if(!n.current&&"changedTouches"in v&&(_||S)&&(n.current=N),!N)return!0;var F=n.current||N;return xU(F,b,v,F==="h"?_:S,!0)},[]),c=y.useCallback(function(v){var b=v;if(!(!xd.length||xd[xd.length-1]!==i)){var x="deltaY"in b?FN(b):v0(b),w=e.current.filter(function(N){return N.name===b.type&&(N.target===b.target||b.target===N.shadowParent)&&yU(N.delta,x)})[0];if(w&&w.should){b.cancelable&&b.preventDefault();return}if(!w){var _=(a.current.shards||[]).map(IN).filter(Boolean).filter(function(N){return N.contains(b.target)}),S=_.length>0?l(b,_[0]):!a.current.noIsolation;S&&b.cancelable&&b.preventDefault()}}},[]),u=y.useCallback(function(v,b,x,w){var _={name:v,delta:b,target:x,should:w,shadowParent:jU(x)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(S){return S!==_})},1)},[]),d=y.useCallback(function(v){r.current=v0(v),n.current=void 0},[]),h=y.useCallback(function(v){u(v.type,FN(v),v.target,l(v,t.lockRef.current))},[]),f=y.useCallback(function(v){u(v.type,v0(v),v.target,l(v,t.lockRef.current))},[]);y.useEffect(function(){return xd.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,vd),document.addEventListener("touchmove",c,vd),document.addEventListener("touchstart",d,vd),function(){xd=xd.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,vd),document.removeEventListener("touchmove",c,vd),document.removeEventListener("touchstart",d,vd)}},[]);var m=t.removeScrollBar,p=t.inert;return y.createElement(y.Fragment,null,p?y.createElement(i,{styles:bU(s)}):null,m?y.createElement(dU,{gapMode:t.gapMode}):null)}function jU(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const SU=Jq(M6,_U);var g1=y.forwardRef(function(t,e){return y.createElement(p1,Da({},t,{ref:e,sideCar:SU}))});g1.classNames=p1.classNames;var CU=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},yd=new WeakMap,x0=new WeakMap,y0={},L2=0,z6=function(t){return t&&(t.host||z6(t.parentNode))},NU=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=z6(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},kU=function(t,e,r,n){var s=NU(e,Array.isArray(t)?t:[t]);y0[r]||(y0[r]=new WeakMap);var i=y0[r],a=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(n),p=m!==null&&m!=="false",v=(yd.get(f)||0)+1,b=(i.get(f)||0)+1;yd.set(f,v),i.set(f,b),a.push(f),v===1&&p&&x0.set(f,!0),b===1&&f.setAttribute(r,"true"),p||f.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",f,x)}})};return d(e),l.clear(),L2++,function(){a.forEach(function(h){var f=yd.get(h)-1,m=i.get(h)-1;yd.set(h,f),i.set(h,m),f||(x0.has(h)||h.removeAttribute(n),x0.delete(h)),m||h.removeAttribute(r)}),L2--,L2||(yd=new WeakMap,yd=new WeakMap,x0=new WeakMap,y0={})}},V_=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=CU(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),kU(n,s,r,"aria-hidden")):function(){return null}},W_="Dialog",[$6,Hne]=Ko(W_),[EU,ga]=$6(W_),B6=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!0}=t,l=y.useRef(null),c=y.useRef(null),[u=!1,d]=ic({prop:n,defaultProp:s,onChange:i});return o.jsx(EU,{scope:e,triggerRef:l,contentRef:c,contentId:Ql(),titleId:Ql(),descriptionId:Ql(),open:u,onOpenChange:d,onOpenToggle:y.useCallback(()=>d(h=>!h),[d]),modal:a,children:r})};B6.displayName=W_;var q6="DialogTrigger",U6=y.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=ga(q6,r),i=Lt(e,s.triggerRef);return o.jsx(vt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Y_(s.open),...n,ref:i,onClick:ct(t.onClick,s.onOpenToggle)})});U6.displayName=q6;var H_="DialogPortal",[PU,V6]=$6(H_,{forceMount:void 0}),W6=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:s}=t,i=ga(H_,e);return o.jsx(PU,{scope:e,forceMount:r,children:y.Children.map(n,a=>o.jsx(ki,{present:r||i.open,children:o.jsx(m1,{asChild:!0,container:s,children:a})}))})};W6.displayName=H_;var dx="DialogOverlay",H6=y.forwardRef((t,e)=>{const r=V6(dx,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=ga(dx,t.__scopeDialog);return i.modal?o.jsx(ki,{present:n||i.open,children:o.jsx(AU,{...s,ref:e})}):null});H6.displayName=dx;var AU=y.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=ga(dx,r);return o.jsx(g1,{as:ei,allowPinchZoom:!0,shards:[s.contentRef],children:o.jsx(vt.div,{"data-state":Y_(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),_u="DialogContent",G6=y.forwardRef((t,e)=>{const r=V6(_u,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=ga(_u,t.__scopeDialog);return o.jsx(ki,{present:n||i.open,children:i.modal?o.jsx(TU,{...s,ref:e}):o.jsx(LU,{...s,ref:e})})});G6.displayName=_u;var TU=y.forwardRef((t,e)=>{const r=ga(_u,t.__scopeDialog),n=y.useRef(null),s=Lt(e,r.contentRef,n);return y.useEffect(()=>{const i=n.current;if(i)return V_(i)},[]),o.jsx(Y6,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ct(t.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ct(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&i.preventDefault()}),onFocusOutside:ct(t.onFocusOutside,i=>i.preventDefault())})}),LU=y.forwardRef((t,e)=>{const r=ga(_u,t.__scopeDialog),n=y.useRef(!1),s=y.useRef(!1);return o.jsx(Y6,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=t.onCloseAutoFocus)==null||a.call(t,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Y6=y.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=t,l=ga(_u,r),c=y.useRef(null),u=Lt(e,c);return U_(),o.jsxs(o.Fragment,{children:[o.jsx(f1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(qp,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Y_(l.open),...a,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(OU,{titleId:l.titleId}),o.jsx(RU,{contentRef:c,descriptionId:l.descriptionId})]})]})}),G_="DialogTitle",X6=y.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=ga(G_,r);return o.jsx(vt.h2,{id:s.titleId,...n,ref:e})});X6.displayName=G_;var K6="DialogDescription",Q6=y.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=ga(K6,r);return o.jsx(vt.p,{id:s.descriptionId,...n,ref:e})});Q6.displayName=K6;var J6="DialogClose",Z6=y.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=ga(J6,r);return o.jsx(vt.button,{type:"button",...n,ref:e,onClick:ct(t.onClick,()=>s.onOpenChange(!1))})});Z6.displayName=J6;function Y_(t){return t?"open":"closed"}var eA="DialogTitleWarning",[Gne,tA]=vq(eA,{contentName:_u,titleName:G_,docsSlug:"dialog"}),OU=({titleId:t})=>{const e=tA(eA),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},MU="DialogDescriptionWarning",RU=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${tA(MU).contentName}}.`;return y.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},rA=B6,DU=U6,nA=W6,v1=H6,x1=G6,y1=X6,b1=Q6,sA=Z6;const Br=rA,Tu=DU,FU=nA,iA=y.forwardRef(({className:t,...e},r)=>o.jsx(v1,{ref:r,className:Be("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));iA.displayName=v1.displayName;const Or=y.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(FU,{children:[o.jsx(iA,{}),o.jsxs(x1,{ref:n,className:Be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,o.jsxs(sA,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsx(qr,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Or.displayName=x1.displayName;const hn=({className:t,...e})=>o.jsx("div",{className:Be("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});hn.displayName="DialogHeader";const aA=({className:t,...e})=>o.jsx("div",{className:Be("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});aA.displayName="DialogFooter";const fn=y.forwardRef(({className:t,...e},r)=>o.jsx(y1,{ref:r,className:Be("text-lg font-semibold leading-none tracking-tight",t),...e}));fn.displayName=y1.displayName;const oA=y.forwardRef(({className:t,...e},r)=>o.jsx(b1,{ref:r,className:Be("text-sm text-muted-foreground",t),...e}));oA.displayName=b1.displayName;const jr=y.forwardRef(({className:t,...e},r)=>o.jsx("textarea",{className:Be("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));jr.displayName="Textarea";var IU="Label",lA=y.forwardRef((t,e)=>o.jsx(vt.label,{...t,ref:e,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));lA.displayName=IU;var cA=lA;const zU=af("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ke=y.forwardRef(({className:t,...e},r)=>o.jsx(cA,{ref:r,className:Be(zU(),t),...e}));Ke.displayName=cA.displayName;const $U=({isOpen:t,onClose:e,onConfirm:r,currentPlan:n,newPlan:s,isLoading:i=!1})=>{const[a,l]=y.useState(""),c=h=>{switch(h){case"free":return"Gratuit";case"standard":return"Standard";case"premium":return"Premium";default:return h}},u=()=>{r(a.trim()||void 0),l("")},d=()=>{l(""),e()};return o.jsx(Br,{open:t,onOpenChange:d,children:o.jsxs(Or,{className:"sm:max-w-md",children:[o.jsx(hn,{children:o.jsxs(fn,{children:["Souhaitez-vous demander un changement de plan vers ",c(s)," ?"]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[o.jsxs("p",{children:["Plan actuel : ",o.jsx("span",{className:"font-medium",children:c(n)})]}),o.jsxs("p",{children:["Nouveau plan : ",o.jsx("span",{className:"font-medium",children:c(s)})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{htmlFor:"justification",children:"Justification (optionnelle)"}),o.jsx(jr,{id:"justification",value:a,onChange:h=>l(h.target.value),placeholder:"Expliquez pourquoi vous souhaitez changer de plan...",rows:3})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(J,{variant:"outline",onClick:d,disabled:i,children:"Annuler"}),o.jsx(J,{onClick:u,disabled:i,children:i?"Envoi...":"Envoyer la demande"})]})]})]})})},uA=({formationId:t,className:e})=>{const{pricingOptions:r,isLoading:n}=B_(t),{user:s}=st(),{subscription:i,createSubscription:a,isCreating:l}=q_(t),{enroll:c,isFormationPending:u}=E6(),d=gq(),[h,f]=y.useState({isOpen:!1,newPlan:""});if(n)return o.jsx("div",{className:`bg-gradient-to-br from-background via-background to-muted/20 rounded-xl p-6 ${e}`,children:o.jsxs("div",{className:"animate-pulse space-y-4",children:[o.jsx("div",{className:"h-8 bg-muted rounded w-2/3"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(E=>o.jsx("div",{className:"h-64 bg-muted rounded-lg"},E))})]})});if(!r||r.length===0)return o.jsxs("div",{className:`bg-gradient-to-br from-background via-background to-muted/20 rounded-xl p-6 text-center ${e}`,children:[o.jsx(rN,{size:48,className:"mx-auto mb-4 text-muted-foreground"}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Options de tarification"}),o.jsx("p",{className:"text-muted-foreground",children:"Les options de tarification seront bientôt disponibles."})]});const m=r.filter(E=>E.is_active).sort((E,P)=>{const A={free:0,standard:1,premium:2};return(A[E.plan_type]||999)-(A[P.plan_type]||999)}),p=E=>{switch(E){case"free":return o.jsx(Iz,{className:"w-6 h-6 text-green-500"});case"standard":return o.jsx(yc,{className:"w-6 h-6 text-blue-500"});case"premium":return o.jsx(ix,{className:"w-6 h-6 text-purple-500"});default:return o.jsx(rN,{className:"w-6 h-6"})}},v=E=>{switch(E){case"free":return"border-green-200 bg-green-50 hover:shadow-green-100";case"standard":return"border-blue-200 bg-blue-50 hover:shadow-blue-100 transform hover:scale-105";case"premium":return"border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50 hover:shadow-purple-100 transform hover:scale-105 ring-2 ring-purple-200";default:return"border-border bg-background"}},b=E=>{switch(E){case"free":return"bg-green-500 hover:bg-green-600 text-white";case"standard":return"bg-blue-500 hover:bg-blue-600 text-white";case"premium":return"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white";default:return"bg-primary hover:bg-primary/90 text-primary-foreground"}},x=async E=>{if(!s||l||u(t))return;const P=i==null?void 0:i.plan_type,A=E.plan_type;if(P&&P!==A){f({isOpen:!0,newPlan:A});return}try{await c(t,s.id,E.plan_type)}catch(F){console.error("Error during subscription:",F)}},w=async E=>{if(!(!s||!i))try{await d.mutateAsync({formationId:t,planType:h.newPlan,justification:E}),f({isOpen:!1,newPlan:""})}catch(P){console.error("Error during plan change:",P)}},_=E=>{if(!s)return"Connectez-vous";if(l||u(t))return"Inscription...";const A=i==null?void 0:i.plan_type;return A===E.plan_type?"Plan actuel":A&&A!==E.plan_type?"Changer de plan":"S'inscrire"},S=E=>{if(!s)return!1;const P=l||u(t),A=(i==null?void 0:i.plan_type)===E.plan_type;return P||A},N=[{key:"discussions",label:"Discussions",icon:Zs},{key:"exercises",label:"Exercices",icon:os},{key:"calls",label:"Appels vidéo",icon:sf}];return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`bg-gradient-to-br from-background via-background to-muted/20 rounded-xl p-6 ${e}`,id:"pricing",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h2",{className:"text-3xl font-bold mb-2 bg-gradient-to-r from-primary to-purple-600 bg-clip-text text-transparent",children:"Choisissez votre formule"}),o.jsx("p",{className:"text-muted-foreground",children:"Sélectionnez l'offre qui correspond le mieux à vos besoins"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:m.map(E=>{const P=(i==null?void 0:i.plan_type)===E.plan_type;return o.jsxs("div",{className:`relative rounded-xl border-2 p-6 transition-all duration-300 hover:shadow-lg ${v(E.plan_type)}`,children:[E.plan_type==="premium"&&o.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:o.jsx(yr,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-3 py-1",children:"Populaire"})}),P&&o.jsx("div",{className:"absolute -top-3 right-4",children:o.jsx(yr,{className:"bg-green-500 text-white px-3 py-1",children:"Actuel"})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"flex justify-center mb-3",children:p(E.plan_type)}),o.jsx("h3",{className:"text-xl font-bold mb-2 capitalize",children:E.plan_type==="free"?"Gratuit":E.plan_type==="standard"?"Standard":"Premium"}),o.jsxs("div",{className:"mb-4",children:[E.price_monthly!==null&&E.price_monthly!==void 0?o.jsxs("div",{children:[o.jsxs("span",{className:"text-3xl font-bold",children:[E.price_monthly,"€"]}),o.jsx("span",{className:"text-muted-foreground",children:"/mois"})]}):o.jsx("div",{children:o.jsx("span",{className:"text-3xl font-bold text-green-600",children:"Gratuit"})}),E.price_yearly&&o.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["ou ",E.price_yearly,"€/an"]})]})]}),o.jsxs("div",{className:"space-y-3 mb-6",children:[N.map(A=>{const F=A.key==="discussions"?E.allow_discussion:A.key==="exercises"?E.allow_exercises:A.key==="calls"?E.allow_calls:!1;return o.jsxs("div",{className:"flex items-center space-x-3",children:[F?o.jsx(vc,{className:"w-5 h-5 text-green-500 flex-shrink-0"}):o.jsx(Dh,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(A.icon,{className:"w-4 h-4 text-muted-foreground"}),o.jsx("span",{className:F?"text-foreground":"text-muted-foreground line-through",children:A.label})]})]},A.key)}),E.message_limit_per_day&&o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-muted-foreground",children:[o.jsx(Zs,{className:"w-4 h-4"}),o.jsxs("span",{children:[E.message_limit_per_day," messages/jour"]})]}),E.time_limit_minutes_per_day&&o.jsxs("div",{className:"flex items-center space-x-3 text-sm text-muted-foreground",children:[o.jsx(Js,{className:"w-4 h-4"}),o.jsxs("span",{children:[E.time_limit_minutes_per_day,"min/jour"]})]})]}),o.jsx(J,{onClick:()=>x(E),disabled:S(E),className:`w-full py-3 font-semibold transition-all duration-200 ${b(E.plan_type)} ${P?"opacity-75 cursor-not-allowed":""}`,children:_(E)}),E.allowed_call_days&&E.allowed_call_days.length>0&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[o.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Jours d'appels :"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:E.allowed_call_days.map(A=>o.jsx(yr,{variant:"outline",className:"text-xs",children:A},A))})]})]},E.id)})})]}),o.jsx($U,{isOpen:h.isOpen,onClose:()=>f({isOpen:!1,newPlan:""}),onConfirm:w,currentPlan:(i==null?void 0:i.plan_type)||"",newPlan:h.newPlan,isLoading:d.isPending})]})},BU=()=>{var d,h,f;const{formationId:t}=n1(),e=Mn(),{user:r}=st(),{enroll:n,isFormationPending:s}=E6(),{data:i,isLoading:a}=Nt({queryKey:["formation-detail",t],queryFn:async()=>{if(!t)throw new Error("Formation ID is required");const{data:m,error:p}=await ae.from("formations").select(`
          *,
          profiles:author_id (
            first_name,
            last_name,
            username
          ),
          levels (
            id,
            title,
            description,
            order_index,
            lessons (
              id,
              title,
              description,
              duration,
              order_index
            )
          )
        `).eq("id",t).single();if(p)throw p;return m},enabled:!!t}),l=async()=>{if(!r){me.error("Veuillez vous connecter pour vous inscrire"),e("/auth");return}if(t){if(s(t)){me.error("Inscription déjà en cours...");return}try{await n(t,r.id)}catch(m){console.error("Enrollment failed:",m)}}},c=m=>{if(!m)return"Auteur inconnu";const p=m.first_name||"",v=m.last_name||"";return`${p} ${v}`.trim()||m.username||"Auteur inconnu"},u=((d=i==null?void 0:i.levels)==null?void 0:d.reduce((m,p)=>{var v;return m+(((v=p.lessons)==null?void 0:v.length)||0)},0))||0;return a?o.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-edu-primary mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Chargement de la formation..."})]})}):i?o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{className:"bg-white border-b sticky top-0 md:top-16 z-40",children:o.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>e("/shop"),className:"text-gray-600 hover:text-gray-900",children:o.jsx(Za,{size:20})}),o.jsx("h1",{className:"text-xl font-semibold text-gray-900 truncate",children:"Détails de la formation"})]})})}),o.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6 space-y-8",children:[o.jsxs(Mt,{className:"overflow-hidden",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"h-64 bg-gradient-to-br from-edu-primary/10 to-edu-secondary/10 flex items-center justify-center",children:i.image_url||i.thumbnail_url?o.jsx("img",{src:i.image_url||i.thumbnail_url,alt:i.title,className:"w-full h-full object-cover"}):o.jsx("span",{className:"text-gray-400",children:"Image de formation"})}),i.badge&&o.jsx(yr,{className:"absolute top-4 right-4 bg-edu-primary text-white",children:i.badge})]}),o.jsx(Rt,{className:"p-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:i.title}),o.jsxs("p",{className:"text-gray-600",children:["Par ",c(i.profiles)]})]}),i.description&&o.jsx("p",{className:"text-gray-700 leading-relaxed",children:i.description}),o.jsxs("div",{className:"flex flex-wrap items-center gap-6 pt-4 border-t",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"flex items-center",children:[...Array(5)].map((m,p)=>o.jsx(yc,{size:16,className:`${p<Math.floor(i.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},p))}),o.jsx("span",{className:"font-medium",children:i.rating||0}),o.jsxs("span",{className:"text-gray-500",children:["(",i.students_count||0,")"]})]}),o.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[o.jsx(pa,{size:16}),o.jsxs("span",{children:[i.students_count||0," étudiants"]})]}),o.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[o.jsx($o,{size:16}),o.jsxs("span",{children:[u," leçons"]})]}),i.duration&&o.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[o.jsx(Js,{size:16}),o.jsxs("span",{children:[i.duration,"h"]})]})]})]})})]}),o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center space-x-2",children:[o.jsx($o,{size:20}),o.jsx("span",{children:"Contenu de la formation"})]})}),o.jsx(Rt,{className:"space-y-4",children:(h=i.levels)==null?void 0:h.sort((m,p)=>m.order_index-p.order_index).map(m=>o.jsxs("div",{className:"border rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold text-lg mb-2",children:m.title}),m.description&&o.jsx("p",{className:"text-gray-600 mb-3",children:m.description}),m.lessons&&m.lessons.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[m.lessons.length," leçon(s)"]}),o.jsxs("div",{className:"space-y-1",children:[m.lessons.sort((p,v)=>p.order_index-v.order_index).slice(0,3).map(p=>o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[o.jsx("div",{className:"w-1.5 h-1.5 bg-edu-primary rounded-full"}),o.jsx("span",{children:p.title}),p.duration&&o.jsxs("span",{className:"text-gray-400",children:["(",p.duration,")"]})]},p.id)),m.lessons.length>3&&o.jsxs("p",{className:"text-sm text-gray-500 italic",children:["... et ",m.lessons.length-3," autres leçons"]})]})]})]},m.id))})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Plans d'abonnement"}),o.jsx("p",{className:"text-gray-600",children:"Choisissez l'offre qui correspond à vos besoins"})]}),o.jsx(uA,{formationId:t||""})]}),o.jsx("div",{className:"flex justify-center",children:o.jsx(Mt,{className:"w-full max-w-md",children:o.jsxs(Rt,{className:"p-6 text-center space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Inscription rapide"}),o.jsx(J,{className:"w-full bg-edu-primary hover:bg-edu-primary/90",onClick:l,disabled:!r||s(t||""),size:"lg",children:r?s(t||"")?"Inscription en cours...":"S'inscrire maintenant (Plan Gratuit)":"Connectez-vous pour vous inscrire"}),!r&&o.jsx("p",{className:"text-xs text-gray-500",children:"Vous devez être connecté pour vous inscrire à cette formation"}),o.jsxs("div",{className:"pt-4 border-t space-y-2 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Niveaux:"}),o.jsx("span",{className:"font-medium",children:((f=i.levels)==null?void 0:f.length)||0})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Leçons:"}),o.jsx("span",{className:"font-medium",children:u})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Étudiants:"}),o.jsx("span",{className:"font-medium",children:i.students_count||0})]}),i.duration&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Durée:"}),o.jsxs("span",{className:"font-medium",children:[i.duration,"h"]})]})]})]})})})]})]}):o.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Formation non trouvée"}),o.jsx(J,{onClick:()=>e("/shop"),children:"Retour au shop"})]})})},qU=()=>{const{profileId:t}=n1();return o.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:o.jsxs("div",{className:"p-4",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profil"}),o.jsxs("p",{className:"text-gray-600",children:["Profile ID: ",t]}),o.jsx("p",{className:"text-gray-500 mt-4",children:"Page en cours de développement..."})]})})},X_=({onScrollToVideo:t,onScrollToMessages:e,className:r=""})=>{const[n,s]=y.useState(!1),[i,a]=y.useState(0),[l,c]=y.useState(!1),u=y.useRef(null),d=y.useRef(0),h=y.useRef(0),f=S=>{s(!0),c(!0),d.current=S,h.current=i},m=S=>{if(!n)return;const N=S-d.current,E=Math.max(-40,Math.min(40,h.current+N));a(E)},p=()=>{n&&(s(!1),i<-20?t():i>20&&e(),a(0),setTimeout(()=>c(!1),1e3))},v=S=>{f(S.touches[0].clientY)},b=S=>{m(S.touches[0].clientY)},x=()=>{p()},w=S=>{f(S.clientY)};y.useEffect(()=>{if(!n)return;const S=E=>{m(E.clientY)},N=()=>{p()};return document.addEventListener("mousemove",S),document.addEventListener("mouseup",N),()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",N)}},[n,i]);const _=()=>{l||(c(!0),setTimeout(()=>c(!1),2e3))};return o.jsxs("div",{className:`fixed right-4 top-1/2 transform -translate-y-1/2 z-30 flex items-center justify-center ${r}`,children:[o.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center transition-opacity duration-300 ${l?"opacity-100":"opacity-0 pointer-events-none"}`,children:[o.jsx("button",{onClick:t,className:"absolute -top-12 bg-blue-500 text-white p-2 rounded-full shadow-lg hover:bg-blue-600 transition-colors z-10",children:o.jsx(Xo,{size:16})}),o.jsx("button",{onClick:e,className:"absolute -bottom-12 bg-green-500 text-white p-2 rounded-full shadow-lg hover:bg-green-600 transition-colors z-10",children:o.jsx(Zs,{size:16})})]}),o.jsxs("div",{ref:u,className:`
          w-12 h-6 bg-gray-300 rounded-full cursor-pointer shadow-md
          flex items-center justify-center relative overflow-hidden
          transition-all duration-300 ease-out
          ${n?"scale-110 shadow-lg":"hover:shadow-lg"}
          ${i<-10?"bg-blue-400":i>10?"bg-green-400":"bg-gray-300"}
        `,style:{transform:`translateY(${i}px)`},onMouseDown:w,onTouchStart:v,onTouchMove:b,onTouchEnd:x,onClick:_,children:[o.jsx("div",{className:`
          w-4 h-1 bg-white rounded-full transition-all duration-200
          ${i<-10?"transform -translate-y-1":i>10?"transform translate-y-1":""}
        `}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"w-6 h-3 flex flex-col justify-between opacity-40",children:[o.jsx("div",{className:"w-full h-0.5 bg-gray-600 rounded"}),o.jsx("div",{className:"w-full h-0.5 bg-gray-600 rounded"}),o.jsx("div",{className:"w-full h-0.5 bg-gray-600 rounded"})]})})]}),n&&o.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2",children:o.jsx("div",{className:`
            px-2 py-1 rounded text-xs font-medium transition-all duration-200
            ${i<-20?"bg-blue-500 text-white":i>20?"bg-green-500 text-white":"bg-gray-500 text-white"}
          `,children:i<-20?"🎥 Vidéo":i>20?"💬 Messages":"Glisser"})})]})},UU=()=>{const{lessonId:t}=n1(),e=y.useRef(null),r=y.useRef(null),n=()=>{var i;(i=e.current)==null||i.scrollIntoView({behavior:"smooth",block:"start"})},s=()=>{var i;(i=r.current)==null||i.scrollIntoView({behavior:"smooth",block:"end"})};return o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{ref:e,className:"bg-black",children:o.jsx("div",{className:"aspect-video flex items-center justify-center text-white",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-6xl mb-4",children:"🎥"}),o.jsx("h2",{className:"text-xl font-semibold",children:"Vidéo de la leçon"}),o.jsxs("p",{className:"text-gray-300 mt-2",children:["Lesson ID: ",t]})]})})}),o.jsx("div",{className:"relative -mt-3 -mb-3 z-20 flex justify-center",children:o.jsx(X_,{onScrollToVideo:n,onScrollToMessages:s})}),o.jsxs("div",{ref:r,className:"p-4 min-h-[400px]",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Discussion"}),o.jsx("div",{className:"space-y-4",children:Array.from({length:10},(i,a)=>o.jsx("div",{className:`flex ${a%2===0?"justify-start":"justify-end"}`,children:o.jsxs("div",{className:`
                max-w-xs px-4 py-2 rounded-lg
                ${a%2===0?"bg-white text-gray-800 border":"bg-[#25d366] text-white"}
              `,children:[o.jsxs("p",{children:["Message ",a+1," - Contenu du message de discussion"]}),o.jsxs("span",{className:"text-xs opacity-70",children:["12:3",a]})]})},a))}),o.jsx("div",{className:"flex justify-end mt-4",children:o.jsxs("div",{className:"max-w-xs px-4 py-2 rounded-lg bg-[#25d366] text-white",children:[o.jsx("p",{children:"💬 Dernier message du chat"}),o.jsx("span",{className:"text-xs opacity-70",children:"12:45"})]})})]})]})},Ye=y.forwardRef(({className:t,type:e,...r},n)=>o.jsx("input",{type:e,className:Be("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...r}));Ye.displayName="Input";const VU=1,WU=1e6;let O2=0;function HU(){return O2=(O2+1)%Number.MAX_SAFE_INTEGER,O2.toString()}const M2=new Map,zN=t=>{if(M2.has(t))return;const e=setTimeout(()=>{M2.delete(t),Dm({type:"REMOVE_TOAST",toastId:t})},WU);M2.set(t,e)},GU=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,VU)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?zN(r):t.toasts.forEach(n=>{zN(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},vv=[];let xv={toasts:[]};function Dm(t){xv=GU(xv,t),vv.forEach(e=>{e(xv)})}function YU({...t}){const e=HU(),r=s=>Dm({type:"UPDATE_TOAST",toast:{...s,id:e}}),n=()=>Dm({type:"DISMISS_TOAST",toastId:e});return Dm({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||n()}}}),{id:e,dismiss:n,update:r}}function dA(){const[t,e]=y.useState(xv);return y.useEffect(()=>(vv.push(e),()=>{const r=vv.indexOf(e);r>-1&&vv.splice(r,1)}),[t]),{...t,toast:YU,dismiss:r=>Dm({type:"DISMISS_TOAST",toastId:r})}}const XU=()=>{const[t,e]=y.useState(!0),[r,n]=y.useState(!1),[s,i]=y.useState(""),[a,l]=y.useState(""),[c,u]=y.useState(""),[d,h]=y.useState(""),[f,m]=y.useState(!1),p=Mn(),{toast:v}=dA();y.useEffect(()=>{(async()=>{const{data:{session:S}}=await ae.auth.getSession();S!=null&&S.user&&p("/cours")})();const{data:{subscription:_}}=ae.auth.onAuthStateChange((S,N)=>{S==="SIGNED_IN"&&(N!=null&&N.user)&&b(N.user.id)});return()=>_.unsubscribe()},[p]);const b=async w=>{try{const{data:_}=await ae.from("profiles").select("profile_completed").eq("id",w).single();_!=null&&_.profile_completed?p("/cours"):p("/complete-profile")}catch(_){console.error("Erreur lors de la vérification du profil:",_),p("/complete-profile")}},x=async w=>{w.preventDefault(),m(!0);try{if(t){const{data:_,error:S}=await ae.auth.signInWithPassword({email:s,password:a});if(S)throw S;_.user&&await b(_.user.id)}else{const{data:_,error:S}=await ae.auth.signUp({email:s,password:a,options:{emailRedirectTo:`${window.location.origin}/`,data:{first_name:c,last_name:d}}});if(S)throw S;_.user&&v({title:"Compte créé avec succès !",description:"Veuillez vérifier votre email pour confirmer votre compte."})}}catch(_){v({title:"Erreur",description:_.message||"Une erreur est survenue",variant:"destructive"})}finally{m(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#25d366]/10 to-[#20c75a]/10 flex items-center justify-center p-4",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[o.jsxs("div",{className:"bg-[#25d366] text-white p-6 text-center",children:[o.jsx("h1",{className:"text-2xl font-bold mb-2",children:"EducTok"}),o.jsx("p",{className:"text-white/80",children:t?"Connectez-vous à votre compte":"Créez votre compte"})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("form",{onSubmit:x,className:"space-y-4",children:[!t&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",children:[o.jsx(Ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),o.jsx(Ye,{type:"text",placeholder:"Prénom",value:c,onChange:w=>u(w.target.value),className:"pl-10",required:!0})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),o.jsx(Ye,{type:"text",placeholder:"Nom",value:d,onChange:w=>h(w.target.value),className:"pl-10",required:!0})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Vz,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),o.jsx(Ye,{type:"email",placeholder:"Email",value:s,onChange:w=>i(w.target.value),className:"pl-10",required:!0})]}),o.jsxs("div",{className:"relative",children:[o.jsx(IP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),o.jsx(Ye,{type:r?"text":"password",placeholder:"Mot de passe",value:a,onChange:w=>l(w.target.value),className:"pl-10 pr-10",required:!0}),o.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:r?o.jsx(N_,{size:20}):o.jsx(Ga,{size:20})})]}),o.jsx(J,{type:"submit",className:"w-full bg-[#25d366] hover:bg-[#20c75a] text-white",disabled:f,children:f?"Chargement...":t?"Se connecter":"Créer un compte"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>e(!t),className:"text-[#25d366] hover:underline",children:t?"Pas encore de compte ? Créez-en un":"Déjà un compte ? Connectez-vous"})})]})]}),o.jsx("div",{className:"mt-4 text-center",children:o.jsxs("button",{onClick:()=>p("/"),className:"flex items-center justify-center mx-auto text-gray-600 hover:text-gray-800",children:[o.jsx(Za,{size:16,className:"mr-1"}),"Retour à l'accueil"]})})]})})},R2=768;function hA(){const[t,e]=y.useState(void 0);return y.useEffect(()=>{const r=window.matchMedia(`(max-width: ${R2-1}px)`),n=()=>{e(window.innerWidth<R2)};return r.addEventListener("change",n),e(window.innerWidth<R2),()=>r.removeEventListener("change",n)},[]),!!t}var KU="Separator",$N="horizontal",QU=["horizontal","vertical"],fA=y.forwardRef((t,e)=>{const{decorative:r,orientation:n=$N,...s}=t,i=JU(n)?n:$N,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return o.jsx(vt.div,{"data-orientation":i,...l,...s,ref:e})});fA.displayName=KU;function JU(t){return QU.includes(t)}var mA=fA;const Qc=y.forwardRef(({className:t,orientation:e="horizontal",decorative:r=!0,...n},s)=>o.jsx(mA,{ref:s,decorative:r,orientation:e,className:Be("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Qc.displayName=mA.displayName;const ZU=rA,eV=nA,pA=y.forwardRef(({className:t,...e},r)=>o.jsx(v1,{className:Be("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:r}));pA.displayName=v1.displayName;const tV=af("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),gA=y.forwardRef(({side:t="right",className:e,children:r,...n},s)=>o.jsxs(eV,{children:[o.jsx(pA,{}),o.jsxs(x1,{ref:s,className:Be(tV({side:t}),e),...n,children:[r,o.jsxs(sA,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[o.jsx(qr,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));gA.displayName=x1.displayName;const rV=y.forwardRef(({className:t,...e},r)=>o.jsx(y1,{ref:r,className:Be("text-lg font-semibold text-foreground",t),...e}));rV.displayName=y1.displayName;const nV=y.forwardRef(({className:t,...e},r)=>o.jsx(b1,{ref:r,className:Be("text-sm text-muted-foreground",t),...e}));nV.displayName=b1.displayName;function BN({className:t,...e}){return o.jsx("div",{className:Be("animate-pulse rounded-md bg-muted",t),...e})}const sV=["top","right","bottom","left"],ac=Math.min,Ws=Math.max,hx=Math.round,b0=Math.floor,oc=t=>({x:t,y:t}),iV={left:"right",right:"left",bottom:"top",top:"bottom"},aV={start:"end",end:"start"};function Lw(t,e,r){return Ws(t,ac(e,r))}function Bo(t,e){return typeof t=="function"?t(e):t}function qo(t){return t.split("-")[0]}function uf(t){return t.split("-")[1]}function K_(t){return t==="x"?"y":"x"}function Q_(t){return t==="y"?"height":"width"}function lc(t){return["top","bottom"].includes(qo(t))?"y":"x"}function J_(t){return K_(lc(t))}function oV(t,e,r){r===void 0&&(r=!1);const n=uf(t),s=J_(t),i=Q_(s);let a=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=fx(a)),[a,fx(a)]}function lV(t){const e=fx(t);return[Ow(t),e,Ow(e)]}function Ow(t){return t.replace(/start|end/g,e=>aV[e])}function cV(t,e,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?i:a;default:return[]}}function uV(t,e,r,n){const s=uf(t);let i=cV(qo(t),r==="start",n);return s&&(i=i.map(a=>a+"-"+s),e&&(i=i.concat(i.map(Ow)))),i}function fx(t){return t.replace(/left|right|bottom|top/g,e=>iV[e])}function dV(t){return{top:0,right:0,bottom:0,left:0,...t}}function vA(t){return typeof t!="number"?dV(t):{top:t,right:t,bottom:t,left:t}}function mx(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function qN(t,e,r){let{reference:n,floating:s}=t;const i=lc(e),a=J_(e),l=Q_(a),c=qo(e),u=i==="y",d=n.x+n.width/2-s.width/2,h=n.y+n.height/2-s.height/2,f=n[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:n.y-s.height};break;case"bottom":m={x:d,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:h};break;case"left":m={x:n.x-s.width,y:h};break;default:m={x:n.x,y:n.y}}switch(uf(e)){case"start":m[a]-=f*(r&&u?-1:1);break;case"end":m[a]+=f*(r&&u?-1:1);break}return m}const hV=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:a}=r,l=i.filter(Boolean),c=await(a.isRTL==null?void 0:a.isRTL(e));let u=await a.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=qN(u,n,c),f=n,m={},p=0;for(let v=0;v<l.length;v++){const{name:b,fn:x}=l[v],{x:w,y:_,data:S,reset:N}=await x({x:d,y:h,initialPlacement:n,placement:f,strategy:s,middlewareData:m,rects:u,platform:a,elements:{reference:t,floating:e}});d=w??d,h=_??h,m={...m,[b]:{...m[b],...S}},N&&p<=50&&(p++,typeof N=="object"&&(N.placement&&(f=N.placement),N.rects&&(u=N.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:s}):N.rects),{x:d,y:h}=qN(u,f,c)),v=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function hp(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:a,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=Bo(e,t),p=vA(m),b=l[f?h==="floating"?"reference":"floating":h],x=mx(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(b)))==null||r?b:b.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),w=h==="floating"?{x:n,y:s,width:a.floating.width,height:a.floating.height}:a.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),S=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},N=mx(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:_,strategy:c}):w);return{top:(x.top-N.top+p.top)/S.y,bottom:(N.bottom-x.bottom+p.bottom)/S.y,left:(x.left-N.left+p.left)/S.x,right:(N.right-x.right+p.right)/S.x}}const fV=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:a,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=Bo(t,e)||{};if(u==null)return{};const h=vA(d),f={x:r,y:n},m=J_(s),p=Q_(m),v=await a.getDimensions(u),b=m==="y",x=b?"top":"left",w=b?"bottom":"right",_=b?"clientHeight":"clientWidth",S=i.reference[p]+i.reference[m]-f[m]-i.floating[p],N=f[m]-i.reference[m],E=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let P=E?E[_]:0;(!P||!await(a.isElement==null?void 0:a.isElement(E)))&&(P=l.floating[_]||i.floating[p]);const A=S/2-N/2,F=P/2-v[p]/2-1,Y=ac(h[x],F),T=ac(h[w],F),O=Y,U=P-v[p]-T,q=P/2-v[p]/2+A,Z=Lw(O,q,U),H=!c.arrow&&uf(s)!=null&&q!==Z&&i.reference[p]/2-(q<O?Y:T)-v[p]/2<0,Q=H?q<O?q-O:q-U:0;return{[m]:f[m]+Q,data:{[m]:Z,centerOffset:q-Z-Q,...H&&{alignmentOffset:Q}},reset:H}}}),mV=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:a,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:v=!0,...b}=Bo(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=qo(s),w=lc(l),_=qo(l)===l,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),N=f||(_||!v?[fx(l)]:lV(l)),E=p!=="none";!f&&E&&N.push(...uV(l,v,p,S));const P=[l,...N],A=await hp(e,b),F=[];let Y=((n=i.flip)==null?void 0:n.overflows)||[];if(d&&F.push(A[x]),h){const q=oV(s,a,S);F.push(A[q[0]],A[q[1]])}if(Y=[...Y,{placement:s,overflows:F}],!F.every(q=>q<=0)){var T,O;const q=(((T=i.flip)==null?void 0:T.index)||0)+1,Z=P[q];if(Z)return{data:{index:q,overflows:Y},reset:{placement:Z}};let H=(O=Y.filter(Q=>Q.overflows[0]<=0).sort((Q,R)=>Q.overflows[1]-R.overflows[1])[0])==null?void 0:O.placement;if(!H)switch(m){case"bestFit":{var U;const Q=(U=Y.filter(R=>{if(E){const B=lc(R.placement);return B===w||B==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(B=>B>0).reduce((B,X)=>B+X,0)]).sort((R,B)=>R[1]-B[1])[0])==null?void 0:U[0];Q&&(H=Q);break}case"initialPlacement":H=l;break}if(s!==H)return{reset:{placement:H}}}return{}}}};function UN(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function VN(t){return sV.some(e=>t[e]>=0)}const pV=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=Bo(t,e);switch(n){case"referenceHidden":{const i=await hp(e,{...s,elementContext:"reference"}),a=UN(i,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:VN(a)}}}case"escaped":{const i=await hp(e,{...s,altBoundary:!0}),a=UN(i,r.floating);return{data:{escapedOffsets:a,escaped:VN(a)}}}default:return{}}}}};async function gV(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),a=qo(r),l=uf(r),c=lc(r)==="y",u=["left","top"].includes(a)?-1:1,d=i&&c?-1:1,h=Bo(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof p=="number"&&(m=l==="end"?p*-1:p),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const vV=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:a,middlewareData:l}=e,c=await gV(e,t);return a===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:a}}}}},xV=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:l={fn:b=>{let{x,y:w}=b;return{x,y:w}}},...c}=Bo(t,e),u={x:r,y:n},d=await hp(e,c),h=lc(qo(s)),f=K_(h);let m=u[f],p=u[h];if(i){const b=f==="y"?"top":"left",x=f==="y"?"bottom":"right",w=m+d[b],_=m-d[x];m=Lw(w,m,_)}if(a){const b=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=p+d[b],_=p-d[x];p=Lw(w,p,_)}const v=l.fn({...e,[f]:m,[h]:p});return{...v,data:{x:v.x-r,y:v.y-n,enabled:{[f]:i,[h]:a}}}}}},yV=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:a}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Bo(t,e),d={x:r,y:n},h=lc(s),f=K_(h);let m=d[f],p=d[h];const v=Bo(l,e),b=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const _=f==="y"?"height":"width",S=i.reference[f]-i.floating[_]+b.mainAxis,N=i.reference[f]+i.reference[_]-b.mainAxis;m<S?m=S:m>N&&(m=N)}if(u){var x,w;const _=f==="y"?"width":"height",S=["top","left"].includes(qo(s)),N=i.reference[h]-i.floating[_]+(S&&((x=a.offset)==null?void 0:x[h])||0)+(S?0:b.crossAxis),E=i.reference[h]+i.reference[_]+(S?0:((w=a.offset)==null?void 0:w[h])||0)-(S?b.crossAxis:0);p<N?p=N:p>E&&(p=E)}return{[f]:m,[h]:p}}}},bV=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:a,elements:l}=e,{apply:c=()=>{},...u}=Bo(t,e),d=await hp(e,u),h=qo(s),f=uf(s),m=lc(s)==="y",{width:p,height:v}=i.floating;let b,x;h==="top"||h==="bottom"?(b=h,x=f===(await(a.isRTL==null?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(x=h,b=f==="end"?"top":"bottom");const w=v-d.top-d.bottom,_=p-d.left-d.right,S=ac(v-d[b],w),N=ac(p-d[x],_),E=!e.middlewareData.shift;let P=S,A=N;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(A=_),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(P=w),E&&!f){const Y=Ws(d.left,0),T=Ws(d.right,0),O=Ws(d.top,0),U=Ws(d.bottom,0);m?A=p-2*(Y!==0||T!==0?Y+T:Ws(d.left,d.right)):P=v-2*(O!==0||U!==0?O+U:Ws(d.top,d.bottom))}await c({...e,availableWidth:A,availableHeight:P});const F=await a.getDimensions(l.floating);return p!==F.width||v!==F.height?{reset:{rects:!0}}:{}}}};function w1(){return typeof window<"u"}function df(t){return xA(t)?(t.nodeName||"").toLowerCase():"#document"}function Ks(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function eo(t){var e;return(e=(xA(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function xA(t){return w1()?t instanceof Node||t instanceof Ks(t).Node:!1}function la(t){return w1()?t instanceof Element||t instanceof Ks(t).Element:!1}function Xa(t){return w1()?t instanceof HTMLElement||t instanceof Ks(t).HTMLElement:!1}function WN(t){return!w1()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ks(t).ShadowRoot}function Up(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=ca(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function wV(t){return["table","td","th"].includes(df(t))}function _1(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Z_(t){const e=ej(),r=la(t)?ca(t):t;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function _V(t){let e=cc(t);for(;Xa(e)&&!$h(e);){if(Z_(e))return e;if(_1(e))return null;e=cc(e)}return null}function ej(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function $h(t){return["html","body","#document"].includes(df(t))}function ca(t){return Ks(t).getComputedStyle(t)}function j1(t){return la(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function cc(t){if(df(t)==="html")return t;const e=t.assignedSlot||t.parentNode||WN(t)&&t.host||eo(t);return WN(e)?e.host:e}function yA(t){const e=cc(t);return $h(e)?t.ownerDocument?t.ownerDocument.body:t.body:Xa(e)&&Up(e)?e:yA(e)}function fp(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=yA(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),a=Ks(s);if(i){const l=Mw(a);return e.concat(a,a.visualViewport||[],Up(s)?s:[],l&&r?fp(l):[])}return e.concat(s,fp(s,[],r))}function Mw(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function bA(t){const e=ca(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Xa(t),i=s?t.offsetWidth:r,a=s?t.offsetHeight:n,l=hx(r)!==i||hx(n)!==a;return l&&(r=i,n=a),{width:r,height:n,$:l}}function tj(t){return la(t)?t:t.contextElement}function ah(t){const e=tj(t);if(!Xa(e))return oc(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=bA(e);let a=(i?hx(r.width):r.width)/n,l=(i?hx(r.height):r.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const jV=oc(0);function wA(t){const e=Ks(t);return!ej()||!e.visualViewport?jV:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function SV(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ks(t)?!1:e}function ju(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=tj(t);let a=oc(1);e&&(n?la(n)&&(a=ah(n)):a=ah(t));const l=SV(i,r,n)?wA(i):oc(0);let c=(s.left+l.x)/a.x,u=(s.top+l.y)/a.y,d=s.width/a.x,h=s.height/a.y;if(i){const f=Ks(i),m=n&&la(n)?Ks(n):n;let p=f,v=Mw(p);for(;v&&n&&m!==p;){const b=ah(v),x=v.getBoundingClientRect(),w=ca(v),_=x.left+(v.clientLeft+parseFloat(w.paddingLeft))*b.x,S=x.top+(v.clientTop+parseFloat(w.paddingTop))*b.y;c*=b.x,u*=b.y,d*=b.x,h*=b.y,c+=_,u+=S,p=Ks(v),v=Mw(p)}}return mx({width:d,height:h,x:c,y:u})}function CV(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",a=eo(n),l=e?_1(e.floating):!1;if(n===a||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=oc(1);const d=oc(0),h=Xa(n);if((h||!h&&!i)&&((df(n)!=="body"||Up(a))&&(c=j1(n)),Xa(n))){const f=ju(n);u=ah(n),d.x=f.x+n.clientLeft,d.y=f.y+n.clientTop}return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x,y:r.y*u.y-c.scrollTop*u.y+d.y}}function NV(t){return Array.from(t.getClientRects())}function Rw(t,e){const r=j1(t).scrollLeft;return e?e.left+r:ju(eo(t)).left+r}function kV(t){const e=eo(t),r=j1(t),n=t.ownerDocument.body,s=Ws(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Ws(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+Rw(t);const l=-r.scrollTop;return ca(n).direction==="rtl"&&(a+=Ws(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:a,y:l}}function EV(t,e){const r=Ks(t),n=eo(t),s=r.visualViewport;let i=n.clientWidth,a=n.clientHeight,l=0,c=0;if(s){i=s.width,a=s.height;const u=ej();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:a,x:l,y:c}}function PV(t,e){const r=ju(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=Xa(t)?ah(t):oc(1),a=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=n*i.y;return{width:a,height:l,x:c,y:u}}function HN(t,e,r){let n;if(e==="viewport")n=EV(t,r);else if(e==="document")n=kV(eo(t));else if(la(e))n=PV(e,r);else{const s=wA(t);n={...e,x:e.x-s.x,y:e.y-s.y}}return mx(n)}function _A(t,e){const r=cc(t);return r===e||!la(r)||$h(r)?!1:ca(r).position==="fixed"||_A(r,e)}function AV(t,e){const r=e.get(t);if(r)return r;let n=fp(t,[],!1).filter(l=>la(l)&&df(l)!=="body"),s=null;const i=ca(t).position==="fixed";let a=i?cc(t):t;for(;la(a)&&!$h(a);){const l=ca(a),c=Z_(a);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Up(a)&&!c&&_A(t,a))?n=n.filter(d=>d!==a):s=l,a=cc(a)}return e.set(t,n),n}function TV(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const a=[...r==="clippingAncestors"?_1(e)?[]:AV(e,this._c):[].concat(r),n],l=a[0],c=a.reduce((u,d)=>{const h=HN(e,d,s);return u.top=Ws(h.top,u.top),u.right=ac(h.right,u.right),u.bottom=ac(h.bottom,u.bottom),u.left=Ws(h.left,u.left),u},HN(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function LV(t){const{width:e,height:r}=bA(t);return{width:e,height:r}}function OV(t,e,r){const n=Xa(e),s=eo(e),i=r==="fixed",a=ju(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=oc(0);if(n||!n&&!i)if((df(e)!=="body"||Up(s))&&(l=j1(e)),n){const m=ju(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&(c.x=Rw(s));let u=0,d=0;if(s&&!n&&!i){const m=s.getBoundingClientRect();d=m.top+l.scrollTop,u=m.left+l.scrollLeft-Rw(s,m)}const h=a.left+l.scrollLeft-c.x-u,f=a.top+l.scrollTop-c.y-d;return{x:h,y:f,width:a.width,height:a.height}}function D2(t){return ca(t).position==="static"}function GN(t,e){if(!Xa(t)||ca(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return eo(t)===r&&(r=r.ownerDocument.body),r}function jA(t,e){const r=Ks(t);if(_1(t))return r;if(!Xa(t)){let s=cc(t);for(;s&&!$h(s);){if(la(s)&&!D2(s))return s;s=cc(s)}return r}let n=GN(t,e);for(;n&&wV(n)&&D2(n);)n=GN(n,e);return n&&$h(n)&&D2(n)&&!Z_(n)?r:n||_V(t)||r}const MV=async function(t){const e=this.getOffsetParent||jA,r=this.getDimensions,n=await r(t.floating);return{reference:OV(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function RV(t){return ca(t).direction==="rtl"}const DV={convertOffsetParentRelativeRectToViewportRelativeRect:CV,getDocumentElement:eo,getClippingRect:TV,getOffsetParent:jA,getElementRects:MV,getClientRects:NV,getDimensions:LV,getScale:ah,isElement:la,isRTL:RV};function FV(t,e){let r=null,n;const s=eo(t);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function a(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const{left:u,top:d,width:h,height:f}=t.getBoundingClientRect();if(l||e(),!h||!f)return;const m=b0(d),p=b0(s.clientWidth-(u+h)),v=b0(s.clientHeight-(d+f)),b=b0(u),w={rootMargin:-m+"px "+-p+"px "+-v+"px "+-b+"px",threshold:Ws(0,ac(1,c))||1};let _=!0;function S(N){const E=N[0].intersectionRatio;if(E!==c){if(!_)return a();E?a(!1,E):n=setTimeout(()=>{a(!1,1e-7)},1e3)}_=!1}try{r=new IntersectionObserver(S,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(S,w)}r.observe(t)}return a(!0),i}function IV(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=tj(t),d=s||i?[...u?fp(u):[],...fp(e)]:[];d.forEach(x=>{s&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const h=u&&l?FV(u,r):null;let f=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=m)==null||_.observe(e)})),r()}),u&&!c&&m.observe(u),m.observe(e));let p,v=c?ju(t):null;c&&b();function b(){const x=ju(t);v&&(x.x!==v.x||x.y!==v.y||x.width!==v.width||x.height!==v.height)&&r(),v=x,p=requestAnimationFrame(b)}return r(),()=>{var x;d.forEach(w=>{s&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),h==null||h(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(p)}}const zV=vV,$V=xV,BV=mV,qV=bV,UV=pV,YN=fV,VV=yV,WV=(t,e,r)=>{const n=new Map,s={platform:DV,...r},i={...s.platform,_c:n};return hV(t,e,{...s,platform:i})};var yv=typeof document<"u"?y.useLayoutEffect:y.useEffect;function px(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!px(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!px(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function SA(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function XN(t,e){const r=SA(t);return Math.round(e*r)/r}function F2(t){const e=y.useRef(t);return yv(()=>{e.current=t}),e}function HV(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:a}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=y.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=y.useState(n);px(f,n)||m(n);const[p,v]=y.useState(null),[b,x]=y.useState(null),w=y.useCallback(R=>{R!==E.current&&(E.current=R,v(R))},[]),_=y.useCallback(R=>{R!==P.current&&(P.current=R,x(R))},[]),S=i||p,N=a||b,E=y.useRef(null),P=y.useRef(null),A=y.useRef(d),F=c!=null,Y=F2(c),T=F2(s),O=F2(u),U=y.useCallback(()=>{if(!E.current||!P.current)return;const R={placement:e,strategy:r,middleware:f};T.current&&(R.platform=T.current),WV(E.current,P.current,R).then(B=>{const X={...B,isPositioned:O.current!==!1};q.current&&!px(A.current,X)&&(A.current=X,Qh.flushSync(()=>{h(X)}))})},[f,e,r,T,O]);yv(()=>{u===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,h(R=>({...R,isPositioned:!1})))},[u]);const q=y.useRef(!1);yv(()=>(q.current=!0,()=>{q.current=!1}),[]),yv(()=>{if(S&&(E.current=S),N&&(P.current=N),S&&N){if(Y.current)return Y.current(S,N,U);U()}},[S,N,U,Y,F]);const Z=y.useMemo(()=>({reference:E,floating:P,setReference:w,setFloating:_}),[w,_]),H=y.useMemo(()=>({reference:S,floating:N}),[S,N]),Q=y.useMemo(()=>{const R={position:r,left:0,top:0};if(!H.floating)return R;const B=XN(H.floating,d.x),X=XN(H.floating,d.y);return l?{...R,transform:"translate("+B+"px, "+X+"px)",...SA(H.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:B,top:X}},[r,l,H.floating,d.x,d.y]);return y.useMemo(()=>({...d,update:U,refs:Z,elements:H,floatingStyles:Q}),[d,U,Z,H,Q])}const GV=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?YN({element:n.current,padding:s}).fn(r):{}:n?YN({element:n,padding:s}).fn(r):{}}}},YV=(t,e)=>({...zV(t),options:[t,e]}),XV=(t,e)=>({...$V(t),options:[t,e]}),KV=(t,e)=>({...VV(t),options:[t,e]}),QV=(t,e)=>({...BV(t),options:[t,e]}),JV=(t,e)=>({...qV(t),options:[t,e]}),ZV=(t,e)=>({...UV(t),options:[t,e]}),eW=(t,e)=>({...GV(t),options:[t,e]});var tW="Arrow",CA=y.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return o.jsx(vt.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});CA.displayName=tW;var rW=CA;function nW(t,e=[]){let r=[];function n(i,a){const l=y.createContext(a),c=r.length;r=[...r,a];function u(h){const{scope:f,children:m,...p}=h,v=(f==null?void 0:f[t][c])||l,b=y.useMemo(()=>p,Object.values(p));return o.jsx(v.Provider,{value:b,children:m})}function d(h,f){const m=(f==null?void 0:f[t][c])||l,p=y.useContext(m);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=r.map(a=>y.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[n,sW(s,...e)]}function sW(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}function S1(t){const[e,r]=y.useState(void 0);return jn(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;a=u.inlineSize,l=u.blockSize}else a=t.offsetWidth,l=t.offsetHeight;r({width:a,height:l})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var rj="Popper",[NA,hf]=nW(rj),[iW,kA]=NA(rj),EA=t=>{const{__scopePopper:e,children:r}=t,[n,s]=y.useState(null);return o.jsx(iW,{scope:e,anchor:n,onAnchorChange:s,children:r})};EA.displayName=rj;var PA="PopperAnchor",AA=y.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=kA(PA,r),a=y.useRef(null),l=Lt(e,a);return y.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||a.current)}),n?null:o.jsx(vt.div,{...s,ref:l})});AA.displayName=PA;var nj="PopperContent",[aW,oW]=NA(nj),TA=y.forwardRef((t,e)=>{var le,ye,oe,ve,Se,Ae;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:p,...v}=t,b=kA(nj,r),[x,w]=y.useState(null),_=Lt(e,Ee=>w(Ee)),[S,N]=y.useState(null),E=S1(S),P=(E==null?void 0:E.width)??0,A=(E==null?void 0:E.height)??0,F=n+(i!=="center"?"-"+i:""),Y=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},T=Array.isArray(u)?u:[u],O=T.length>0,U={padding:Y,boundary:T.filter(cW),altBoundary:O},{refs:q,floatingStyles:Z,placement:H,isPositioned:Q,middlewareData:R}=HV({strategy:"fixed",placement:F,whileElementsMounted:(...Ee)=>IV(...Ee,{animationFrame:m==="always"}),elements:{reference:b.anchor},middleware:[YV({mainAxis:s+A,alignmentAxis:a}),c&&XV({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?KV():void 0,...U}),c&&QV({...U}),JV({...U,apply:({elements:Ee,rects:$e,availableWidth:je,availableHeight:te})=>{const{width:it,height:Qe}=$e.reference,Te=Ee.floating.style;Te.setProperty("--radix-popper-available-width",`${je}px`),Te.setProperty("--radix-popper-available-height",`${te}px`),Te.setProperty("--radix-popper-anchor-width",`${it}px`),Te.setProperty("--radix-popper-anchor-height",`${Qe}px`)}}),S&&eW({element:S,padding:l}),uW({arrowWidth:P,arrowHeight:A}),f&&ZV({strategy:"referenceHidden",...U})]}),[B,X]=MA(H),ie=An(p);jn(()=>{Q&&(ie==null||ie())},[Q,ie]);const M=(le=R.arrow)==null?void 0:le.x,W=(ye=R.arrow)==null?void 0:ye.y,K=((oe=R.arrow)==null?void 0:oe.centerOffset)!==0,[ne,se]=y.useState();return jn(()=>{x&&se(window.getComputedStyle(x).zIndex)},[x]),o.jsx("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:Q?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,"--radix-popper-transform-origin":[(ve=R.transformOrigin)==null?void 0:ve.x,(Se=R.transformOrigin)==null?void 0:Se.y].join(" "),...((Ae=R.hide)==null?void 0:Ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:o.jsx(aW,{scope:r,placedSide:B,onArrowChange:N,arrowX:M,arrowY:W,shouldHideArrow:K,children:o.jsx(vt.div,{"data-side":B,"data-align":X,...v,ref:_,style:{...v.style,animation:Q?void 0:"none"}})})})});TA.displayName=nj;var LA="PopperArrow",lW={top:"bottom",right:"left",bottom:"top",left:"right"},OA=y.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=oW(LA,n),a=lW[i.placedSide];return o.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:o.jsx(rW,{...s,ref:r,style:{...s.style,display:"block"}})})});OA.displayName=LA;function cW(t){return t!==null}var uW=t=>({name:"transformOrigin",options:t,fn(e){var b,x,w;const{placement:r,rects:n,middlewareData:s}=e,a=((b=s.arrow)==null?void 0:b.centerOffset)!==0,l=a?0:t.arrowWidth,c=a?0:t.arrowHeight,[u,d]=MA(r),h={start:"0%",center:"50%",end:"100%"}[d],f=(((x=s.arrow)==null?void 0:x.x)??0)+l/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+c/2;let p="",v="";return u==="bottom"?(p=a?h:`${f}px`,v=`${-c}px`):u==="top"?(p=a?h:`${f}px`,v=`${n.floating.height+c}px`):u==="right"?(p=`${-c}px`,v=a?h:`${m}px`):u==="left"&&(p=`${n.floating.width+c}px`,v=a?h:`${m}px`),{data:{x:p,y:v}}}});function MA(t){const[e,r="center"]=t.split("-");return[e,r]}var sj=EA,C1=AA,ij=TA,aj=OA,dW="VisuallyHidden",oj=y.forwardRef((t,e)=>o.jsx(vt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));oj.displayName=dW;var hW=oj,[N1,Yne]=Ko("Tooltip",[hf]),k1=hf(),RA="TooltipProvider",fW=700,Dw="tooltip.open",[mW,lj]=N1(RA),DA=t=>{const{__scopeTooltip:e,delayDuration:r=fW,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=t,[a,l]=y.useState(!0),c=y.useRef(!1),u=y.useRef(0);return y.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),o.jsx(mW,{scope:e,isOpenDelayed:a,delayDuration:r,onOpen:y.useCallback(()=>{window.clearTimeout(u.current),l(!1)},[]),onClose:y.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>l(!0),n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:y.useCallback(d=>{c.current=d},[]),disableHoverableContent:s,children:i})};DA.displayName=RA;var E1="Tooltip",[pW,P1]=N1(E1),FA=t=>{const{__scopeTooltip:e,children:r,open:n,defaultOpen:s=!1,onOpenChange:i,disableHoverableContent:a,delayDuration:l}=t,c=lj(E1,t.__scopeTooltip),u=k1(e),[d,h]=y.useState(null),f=Ql(),m=y.useRef(0),p=a??c.disableHoverableContent,v=l??c.delayDuration,b=y.useRef(!1),[x=!1,w]=ic({prop:n,defaultProp:s,onChange:P=>{P?(c.onOpen(),document.dispatchEvent(new CustomEvent(Dw))):c.onClose(),i==null||i(P)}}),_=y.useMemo(()=>x?b.current?"delayed-open":"instant-open":"closed",[x]),S=y.useCallback(()=>{window.clearTimeout(m.current),m.current=0,b.current=!1,w(!0)},[w]),N=y.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),E=y.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{b.current=!0,w(!0),m.current=0},v)},[v,w]);return y.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),o.jsx(sj,{...u,children:o.jsx(pW,{scope:e,contentId:f,open:x,stateAttribute:_,trigger:d,onTriggerChange:h,onTriggerEnter:y.useCallback(()=>{c.isOpenDelayed?E():S()},[c.isOpenDelayed,E,S]),onTriggerLeave:y.useCallback(()=>{p?N():(window.clearTimeout(m.current),m.current=0)},[N,p]),onOpen:S,onClose:N,disableHoverableContent:p,children:r})})};FA.displayName=E1;var Fw="TooltipTrigger",IA=y.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=P1(Fw,r),i=lj(Fw,r),a=k1(r),l=y.useRef(null),c=Lt(e,l,s.onTriggerChange),u=y.useRef(!1),d=y.useRef(!1),h=y.useCallback(()=>u.current=!1,[]);return y.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),o.jsx(C1,{asChild:!0,...a,children:o.jsx(vt.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:c,onPointerMove:ct(t.onPointerMove,f=>{f.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:ct(t.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:ct(t.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ct(t.onFocus,()=>{u.current||s.onOpen()}),onBlur:ct(t.onBlur,s.onClose),onClick:ct(t.onClick,s.onClose)})})});IA.displayName=Fw;var gW="TooltipPortal",[Xne,vW]=N1(gW,{forceMount:void 0}),Bh="TooltipContent",zA=y.forwardRef((t,e)=>{const r=vW(Bh,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,a=P1(Bh,t.__scopeTooltip);return o.jsx(ki,{present:n||a.open,children:a.disableHoverableContent?o.jsx($A,{side:s,...i,ref:e}):o.jsx(xW,{side:s,...i,ref:e})})}),xW=y.forwardRef((t,e)=>{const r=P1(Bh,t.__scopeTooltip),n=lj(Bh,t.__scopeTooltip),s=y.useRef(null),i=Lt(e,s),[a,l]=y.useState(null),{trigger:c,onClose:u}=r,d=s.current,{onPointerInTransitChange:h}=n,f=y.useCallback(()=>{l(null),h(!1)},[h]),m=y.useCallback((p,v)=>{const b=p.currentTarget,x={x:p.clientX,y:p.clientY},w=_W(x,b.getBoundingClientRect()),_=jW(x,w),S=SW(v.getBoundingClientRect()),N=NW([..._,...S]);l(N),h(!0)},[h]);return y.useEffect(()=>()=>f(),[f]),y.useEffect(()=>{if(c&&d){const p=b=>m(b,d),v=b=>m(b,c);return c.addEventListener("pointerleave",p),d.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",p),d.removeEventListener("pointerleave",v)}}},[c,d,m,f]),y.useEffect(()=>{if(a){const p=v=>{const b=v.target,x={x:v.clientX,y:v.clientY},w=(c==null?void 0:c.contains(b))||(d==null?void 0:d.contains(b)),_=!CW(x,a);w?f():_&&(f(),u())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[c,d,a,u,f]),o.jsx($A,{...t,ref:i})}),[yW,bW]=N1(E1,{isInside:!1}),$A=y.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...l}=t,c=P1(Bh,r),u=k1(r),{onClose:d}=c;return y.useEffect(()=>(document.addEventListener(Dw,d),()=>document.removeEventListener(Dw,d)),[d]),y.useEffect(()=>{if(c.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(c.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,d]),o.jsx(qp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:o.jsxs(ij,{"data-state":c.stateAttribute,...u,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(YP,{children:n}),o.jsx(yW,{scope:r,isInside:!0,children:o.jsx(hW,{id:c.contentId,role:"tooltip",children:s||n})})]})})});zA.displayName=Bh;var BA="TooltipArrow",wW=y.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=k1(r);return bW(BA,r).isInside?null:o.jsx(aj,{...s,...n,ref:e})});wW.displayName=BA;function _W(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function jW(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function SW(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function CW(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const l=e[i].x,c=e[i].y,u=e[a].x,d=e[a].y;c>n!=d>n&&r<(u-l)*(n-c)/(d-c)+l&&(s=!s)}return s}function NW(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),kW(e)}function kW(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],a=r[r.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var EW=DA,PW=FA,AW=IA,qA=zA;const TW=EW,LW=PW,OW=AW,UA=y.forwardRef(({className:t,sideOffset:e=4,...r},n)=>o.jsx(qA,{ref:n,sideOffset:e,className:Be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));UA.displayName=qA.displayName;const MW="sidebar:state",RW=60*60*24*7,DW="16rem",FW="18rem",IW="3rem",zW="b",VA=y.createContext(null);function Vp(){const t=y.useContext(VA);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}const WA=y.forwardRef(({defaultOpen:t=!0,open:e,onOpenChange:r,className:n,style:s,children:i,...a},l)=>{const c=hA(),[u,d]=y.useState(!1),[h,f]=y.useState(t),m=e??h,p=y.useCallback(w=>{const _=typeof w=="function"?w(m):w;r?r(_):f(_),document.cookie=`${MW}=${_}; path=/; max-age=${RW}`},[r,m]),v=y.useCallback(()=>c?d(w=>!w):p(w=>!w),[c,p,d]);y.useEffect(()=>{const w=_=>{_.key===zW&&(_.metaKey||_.ctrlKey)&&(_.preventDefault(),v())};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[v]);const b=m?"expanded":"collapsed",x=y.useMemo(()=>({state:b,open:m,setOpen:p,isMobile:c,openMobile:u,setOpenMobile:d,toggleSidebar:v}),[b,m,p,c,u,d,v]);return o.jsx(VA.Provider,{value:x,children:o.jsx(TW,{delayDuration:0,children:o.jsx("div",{style:{"--sidebar-width":DW,"--sidebar-width-icon":IW,...s},className:Be("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:l,...a,children:i})})})});WA.displayName="SidebarProvider";const HA=y.forwardRef(({side:t="left",variant:e="sidebar",collapsible:r="offcanvas",className:n,children:s,...i},a)=>{const{isMobile:l,state:c,openMobile:u,setOpenMobile:d}=Vp();return r==="none"?o.jsx("div",{className:Be("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:a,...i,children:s}):l?o.jsx(ZU,{open:u,onOpenChange:d,...i,children:o.jsx(gA,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":FW},side:t,children:o.jsx("div",{className:"flex h-full w-full flex-col",children:s})})}):o.jsxs("div",{ref:a,className:"group peer hidden md:block text-sidebar-foreground","data-state":c,"data-collapsible":c==="collapsed"?r:"","data-variant":e,"data-side":t,children:[o.jsx("div",{className:Be("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",e==="floating"||e==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),o.jsx("div",{className:Be("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",e==="floating"||e==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...i,children:o.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:s})})]})});HA.displayName="Sidebar";const GA=y.forwardRef(({className:t,onClick:e,...r},n)=>{const{toggleSidebar:s}=Vp();return o.jsxs(J,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Be("h-7 w-7",t),onClick:i=>{e==null||e(i),s()},...r,children:[o.jsx(Zz,{}),o.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});GA.displayName="SidebarTrigger";const $W=y.forwardRef(({className:t,...e},r)=>{const{toggleSidebar:n}=Vp();return o.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Be("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...e})});$W.displayName="SidebarRail";const YA=y.forwardRef(({className:t,...e},r)=>o.jsx("main",{ref:r,className:Be("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",t),...e}));YA.displayName="SidebarInset";const BW=y.forwardRef(({className:t,...e},r)=>o.jsx(Ye,{ref:r,"data-sidebar":"input",className:Be("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",t),...e}));BW.displayName="SidebarInput";const XA=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"header",className:Be("flex flex-col gap-2 p-2",t),...e}));XA.displayName="SidebarHeader";const qW=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"footer",className:Be("flex flex-col gap-2 p-2",t),...e}));qW.displayName="SidebarFooter";const UW=y.forwardRef(({className:t,...e},r)=>o.jsx(Qc,{ref:r,"data-sidebar":"separator",className:Be("mx-2 w-auto bg-sidebar-border",t),...e}));UW.displayName="SidebarSeparator";const KA=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"content",className:Be("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...e}));KA.displayName="SidebarContent";const QA=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"group",className:Be("relative flex w-full min-w-0 flex-col p-2",t),...e}));QA.displayName="SidebarGroup";const JA=y.forwardRef(({className:t,asChild:e=!1,...r},n)=>{const s=e?ei:"div";return o.jsx(s,{ref:n,"data-sidebar":"group-label",className:Be("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...r})});JA.displayName="SidebarGroupLabel";const VW=y.forwardRef(({className:t,asChild:e=!1,...r},n)=>{const s=e?ei:"button";return o.jsx(s,{ref:n,"data-sidebar":"group-action",className:Be("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",t),...r})});VW.displayName="SidebarGroupAction";const ZA=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"group-content",className:Be("w-full text-sm",t),...e}));ZA.displayName="SidebarGroupContent";const eT=y.forwardRef(({className:t,...e},r)=>o.jsx("ul",{ref:r,"data-sidebar":"menu",className:Be("flex w-full min-w-0 flex-col gap-1",t),...e}));eT.displayName="SidebarMenu";const tT=y.forwardRef(({className:t,...e},r)=>o.jsx("li",{ref:r,"data-sidebar":"menu-item",className:Be("group/menu-item relative",t),...e}));tT.displayName="SidebarMenuItem";const WW=af("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),rT=y.forwardRef(({asChild:t=!1,isActive:e=!1,variant:r="default",size:n="default",tooltip:s,className:i,...a},l)=>{const c=t?ei:"button",{isMobile:u,state:d}=Vp(),h=o.jsx(c,{ref:l,"data-sidebar":"menu-button","data-size":n,"data-active":e,className:Be(WW({variant:r,size:n}),i),...a});return s?(typeof s=="string"&&(s={children:s}),o.jsxs(LW,{children:[o.jsx(OW,{asChild:!0,children:h}),o.jsx(UA,{side:"right",align:"center",hidden:d!=="collapsed"||u,...s})]})):h});rT.displayName="SidebarMenuButton";const HW=y.forwardRef(({className:t,asChild:e=!1,showOnHover:r=!1,...n},s)=>{const i=e?ei:"button";return o.jsx(i,{ref:s,"data-sidebar":"menu-action",className:Be("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",t),...n})});HW.displayName="SidebarMenuAction";const GW=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:Be("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t),...e}));GW.displayName="SidebarMenuBadge";const YW=y.forwardRef(({className:t,showIcon:e=!1,...r},n)=>{const s=y.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return o.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:Be("rounded-md h-8 flex gap-2 px-2 items-center",t),...r,children:[e&&o.jsx(BN,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),o.jsx(BN,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":s}})]})});YW.displayName="SidebarMenuSkeleton";const XW=y.forwardRef(({className:t,...e},r)=>o.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:Be("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",t),...e}));XW.displayName="SidebarMenuSub";const KW=y.forwardRef(({...t},e)=>o.jsx("li",{ref:e,...t}));KW.displayName="SidebarMenuSubItem";const QW=y.forwardRef(({asChild:t=!1,size:e="md",isActive:r,className:n,...s},i)=>{const a=t?ei:"a";return o.jsx(a,{ref:i,"data-sidebar":"menu-sub-button","data-size":e,"data-active":r,className:Be("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",e==="sm"&&"text-xs",e==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...s})});QW.displayName="SidebarMenuSubButton";const Lu=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:Be("w-full caption-bottom text-sm",t),...e})}));Lu.displayName="Table";const Ou=y.forwardRef(({className:t,...e},r)=>o.jsx("thead",{ref:r,className:Be("[&_tr]:border-b",t),...e}));Ou.displayName="TableHeader";const Mu=y.forwardRef(({className:t,...e},r)=>o.jsx("tbody",{ref:r,className:Be("[&_tr:last-child]:border-0",t),...e}));Mu.displayName="TableBody";const JW=y.forwardRef(({className:t,...e},r)=>o.jsx("tfoot",{ref:r,className:Be("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));JW.displayName="TableFooter";const ti=y.forwardRef(({className:t,...e},r)=>o.jsx("tr",{ref:r,className:Be("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));ti.displayName="TableRow";const $t=y.forwardRef(({className:t,...e},r)=>o.jsx("th",{ref:r,className:Be("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));$t.displayName="TableHead";const Bt=y.forwardRef(({className:t,...e},r)=>o.jsx("td",{ref:r,className:Be("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Bt.displayName="TableCell";const ZW=y.forwardRef(({className:t,...e},r)=>o.jsx("caption",{ref:r,className:Be("mt-4 text-sm text-muted-foreground",t),...e}));ZW.displayName="TableCaption";var eH=y.createContext(void 0);function cj(t){const e=y.useContext(eH);return t||e||"ltr"}function mp(t,[e,r]){return Math.min(r,Math.max(e,t))}function tH(t,e){return y.useReducer((r,n)=>e[r][n]??r,t)}var uj="ScrollArea",[nT,Kne]=Ko(uj),[rH,Ei]=nT(uj),sT=y.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:i=600,...a}=t,[l,c]=y.useState(null),[u,d]=y.useState(null),[h,f]=y.useState(null),[m,p]=y.useState(null),[v,b]=y.useState(null),[x,w]=y.useState(0),[_,S]=y.useState(0),[N,E]=y.useState(!1),[P,A]=y.useState(!1),F=Lt(e,T=>c(T)),Y=cj(s);return o.jsx(rH,{scope:r,type:n,dir:Y,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:p,scrollbarXEnabled:N,onScrollbarXEnabledChange:E,scrollbarY:v,onScrollbarYChange:b,scrollbarYEnabled:P,onScrollbarYEnabledChange:A,onCornerWidthChange:w,onCornerHeightChange:S,children:o.jsx(vt.div,{dir:Y,...a,ref:F,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":_+"px",...t.style}})})});sT.displayName=uj;var iT="ScrollAreaViewport",aT=y.forwardRef((t,e)=>{const{__scopeScrollArea:r,children:n,asChild:s,nonce:i,...a}=t,l=Ei(iT,r),c=y.useRef(null),u=Lt(e,c,l.onViewportChange);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),o.jsx(vt.div,{"data-radix-scroll-area-viewport":"",...a,asChild:s,ref:u,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...t.style},children:hH({asChild:s,children:n},d=>o.jsx("div",{"data-radix-scroll-area-content":"",ref:l.onContentChange,style:{minWidth:l.scrollbarXEnabled?"fit-content":void 0},children:d}))})]})});aT.displayName=iT;var to="ScrollAreaScrollbar",dj=y.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=Ei(to,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,l=t.orientation==="horizontal";return y.useEffect(()=>(l?i(!0):a(!0),()=>{l?i(!1):a(!1)}),[l,i,a]),s.type==="hover"?o.jsx(nH,{...n,ref:e,forceMount:r}):s.type==="scroll"?o.jsx(sH,{...n,ref:e,forceMount:r}):s.type==="auto"?o.jsx(oT,{...n,ref:e,forceMount:r}):s.type==="always"?o.jsx(hj,{...n,ref:e}):null});dj.displayName=to;var nH=y.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=Ei(to,t.__scopeScrollArea),[i,a]=y.useState(!1);return y.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),a(!0)},d=()=>{c=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),o.jsx(ki,{present:r||i,children:o.jsx(oT,{"data-state":i?"visible":"hidden",...n,ref:e})})}),sH=y.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=Ei(to,t.__scopeScrollArea),i=t.orientation==="horizontal",a=T1(()=>c("SCROLL_END"),100),[l,c]=tH("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),y.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),a()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,a]),o.jsx(ki,{present:r||l!=="hidden",children:o.jsx(hj,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:ct(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:ct(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),oT=y.forwardRef((t,e)=>{const r=Ei(to,t.__scopeScrollArea),{forceMount:n,...s}=t,[i,a]=y.useState(!1),l=t.orientation==="horizontal",c=T1(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;a(l?u:d)}},10);return qh(r.viewport,c),qh(r.content,c),o.jsx(ki,{present:n||i,children:o.jsx(hj,{"data-state":i?"visible":"hidden",...s,ref:e})})}),hj=y.forwardRef((t,e)=>{const{orientation:r="vertical",...n}=t,s=Ei(to,t.__scopeScrollArea),i=y.useRef(null),a=y.useRef(0),[l,c]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=hT(l.viewport,l.content),d={...n,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:f=>a.current=f};function h(f,m){return uH(f,a.current,l,m)}return r==="horizontal"?o.jsx(iH,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=KN(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):r==="vertical"?o.jsx(aH,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=KN(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),iH=y.forwardRef((t,e)=>{const{sizes:r,onSizesChange:n,...s}=t,i=Ei(to,t.__scopeScrollArea),[a,l]=y.useState(),c=y.useRef(null),u=Lt(e,c,i.onScrollbarXChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),o.jsx(cT,{"data-orientation":"horizontal",...s,ref:u,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":A1(r)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),mT(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&a&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:vx(a.paddingLeft),paddingEnd:vx(a.paddingRight)}})}})}),aH=y.forwardRef((t,e)=>{const{sizes:r,onSizesChange:n,...s}=t,i=Ei(to,t.__scopeScrollArea),[a,l]=y.useState(),c=y.useRef(null),u=Lt(e,c,i.onScrollbarYChange);return y.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),o.jsx(cT,{"data-orientation":"vertical",...s,ref:u,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":A1(r)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),mT(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&a&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:vx(a.paddingTop),paddingEnd:vx(a.paddingBottom)}})}})}),[oH,lT]=nT(to),cT=y.forwardRef((t,e)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=Ei(to,r),[p,v]=y.useState(null),b=Lt(e,F=>v(F)),x=y.useRef(null),w=y.useRef(""),_=m.viewport,S=n.content-n.viewport,N=An(d),E=An(c),P=T1(h,10);function A(F){if(x.current){const Y=F.clientX-x.current.left,T=F.clientY-x.current.top;u({x:Y,y:T})}}return y.useEffect(()=>{const F=Y=>{const T=Y.target;(p==null?void 0:p.contains(T))&&N(Y,S)};return document.addEventListener("wheel",F,{passive:!1}),()=>document.removeEventListener("wheel",F,{passive:!1})},[_,p,S,N]),y.useEffect(E,[n,E]),qh(p,P),qh(m.content,P),o.jsx(oH,{scope:r,scrollbar:p,hasThumb:s,onThumbChange:An(i),onThumbPointerUp:An(a),onThumbPositionChange:E,onThumbPointerDown:An(l),children:o.jsx(vt.div,{...f,ref:b,style:{position:"absolute",...f.style},onPointerDown:ct(t.onPointerDown,F=>{F.button===0&&(F.target.setPointerCapture(F.pointerId),x.current=p.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),A(F))}),onPointerMove:ct(t.onPointerMove,A),onPointerUp:ct(t.onPointerUp,F=>{const Y=F.target;Y.hasPointerCapture(F.pointerId)&&Y.releasePointerCapture(F.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),gx="ScrollAreaThumb",uT=y.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=lT(gx,t.__scopeScrollArea);return o.jsx(ki,{present:r||s.hasThumb,children:o.jsx(lH,{ref:e,...n})})}),lH=y.forwardRef((t,e)=>{const{__scopeScrollArea:r,style:n,...s}=t,i=Ei(gx,r),a=lT(gx,r),{onThumbPositionChange:l}=a,c=Lt(e,h=>a.onThumbChange(h)),u=y.useRef(),d=T1(()=>{u.current&&(u.current(),u.current=void 0)},100);return y.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=dH(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),o.jsx(vt.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ct(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),p=h.clientX-m.left,v=h.clientY-m.top;a.onThumbPointerDown({x:p,y:v})}),onPointerUp:ct(t.onPointerUp,a.onThumbPointerUp)})});uT.displayName=gx;var fj="ScrollAreaCorner",dT=y.forwardRef((t,e)=>{const r=Ei(fj,t.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?o.jsx(cH,{...t,ref:e}):null});dT.displayName=fj;var cH=y.forwardRef((t,e)=>{const{__scopeScrollArea:r,...n}=t,s=Ei(fj,r),[i,a]=y.useState(0),[l,c]=y.useState(0),u=!!(i&&l);return qh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),qh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),a(d)}),u?o.jsx(vt.div,{...n,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function vx(t){return t?parseInt(t,10):0}function hT(t,e){const r=t/e;return isNaN(r)?0:r}function A1(t){const e=hT(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=(t.scrollbar.size-r)*e;return Math.max(n,18)}function uH(t,e,r,n="ltr"){const s=A1(r),i=s/2,a=e||i,l=s-a,c=r.scrollbar.paddingStart+a,u=r.scrollbar.size-r.scrollbar.paddingEnd-l,d=r.content-r.viewport,h=n==="ltr"?[0,d]:[d*-1,0];return fT([c,u],h)(t)}function KN(t,e,r="ltr"){const n=A1(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,a=e.content-e.viewport,l=i-n,c=r==="ltr"?[0,a]:[a*-1,0],u=mp(t,c);return fT([0,a],[0,l])(u)}function fT(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(t[1]-t[0]);return e[0]+n*(r-t[0])}}function mT(t,e){return t>0&&t<e}var dH=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},n=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},a=r.left!==i.left,l=r.top!==i.top;(a||l)&&e(),r=i,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function T1(t,e){const r=An(t),n=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),y.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,e)},[r,e])}function qh(t,e){const r=An(e);jn(()=>{let n=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(t),()=>{window.cancelAnimationFrame(n),s.unobserve(t)}}},[t,r])}function hH(t,e){const{asChild:r,children:n}=t;if(!r)return typeof e=="function"?e(n):e;const s=y.Children.only(n);return y.cloneElement(s,{children:typeof e=="function"?e(s.props.children):e})}var pT=sT,fH=aT,mH=dT;const ko=y.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(pT,{ref:n,className:Be("relative overflow-hidden",t),...r,children:[o.jsx(fH,{className:"h-full w-full rounded-[inherit]",children:e}),o.jsx(gT,{}),o.jsx(mH,{})]}));ko.displayName=pT.displayName;const gT=y.forwardRef(({className:t,orientation:e="vertical",...r},n)=>o.jsx(dj,{ref:n,orientation:e,className:Be("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:o.jsx(uT,{className:"relative flex-1 rounded-full bg-border"})}));gT.displayName=dj.displayName;function pH(t,e=[]){let r=[];function n(i,a){const l=y.createContext(a),c=r.length;r=[...r,a];function u(h){const{scope:f,children:m,...p}=h,v=(f==null?void 0:f[t][c])||l,b=y.useMemo(()=>p,Object.values(p));return o.jsx(v.Provider,{value:b,children:m})}function d(h,f){const m=(f==null?void 0:f[t][c])||l,p=y.useContext(m);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=r.map(a=>y.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[n,gH(s,...e)]}function gH(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}function vT(t){const e=t+"CollectionProvider",[r,n]=pH(e),[s,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),a=m=>{const{scope:p,children:v}=m,b=Fe.useRef(null),x=Fe.useRef(new Map).current;return o.jsx(s,{scope:p,itemMap:x,collectionRef:b,children:v})};a.displayName=e;const l=t+"CollectionSlot",c=Fe.forwardRef((m,p)=>{const{scope:v,children:b}=m,x=i(l,v),w=Lt(p,x.collectionRef);return o.jsx(ei,{ref:w,children:b})});c.displayName=l;const u=t+"CollectionItemSlot",d="data-radix-collection-item",h=Fe.forwardRef((m,p)=>{const{scope:v,children:b,...x}=m,w=Fe.useRef(null),_=Lt(p,w),S=i(u,v);return Fe.useEffect(()=>(S.itemMap.set(w,{ref:w,...x}),()=>void S.itemMap.delete(w))),o.jsx(ei,{[d]:"",ref:_,children:b})});h.displayName=u;function f(m){const p=i(t+"CollectionConsumer",m);return Fe.useCallback(()=>{const b=p.collectionRef.current;if(!b)return[];const x=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(p.itemMap.values()).sort((S,N)=>x.indexOf(S.ref.current)-x.indexOf(N.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:a,Slot:c,ItemSlot:h},f,n]}function L1(t){const e=y.useRef({value:t,previous:t});return y.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var vH=[" ","Enter","ArrowUp","ArrowDown"],xH=[" ","Enter"],Wp="Select",[O1,M1,yH]=vT(Wp),[ff,Qne]=Ko(Wp,[yH,hf]),R1=hf(),[bH,wc]=ff(Wp),[wH,_H]=ff(Wp),xT=t=>{const{__scopeSelect:e,children:r,open:n,defaultOpen:s,onOpenChange:i,value:a,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m,form:p}=t,v=R1(e),[b,x]=y.useState(null),[w,_]=y.useState(null),[S,N]=y.useState(!1),E=cj(u),[P=!1,A]=ic({prop:n,defaultProp:s,onChange:i}),[F,Y]=ic({prop:a,defaultProp:l,onChange:c}),T=y.useRef(null),O=b?p||!!b.closest("form"):!0,[U,q]=y.useState(new Set),Z=Array.from(U).map(H=>H.props.value).join(";");return o.jsx(sj,{...v,children:o.jsxs(bH,{required:m,scope:e,trigger:b,onTriggerChange:x,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:S,onValueNodeHasChildrenChange:N,contentId:Ql(),value:F,onValueChange:Y,open:P,onOpenChange:A,dir:E,triggerPointerDownPosRef:T,disabled:f,children:[o.jsx(O1.Provider,{scope:e,children:o.jsx(wH,{scope:t.__scopeSelect,onNativeOptionAdd:y.useCallback(H=>{q(Q=>new Set(Q).add(H))},[]),onNativeOptionRemove:y.useCallback(H=>{q(Q=>{const R=new Set(Q);return R.delete(H),R})},[]),children:r})}),O?o.jsxs(UT,{"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:F,onChange:H=>Y(H.target.value),disabled:f,form:p,children:[F===void 0?o.jsx("option",{value:""}):null,Array.from(U)]},Z):null]})})};xT.displayName=Wp;var yT="SelectTrigger",bT=y.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:n=!1,...s}=t,i=R1(r),a=wc(yT,r),l=a.disabled||n,c=Lt(e,a.onTriggerChange),u=M1(r),d=y.useRef("touch"),[h,f,m]=VT(v=>{const b=u().filter(_=>!_.disabled),x=b.find(_=>_.value===a.value),w=WT(b,v,x);w!==void 0&&a.onValueChange(w.value)}),p=v=>{l||(a.onOpenChange(!0),m()),v&&(a.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return o.jsx(C1,{asChild:!0,...i,children:o.jsx(vt.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":qT(a.value)?"":void 0,...s,ref:c,onClick:ct(s.onClick,v=>{v.currentTarget.focus(),d.current!=="mouse"&&p(v)}),onPointerDown:ct(s.onPointerDown,v=>{d.current=v.pointerType;const b=v.target;b.hasPointerCapture(v.pointerId)&&b.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(p(v),v.preventDefault())}),onKeyDown:ct(s.onKeyDown,v=>{const b=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&f(v.key),!(b&&v.key===" ")&&vH.includes(v.key)&&(p(),v.preventDefault())})})})});bT.displayName=yT;var wT="SelectValue",_T=y.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:s,children:i,placeholder:a="",...l}=t,c=wc(wT,r),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=Lt(e,c.onValueNodeChange);return jn(()=>{u(d)},[u,d]),o.jsx(vt.span,{...l,ref:h,style:{pointerEvents:"none"},children:qT(c.value)?o.jsx(o.Fragment,{children:a}):i})});_T.displayName=wT;var jH="SelectIcon",jT=y.forwardRef((t,e)=>{const{__scopeSelect:r,children:n,...s}=t;return o.jsx(vt.span,{"aria-hidden":!0,...s,ref:e,children:n||"▼"})});jT.displayName=jH;var SH="SelectPortal",ST=t=>o.jsx(m1,{asChild:!0,...t});ST.displayName=SH;var Su="SelectContent",CT=y.forwardRef((t,e)=>{const r=wc(Su,t.__scopeSelect),[n,s]=y.useState();if(jn(()=>{s(new DocumentFragment)},[]),!r.open){const i=n;return i?Qh.createPortal(o.jsx(NT,{scope:t.__scopeSelect,children:o.jsx(O1.Slot,{scope:t.__scopeSelect,children:o.jsx("div",{children:t.children})})}),i):null}return o.jsx(kT,{...t,ref:e})});CT.displayName=Su;var Ui=10,[NT,_c]=ff(Su),CH="SelectContentImpl",kT=y.forwardRef((t,e)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:v,avoidCollisions:b,...x}=t,w=wc(Su,r),[_,S]=y.useState(null),[N,E]=y.useState(null),P=Lt(e,le=>S(le)),[A,F]=y.useState(null),[Y,T]=y.useState(null),O=M1(r),[U,q]=y.useState(!1),Z=y.useRef(!1);y.useEffect(()=>{if(_)return V_(_)},[_]),U_();const H=y.useCallback(le=>{const[ye,...oe]=O().map(Ae=>Ae.ref.current),[ve]=oe.slice(-1),Se=document.activeElement;for(const Ae of le)if(Ae===Se||(Ae==null||Ae.scrollIntoView({block:"nearest"}),Ae===ye&&N&&(N.scrollTop=0),Ae===ve&&N&&(N.scrollTop=N.scrollHeight),Ae==null||Ae.focus(),document.activeElement!==Se))return},[O,N]),Q=y.useCallback(()=>H([A,_]),[H,A,_]);y.useEffect(()=>{U&&Q()},[U,Q]);const{onOpenChange:R,triggerPointerDownPosRef:B}=w;y.useEffect(()=>{if(_){let le={x:0,y:0};const ye=ve=>{var Se,Ae;le={x:Math.abs(Math.round(ve.pageX)-(((Se=B.current)==null?void 0:Se.x)??0)),y:Math.abs(Math.round(ve.pageY)-(((Ae=B.current)==null?void 0:Ae.y)??0))}},oe=ve=>{le.x<=10&&le.y<=10?ve.preventDefault():_.contains(ve.target)||R(!1),document.removeEventListener("pointermove",ye),B.current=null};return B.current!==null&&(document.addEventListener("pointermove",ye),document.addEventListener("pointerup",oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ye),document.removeEventListener("pointerup",oe,{capture:!0})}}},[_,R,B]),y.useEffect(()=>{const le=()=>R(!1);return window.addEventListener("blur",le),window.addEventListener("resize",le),()=>{window.removeEventListener("blur",le),window.removeEventListener("resize",le)}},[R]);const[X,ie]=VT(le=>{const ye=O().filter(Se=>!Se.disabled),oe=ye.find(Se=>Se.ref.current===document.activeElement),ve=WT(ye,le,oe);ve&&setTimeout(()=>ve.ref.current.focus())}),M=y.useCallback((le,ye,oe)=>{const ve=!Z.current&&!oe;(w.value!==void 0&&w.value===ye||ve)&&(F(le),ve&&(Z.current=!0))},[w.value]),W=y.useCallback(()=>_==null?void 0:_.focus(),[_]),K=y.useCallback((le,ye,oe)=>{const ve=!Z.current&&!oe;(w.value!==void 0&&w.value===ye||ve)&&T(le)},[w.value]),ne=n==="popper"?Iw:ET,se=ne===Iw?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:v,avoidCollisions:b}:{};return o.jsx(NT,{scope:r,content:_,viewport:N,onViewportChange:E,itemRefCallback:M,selectedItem:A,onItemLeave:W,itemTextRefCallback:K,focusSelectedItem:Q,selectedItemText:Y,position:n,isPositioned:U,searchRef:X,children:o.jsx(g1,{as:ei,allowPinchZoom:!0,children:o.jsx(f1,{asChild:!0,trapped:w.open,onMountAutoFocus:le=>{le.preventDefault()},onUnmountAutoFocus:ct(s,le=>{var ye;(ye=w.trigger)==null||ye.focus({preventScroll:!0}),le.preventDefault()}),children:o.jsx(qp,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:le=>le.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:o.jsx(ne,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:le=>le.preventDefault(),...x,...se,onPlaced:()=>q(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:ct(x.onKeyDown,le=>{const ye=le.ctrlKey||le.altKey||le.metaKey;if(le.key==="Tab"&&le.preventDefault(),!ye&&le.key.length===1&&ie(le.key),["ArrowUp","ArrowDown","Home","End"].includes(le.key)){let ve=O().filter(Se=>!Se.disabled).map(Se=>Se.ref.current);if(["ArrowUp","End"].includes(le.key)&&(ve=ve.slice().reverse()),["ArrowUp","ArrowDown"].includes(le.key)){const Se=le.target,Ae=ve.indexOf(Se);ve=ve.slice(Ae+1)}setTimeout(()=>H(ve)),le.preventDefault()}})})})})})})});kT.displayName=CH;var NH="SelectItemAlignedPosition",ET=y.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:n,...s}=t,i=wc(Su,r),a=_c(Su,r),[l,c]=y.useState(null),[u,d]=y.useState(null),h=Lt(e,P=>d(P)),f=M1(r),m=y.useRef(!1),p=y.useRef(!0),{viewport:v,selectedItem:b,selectedItemText:x,focusSelectedItem:w}=a,_=y.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&v&&b&&x){const P=i.trigger.getBoundingClientRect(),A=u.getBoundingClientRect(),F=i.valueNode.getBoundingClientRect(),Y=x.getBoundingClientRect();if(i.dir!=="rtl"){const Se=Y.left-A.left,Ae=F.left-Se,Ee=P.left-Ae,$e=P.width+Ee,je=Math.max($e,A.width),te=window.innerWidth-Ui,it=mp(Ae,[Ui,Math.max(Ui,te-je)]);l.style.minWidth=$e+"px",l.style.left=it+"px"}else{const Se=A.right-Y.right,Ae=window.innerWidth-F.right-Se,Ee=window.innerWidth-P.right-Ae,$e=P.width+Ee,je=Math.max($e,A.width),te=window.innerWidth-Ui,it=mp(Ae,[Ui,Math.max(Ui,te-je)]);l.style.minWidth=$e+"px",l.style.right=it+"px"}const T=f(),O=window.innerHeight-Ui*2,U=v.scrollHeight,q=window.getComputedStyle(u),Z=parseInt(q.borderTopWidth,10),H=parseInt(q.paddingTop,10),Q=parseInt(q.borderBottomWidth,10),R=parseInt(q.paddingBottom,10),B=Z+H+U+R+Q,X=Math.min(b.offsetHeight*5,B),ie=window.getComputedStyle(v),M=parseInt(ie.paddingTop,10),W=parseInt(ie.paddingBottom,10),K=P.top+P.height/2-Ui,ne=O-K,se=b.offsetHeight/2,le=b.offsetTop+se,ye=Z+H+le,oe=B-ye;if(ye<=K){const Se=T.length>0&&b===T[T.length-1].ref.current;l.style.bottom="0px";const Ae=u.clientHeight-v.offsetTop-v.offsetHeight,Ee=Math.max(ne,se+(Se?W:0)+Ae+Q),$e=ye+Ee;l.style.height=$e+"px"}else{const Se=T.length>0&&b===T[0].ref.current;l.style.top="0px";const Ee=Math.max(K,Z+v.offsetTop+(Se?M:0)+se)+oe;l.style.height=Ee+"px",v.scrollTop=ye-K+v.offsetTop}l.style.margin=`${Ui}px 0`,l.style.minHeight=X+"px",l.style.maxHeight=O+"px",n==null||n(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,v,b,x,i.dir,n]);jn(()=>_(),[_]);const[S,N]=y.useState();jn(()=>{u&&N(window.getComputedStyle(u).zIndex)},[u]);const E=y.useCallback(P=>{P&&p.current===!0&&(_(),w==null||w(),p.current=!1)},[_,w]);return o.jsx(EH,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:E,children:o.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:o.jsx(vt.div,{...s,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});ET.displayName=NH;var kH="SelectPopperPosition",Iw=y.forwardRef((t,e)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=Ui,...i}=t,a=R1(r);return o.jsx(ij,{...a,...i,ref:e,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Iw.displayName=kH;var[EH,mj]=ff(Su,{}),zw="SelectViewport",PT=y.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:n,...s}=t,i=_c(zw,r),a=mj(zw,r),l=Lt(e,i.onViewportChange),c=y.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(O1.Slot,{scope:r,children:o.jsx(vt.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:ct(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=a;if(f!=null&&f.current&&h){const m=Math.abs(c.current-d.scrollTop);if(m>0){const p=window.innerHeight-Ui*2,v=parseFloat(h.style.minHeight),b=parseFloat(h.style.height),x=Math.max(v,b);if(x<p){const w=x+m,_=Math.min(p,w),S=w-_;h.style.height=_+"px",h.style.bottom==="0px"&&(d.scrollTop=S>0?S:0,h.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});PT.displayName=zw;var AT="SelectGroup",[PH,AH]=ff(AT),TH=y.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=Ql();return o.jsx(PH,{scope:r,id:s,children:o.jsx(vt.div,{role:"group","aria-labelledby":s,...n,ref:e})})});TH.displayName=AT;var TT="SelectLabel",LT=y.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=AH(TT,r);return o.jsx(vt.div,{id:s.id,...n,ref:e})});LT.displayName=TT;var xx="SelectItem",[LH,OT]=ff(xx),MT=y.forwardRef((t,e)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:i,...a}=t,l=wc(xx,r),c=_c(xx,r),u=l.value===n,[d,h]=y.useState(i??""),[f,m]=y.useState(!1),p=Lt(e,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,n,s)}),v=Ql(),b=y.useRef("touch"),x=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(LH,{scope:r,value:n,disabled:s,textId:v,isSelected:u,onItemTextChange:y.useCallback(w=>{h(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:o.jsx(O1.ItemSlot,{scope:r,value:n,disabled:s,textValue:d,children:o.jsx(vt.div,{role:"option","aria-labelledby":v,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:p,onFocus:ct(a.onFocus,()=>m(!0)),onBlur:ct(a.onBlur,()=>m(!1)),onClick:ct(a.onClick,()=>{b.current!=="mouse"&&x()}),onPointerUp:ct(a.onPointerUp,()=>{b.current==="mouse"&&x()}),onPointerDown:ct(a.onPointerDown,w=>{b.current=w.pointerType}),onPointerMove:ct(a.onPointerMove,w=>{var _;b.current=w.pointerType,s?(_=c.onItemLeave)==null||_.call(c):b.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ct(a.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:ct(a.onKeyDown,w=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(xH.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});MT.displayName=xx;var wm="SelectItemText",RT=y.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:s,...i}=t,a=wc(wm,r),l=_c(wm,r),c=OT(wm,r),u=_H(wm,r),[d,h]=y.useState(null),f=Lt(e,x=>h(x),c.onItemTextChange,x=>{var w;return(w=l.itemTextRefCallback)==null?void 0:w.call(l,x,c.value,c.disabled)}),m=d==null?void 0:d.textContent,p=y.useMemo(()=>o.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:v,onNativeOptionRemove:b}=u;return jn(()=>(v(p),()=>b(p)),[v,b,p]),o.jsxs(o.Fragment,{children:[o.jsx(vt.span,{id:c.textId,...i,ref:f}),c.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Qh.createPortal(i.children,a.valueNode):null]})});RT.displayName=wm;var DT="SelectItemIndicator",FT=y.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return OT(DT,r).isSelected?o.jsx(vt.span,{"aria-hidden":!0,...n,ref:e}):null});FT.displayName=DT;var $w="SelectScrollUpButton",IT=y.forwardRef((t,e)=>{const r=_c($w,t.__scopeSelect),n=mj($w,t.__scopeSelect),[s,i]=y.useState(!1),a=Lt(e,n.onScrollButtonChange);return jn(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollTop>0;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?o.jsx($T,{...t,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});IT.displayName=$w;var Bw="SelectScrollDownButton",zT=y.forwardRef((t,e)=>{const r=_c(Bw,t.__scopeSelect),n=mj(Bw,t.__scopeSelect),[s,i]=y.useState(!1),a=Lt(e,n.onScrollButtonChange);return jn(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?o.jsx($T,{...t,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});zT.displayName=Bw;var $T=y.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=t,i=_c("SelectScrollButton",r),a=y.useRef(null),l=M1(r),c=y.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return y.useEffect(()=>()=>c(),[c]),jn(()=>{var d;const u=l().find(h=>h.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),o.jsx(vt.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:ct(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:ct(s.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:ct(s.onPointerLeave,()=>{c()})})}),OH="SelectSeparator",BT=y.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return o.jsx(vt.div,{"aria-hidden":!0,...n,ref:e})});BT.displayName=OH;var qw="SelectArrow",MH=y.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=R1(r),i=wc(qw,r),a=_c(qw,r);return i.open&&a.position==="popper"?o.jsx(aj,{...s,...n,ref:e}):null});MH.displayName=qw;function qT(t){return t===""||t===void 0}var UT=y.forwardRef((t,e)=>{const{value:r,...n}=t,s=y.useRef(null),i=Lt(e,s),a=L1(r);return y.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==r&&d){const h=new Event("change",{bubbles:!0});d.call(l,r),l.dispatchEvent(h)}},[a,r]),o.jsx(oj,{asChild:!0,children:o.jsx("select",{...n,ref:i,defaultValue:r})})});UT.displayName="BubbleSelect";function VT(t){const e=An(t),r=y.useRef(""),n=y.useRef(0),s=y.useCallback(a=>{const l=r.current+a;e(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=y.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,i]}function WT(t,e,r){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let a=RH(t,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==r));const c=a.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function RH(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var DH=xT,HT=bT,FH=_T,IH=jT,zH=ST,GT=CT,$H=PT,YT=LT,XT=MT,BH=RT,qH=FT,KT=IT,QT=zT,JT=BT;const Ka=DH,Qa=FH,ua=y.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(HT,{ref:n,className:Be("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,o.jsx(IH,{asChild:!0,children:o.jsx($a,{className:"h-4 w-4 opacity-50"})})]}));ua.displayName=HT.displayName;const ZT=y.forwardRef(({className:t,...e},r)=>o.jsx(KT,{ref:r,className:Be("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx(Kc,{className:"h-4 w-4"})}));ZT.displayName=KT.displayName;const eL=y.forwardRef(({className:t,...e},r)=>o.jsx(QT,{ref:r,className:Be("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx($a,{className:"h-4 w-4"})}));eL.displayName=QT.displayName;const da=y.forwardRef(({className:t,children:e,position:r="popper",...n},s)=>o.jsx(zH,{children:o.jsxs(GT,{ref:s,className:Be("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[o.jsx(ZT,{}),o.jsx($H,{className:Be("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),o.jsx(eL,{})]})}));da.displayName=GT.displayName;const UH=y.forwardRef(({className:t,...e},r)=>o.jsx(YT,{ref:r,className:Be("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));UH.displayName=YT.displayName;const Ut=y.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(XT,{ref:n,className:Be("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(qH,{children:o.jsx(rc,{className:"h-4 w-4"})})}),o.jsx(BH,{children:e})]}));Ut.displayName=XT.displayName;const VH=y.forwardRef(({className:t,...e},r)=>o.jsx(JT,{ref:r,className:Be("-mx-1 my-1 h-px bg-muted",t),...e}));VH.displayName=JT.displayName;const D1=()=>{const[t,e]=y.useState(!1),{user:r}=st(),n=async(i,a="lesson_discussion_files")=>{if(!(r!=null&&r.id))throw new Error("User not authenticated");e(!0);try{const l=i.name.split(".").pop(),c=`${r.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${l}`;console.log("📤 Upload fichier:",{name:i.name,size:i.size,bucket:a,path:c});const{data:u,error:d}=await ae.storage.from(a).upload(c,i,{cacheControl:"3600",upsert:!1});if(d)throw console.error("❌ Erreur upload:",d),me.error(`Erreur upload: ${d.message}`),d;const{data:{publicUrl:h}}=ae.storage.from(a).getPublicUrl(c);return console.log("✅ Fichier uploadé:",{originalName:i.name,storagePath:c,publicUrl:h,bucket:a}),{fileUrl:h,fileName:i.name,fileType:i.type,filePath:c}}catch(l){throw console.error("❌ Erreur dans uploadFile:",l),me.error("Erreur lors de l'upload"),l}finally{e(!1)}};return{uploadFile:n,uploadExerciseFile:async i=>{console.log("📚 Upload fichier exercice vers lessons_exercises_files");try{const a=await n(i,"lessons_exercises_files");return console.log("✅ Fichier exercice uploadé:",a),a}catch(a){throw console.error("❌ Erreur upload fichier exercice:",a),a}},isUploading:t}},QN=({onFilesChange:t,existingFiles:e=[],disabled:r=!1,exerciseId:n})=>{const[s,i]=y.useState([]),[a,l]=y.useState(e),[c,u]=y.useState(!1),{uploadExerciseFile:d,isUploading:h}=D1(),f=N=>N.startsWith("image/")?"image":N.startsWith("video/")?"video":N.startsWith("audio/")?"audio":"document",m=N=>{switch(N){case"image":return o.jsx(nf,{size:16,className:"text-green-600 flex-shrink-0"});case"video":return o.jsx(Xo,{size:16,className:"text-blue-600 flex-shrink-0"});case"audio":return o.jsx(A_,{size:16,className:"text-purple-600 flex-shrink-0"});default:return o.jsx(os,{size:16,className:"text-gray-600 flex-shrink-0"})}},p=N=>{switch(N){case"image":return"bg-green-50 border-green-200";case"video":return"bg-blue-50 border-blue-200";case"audio":return"bg-purple-50 border-purple-200";default:return"bg-gray-50 border-gray-200"}},v=y.useCallback(N=>{const E=Array.from(N.target.files||[]);console.log("Fichiers sélectionnés:",E.map(A=>`${A.name} (${A.type})`));const P=E.filter(A=>{const F=A.type.startsWith("video/"),Y=F?50*1024*1024:10*1024*1024;return A.size>Y?(me.error(`${A.name} dépasse la taille limite (${F?"50MB":"10MB"})`),!1):!0});i(A=>[...A,...P])},[]),b=y.useCallback(N=>{i(E=>E.filter((P,A)=>A!==N))},[]),x=y.useCallback(N=>{const E=a.filter((P,A)=>A!==N);l(E),t(E)},[a,t]),w=y.useCallback(async()=>{if(s.length===0){me.error("Aucun fichier sélectionné");return}u(!0),console.log("Début upload vers bucket lessons_exercises_files:",s.length,"fichiers");try{const N=s.map(async F=>{console.log("Upload du fichier:",F.name,"type:",F.type,"taille:",F.size);const Y=await d(F),T=f(F.type);return console.log("Résultat upload:",Y,"catégorie:",T),{...Y,category:T}}),P=(await Promise.all(N)).map(F=>({url:F.fileUrl,type:F.fileType,name:F.fileName,category:F.category}));console.log("Tous les fichiers uploadés:",P);const A=[...a,...P];l(A),t(A),i([]),me.success(`${P.length} fichier(s) uploadé(s) avec succès`)}catch(N){console.error("Erreur lors de l'upload:",N),me.error("Erreur lors de l'upload des fichiers")}finally{u(!1)}},[s,a,t,d]),_=h||c,S=a.reduce((N,E,P)=>{const A=E.category||f(E.type);return N[A]||(N[A]=[]),N[A].push({...E,originalIndex:P}),N},{});return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Fichiers de l'exercice (supports multiples)",_&&o.jsx("span",{className:"ml-2 text-blue-600",children:"⏳ Traitement en cours..."})]}),o.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ih,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("div",{className:"mt-2",children:o.jsx(Ye,{type:"file",multiple:!0,onChange:v,disabled:r||_,className:"cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:".pdf,.doc,.docx,.txt,.png,.jpg,.jpeg,.gif,.mp4,.mov,.avi,.mp3,.wav,.xlsx,.ppt,.pptx"})}),o.jsxs("div",{className:"mt-3 text-sm text-gray-500 space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Images:"})," PNG, JPG, JPEG, GIF (max 10MB)"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Vidéos:"})," MP4, MOV, AVI (max 50MB)"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Audio:"})," MP3, WAV (max 10MB)"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Documents:"})," PDF, DOC, Excel, PowerPoint (max 10MB)"]})]})]})})]}),s.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-sm font-medium",children:"Fichiers sélectionnés :"}),o.jsx(sx,{size:16,className:"text-yellow-600"})]}),o.jsx("div",{className:"max-h-32 overflow-y-auto space-y-2 pr-2",children:s.map((N,E)=>{const P=f(N.type);return o.jsxs("div",{className:`flex items-center justify-between p-2 rounded border ${p(P)}`,children:[o.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[m(P),o.jsx("span",{className:"text-sm truncate",children:N.name}),o.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:["(",(N.size/1024/1024).toFixed(2)," MB)"]})]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>b(E),disabled:r||_,className:"flex-shrink-0",children:o.jsx(qr,{size:14})})]},E)})}),o.jsx(J,{onClick:w,disabled:r||_||s.length===0,className:"w-full bg-blue-600 hover:bg-blue-700",children:_?o.jsx(o.Fragment,{children:"⏳ Upload en cours..."}):o.jsxs(o.Fragment,{children:["📤 Uploader ",s.length," fichier(s)"]})})]}),a.length>0&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-sm font-medium",children:"Fichiers uploadés :"}),o.jsx(vc,{size:16,className:"text-green-600"})]}),Object.entries(S).map(([N,E])=>o.jsxs("div",{className:"space-y-2",children:[o.jsxs("h5",{className:"text-xs font-medium text-gray-700 capitalize flex items-center gap-1",children:[m(N),N==="image"?"Images":N==="video"?"Vidéos":N==="audio"?"Audio":"Documents"," (",E.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:E.map(P=>o.jsxs("div",{className:`flex items-center justify-between p-2 rounded border ${p(N)}`,children:[o.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[m(N),o.jsx("a",{href:P.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate",children:P.name||"Fichier"})]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>x(P.originalIndex),disabled:r,className:"flex-shrink-0",children:o.jsx(qr,{size:14})})]},P.originalIndex))})]},N))]})]})},WH=({lessonId:t,lessonTitle:e,levelTitle:r,formationTitle:n,onBack:s})=>{const[i,a]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState(null),[h,f]=y.useState([]),[m,p]=y.useState([]),v=br(),{data:b,isLoading:x}=Nt({queryKey:["exercises",t],queryFn:async()=>{const{data:T,error:O}=await ae.from("exercises").select(`
          *,
          exercise_files (
            id,
            file_url,
            file_type
          )
        `).eq("lesson_id",t).order("created_at",{ascending:!0});if(O)throw O;return T||[]}}),w=Vt({mutationFn:async T=>{console.log("Creating exercise with data:",T);const{data:O,error:U}=await ae.from("exercises").insert({title:T.title,description:T.description,content:T.content,type:T.type,lesson_id:t}).select().single();if(U)throw console.error("Error creating exercise:",U),U;if(console.log("Exercise created successfully:",O),T.files&&T.files.length>0&&O){console.log("Saving",T.files.length,"files to exercise_files table for exercise:",O.id);const q=T.files.map(Q=>({exercise_id:O.id,file_url:Q.url,file_type:Q.type}));console.log("File inserts to be made:",q);const{data:Z,error:H}=await ae.from("exercise_files").insert(q).select();H?(console.error("Error saving exercise files to database:",H),me.error("Exercice créé mais erreur lors de la sauvegarde des fichiers")):console.log("Files saved successfully to exercise_files table:",Z)}return O},onSuccess:()=>{v.invalidateQueries({queryKey:["exercises",t]}),me.success("Exercice créé avec succès"),a(!1),p([])},onError:T=>{me.error("Erreur lors de la création de l'exercice"),console.error("Create exercise error:",T)}}),_=Vt({mutationFn:async({id:T,exerciseData:O,files:U})=>{console.log("Updating exercise:",T,"with data:",O,"and files:",U);const{data:q,error:Z}=await ae.from("exercises").update(O).eq("id",T).select().single();if(Z)throw console.error("Error updating exercise:",Z),Z;if(U!==void 0){console.log("Updating files for exercise:",T);const{error:H}=await ae.from("exercise_files").delete().eq("exercise_id",T);if(H&&console.error("Error deleting old exercise files:",H),U.length>0){const Q=U.map(X=>({exercise_id:T,file_url:X.url,file_type:X.type}));console.log("Inserting new files:",Q);const{data:R,error:B}=await ae.from("exercise_files").insert(Q).select();B?(console.error("Error updating exercise files:",B),me.error("Exercice mis à jour mais erreur lors de la sauvegarde des fichiers")):console.log(`Updated ${R.length} files for exercise ${T}`)}}return q},onSuccess:()=>{v.invalidateQueries({queryKey:["exercises",t]}),me.success("Exercice mis à jour avec succès"),c(!1),d(null),f([])},onError:T=>{me.error("Erreur lors de la mise à jour de l'exercice"),console.error("Update exercise error:",T)}}),S=Vt({mutationFn:async T=>{const{error:O}=await ae.from("exercises").delete().eq("id",T);if(O)throw O},onSuccess:()=>{v.invalidateQueries({queryKey:["exercises",t]}),me.success("Exercice supprimé avec succès")},onError:T=>{me.error("Erreur lors de la suppression de l'exercice"),console.error(T)}}),N=T=>{T.preventDefault();const O=new FormData(T.currentTarget),U=O.get("title"),q=O.get("description"),Z=O.get("content"),H=O.get("type");console.log("Submitting exercise creation with files:",m),w.mutate({title:U,description:q,content:Z,type:H,files:m})},E=T=>{T.preventDefault();const O=new FormData(T.currentTarget),U=O.get("title"),q=O.get("description"),Z=O.get("content"),H=O.get("type");console.log("Submitting exercise update with files:",h),_.mutate({id:u.id,exerciseData:{title:U,description:q,content:Z,type:H},files:h})},P=T=>{var U;d(T);const O=((U=T.exercise_files)==null?void 0:U.map(q=>({url:q.file_url,type:q.file_type,name:"Fichier existant"})))||[];f(O),c(!0)},A=T=>{confirm("Êtes-vous sûr de vouloir supprimer cet exercice ?")&&S.mutate(T)};if(x)return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),o.jsx("p",{className:"text-purple-700",children:"Chargement des exercices..."})]})});const F=T=>{switch(T){case"practical":return"bg-purple-100 text-purple-800";case"quiz":return"bg-orange-100 text-orange-800";case"assignment":return"bg-blue-100 text-blue-800";case"project":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Y=T=>{switch(T){case"practical":return o.jsx(os,{size:12});case"quiz":return o.jsx(LP,{size:12});default:return o.jsx(os,{size:12})}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50",children:o.jsx(ko,{className:"h-screen",children:o.jsxs("div",{className:"p-3 sm:p-4 md:p-6 pb-20 md:pb-6",children:[o.jsxs(Mt,{className:"shadow-lg border-0",children:[o.jsx(er,{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-t-lg p-4 sm:p-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:s,className:"text-white hover:bg-white/20 flex-shrink-0",children:o.jsx(Za,{size:16})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx(ur,{className:"text-lg sm:text-xl truncate",children:"Exercices de la leçon"}),o.jsxs("p",{className:"text-purple-100 text-xs sm:text-sm mt-1 truncate",children:[n," → ",r," → ",e]})]})]}),o.jsxs(Br,{open:i,onOpenChange:a,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-white text-purple-600 hover:bg-purple-50 flex-shrink-0",children:[o.jsx(ls,{size:16,className:"mr-2"}),o.jsx("span",{className:"hidden sm:inline",children:"Nouvel exercice"}),o.jsx("span",{className:"sm:hidden",children:"Nouveau"})]})}),o.jsxs(Or,{className:"max-w-md sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer un nouvel exercice"})}),o.jsx(ko,{className:"max-h-[70vh] pr-4",children:o.jsxs("form",{onSubmit:N,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),o.jsxs(Ka,{name:"type",defaultValue:"practical",children:[o.jsx(ua,{children:o.jsx(Qa,{})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"practical",children:"Exercice pratique"}),o.jsx(Ut,{value:"quiz",children:"Quiz"}),o.jsx(Ut,{value:"assignment",children:"Devoir"}),o.jsx(Ut,{value:"project",children:"Projet"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contenu/Instructions"}),o.jsx(jr,{name:"content",rows:6,required:!0})]}),o.jsx("div",{children:o.jsx(QN,{onFilesChange:p,existingFiles:m,disabled:w.isPending})}),o.jsx(J,{type:"submit",className:"w-full",disabled:w.isPending,children:w.isPending?"Création...":"Créer l'exercice"})]})})]})]})]})}),o.jsx(Rt,{className:"p-0",children:o.jsx(ko,{className:"h-[calc(100vh-300px)]",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{className:"bg-gray-50",children:[o.jsx($t,{className:"font-semibold",children:"Titre"}),o.jsx($t,{className:"font-semibold",children:"Type"}),o.jsx($t,{className:"font-semibold hidden sm:table-cell",children:"Description"}),o.jsx($t,{className:"font-semibold hidden md:table-cell",children:"Fichiers"}),o.jsx($t,{className:"font-semibold",children:"Actions"})]})}),o.jsx(Mu,{children:b==null?void 0:b.map((T,O)=>o.jsxs(ti,{className:`transition-colors hover:bg-purple-50 ${O%2===0?"bg-white":"bg-slate-50"}`,children:[o.jsx(Bt,{className:"font-medium text-gray-900",children:o.jsx("span",{className:"truncate block max-w-[150px] sm:max-w-none",children:T.title})}),o.jsx(Bt,{children:o.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 w-fit ${F(T.type||"practical")}`,children:[Y(T.type||"practical"),o.jsx("span",{className:"hidden sm:inline",children:T.type||"Exercice"})]})}),o.jsx(Bt,{className:"text-gray-600 hidden sm:table-cell",children:o.jsx("span",{className:"truncate block max-w-[200px]",children:T.description})}),o.jsx(Bt,{className:"hidden md:table-cell",children:T.exercise_files&&T.exercise_files.length>0?o.jsxs("span",{className:"text-sm text-blue-600",children:[T.exercise_files.length," fichier(s)"]}):o.jsx("span",{className:"text-sm text-gray-400",children:"Aucun fichier"})}),o.jsx(Bt,{children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[o.jsx(J,{size:"sm",variant:"outline",className:"text-gray-600 hover:bg-gray-50 text-xs",onClick:()=>P(T),children:o.jsx(Pu,{size:12})}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>A(T.id),className:"text-red-600 border-red-200 hover:bg-red-50 text-xs",children:o.jsx(cs,{size:12})})]})})]},T.id))})]})})})})]}),o.jsx(Br,{open:l,onOpenChange:c,children:o.jsxs(Or,{className:"max-w-md sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Modifier l'exercice"})}),u&&o.jsx(ko,{className:"max-h-[70vh] pr-4",children:o.jsxs("form",{onSubmit:E,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",defaultValue:u.title,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description",defaultValue:u.description})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),o.jsxs(Ka,{name:"type",defaultValue:u.type||"practical",children:[o.jsx(ua,{children:o.jsx(Qa,{})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"practical",children:"Exercice pratique"}),o.jsx(Ut,{value:"quiz",children:"Quiz"}),o.jsx(Ut,{value:"assignment",children:"Devoir"}),o.jsx(Ut,{value:"project",children:"Projet"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Contenu/Instructions"}),o.jsx(jr,{name:"content",rows:6,defaultValue:u.content,required:!0})]}),o.jsx("div",{children:o.jsx(QN,{onFilesChange:f,existingFiles:h,disabled:_.isPending})}),o.jsx(J,{type:"submit",className:"w-full",disabled:_.isPending,children:_.isPending?"Mise à jour...":"Mettre à jour l'exercice"})]})})]})})]})})})},HH=({levelId:t,levelTitle:e,formationTitle:r,onBack:n})=>{const[s,i]=y.useState(null),[a,l]=y.useState(!1),[c,u]=y.useState(!1),[d,h]=y.useState(null),f=br(),{data:m,isLoading:p}=Nt({queryKey:["lessons",t],queryFn:async()=>{const{data:E,error:P}=await ae.from("lessons").select("*").eq("level_id",t).order("order_index",{ascending:!0});if(P)throw P;return E||[]}}),v=Vt({mutationFn:async E=>{const{data:P,error:A}=await ae.from("lessons").insert({...E,level_id:t}).select().single();if(A)throw A;return P},onSuccess:()=>{f.invalidateQueries({queryKey:["lessons",t]}),me.success("Leçon créée avec succès"),l(!1)},onError:E=>{me.error("Erreur lors de la création de la leçon"),console.error(E)}}),b=Vt({mutationFn:async({id:E,lessonData:P})=>{const{data:A,error:F}=await ae.from("lessons").update(P).eq("id",E).select().single();if(F)throw F;return A},onSuccess:()=>{f.invalidateQueries({queryKey:["lessons",t]}),me.success("Leçon mise à jour avec succès"),u(!1),h(null)},onError:E=>{me.error("Erreur lors de la mise à jour de la leçon"),console.error(E)}}),x=Vt({mutationFn:async E=>{const{error:P}=await ae.from("lessons").delete().eq("id",E);if(P)throw P},onSuccess:()=>{f.invalidateQueries({queryKey:["lessons",t]}),me.success("Leçon supprimée avec succès")},onError:E=>{me.error("Erreur lors de la suppression de la leçon"),console.error(E)}}),w=E=>{E.preventDefault();const P=new FormData(E.currentTarget),A=P.get("title"),F=P.get("description"),Y=parseInt(P.get("order_index"))||1,T=P.get("video_url"),O=P.get("duration");v.mutate({title:A,description:F,order_index:Y,video_url:T,duration:O})},_=E=>{E.preventDefault();const P=new FormData(E.currentTarget),A=P.get("title"),F=P.get("description"),Y=parseInt(P.get("order_index"))||1,T=P.get("video_url"),O=P.get("duration");b.mutate({id:d.id,lessonData:{title:A,description:F,order_index:Y,video_url:T,duration:O}})},S=E=>{h(E),u(!0)},N=E=>{confirm("Êtes-vous sûr de vouloir supprimer cette leçon ?")&&x.mutate(E)};return s?o.jsx(WH,{lessonId:s.id,lessonTitle:s.title,levelTitle:e,formationTitle:r,onBack:()=>i(null)}):p?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),o.jsx("p",{className:"text-green-700",children:"Chargement des leçons..."})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-50",children:o.jsx(ko,{className:"h-screen",children:o.jsxs("div",{className:"p-3 sm:p-4 md:p-6 pb-20 md:pb-6",children:[o.jsxs(Mt,{className:"shadow-lg border-0",children:[o.jsx(er,{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-t-lg p-4 sm:p-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:n,className:"text-white hover:bg-white/20 flex-shrink-0",children:o.jsx(Za,{size:16})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx(ur,{className:"text-lg sm:text-xl truncate",children:"Leçons du niveau"}),o.jsxs("p",{className:"text-green-100 text-xs sm:text-sm mt-1 truncate",children:[r," → ",e]})]})]}),o.jsxs(Br,{open:a,onOpenChange:l,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-white text-green-600 hover:bg-green-50 flex-shrink-0",children:[o.jsx(ls,{size:16,className:"mr-2"}),o.jsx("span",{className:"hidden sm:inline",children:"Nouvelle leçon"}),o.jsx("span",{className:"sm:hidden",children:"Nouveau"})]})}),o.jsxs(Or,{className:"max-w-md sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer une nouvelle leçon"})}),o.jsxs("form",{onSubmit:w,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Numéro d'ordre"}),o.jsx(Ye,{name:"order_index",type:"number",min:"1",defaultValue:"1",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL de la vidéo"}),o.jsx(Ye,{name:"video_url",type:"url"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Durée"}),o.jsx(Ye,{name:"duration",placeholder:"ex: 30 min"})]}),o.jsx(J,{type:"submit",className:"w-full",disabled:v.isPending,children:v.isPending?"Création...":"Créer la leçon"})]})]})]})]})}),o.jsx(Rt,{className:"p-0",children:o.jsx(ko,{className:"h-[calc(100vh-300px)]",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{className:"bg-gray-50",children:[o.jsx($t,{className:"font-semibold",children:"Ordre"}),o.jsx($t,{className:"font-semibold",children:"Titre"}),o.jsx($t,{className:"font-semibold hidden sm:table-cell",children:"Description"}),o.jsx($t,{className:"font-semibold hidden md:table-cell",children:"Durée"}),o.jsx($t,{className:"font-semibold",children:"Actions"})]})}),o.jsx(Mu,{children:m==null?void 0:m.map((E,P)=>o.jsxs(ti,{className:`transition-colors hover:bg-green-50 ${P%2===0?"bg-white":"bg-slate-50"}`,children:[o.jsx(Bt,{children:o.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm font-medium",children:E.order_index})}),o.jsx(Bt,{className:"font-medium text-gray-900",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[E.video_url&&o.jsx(oa,{size:16,className:"text-green-600 flex-shrink-0"}),o.jsx("span",{className:"truncate max-w-[150px] sm:max-w-none",children:E.title})]})}),o.jsx(Bt,{className:"text-gray-600 hidden sm:table-cell",children:o.jsx("span",{className:"truncate block max-w-[200px]",children:E.description})}),o.jsx(Bt,{className:"hidden md:table-cell",children:E.duration&&o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:E.duration})}),o.jsx(Bt,{children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[o.jsxs(J,{size:"sm",variant:"outline",onClick:()=>i({id:E.id,title:E.title}),className:"text-green-600 border-green-200 hover:bg-green-50 text-xs",children:[o.jsx(os,{size:12,className:"mr-1"}),o.jsx("span",{className:"hidden sm:inline",children:"Exercices"}),o.jsx("span",{className:"sm:hidden",children:"Ex."})]}),o.jsx(J,{size:"sm",variant:"outline",className:"text-gray-600 hover:bg-gray-50",onClick:()=>S(E),children:o.jsx(Pu,{size:12})}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>N(E.id),className:"text-red-600 border-red-200 hover:bg-red-50",children:o.jsx(cs,{size:12})})]})})]},E.id))})]})})})})]}),o.jsx(Br,{open:c,onOpenChange:u,children:o.jsxs(Or,{className:"max-w-md sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Modifier la leçon"})}),d&&o.jsxs("form",{onSubmit:_,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",defaultValue:d.title,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description",defaultValue:d.description})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Numéro d'ordre"}),o.jsx(Ye,{name:"order_index",type:"number",min:"1",defaultValue:d.order_index,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL de la vidéo"}),o.jsx(Ye,{name:"video_url",type:"url",defaultValue:d.video_url})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Durée"}),o.jsx(Ye,{name:"duration",placeholder:"ex: 30 min",defaultValue:d.duration})]}),o.jsx(J,{type:"submit",className:"w-full",disabled:b.isPending,children:b.isPending?"Mise à jour...":"Mettre à jour la leçon"})]})]})})]})})})},GH=({formationId:t,formationTitle:e,onBack:r})=>{const[n,s]=y.useState(null),[i,a]=y.useState(!1),[l,c]=y.useState(!1),[u,d]=y.useState(null),h=br(),{data:f,isLoading:m}=Nt({queryKey:["levels",t],queryFn:async()=>{const{data:N,error:E}=await ae.from("levels").select("*").eq("formation_id",t).order("order_index",{ascending:!0});if(E)throw E;return N||[]}}),p=Vt({mutationFn:async N=>{const{data:E,error:P}=await ae.from("levels").insert({...N,formation_id:t}).select().single();if(P)throw P;return E},onSuccess:()=>{h.invalidateQueries({queryKey:["levels",t]}),me.success("Niveau créé avec succès"),a(!1)},onError:N=>{me.error("Erreur lors de la création du niveau"),console.error(N)}}),v=Vt({mutationFn:async({id:N,levelData:E})=>{const{data:P,error:A}=await ae.from("levels").update(E).eq("id",N).select().single();if(A)throw A;return P},onSuccess:()=>{h.invalidateQueries({queryKey:["levels",t]}),me.success("Niveau mis à jour avec succès"),c(!1),d(null)},onError:N=>{me.error("Erreur lors de la mise à jour du niveau"),console.error(N)}}),b=Vt({mutationFn:async N=>{const{error:E}=await ae.from("levels").delete().eq("id",N);if(E)throw E},onSuccess:()=>{h.invalidateQueries({queryKey:["levels",t]}),me.success("Niveau supprimé avec succès")},onError:N=>{me.error("Erreur lors de la suppression du niveau"),console.error(N)}}),x=N=>{N.preventDefault();const E=new FormData(N.currentTarget),P=E.get("title"),A=E.get("description"),F=parseInt(E.get("order_index"))||1;p.mutate({title:P,description:A,order_index:F})},w=N=>{N.preventDefault();const E=new FormData(N.currentTarget),P=E.get("title"),A=E.get("description"),F=parseInt(E.get("order_index"))||1;v.mutate({id:u.id,levelData:{title:P,description:A,order_index:F}})},_=N=>{d(N),c(!0)},S=N=>{confirm("Êtes-vous sûr de vouloir supprimer ce niveau ?")&&b.mutate(N)};return n?o.jsx(HH,{levelId:n.id,levelTitle:n.title,formationTitle:e,onBack:()=>s(null)}):m?o.jsx("div",{className:"text-center py-8",children:"Chargement des niveaux..."}):o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen p-6",children:[o.jsxs(Mt,{className:"shadow-lg border-0",children:[o.jsx(er,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-t-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:r,className:"text-white hover:bg-white/20",children:o.jsx(Za,{size:16})}),o.jsxs("div",{children:[o.jsx(ur,{className:"text-xl",children:"Niveaux de la formation"}),o.jsx("p",{className:"text-blue-100 text-sm mt-1",children:e})]})]}),o.jsxs(Br,{open:i,onOpenChange:a,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-white text-blue-600 hover:bg-blue-50",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Nouveau niveau"]})}),o.jsxs(Or,{children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer un nouveau niveau"})}),o.jsxs("form",{onSubmit:x,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Numéro d'ordre"}),o.jsx(Ye,{name:"order_index",type:"number",min:"1",defaultValue:"1",required:!0})]}),o.jsx(J,{type:"submit",className:"w-full",disabled:p.isPending,children:p.isPending?"Création...":"Créer le niveau"})]})]})]})]})}),o.jsx(Rt,{className:"p-0",children:o.jsx("div",{className:"overflow-hidden",children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{className:"bg-gray-50",children:[o.jsx($t,{className:"font-semibold",children:"Ordre"}),o.jsx($t,{className:"font-semibold",children:"Titre"}),o.jsx($t,{className:"font-semibold",children:"Description"}),o.jsx($t,{className:"font-semibold",children:"Actions"})]})}),o.jsx(Mu,{children:f==null?void 0:f.map((N,E)=>o.jsxs(ti,{className:`transition-colors hover:bg-blue-50 ${E%2===0?"bg-white":"bg-slate-50"}`,children:[o.jsx(Bt,{children:o.jsx("div",{className:"flex items-center",children:o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium",children:N.order_index})})}),o.jsx(Bt,{className:"font-medium text-gray-900",children:N.title}),o.jsx(Bt,{className:"text-gray-600",children:N.description}),o.jsx(Bt,{children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{size:"sm",variant:"outline",onClick:()=>s({id:N.id,title:N.title}),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[o.jsx($o,{size:14,className:"mr-1"}),"Leçons"]}),o.jsx(J,{size:"sm",variant:"outline",className:"text-gray-600 hover:bg-gray-50",onClick:()=>_(N),children:o.jsx(Pu,{size:14})}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>S(N.id),className:"text-red-600 border-red-200 hover:bg-red-50",children:o.jsx(cs,{size:14})})]})})]},N.id))})]})})})]}),o.jsx(Br,{open:l,onOpenChange:c,children:o.jsxs(Or,{children:[o.jsx(hn,{children:o.jsx(fn,{children:"Modifier le niveau"})}),u&&o.jsxs("form",{onSubmit:w,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),o.jsx(Ye,{name:"title",defaultValue:u.title,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description",defaultValue:u.description})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Numéro d'ordre"}),o.jsx(Ye,{name:"order_index",type:"number",min:"1",defaultValue:u.order_index,required:!0})]}),o.jsx(J,{type:"submit",className:"w-full",disabled:v.isPending,children:v.isPending?"Mise à jour...":"Mettre à jour le niveau"})]})]})})]})};var pj="Switch",[YH,Jne]=Ko(pj),[XH,KH]=YH(pj),tL=y.forwardRef((t,e)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:i,required:a,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=y.useState(null),p=Lt(e,_=>m(_)),v=y.useRef(!1),b=f?d||!!f.closest("form"):!0,[x=!1,w]=ic({prop:s,defaultProp:i,onChange:u});return o.jsxs(XH,{scope:r,checked:x,disabled:l,children:[o.jsx(vt.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":sL(x),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:p,onClick:ct(t.onClick,_=>{w(S=>!S),b&&(v.current=_.isPropagationStopped(),v.current||_.stopPropagation())})}),b&&o.jsx(QH,{control:f,bubbles:!v.current,name:n,value:c,checked:x,required:a,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});tL.displayName=pj;var rL="SwitchThumb",nL=y.forwardRef((t,e)=>{const{__scopeSwitch:r,...n}=t,s=KH(rL,r);return o.jsx(vt.span,{"data-state":sL(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:e})});nL.displayName=rL;var QH=t=>{const{control:e,checked:r,bubbles:n=!0,...s}=t,i=y.useRef(null),a=L1(r),l=S1(e);return y.useEffect(()=>{const c=i.current,u=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(u,"checked").set;if(a!==r&&h){const f=new Event("click",{bubbles:n});h.call(c,r),c.dispatchEvent(f)}},[a,r,n]),o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:i,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function sL(t){return t?"checked":"unchecked"}var iL=tL,JH=nL;const Ud=y.forwardRef(({className:t,...e},r)=>o.jsx(iL,{className:Be("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:r,children:o.jsx(JH,{className:Be("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ud.displayName=iL.displayName;const ZH=()=>Nt({queryKey:["lesson-videos"],queryFn:async()=>{const{data:t,error:e}=await ae.from("videos").select(`
          id,
          title,
          video_url,
          thumbnail_url,
          profiles:author_id (
            first_name,
            last_name,
            username
          )
        `).eq("video_type","lesson").eq("is_active",!0).order("created_at",{ascending:!1});return e?(console.error("Error fetching lesson videos:",e),[]):t||[]}}),eG=({onVideoSelect:t,currentVideoUrl:e})=>{const[r,n]=y.useState(!1),[s,i]=y.useState(""),[a,l]=y.useState(""),{data:c,isLoading:u}=ZH(),d=()=>{const f=c==null?void 0:c.find(m=>m.id===a);f!=null&&f.video_url&&(t(f.video_url),n(!1),l(""))},h=()=>{s.trim()&&(t(s.trim()),n(!1),i(""))};return o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"URL de la vidéo"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Ye,{value:e||"",onChange:f=>t(f.target.value),placeholder:"URL de la vidéo",className:"flex-1"}),o.jsxs(Br,{open:r,onOpenChange:n,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{type:"button",variant:"outline",size:"sm",children:[o.jsx(Xo,{size:16,className:"mr-1"}),"Choisir"]})}),o.jsxs(Or,{className:"max-w-md",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Sélectionner une vidéo"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Choisir depuis les vidéos existantes"}),o.jsxs(Ka,{value:a,onValueChange:l,children:[o.jsx(ua,{children:o.jsx(Qa,{placeholder:"Sélectionner une vidéo"})}),o.jsx(da,{children:u?o.jsx(Ut,{value:"loading",disabled:!0,children:"Chargement..."}):c==null?void 0:c.map(f=>{var m,p;return o.jsxs(Ut,{value:f.id,children:[f.title," - ",(m=f.profiles)==null?void 0:m.first_name," ",(p=f.profiles)==null?void 0:p.last_name]},f.id)})})]}),o.jsx(J,{onClick:d,disabled:!a,className:"w-full",children:"Utiliser cette vidéo"})]}),o.jsx("div",{className:"text-center text-sm text-gray-500",children:"ou"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Insérer une URL manuellement"}),o.jsx(Ye,{value:s,onChange:f=>i(f.target.value),placeholder:"https://..."}),o.jsxs(J,{onClick:h,disabled:!s.trim(),className:"w-full",variant:"outline",children:[o.jsx(FP,{size:16,className:"mr-1"}),"Utiliser cette URL"]})]})]})]})]})]})]})},tG=t=>{const[e,r]=y.useState([]),[n,s]=y.useState(!1);y.useEffect(()=>{t&&i(t)},[t]);const i=async l=>{s(!0);try{const{data:c,error:u}=await ae.from("exercise_files").select("*").eq("exercise_id",l);if(u)throw u;const d=(c==null?void 0:c.map(h=>({id:h.id,exercise_id:h.exercise_id,file_url:h.file_url,file_type:h.file_type,file_name:h.file_url.split("/").pop()||"Fichier"})))||[];r(d)}catch(c){console.error("Erreur lors du chargement des fichiers:",c),me.error("Erreur lors du chargement des fichiers")}finally{s(!1)}};return{files:e,isLoading:n,saveExerciseFiles:async(l,c)=>{try{if(await ae.from("exercise_files").delete().eq("exercise_id",l),c.length>0){const{error:u}=await ae.from("exercise_files").insert(c.map(d=>({exercise_id:l,file_url:d.url,file_type:d.type})));if(u)throw u}await i(l),me.success("Fichiers sauvegardés avec succès")}catch(u){throw console.error("Erreur lors de la sauvegarde des fichiers:",u),me.error("Erreur lors de la sauvegarde des fichiers"),u}},loadExerciseFiles:i}},rG=({exerciseId:t,onFilesChange:e,disabled:r=!1})=>{const[n,s]=y.useState([]),[i,a]=y.useState([]),[l,c]=y.useState(!1),{uploadExerciseFile:u,isUploading:d}=D1(),{saveExerciseFiles:h}=tG(t),f=y.useCallback(x=>{const w=Array.from(x.target.files||[]);console.log("Fichiers sélectionnés:",w.map(_=>_.name)),s(_=>[..._,...w])},[]),m=y.useCallback(x=>{s(w=>w.filter((_,S)=>S!==x))},[]),p=y.useCallback(x=>{const w=i.filter((_,S)=>S!==x);a(w),e(w)},[i,e]),v=y.useCallback(async()=>{if(n.length===0){me.error("Aucun fichier sélectionné");return}c(!0),console.log("Début upload vers bucket lessons_exercises_files:",n.length,"fichiers");try{const x=n.map(async N=>{console.log("Upload du fichier:",N.name,"taille:",N.size);const E=await u(N);return console.log("Résultat upload:",E),E}),_=(await Promise.all(x)).map(N=>({url:N.fileUrl,type:N.fileType,name:N.fileName}));console.log("Tous les fichiers uploadés:",_);const S=[...i,..._];a(S),e(S),s([]),t&&(console.log("Sauvegarde en base pour exercice:",t),await h(t,S)),me.success(`${_.length} fichier(s) uploadé(s) avec succès`)}catch(x){console.error("Erreur lors de l'upload:",x),me.error("Erreur lors de l'upload des fichiers")}finally{c(!1)}},[n,i,e,t,u,h]),b=d||l;return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Fichiers de l'exercice",b&&o.jsx("span",{className:"ml-2 text-blue-600",children:"⏳ Traitement en cours..."})]}),o.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ih,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("div",{className:"mt-2",children:o.jsx(Ye,{type:"file",multiple:!0,onChange:f,disabled:r||b,className:"cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:".pdf,.doc,.docx,.txt,.png,.jpg,.jpeg,.xlsx,.ppt,.pptx"})}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"PDF, DOC, images, Excel, PowerPoint (max 10MB par fichier)"})]})})]}),n.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-sm font-medium",children:"Fichiers sélectionnés :"}),o.jsx(sx,{size:16,className:"text-yellow-600"})]}),o.jsx("div",{className:"max-h-32 overflow-y-auto space-y-2 pr-2",children:n.map((x,w)=>o.jsxs("div",{className:"flex items-center justify-between bg-yellow-50 p-2 rounded border border-yellow-200",children:[o.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[o.jsx(xw,{size:16,className:"text-yellow-600 flex-shrink-0"}),o.jsx("span",{className:"text-sm truncate",children:x.name}),o.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:["(",(x.size/1024/1024).toFixed(2)," MB)"]})]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>m(w),disabled:r||b,className:"flex-shrink-0",children:o.jsx(qr,{size:14})})]},w))}),o.jsx(J,{onClick:v,disabled:r||b||n.length===0,className:"w-full bg-blue-600 hover:bg-blue-700",children:b?o.jsx(o.Fragment,{children:"⏳ Upload en cours..."}):o.jsxs(o.Fragment,{children:["📤 Uploader ",n.length," fichier(s)"]})})]}),i.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"text-sm font-medium",children:"Fichiers uploadés :"}),o.jsx(vc,{size:16,className:"text-green-600"})]}),o.jsx("div",{className:"max-h-32 overflow-y-auto space-y-2 pr-2",children:i.map((x,w)=>o.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-2 rounded border border-green-200",children:[o.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[o.jsx(xw,{size:16,className:"text-green-600 flex-shrink-0"}),o.jsx("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate",children:x.name||"Fichier"})]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>p(w),disabled:r,className:"flex-shrink-0",children:o.jsx(qr,{size:14})})]},w))})]})]})},nG=t=>(console.log("⚠️ ExerciseFileUploader est déprécié, utilisez ExerciseFileManager"),o.jsx(rG,{exerciseId:t.exerciseId,onFilesChange:t.onFilesUploaded,disabled:t.disabled})),JN=({onSubmit:t,isLoading:e,initialData:r,isEditing:n=!1,formationId:s,onConfigurePricing:i})=>{const[a,l]=y.useState({title:"",description:"",badge:"",duration:0,price:0,originalPrice:0,promoVideoUrl:"",thumbnailUrl:"",isActive:!0,levels:[{title:"",description:"",orderIndex:0,lessons:[{title:"",description:"",videoUrl:"",duration:"",orderIndex:0,exercises:[]}]}]});y.useEffect(()=>{r&&n&&l(_=>({..._,title:r.title||"",description:r.description||"",badge:r.badge||"",duration:r.duration||0,price:r.price||0,originalPrice:r.originalPrice||0,promoVideoUrl:r.promoVideoUrl||"",thumbnailUrl:r.thumbnailUrl||"",isActive:r.isActive!==void 0?r.isActive:!0,levels:r.levels||_.levels}))},[r,n]);const c=()=>{l(_=>({..._,levels:[..._.levels,{title:"",description:"",orderIndex:_.levels.length,lessons:[{title:"",description:"",videoUrl:"",duration:"",orderIndex:0,exercises:[]}]}]}))},u=_=>{l(S=>({...S,levels:S.levels.filter((N,E)=>E!==_)}))},d=(_,S,N)=>{l(E=>({...E,levels:E.levels.map((P,A)=>A===_?{...P,[S]:N}:P)}))},h=_=>{l(S=>({...S,levels:S.levels.map((N,E)=>E===_?{...N,lessons:[...N.lessons,{title:"",description:"",videoUrl:"",duration:"",orderIndex:N.lessons.length,exercises:[]}]}:N)}))},f=(_,S)=>{l(N=>({...N,levels:N.levels.map((E,P)=>P===_?{...E,lessons:E.lessons.filter((A,F)=>F!==S)}:E)}))},m=(_,S,N,E)=>{l(P=>({...P,levels:P.levels.map((A,F)=>F===_?{...A,lessons:A.lessons.map((Y,T)=>T===S?{...Y,[N]:E}:Y)}:A)}))},p=(_,S)=>{l(N=>({...N,levels:N.levels.map((E,P)=>P===_?{...E,lessons:E.lessons.map((A,F)=>F===S?{...A,exercises:[...A.exercises,{title:"",description:"",type:"text",content:"",uploadedFiles:[]}]}:A)}:E)}))},v=(_,S,N)=>{l(E=>({...E,levels:E.levels.map((P,A)=>A===_?{...P,lessons:P.lessons.map((F,Y)=>Y===S?{...F,exercises:F.exercises.filter((T,O)=>O!==N)}:F)}:P)}))},b=(_,S,N,E,P)=>{l(A=>({...A,levels:A.levels.map((F,Y)=>Y===_?{...F,lessons:F.lessons.map((T,O)=>O===S?{...T,exercises:T.exercises.map((U,q)=>q===N?{...U,[E]:P}:U)}:T)}:F)}))},x=(_,S,N,E)=>{b(_,S,N,"uploadedFiles",E)},w=_=>{_.preventDefault(),t(a)};return o.jsxs("form",{onSubmit:w,className:"space-y-6",children:[o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsx(ur,{children:"Informations de la formation"})}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{children:"Titre"}),o.jsx(Ye,{value:a.title,onChange:_=>l(S=>({...S,title:_.target.value})),placeholder:"Titre de la formation",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Badge"}),o.jsx(Ye,{value:a.badge,onChange:_=>l(S=>({...S,badge:_.target.value})),placeholder:"Badge de la formation"})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Description"}),o.jsx(jr,{value:a.description,onChange:_=>l(S=>({...S,description:_.target.value})),placeholder:"Description de la formation",rows:3})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{children:"Durée (heures)"}),o.jsx(Ye,{type:"number",value:a.duration,onChange:_=>l(S=>({...S,duration:parseInt(_.target.value)||0})),placeholder:"0",min:"0"})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Prix actuel (€)"}),o.jsx(Ye,{type:"number",step:"0.01",value:a.price,onChange:_=>l(S=>({...S,price:parseFloat(_.target.value)||0})),placeholder:"0.00",min:"0"})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Prix original (€)"}),o.jsx(Ye,{type:"number",step:"0.01",value:a.originalPrice,onChange:_=>l(S=>({...S,originalPrice:parseFloat(_.target.value)||0})),placeholder:"0.00",min:"0"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{children:"URL de la vidéo promotionnelle"}),o.jsx(Ye,{value:a.promoVideoUrl,onChange:_=>l(S=>({...S,promoVideoUrl:_.target.value})),placeholder:"https://..."})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"URL de la miniature"}),o.jsx(Ye,{value:a.thumbnailUrl,onChange:_=>l(S=>({...S,thumbnailUrl:_.target.value})),placeholder:"https://..."})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ud,{checked:a.isActive,onCheckedChange:_=>l(S=>({...S,isActive:_}))}),o.jsx(Ke,{children:"Formation active"})]})]})]}),a.levels.map((_,S)=>o.jsxs(Mt,{children:[o.jsxs(er,{className:"flex flex-row items-center justify-between",children:[o.jsxs(ur,{children:["Niveau ",S+1]}),a.levels.length>1&&o.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>u(S),children:o.jsx(cs,{size:16})})]}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.jsxs("div",{children:[o.jsx(Ke,{children:"Titre du niveau"}),o.jsx(Ye,{value:_.title,onChange:N=>d(S,"title",N.target.value),placeholder:"Titre du niveau",required:!0})]})}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Description du niveau"}),o.jsx(jr,{value:_.description,onChange:N=>d(S,"description",N.target.value),placeholder:"Description du niveau",rows:2})]}),_.lessons.map((N,E)=>o.jsxs(Mt,{className:"ml-4",children:[o.jsxs(er,{className:"flex flex-row items-center justify-between",children:[o.jsxs(ur,{className:"text-lg",children:["Leçon ",E+1]}),_.lessons.length>1&&o.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>f(S,E),children:o.jsx(cs,{size:16})})]}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{children:"Titre de la leçon"}),o.jsx(Ye,{value:N.title,onChange:P=>m(S,E,"title",P.target.value),placeholder:"Titre de la leçon",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Durée"}),o.jsx(Ye,{value:N.duration,onChange:P=>m(S,E,"duration",P.target.value),placeholder:"ex: 15 min"})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Description de la leçon"}),o.jsx(jr,{value:N.description,onChange:P=>m(S,E,"description",P.target.value),placeholder:"Description de la leçon",rows:2})]}),o.jsx(eG,{currentVideoUrl:N.videoUrl,onVideoSelect:P=>m(S,E,"videoUrl",P)}),N.exercises.map((P,A)=>o.jsxs(Mt,{className:"ml-4 bg-gray-50",children:[o.jsxs(er,{className:"flex flex-row items-center justify-between",children:[o.jsxs(ur,{className:"text-base",children:["Exercice ",A+1]}),o.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>v(S,E,A),children:o.jsx(cs,{size:16})})]}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{children:"Titre de l'exercice"}),o.jsx(Ye,{value:P.title,onChange:F=>b(S,E,A,"title",F.target.value),placeholder:"Titre de l'exercice",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Type"}),o.jsx(Ye,{value:P.type,onChange:F=>b(S,E,A,"type",F.target.value),placeholder:"text, image, video, etc."})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Description"}),o.jsx(jr,{value:P.description,onChange:F=>b(S,E,A,"description",F.target.value),placeholder:"Description de l'exercice",rows:2})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Contenu"}),o.jsx(jr,{value:P.content,onChange:F=>b(S,E,A,"content",F.target.value),placeholder:"Contenu de l'exercice (consignes, questions, etc.)",rows:3})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Fichiers joints"}),o.jsx(nG,{onFilesUploaded:F=>x(S,E,A,F),existingFiles:P.uploadedFiles||[],disabled:e})]})]})]},A)),o.jsxs(J,{type:"button",variant:"outline",onClick:()=>p(S,E),className:"ml-4",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Ajouter un exercice"]})]})]},E)),o.jsxs(J,{type:"button",variant:"outline",onClick:()=>h(S),className:"ml-4",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Ajouter une leçon"]})]})]},S)),o.jsxs(J,{type:"button",variant:"outline",onClick:c,children:[o.jsx(ls,{size:16,className:"mr-2"}),"Ajouter un niveau"]}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx(J,{type:"submit",disabled:e,className:"w-full bg-[#25d366] hover:bg-[#25d366]/90",children:e?"Traitement...":n?"Mettre à jour la formation":"Créer la formation complète"}),(s||n)&&i&&o.jsx(J,{type:"button",variant:"outline",onClick:()=>i(s),className:"w-full",children:"💳 Configurer les tarifs d'abonnement"})]})]})};var gj="Checkbox",[sG,Zne]=Ko(gj),[iG,aG]=sG(gj),aL=y.forwardRef((t,e)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:i,required:a,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=y.useState(null),p=Lt(e,S=>m(S)),v=y.useRef(!1),b=f?d||!!f.closest("form"):!0,[x=!1,w]=ic({prop:s,defaultProp:i,onChange:u}),_=y.useRef(x);return y.useEffect(()=>{const S=f==null?void 0:f.form;if(S){const N=()=>w(_.current);return S.addEventListener("reset",N),()=>S.removeEventListener("reset",N)}},[f,w]),o.jsxs(iG,{scope:r,state:x,disabled:l,children:[o.jsx(vt.button,{type:"button",role:"checkbox","aria-checked":Jl(x)?"mixed":x,"aria-required":a,"data-state":cL(x),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:p,onKeyDown:ct(t.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:ct(t.onClick,S=>{w(N=>Jl(N)?!0:!N),b&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})}),b&&o.jsx(oG,{control:f,bubbles:!v.current,name:n,value:c,checked:x,required:a,disabled:l,form:d,style:{transform:"translateX(-100%)"},defaultChecked:Jl(i)?!1:i})]})});aL.displayName=gj;var oL="CheckboxIndicator",lL=y.forwardRef((t,e)=>{const{__scopeCheckbox:r,forceMount:n,...s}=t,i=aG(oL,r);return o.jsx(ki,{present:n||Jl(i.state)||i.state===!0,children:o.jsx(vt.span,{"data-state":cL(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});lL.displayName=oL;var oG=t=>{const{control:e,checked:r,bubbles:n=!0,defaultChecked:s,...i}=t,a=y.useRef(null),l=L1(r),c=S1(e);y.useEffect(()=>{const d=a.current,h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==r&&m){const p=new Event("click",{bubbles:n});d.indeterminate=Jl(r),m.call(d,Jl(r)?!1:r),d.dispatchEvent(p)}},[l,r,n]);const u=y.useRef(Jl(r)?!1:r);return o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??u.current,...i,tabIndex:-1,ref:a,style:{...t.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Jl(t){return t==="indeterminate"}function cL(t){return Jl(t)?"indeterminate":t?"checked":"unchecked"}var uL=aL,lG=lL;const oh=y.forwardRef(({className:t,...e},r)=>o.jsx(uL,{ref:r,className:Be("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:o.jsx(lG,{className:Be("flex items-center justify-center text-current"),children:o.jsx(rc,{className:"h-4 w-4"})})}));oh.displayName=uL.displayName;const w0=[{value:"monday",label:"Lundi"},{value:"tuesday",label:"Mardi"},{value:"wednesday",label:"Mercredi"},{value:"thursday",label:"Jeudi"},{value:"friday",label:"Vendredi"},{value:"saturday",label:"Samedi"},{value:"sunday",label:"Dimanche"}],cG=({formationId:t,lessons:e,levels:r,onClose:n})=>{const[s,i]=y.useState([]),[a,l]=y.useState(!1),c=()=>{const b=[{formation_id:t,plan_type:"free",allow_discussion:!1,allow_exercises:!1,allow_calls:!1,call_type:"none",allowed_call_days:[],allowed_response_days:[],lesson_access:[],is_active:!0},{formation_id:t,plan_type:"standard",allow_discussion:!0,allow_exercises:!0,allow_calls:!0,call_type:"both",allowed_call_days:["tuesday","thursday","saturday"],allowed_response_days:["tuesday","thursday","saturday"],lesson_access:e.map(x=>x.id),is_active:!0},{formation_id:t,plan_type:"premium",allow_discussion:!0,allow_exercises:!0,allow_calls:!0,call_type:"both",allowed_call_days:w0.map(x=>x.value),allowed_response_days:w0.map(x=>x.value),lesson_access:e.map(x=>x.id),is_active:!0}];i(b)};y.useEffect(()=>{u()},[t]);const u=async()=>{try{const{data:b,error:x}=await ae.from("formation_pricing_options").select("*").eq("formation_id",t);if(x)throw x;b&&b.length>0?i(b):c()}catch(b){console.error("Error fetching pricing options:",b),c()}},d=(b,x,w)=>{i(_=>_.map((S,N)=>N===b?{...S,[x]:w}:S))},h=(b,x,w)=>{const S=s[b][x]||[],N=S.includes(w)?S.filter(E=>E!==w):[...S,w];d(b,x,N)},f=(b,x)=>{const _=s[b].lesson_access||[],S=_.includes(x)?_.filter(N=>N!==x):[..._,x];d(b,"lesson_access",S)},m=async()=>{l(!0);try{await ae.from("formation_pricing_options").delete().eq("formation_id",t);const b=s.map(w=>{const{id:_,...S}=w;return{...S,formation_id:t}}),{error:x}=await ae.from("formation_pricing_options").insert(b);if(x)throw x;me.success("Options de tarification sauvegardées avec succès"),n==null||n()}catch(b){console.error("Error saving pricing options:",b),me.error("Erreur lors de la sauvegarde")}finally{l(!1)}},p=b=>{switch(b){case"free":return"Offre Gratuite";case"standard":return"Offre Standard";case"premium":return"Offre Premium";default:return b}},v=b=>{switch(b){case"free":return"border-green-500";case"standard":return"border-blue-500";case"premium":return"border-purple-500";default:return"border-gray-500"}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Configuration des Tarifs"}),o.jsxs("div",{className:"space-x-2",children:[o.jsx(J,{variant:"outline",onClick:n,children:"Annuler"}),o.jsx(J,{onClick:m,disabled:a,children:a?"Save...":"Save"})]})]}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:s.map((b,x)=>o.jsxs(Mt,{className:`${v(b.plan_type)} border-2`,children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center justify-between",children:[p(b.plan_type),o.jsx(Ud,{checked:b.is_active,onCheckedChange:w=>d(x,"is_active",w)})]})}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Prix mensuel (FCFA)"}),o.jsx(Ye,{type:"number",min:"0",value:b.price_monthly??"",onChange:w=>{const _=w.target.value;d(x,"price_monthly",_===""?void 0:parseInt(_)||0)},placeholder:"Ex: 5000 (0 pour gratuit)"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Prix annuel (FCFA)"}),o.jsx(Ye,{type:"number",min:"0",value:b.price_yearly??"",onChange:w=>{const _=w.target.value;d(x,"price_yearly",_===""?void 0:parseInt(_)||0)},placeholder:"Ex: 50000 (0 pour gratuit)"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(Ke,{className:"text-base font-semibold",children:"Accès autorisés"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ud,{checked:b.allow_discussion,onCheckedChange:w=>d(x,"allow_discussion",w)}),o.jsx(Ke,{children:"Discussions"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ud,{checked:b.allow_exercises,onCheckedChange:w=>d(x,"allow_exercises",w)}),o.jsx(Ke,{children:"Exercices"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ud,{checked:b.allow_calls,onCheckedChange:w=>d(x,"allow_calls",w)}),o.jsx(Ke,{children:"Appels"})]})]}),b.allow_calls&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Type d'appel"}),o.jsxs(Ka,{value:b.call_type,onValueChange:w=>d(x,"call_type",w),children:[o.jsx(ua,{children:o.jsx(Qa,{})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"none",children:"Aucun"}),o.jsx(Ut,{value:"audio",children:"Audio uniquement"}),o.jsx(Ut,{value:"video",children:"Vidéo uniquement"}),o.jsx(Ut,{value:"both",children:"Audio et Vidéo"})]})]})]}),b.plan_type==="free"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Limite par jour (minutes)"}),o.jsx(Ye,{type:"number",value:b.time_limit_minutes_per_day||"",onChange:w=>d(x,"time_limit_minutes_per_day",parseInt(w.target.value)||void 0),placeholder:"Ex: 15"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Limite par semaine (minutes)"}),o.jsx(Ye,{type:"number",value:b.time_limit_minutes_per_week||"",onChange:w=>d(x,"time_limit_minutes_per_week",parseInt(w.target.value)||void 0),placeholder:"Ex: 120mn"})]})]}),b.allow_discussion&&b.plan_type!=="premium"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Messages par jour"}),o.jsx(Ye,{type:"number",value:b.message_limit_per_day||"",onChange:w=>d(x,"message_limit_per_day",parseInt(w.target.value)||void 0),placeholder:"Ex: 10"})]}),b.allow_calls&&b.plan_type!=="premium"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Jours d'appels autorisés"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:w0.map(w=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(oh,{checked:(b.allowed_call_days||[]).includes(w.value),onCheckedChange:()=>h(x,"allowed_call_days",w.value)}),o.jsx(Ke,{className:"text-sm",children:w.label})]},w.value))})]}),b.allow_discussion&&b.plan_type!=="premium"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{children:"Jours de réponse prof"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:w0.map(w=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(oh,{checked:(b.allowed_response_days||[]).includes(w.value),onCheckedChange:()=>h(x,"allowed_response_days",w.value)}),o.jsx(Ke,{className:"text-sm",children:w.label})]},w.value))})]}),b.plan_type==="free"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx(Ke,{children:"Leçons accessibles par niveau"}),o.jsx("div",{className:"max-h-96 overflow-y-auto space-y-4",children:r.map(w=>o.jsxs("div",{className:"border rounded-lg p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"font-medium text-sm",children:w.title}),o.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>{const _=w.lessons.map(E=>E.id),S=b.lesson_access||[];if(_.every(E=>S.includes(E))){const E=S.filter(P=>!_.includes(P));d(x,"lesson_access",E)}else{const E=[...new Set([...S,..._])];d(x,"lesson_access",E)}},className:"h-6 text-xs",children:(()=>{const _=w.lessons.map(E=>E.id),S=b.lesson_access||[];return _.every(E=>S.includes(E))?"Tout décocher":"Tout cocher"})()})]}),o.jsx("div",{className:"space-y-2",children:w.lessons.map(_=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(oh,{checked:(b.lesson_access||[]).includes(_.id),onCheckedChange:()=>f(x,_.id)}),o.jsx(Ke,{className:"text-sm",children:_.title})]},_.id))})]},w.id))})]})]})]},`${b.plan_type}-${x}`))})]})},uG=()=>{const[t,e]=y.useState(null),[r,n]=y.useState(!1),[s,i]=y.useState(!1),[a,l]=y.useState(null),[c,u]=y.useState(!1),[d,h]=y.useState(null),[f,m]=y.useState([]),p=br(),{user:v}=st(),{data:b,isLoading:x}=Nt({queryKey:["admin-formations"],queryFn:async()=>{const{data:T,error:O}=await ae.from("formations").select(`
          *,
          profiles:author_id (
            first_name,
            last_name,
            username
          ),
          teacher_formations (
            teachers (
              profiles (
                first_name,
                last_name,
                username
              )
            )
          )
        `).order("created_at",{ascending:!1});if(O)throw O;return T||[]}}),w=Vt({mutationFn:async T=>{console.log("Creating complete formation:",T);const O=crypto.randomUUID();try{const{data:U,error:q}=await ae.from("formations").insert({id:O,title:T.title,description:T.description,badge:T.badge,duration:T.duration,price:T.price,original_price:T.originalPrice,promo_video_url:T.promoVideoUrl,thumbnail_url:T.thumbnailUrl,is_active:T.isActive,author_id:v==null?void 0:v.id}).select().single();if(q)throw q;for(const Z of T.levels){const H=crypto.randomUUID(),{error:Q}=await ae.from("levels").insert({id:H,formation_id:O,title:Z.title,description:Z.description,order_index:Z.orderIndex});if(Q)throw Q;const R=Z.lessons.sort((B,X)=>B.orderIndex-X.orderIndex);for(const B of R){const X=crypto.randomUUID(),{error:ie}=await ae.from("lessons").insert({id:X,level_id:H,title:B.title,description:B.description,video_url:B.videoUrl,duration:B.duration,order_index:B.orderIndex});if(ie)throw ie;for(const M of B.exercises){const W=crypto.randomUUID(),{error:K}=await ae.from("exercises").insert({id:W,lesson_id:X,title:M.title,description:M.description,type:M.type,content:M.content});if(K)throw K;if(M.uploadedFiles&&M.uploadedFiles.length>0){const ne=M.uploadedFiles.map(le=>({id:crypto.randomUUID(),exercise_id:W,file_url:le.url,file_type:le.type})),{error:se}=await ae.from("exercise_files").insert(ne);if(se)throw console.error("Error saving exercise files:",se),se;console.log(`Saved ${ne.length} files for exercise ${W}`)}}}}return U}catch(U){throw console.error("Error creating complete formation:",U),U}},onSuccess:()=>{p.invalidateQueries({queryKey:["admin-formations"]}),me.success("Formation créée avec succès avec tous ses éléments et médias"),n(!1)},onError:T=>{me.error("Erreur lors de la création de la formation complète"),console.error(T)}}),_=Vt({mutationFn:async({id:T,formationData:O})=>{console.log("Updating complete formation:",O);try{const{error:U}=await ae.from("formations").update({title:O.title,description:O.description,badge:O.badge,duration:O.duration,price:O.price,original_price:O.originalPrice,promo_video_url:O.promoVideoUrl,thumbnail_url:O.thumbnailUrl,is_active:O.isActive}).eq("id",T);if(U)throw U;for(const q of O.levels){if(q.id){const{error:H}=await ae.from("levels").update({title:q.title,description:q.description,order_index:q.orderIndex}).eq("id",q.id);if(H)throw H}else{const H=crypto.randomUUID(),{error:Q}=await ae.from("levels").insert({id:H,formation_id:T,title:q.title,description:q.description,order_index:q.orderIndex});if(Q)throw Q;q.id=H}const Z=q.lessons.sort((H,Q)=>H.orderIndex-Q.orderIndex);for(const H of Z){if(H.id){const{error:Q}=await ae.from("lessons").update({title:H.title,description:H.description,video_url:H.videoUrl,duration:H.duration,order_index:H.orderIndex}).eq("id",H.id);if(Q)throw Q}else{const Q=crypto.randomUUID(),{error:R}=await ae.from("lessons").insert({id:Q,level_id:q.id,title:H.title,description:H.description,video_url:H.videoUrl,duration:H.duration,order_index:H.orderIndex});if(R)throw R;H.id=Q}for(const Q of H.exercises)if(Q.id){const{error:R}=await ae.from("exercises").update({title:Q.title,description:Q.description,type:Q.type,content:Q.content}).eq("id",Q.id);if(R)throw R;if(Q.uploadedFiles&&Q.uploadedFiles.length>0){await ae.from("exercise_files").delete().eq("exercise_id",Q.id);const B=Q.uploadedFiles.map(ie=>({id:crypto.randomUUID(),exercise_id:Q.id,file_url:ie.url,file_type:ie.type})),{error:X}=await ae.from("exercise_files").insert(B);if(X)throw console.error("Error updating exercise files:",X),X;console.log(`Updated ${B.length} files for exercise ${Q.id}`)}}else{const R=crypto.randomUUID(),{error:B}=await ae.from("exercises").insert({id:R,lesson_id:H.id,title:Q.title,description:Q.description,type:Q.type,content:Q.content});if(B)throw B;if(Q.uploadedFiles&&Q.uploadedFiles.length>0){const X=Q.uploadedFiles.map(M=>({id:crypto.randomUUID(),exercise_id:R,file_url:M.url,file_type:M.type})),{error:ie}=await ae.from("exercise_files").insert(X);if(ie)throw console.error("Error saving new exercise files:",ie),ie;console.log(`Saved ${X.length} files for new exercise ${R}`)}}}}return{id:T}}catch(U){throw console.error("Error updating formation:",U),U}},onSuccess:()=>{p.invalidateQueries({queryKey:["admin-formations"]}),me.success("Formation mise à jour avec succès"),i(!1),l(null)},onError:T=>{me.error("Erreur lors de la mise à jour de la formation"),console.error(T)}}),S=Vt({mutationFn:async T=>{const{error:O}=await ae.from("formations").delete().eq("id",T);if(O)throw O},onSuccess:()=>{p.invalidateQueries({queryKey:["admin-formations"]}),me.success("Formation supprimée avec succès")},onError:T=>{me.error("Erreur lors de la suppression de la formation"),console.error(T)}}),N=async T=>{var O,U;try{console.log("Loading formation for edit:",T.id);const{data:q,error:Z}=await ae.from("formations").select(`
          *,
          levels (
            *,
            lessons (
              *,
              exercises!exercises_lesson_id_fkey (
                *,
                exercise_files (*)
              )
            )
          )
        `).eq("id",T.id).single();if(Z)throw console.error("Error fetching formation for edit:",Z),Z;console.log("Complete formation data loaded:",q);const H={...q,originalPrice:q.original_price,promoVideoUrl:q.promo_video_url,thumbnailUrl:q.thumbnail_url,isActive:q.is_active,levels:((U=(O=q.levels)==null?void 0:O.sort((Q,R)=>Q.order_index-R.order_index))==null?void 0:U.map(Q=>{var R,B;return{...Q,orderIndex:Q.order_index,lessons:((B=(R=Q.lessons)==null?void 0:R.sort((X,ie)=>X.order_index-ie.order_index))==null?void 0:B.map(X=>{var ie;return{...X,videoUrl:X.video_url,orderIndex:X.order_index,exercises:((ie=X.exercises)==null?void 0:ie.map(M=>{var W;return{...M,uploadedFiles:((W=M.exercise_files)==null?void 0:W.map(K=>({url:K.file_url,type:K.file_type})))||[]}}))||[]}}))||[]}}))||[]};console.log("Formatted formation for editing:",H),l(H),i(!0)}catch(q){console.error("Error loading formation for edit:",q),me.error("Erreur lors du chargement de la formation")}},[E,P]=y.useState([]),A=async T=>{try{const{data:O,error:U}=await ae.from("levels").select(`
          *,
          lessons (
            id,
            title,
            order_index
          )
        `).eq("formation_id",T).order("order_index");if(U)throw U;const q=(O==null?void 0:O.map(H=>{var Q,R;return{id:H.id,title:H.title,lessons:((R=(Q=H.lessons)==null?void 0:Q.sort((B,X)=>B.order_index-X.order_index))==null?void 0:R.map(B=>({id:B.id,title:B.title})))||[]}}))||[],Z=(O==null?void 0:O.flatMap(H=>{var Q;return((Q=H.lessons)==null?void 0:Q.map(R=>({id:R.id,title:R.title})))||[]}))||[];h(T),m(Z),P(q),u(!0)}catch(O){console.error("Error loading lessons for pricing:",O),me.error("Erreur lors du chargement des leçons")}},F=T=>{confirm("Êtes-vous sûr de vouloir supprimer cette formation ?")&&S.mutate(T)};if(t)return o.jsx(GH,{formationId:t.id,formationTitle:t.title,onBack:()=>e(null)});if(x)return o.jsx("div",{className:"text-center py-8",children:"Chargement des formations..."});const Y=T=>!T||T.length===0?"Aucun enseignant assigné":T.map(O=>{var q;const U=(q=O.teachers)==null?void 0:q.profiles;return U!=null&&U.first_name&&(U!=null&&U.last_name)?`${U.first_name} ${U.last_name}`:(U==null?void 0:U.username)||"Enseignant"}).join(", ");return o.jsxs(Mt,{children:[o.jsxs(er,{className:"flex flex-row items-center justify-between",children:[o.jsx(ur,{children:"Gestion des formations"}),o.jsxs(Br,{open:r,onOpenChange:n,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-[#25d366] hover:bg-[#25d366]/90",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Nouvelle formation complète"]})}),o.jsxs(Or,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer une formation complète"})}),o.jsx(JN,{onSubmit:T=>w.mutate(T),isLoading:w.isPending})]})]}),o.jsx(Br,{open:s,onOpenChange:i,children:o.jsxs(Or,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Modifier la formation"})}),a&&o.jsx(JN,{onSubmit:T=>_.mutate({id:a.id,formationData:T}),isLoading:_.isPending,initialData:a,isEditing:!0})]})}),o.jsx(Br,{open:c,onOpenChange:u,children:o.jsxs(Or,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Configuration des tarifs d'abonnement"})}),d&&o.jsx(cG,{formationId:d,lessons:f,levels:E,onClose:()=>u(!1)})]})})]}),o.jsx(Rt,{children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{children:[o.jsx($t,{children:"Titre"}),o.jsx($t,{children:"Auteur"}),o.jsx($t,{children:"Enseignants"}),o.jsx($t,{children:"Badge"}),o.jsx($t,{children:"Prix"}),o.jsx($t,{children:"Statut"}),o.jsx($t,{children:"Actions"})]})}),o.jsx(Mu,{children:b==null?void 0:b.map(T=>o.jsxs(ti,{children:[o.jsx(Bt,{className:"font-medium",children:T.title}),o.jsx(Bt,{children:T.profiles&&(`${T.profiles.first_name||""} ${T.profiles.last_name||""}`.trim()||T.profiles.username)||"Auteur inconnu"}),o.jsx(Bt,{children:o.jsx("div",{className:"text-sm",children:Y(T.teacher_formations)})}),o.jsx(Bt,{children:o.jsx(yr,{variant:"outline",children:T.badge||"N/A"})}),o.jsx(Bt,{children:T.price?`${T.price}€`:"Gratuit"}),o.jsx(Bt,{children:o.jsx(yr,{variant:T.is_active?"default":"destructive",children:T.is_active?"Actif":"Inactif"})}),o.jsx(Bt,{children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{size:"sm",variant:"outline",onClick:()=>e({id:T.id,title:T.title}),children:[o.jsx(qz,{size:14,className:"mr-1"}),"Niveaux"]}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>A(T.id),className:"text-purple-600",children:"💳"}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>N(T),children:o.jsx(Pu,{size:14})}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>F(T.id),className:"text-red-600",children:o.jsx(cs,{size:14})})]})})]},T.id))})]})})]})},dG=()=>{const t=br(),{data:e,isLoading:r}=Nt({queryKey:["admin-products"],queryFn:async()=>{const{data:c,error:u}=await ae.from("products").select("*").order("created_at",{ascending:!1});if(u)throw u;return c||[]}}),n=Vt({mutationFn:async c=>{const{data:u,error:d}=await ae.from("products").insert(c).select().single();if(d)throw d;return{id:u.id,data:u}},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-products"]}),me.success("Produit créé avec succès")},onError:c=>{me.error("Erreur lors de la création du produit"),console.error(c)}}),s=Vt({mutationFn:async c=>{const{error:u}=await ae.from("products").update(c.data).eq("id",c.id);if(u)throw u},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-products"]}),me.success("Produit mis à jour avec succès")},onError:c=>{me.error("Erreur lors de la mise à jour du produit"),console.error(c)}}),i=Vt({mutationFn:async c=>{const{error:u}=await ae.from("products").delete().eq("id",c);if(u)throw u},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-products"]}),me.success("Produit supprimé avec succès")},onError:c=>{me.error("Erreur lors de la suppression du produit"),console.error(c)}}),a=(c,u=!1,d)=>{c.preventDefault();const h=new FormData(c.currentTarget),f=h.get("title"),m=h.get("description"),p=parseFloat(h.get("price"))||0,v=h.get("category"),b=h.get("image_url"),x=h.get("is_active")==="true",w=h.get("product_type"),_={title:f,description:m,price:p,category_id:v,image_url:b,is_active:x,product_type:w};u&&d?s.mutate({id:d,data:_}):n.mutate(_)},l=c=>{confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")&&i.mutate(c)};return r?o.jsx("div",{className:"text-center py-8",children:"Chargement des produits..."}):o.jsxs(Mt,{children:[o.jsxs(er,{className:"flex flex-row items-center justify-between",children:[o.jsx(ur,{children:"Gestion des produits"}),o.jsxs(Br,{children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-[#25d366] hover:bg-[#25d366]/90",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Nouveau produit"]})}),o.jsxs(Or,{className:"max-w-2xl",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer un nouveau produit"})}),o.jsxs("form",{onSubmit:c=>a(c),className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nom"}),o.jsx(Ye,{name:"title",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),o.jsx(jr,{name:"description",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Prix (€)"}),o.jsx(Ye,{name:"price",type:"number",min:"0",step:"0.01",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Catégorie"}),o.jsx(Ye,{name:"category",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL de l'image"}),o.jsx(Ye,{name:"image_url",type:"url"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type de produit"}),o.jsxs("select",{name:"product_type",className:"w-full border border-gray-300 rounded px-3 py-2",required:!0,children:[o.jsx("option",{value:"formation",children:"Formation"}),o.jsx("option",{value:"article",children:"Article"}),o.jsx("option",{value:"service",children:"Service"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",name:"is_active",id:"is_active",defaultChecked:!0}),o.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium",children:"Produit actif"})]}),o.jsx(J,{type:"submit",className:"w-full",children:"Créer le produit"})]})]})]})]}),o.jsx(Rt,{children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{children:[o.jsx($t,{children:"Nom"}),o.jsx($t,{children:"Catégorie"}),o.jsx($t,{children:"Prix"}),o.jsx($t,{children:"Type"}),o.jsx($t,{children:"Statut"}),o.jsx($t,{children:"Actions"})]})}),o.jsx(Mu,{children:e==null?void 0:e.map(c=>o.jsxs(ti,{children:[o.jsx(Bt,{className:"font-medium",children:c.title||"N/A"}),o.jsx(Bt,{children:c.category_id||"N/A"}),o.jsx(Bt,{children:c.price?`${c.price}€`:"N/A"}),o.jsx(Bt,{children:o.jsx(yr,{variant:"outline",children:c.product_type==="formation"?"Formation":c.product_type==="article"?"Article":"Service"})}),o.jsx(Bt,{children:o.jsx(yr,{variant:c.is_active?"default":"destructive",children:c.is_active?"Actif":"Inactif"})}),o.jsx(Bt,{children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{size:"sm",variant:"outline",children:o.jsx(Pu,{size:14})}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>l(c.id),className:"text-red-600",children:o.jsx(cs,{size:14})})]})})]},c.id))})]})})]})},hG=()=>{const t=br(),{data:e,isLoading:r}=Nt({queryKey:["admin-users"],queryFn:async()=>{const{data:i,error:a}=await ae.from("profiles").select("*").order("created_at",{ascending:!1});if(a)throw a;return i||[]}}),n=Vt({mutationFn:async({userId:i,role:a})=>{const{error:l}=await ae.from("profiles").update({role:a}).eq("id",i);if(l)throw l},onSuccess:()=>{t.invalidateQueries({queryKey:["admin-users"]}),me.success("Rôle utilisateur mis à jour avec succès")},onError:i=>{me.error("Erreur lors de la mise à jour du rôle"),console.error(i)}}),s=(i,a)=>{const l=a==="admin"?"user":"admin";confirm(`Êtes-vous sûr de vouloir ${l==="admin"?"promouvoir cet utilisateur comme administrateur":"retirer les droits administrateur à cet utilisateur"} ?`)&&n.mutate({userId:i,role:l})};return r?o.jsx("div",{className:"text-center py-8",children:o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Chargement des utilisateurs..."})}):o.jsxs(Mt,{children:[o.jsxs(er,{children:[o.jsx(ur,{children:"Gestion des utilisateurs"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Gérez les rôles et permissions des utilisateurs de la plateforme"})]}),o.jsx(Rt,{children:o.jsxs(Lu,{children:[o.jsx(Ou,{children:o.jsxs(ti,{children:[o.jsx($t,{children:"Nom complet"}),o.jsx($t,{children:"Nom d'utilisateur"}),o.jsx($t,{children:"Email"}),o.jsx($t,{children:"Rôle"}),o.jsx($t,{children:"Enseignant"}),o.jsx($t,{children:"Date d'inscription"}),o.jsx($t,{children:"Actions"})]})}),o.jsx(Mu,{children:e==null?void 0:e.map(i=>o.jsxs(ti,{children:[o.jsx(Bt,{className:"font-medium",children:`${i.first_name||""} ${i.last_name||""}`.trim()||"N/A"}),o.jsx(Bt,{children:i.username||"N/A"}),o.jsx(Bt,{children:i.email||"N/A"}),o.jsx(Bt,{children:o.jsx(yr,{variant:i.role==="admin"?"destructive":"default",children:i.role==="admin"?"Administrateur":"Utilisateur"})}),o.jsx(Bt,{children:o.jsx(yr,{variant:i.is_teacher?"default":"outline",children:i.is_teacher?"Oui":"Non"})}),o.jsx(Bt,{children:i.created_at?new Date(i.created_at).toLocaleDateString("fr-FR"):"N/A"}),o.jsx(Bt,{children:o.jsxs(J,{size:"sm",variant:"outline",onClick:()=>s(i.id,i.role),className:i.role==="admin"?"text-red-600 hover:text-red-700":"text-green-600 hover:text-green-700",disabled:n.isPending,children:[i.role==="admin"?o.jsx(s9,{size:14,className:"mr-1"}):o.jsx(zp,{size:14,className:"mr-1"}),i.role==="admin"?"Retirer admin":"Promouvoir admin"]})})]},i.id))})]})})]})},ZN=()=>{const{data:t,isLoading:e}=Nt({queryKey:["admin-stats"],queryFn:async()=>{const[n,s,i,a]=await Promise.all([ae.from("profiles").select("id",{count:"exact"}),ae.from("formations").select("id",{count:"exact"}),ae.from("products").select("id",{count:"exact"}),ae.from("enrollment_requests").select("id",{count:"exact"}).eq("status","approved")]);return{users:n.count||0,formations:s.count||0,products:i.count||0,enrollments:a.count||0}}});if(e)return o.jsx("div",{className:"text-center py-8",children:"Chargement des statistiques..."});const r=[{title:"Utilisateurs totaux",value:(t==null?void 0:t.users)||0,icon:pa,color:"text-blue-600"},{title:"Formations actives",value:(t==null?void 0:t.formations)||0,icon:$o,color:"text-green-600"},{title:"Produits disponibles",value:(t==null?void 0:t.products)||0,icon:zP,color:"text-purple-600"},{title:"Inscriptions totales",value:(t==null?void 0:t.enrollments)||0,icon:VP,color:"text-orange-600"}];return o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map((n,s)=>o.jsxs(Mt,{children:[o.jsxs(er,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(ur,{className:"text-sm font-medium text-gray-600",children:n.title}),o.jsx(n.icon,{className:`h-4 w-4 ${n.color}`})]}),o.jsx(Rt,{children:o.jsx("div",{className:"text-2xl font-bold",children:n.value})})]},s))})},fG=()=>{const[t,e]=y.useState(""),[r,n]=y.useState("all"),[s,i]=y.useState("all"),{data:a,isLoading:l}=Nt({queryKey:["online-users"],queryFn:async()=>{const{data:d,error:h}=await ae.from("profiles").select("*").order("created_at",{ascending:!1});if(h)throw h;return d.map(f=>({...f,last_seen:new Date().toISOString(),status:Math.random()>.3?"online":"offline"}))},refetchInterval:3e4}),c=a==null?void 0:a.filter(d=>{var p,v,b;const h=t===""||((p=d.first_name)==null?void 0:p.toLowerCase().includes(t.toLowerCase()))||((v=d.last_name)==null?void 0:v.toLowerCase().includes(t.toLowerCase()))||((b=d.username)==null?void 0:b.toLowerCase().includes(t.toLowerCase())),f=r==="all"||d.role===r,m=s==="all"||d.status===s;return h&&f&&m}),u=(c==null?void 0:c.filter(d=>d.status==="online").length)||0;return l?o.jsx("div",{className:"text-center py-8",children:"Chargement des utilisateurs en ligne..."}):o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center gap-2",children:[o.jsx(pa,{size:20}),"Utilisateurs en ligne (",u,")"]})}),o.jsxs(Rt,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(bu,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsx(Ye,{placeholder:"Rechercher un utilisateur...",value:t,onChange:d=>e(d.target.value),className:"pl-10"})]}),o.jsxs(Ka,{value:r,onValueChange:n,children:[o.jsx(ua,{className:"w-full sm:w-32",children:o.jsx(Qa,{placeholder:"Rôle"})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"all",children:"Tous"}),o.jsx(Ut,{value:"admin",children:"Admin"}),o.jsx(Ut,{value:"teacher",children:"Professeur"}),o.jsx(Ut,{value:"user",children:"Élève"})]})]}),o.jsxs(Ka,{value:s,onValueChange:i,children:[o.jsx(ua,{className:"w-full sm:w-32",children:o.jsx(Qa,{placeholder:"Statut"})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"all",children:"Tous"}),o.jsx(Ut,{value:"online",children:"En ligne"}),o.jsx(Ut,{value:"offline",children:"Hors ligne"})]})]})]}),o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:c==null?void 0:c.map(d=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:d.avatar_url||"/placeholder.svg",alt:d.username||"Avatar",className:"w-10 h-10 rounded-full object-cover"}),o.jsx("div",{className:`absolute -bottom-1 -right-1 w-4 h-4 rounded-full border-2 border-white ${d.status==="online"?"bg-green-500":d.status==="away"?"bg-yellow-500":"bg-gray-400"}`})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-medium",children:[d.first_name," ",d.last_name,d.username&&o.jsxs("span",{className:"text-gray-500 ml-1",children:["(@",d.username,")"]})]}),o.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[o.jsx(Js,{size:12}),d.status==="online"?"En ligne maintenant":"Vu il y a 2h"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(yr,{variant:d.role==="admin"?"destructive":d.role==="teacher"?"default":"secondary",children:d.role==="admin"?"Admin":d.role==="teacher"?"Prof":"Élève"}),o.jsx(yr,{variant:d.status==="online"?"default":"secondary",children:d.status==="online"?"En ligne":"Hors ligne"})]})]},d.id))}),(c==null?void 0:c.length)===0&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun utilisateur trouvé"})]})]})},mG=()=>Nt({queryKey:["videos"],queryFn:async()=>{const{data:t,error:e}=await ae.from("videos").select(`
          *,
          profiles:author_id (
            first_name,
            last_name,
            username,
            avatar_url
          )
        `).eq("is_active",!0).order("created_at",{ascending:!1});return e?(console.error("Error fetching videos:",e),[]):t||[]}});function Lo(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function vj(t,e=[]){let r=[];function n(i,a){const l=y.createContext(a),c=r.length;r=[...r,a];const u=h=>{var x;const{scope:f,children:m,...p}=h,v=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,b=y.useMemo(()=>p,Object.values(p));return o.jsx(v.Provider,{value:b,children:m})};u.displayName=i+"Provider";function d(h,f){var v;const m=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,p=y.useContext(m);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=r.map(a=>y.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[n,pG(s,...e)]}function pG(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}function ek(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function dL(...t){return e=>{let r=!1;const n=t.map(s=>{const i=ek(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():ek(t[s],null)}}}}function yx(...t){return y.useCallback(dL(...t),t)}function Uw(t){const e=gG(t),r=y.forwardRef((n,s)=>{const{children:i,...a}=n,l=y.Children.toArray(i),c=l.find(xG);if(c){const u=c.props.children,d=l.map(h=>h===c?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:h);return o.jsx(e,{...a,ref:s,children:y.isValidElement(u)?y.cloneElement(u,void 0,d):null})}return o.jsx(e,{...a,ref:s,children:i})});return r.displayName=`${t}.Slot`,r}function gG(t){const e=y.forwardRef((r,n)=>{const{children:s,...i}=r;if(y.isValidElement(s)){const a=bG(s),l=yG(i,s.props);return s.type!==y.Fragment&&(l.ref=n?dL(n,a):a),y.cloneElement(s,l)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var vG=Symbol("radix.slottable");function xG(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===vG}function yG(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function bG(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function wG(t){const e=t+"CollectionProvider",[r,n]=vj(e),[s,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),a=v=>{const{scope:b,children:x}=v,w=Fe.useRef(null),_=Fe.useRef(new Map).current;return o.jsx(s,{scope:b,itemMap:_,collectionRef:w,children:x})};a.displayName=e;const l=t+"CollectionSlot",c=Uw(l),u=Fe.forwardRef((v,b)=>{const{scope:x,children:w}=v,_=i(l,x),S=yx(b,_.collectionRef);return o.jsx(c,{ref:S,children:w})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Uw(d),m=Fe.forwardRef((v,b)=>{const{scope:x,children:w,..._}=v,S=Fe.useRef(null),N=yx(b,S),E=i(d,x);return Fe.useEffect(()=>(E.itemMap.set(S,{ref:S,..._}),()=>void E.itemMap.delete(S))),o.jsx(f,{[h]:"",ref:N,children:w})});m.displayName=d;function p(v){const b=i(t+"CollectionConsumer",v);return Fe.useCallback(()=>{const w=b.collectionRef.current;if(!w)return[];const _=Array.from(w.querySelectorAll(`[${h}]`));return Array.from(b.itemMap.values()).sort((E,P)=>_.indexOf(E.ref.current)-_.indexOf(P.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:a,Slot:u,ItemSlot:m},p,n]}var bx=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},_G=Lp[" useId ".trim().toString()]||(()=>{}),jG=0;function hL(t){const[e,r]=y.useState(_G());return bx(()=>{t||r(n=>n??String(jG++))},[t]),t||(e?`radix-${e}`:"")}var SG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],mf=SG.reduce((t,e)=>{const r=Uw(`Primitive.${e}`),n=y.forwardRef((s,i)=>{const{asChild:a,...l}=s,c=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function CG(t){const e=y.useRef(t);return y.useEffect(()=>{e.current=t}),y.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}var NG=Lp[" useInsertionEffect ".trim().toString()]||bx;function fL({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,i,a]=kG({defaultProp:e,onChange:r}),l=t!==void 0,c=l?t:s;{const d=y.useRef(t!==void 0);y.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=y.useCallback(d=>{var h;if(l){const f=EG(d)?d(t):d;f!==t&&((h=a.current)==null||h.call(a,f))}else i(d)},[l,t,i,a]);return[c,u]}function kG({defaultProp:t,onChange:e}){const[r,n]=y.useState(t),s=y.useRef(r),i=y.useRef(e);return NG(()=>{i.current=e},[e]),y.useEffect(()=>{var a;s.current!==r&&((a=i.current)==null||a.call(i,r),s.current=r)},[r,s]),[r,n,i]}function EG(t){return typeof t=="function"}var PG=y.createContext(void 0);function mL(t){const e=y.useContext(PG);return t||e||"ltr"}var I2="rovingFocusGroup.onEntryFocus",AG={bubbles:!1,cancelable:!0},Hp="RovingFocusGroup",[Vw,pL,TG]=wG(Hp),[LG,gL]=vj(Hp,[TG]),[OG,MG]=LG(Hp),vL=y.forwardRef((t,e)=>o.jsx(Vw.Provider,{scope:t.__scopeRovingFocusGroup,children:o.jsx(Vw.Slot,{scope:t.__scopeRovingFocusGroup,children:o.jsx(RG,{...t,ref:e})})}));vL.displayName=Hp;var RG=y.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=y.useRef(null),m=yx(e,f),p=mL(i),[v,b]=fL({prop:a,defaultProp:l??null,onChange:c,caller:Hp}),[x,w]=y.useState(!1),_=CG(u),S=pL(r),N=y.useRef(!1),[E,P]=y.useState(0);return y.useEffect(()=>{const A=f.current;if(A)return A.addEventListener(I2,_),()=>A.removeEventListener(I2,_)},[_]),o.jsx(OG,{scope:r,orientation:n,dir:p,loop:s,currentTabStopId:v,onItemFocus:y.useCallback(A=>b(A),[b]),onItemShiftTab:y.useCallback(()=>w(!0),[]),onFocusableItemAdd:y.useCallback(()=>P(A=>A+1),[]),onFocusableItemRemove:y.useCallback(()=>P(A=>A-1),[]),children:o.jsx(mf.div,{tabIndex:x||E===0?-1:0,"data-orientation":n,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:Lo(t.onMouseDown,()=>{N.current=!0}),onFocus:Lo(t.onFocus,A=>{const F=!N.current;if(A.target===A.currentTarget&&F&&!x){const Y=new CustomEvent(I2,AG);if(A.currentTarget.dispatchEvent(Y),!Y.defaultPrevented){const T=S().filter(H=>H.focusable),O=T.find(H=>H.active),U=T.find(H=>H.id===v),Z=[O,U,...T].filter(Boolean).map(H=>H.ref.current);bL(Z,d)}}N.current=!1}),onBlur:Lo(t.onBlur,()=>w(!1))})})}),xL="RovingFocusGroupItem",yL=y.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,children:a,...l}=t,c=hL(),u=i||c,d=MG(xL,r),h=d.currentTabStopId===u,f=pL(r),{onFocusableItemAdd:m,onFocusableItemRemove:p,currentTabStopId:v}=d;return y.useEffect(()=>{if(n)return m(),()=>p()},[n,m,p]),o.jsx(Vw.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:o.jsx(mf.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:Lo(t.onMouseDown,b=>{n?d.onItemFocus(u):b.preventDefault()}),onFocus:Lo(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:Lo(t.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){d.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const x=IG(b,d.orientation,d.dir);if(x!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let _=f().filter(S=>S.focusable).map(S=>S.ref.current);if(x==="last")_.reverse();else if(x==="prev"||x==="next"){x==="prev"&&_.reverse();const S=_.indexOf(b.currentTarget);_=d.loop?zG(_,S+1):_.slice(S+1)}setTimeout(()=>bL(_))}}),children:typeof a=="function"?a({isCurrentTabStop:h,hasTabStop:v!=null}):a})})});yL.displayName=xL;var DG={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function FG(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function IG(t,e,r){const n=FG(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return DG[n]}function bL(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function zG(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var $G=vL,BG=yL;function qG(t,e){return y.useReducer((r,n)=>e[r][n]??r,t)}var wL=t=>{const{present:e,children:r}=t,n=UG(e),s=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),i=yx(n.ref,VG(s));return typeof r=="function"||n.isPresent?y.cloneElement(s,{ref:i}):null};wL.displayName="Presence";function UG(t){const[e,r]=y.useState(),n=y.useRef(null),s=y.useRef(t),i=y.useRef("none"),a=t?"mounted":"unmounted",[l,c]=qG(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=_0(n.current);i.current=l==="mounted"?u:"none"},[l]),bx(()=>{const u=n.current,d=s.current;if(d!==t){const f=i.current,m=_0(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),bx(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const v=_0(n.current).includes(m.animationName);if(m.target===e&&v&&(c("ANIMATION_END"),!s.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},f=m=>{m.target===e&&(i.current=_0(n.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function _0(t){return(t==null?void 0:t.animationName)||"none"}function VG(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var F1="Tabs",[WG,ese]=vj(F1,[gL]),_L=gL(),[HG,xj]=WG(F1),jL=y.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=mL(l),[h,f]=fL({prop:n,onChange:s,defaultProp:i??"",caller:F1});return o.jsx(HG,{scope:r,baseId:hL(),value:h,onValueChange:f,orientation:a,dir:d,activationMode:c,children:o.jsx(mf.div,{dir:d,"data-orientation":a,...u,ref:e})})});jL.displayName=F1;var SL="TabsList",CL=y.forwardRef((t,e)=>{const{__scopeTabs:r,loop:n=!0,...s}=t,i=xj(SL,r),a=_L(r);return o.jsx($G,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:n,children:o.jsx(mf.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});CL.displayName=SL;var NL="TabsTrigger",kL=y.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...i}=t,a=xj(NL,r),l=_L(r),c=AL(a.baseId,n),u=TL(a.baseId,n),d=n===a.value;return o.jsx(BG,{asChild:!0,...l,focusable:!s,active:d,children:o.jsx(mf.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:Lo(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?a.onValueChange(n):h.preventDefault()}),onKeyDown:Lo(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&a.onValueChange(n)}),onFocus:Lo(t.onFocus,()=>{const h=a.activationMode!=="manual";!d&&!s&&h&&a.onValueChange(n)})})})});kL.displayName=NL;var EL="TabsContent",PL=y.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,forceMount:s,children:i,...a}=t,l=xj(EL,r),c=AL(l.baseId,n),u=TL(l.baseId,n),d=n===l.value,h=y.useRef(d);return y.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),o.jsx(wL,{present:s||d,children:({present:f})=>o.jsx(mf.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});PL.displayName=EL;function AL(t,e){return`${t}-trigger-${e}`}function TL(t,e){return`${t}-content-${e}`}var GG=jL,LL=CL,OL=kL,ML=PL;const RL=GG,yj=y.forwardRef(({className:t,...e},r)=>o.jsx(LL,{ref:r,className:Be("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));yj.displayName=LL.displayName;const pp=y.forwardRef(({className:t,...e},r)=>o.jsx(OL,{ref:r,className:Be("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));pp.displayName=OL.displayName;const gp=y.forwardRef(({className:t,...e},r)=>o.jsx(ML,{ref:r,className:Be("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));gp.displayName=ML.displayName;const YG=({onSuccess:t,onCancel:e})=>{const{user:r}=st(),{uploadFile:n,isUploading:s}=D1(),[i,a]=y.useState({title:"",description:"",video_url:"",thumbnail_url:"",video_type:"classic",formation_id:"",price:""}),[l,c]=y.useState(null),[u,d]=y.useState(null),[h,f]=y.useState("url"),m=(_,S)=>{a(N=>({...N,[_]:S}))},p=_=>{var N;const S=(N=_.target.files)==null?void 0:N[0];if(S){if(!S.type.startsWith("video/")){me.error("Veuillez sélectionner un fichier vidéo");return}c(S)}},v=_=>{var N;const S=(N=_.target.files)==null?void 0:N[0];if(S){if(!S.type.startsWith("image/")){me.error("Veuillez sélectionner un fichier image");return}d(S)}},b=async _=>{try{return(await n(_,"lesson_discussion_files")).fileUrl}catch(S){throw console.error("Erreur upload vidéo:",S),S}},x=async _=>{try{return(await n(_,"lesson_discussion_files")).fileUrl}catch(S){throw console.error("Erreur upload miniature:",S),S}},w=async _=>{if(_.preventDefault(),!i.title.trim()){me.error("Le titre est requis");return}if(h==="url"&&!i.video_url.trim()){me.error("Veuillez saisir l'URL de la vidéo");return}if(h==="upload"&&!l){me.error("Veuillez sélectionner un fichier vidéo");return}try{let S=i.video_url,N=i.thumbnail_url;h==="upload"&&l&&(console.log("Upload de la vidéo:",l.name),S=await b(l),console.log("Vidéo uploadée:",S)),u&&(console.log("Upload de la miniature:",u.name),N=await x(u),console.log("Miniature uploadée:",N));const E={title:i.title.trim(),description:i.description.trim(),video_url:S,thumbnail_url:N||null,video_type:i.video_type,formation_id:i.formation_id.trim()||null,price:i.price?parseFloat(i.price):null,author_id:r==null?void 0:r.id};console.log("Création vidéo avec données:",E);const{error:P}=await ae.from("videos").insert(E);if(P)throw console.error("Erreur création vidéo:",P),P;me.success("Vidéo créée avec succès"),t()}catch(S){console.error("Error:",S),me.error("Erreur lors de la création")}};return o.jsxs("form",{onSubmit:w,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"title",children:"Titre"}),o.jsx(Ye,{id:"title",value:i.title,onChange:_=>m("title",_.target.value),placeholder:"Titre de la vidéo",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"description",children:"Description"}),o.jsx(jr,{id:"description",value:i.description,onChange:_=>m("description",_.target.value),placeholder:"Description de la vidéo",rows:3})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Vidéo"}),o.jsxs(RL,{value:h,onValueChange:_=>f(_),children:[o.jsxs(yj,{className:"grid w-full grid-cols-2",children:[o.jsxs(pp,{value:"url",className:"flex items-center gap-2",children:[o.jsx(FP,{size:16}),"URL"]}),o.jsxs(pp,{value:"upload",className:"flex items-center gap-2",children:[o.jsx(Ih,{size:16}),"Upload"]})]}),o.jsx(gp,{value:"url",className:"mt-3",children:o.jsx(Ye,{type:"url",value:i.video_url,onChange:_=>m("video_url",_.target.value),placeholder:"https://example.com/video.mp4",required:h==="url"})}),o.jsx(gp,{value:"upload",className:"mt-3",children:o.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ih,{className:"mx-auto h-8 w-8 text-gray-400"}),o.jsx(Ye,{type:"file",accept:"video/*",onChange:p,className:"mt-2"}),l&&o.jsxs("p",{className:"mt-2 text-sm text-green-600",children:["Fichier sélectionné: ",l.name]})]})})})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{children:"Miniature (optionnel)"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ye,{type:"url",value:i.thumbnail_url,onChange:_=>m("thumbnail_url",_.target.value),placeholder:"https://example.com/thumbnail.jpg ou uploadez un fichier ci-dessous"}),o.jsxs("div",{className:"border border-gray-300 rounded-lg p-2",children:[o.jsx(Ye,{type:"file",accept:"image/*",onChange:v,className:"text-sm"}),u&&o.jsxs("p",{className:"mt-1 text-sm text-green-600",children:["Fichier sélectionné: ",u.name]})]})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"video_type",children:"Type de vidéo"}),o.jsxs(Ka,{value:i.video_type,onValueChange:_=>m("video_type",_),children:[o.jsx(ua,{children:o.jsx(Qa,{placeholder:"Sélectionner le type"})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"classic",children:"Classique"}),o.jsx(Ut,{value:"promo",children:"Promotion"}),o.jsx(Ut,{value:"lesson",children:"Leçon"})]})]})]}),i.video_type==="promo"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"formation_id",children:"ID Formation"}),o.jsx(Ye,{id:"formation_id",value:i.formation_id,onChange:_=>m("formation_id",_.target.value),placeholder:"UUID de la formation"})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"price",children:"Prix (€/mois)"}),o.jsx(Ye,{id:"price",type:"number",step:"0.01",min:"0",value:i.price,onChange:_=>m("price",_.target.value),placeholder:"29.99"})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{type:"submit",className:"flex-1",disabled:s,children:s?"Upload en cours...":"Créer"}),o.jsx(J,{type:"button",variant:"outline",onClick:e,children:"Annuler"})]})]})},XG=({video:t,onSuccess:e,onCancel:r})=>{st();const[n,s]=y.useState({title:t.title||"",description:t.description||"",video_url:t.video_url||"",thumbnail_url:t.thumbnail_url||"",video_type:t.video_type||"classic",formation_id:t.formation_id||"",price:t.price?t.price.toString():""}),i=(l,c)=>{s(u=>({...u,[l]:c}))},a=async l=>{if(l.preventDefault(),!n.title.trim()||!n.video_url.trim()){me.error("Le titre et l'URL de la vidéo sont requis");return}try{const c={title:n.title.trim(),description:n.description.trim(),video_url:n.video_url.trim(),thumbnail_url:n.thumbnail_url.trim()||null,video_type:n.video_type,formation_id:n.formation_id.trim()||null,price:n.price?parseFloat(n.price):null},{error:u}=await ae.from("videos").update(c).eq("id",t.id);if(u)throw u;me.success("Vidéo modifiée avec succès"),e()}catch(c){console.error("Error:",c),me.error("Erreur lors de la modification")}};return o.jsxs("form",{onSubmit:a,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"title",children:"Titre"}),o.jsx(Ye,{id:"title",value:n.title,onChange:l=>i("title",l.target.value),placeholder:"Titre de la vidéo",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"description",children:"Description"}),o.jsx(jr,{id:"description",value:n.description,onChange:l=>i("description",l.target.value),placeholder:"Description de la vidéo",rows:3})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"video_url",children:"URL de la vidéo"}),o.jsx(Ye,{id:"video_url",type:"url",value:n.video_url,onChange:l=>i("video_url",l.target.value),placeholder:"https://example.com/video.mp4",required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"thumbnail_url",children:"URL de la miniature"}),o.jsx(Ye,{id:"thumbnail_url",type:"url",value:n.thumbnail_url,onChange:l=>i("thumbnail_url",l.target.value),placeholder:"https://example.com/thumbnail.jpg"})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"video_type",children:"Type de vidéo"}),o.jsxs(Ka,{value:n.video_type,onValueChange:l=>i("video_type",l),children:[o.jsx(ua,{children:o.jsx(Qa,{placeholder:"Sélectionner le type"})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"classic",children:"Classique"}),o.jsx(Ut,{value:"promo",children:"Promotion"}),o.jsx(Ut,{value:"lesson",children:"Leçon"})]})]})]}),n.video_type==="promo"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"formation_id",children:"ID Formation"}),o.jsx(Ye,{id:"formation_id",value:n.formation_id,onChange:l=>i("formation_id",l.target.value),placeholder:"UUID de la formation"})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"price",children:"Prix (€/mois)"}),o.jsx(Ye,{id:"price",type:"number",step:"0.01",min:"0",value:n.price,onChange:l=>i("price",l.target.value),placeholder:"29.99"})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{type:"submit",className:"flex-1",children:"Modifier"}),o.jsx(J,{type:"button",variant:"outline",onClick:r,children:"Annuler"})]})]})},KG=()=>{const{data:t=[],refetch:e}=mG(),[r,n]=y.useState(!1),[s,i]=y.useState(null),a=()=>{n(!1),e()},l=()=>{i(null),e()},c=d=>{i(d)},u=async d=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette vidéo ?"))try{const{error:h}=await ae.from("videos").delete().eq("id",d);if(h)throw h;me.success("Vidéo supprimée avec succès"),e()}catch(h){console.error("Error:",h),me.error("Erreur lors de la suppression")}};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Gestion des Vidéos"}),o.jsxs(Br,{open:r,onOpenChange:n,children:[o.jsx(Tu,{asChild:!0,children:o.jsxs(J,{className:"bg-blue-500 hover:bg-blue-600",children:[o.jsx(ls,{size:16,className:"mr-2"}),"Nouvelle Vidéo"]})}),o.jsxs(Or,{className:"max-w-md",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Créer une nouvelle vidéo"})}),o.jsx(YG,{onSuccess:a,onCancel:()=>n(!1)})]})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(d=>o.jsxs(Mt,{className:"overflow-hidden",children:[o.jsxs("div",{className:"aspect-video bg-gray-200 relative",children:[d.thumbnail_url?o.jsx("img",{src:d.thumbnail_url,alt:d.title,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center",children:o.jsx(oa,{size:48,className:"text-gray-400"})}),o.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:o.jsx(oa,{size:32,className:"text-white"})}),d.video_type&&o.jsx("div",{className:"absolute top-2 left-2",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.video_type==="promo"?"bg-purple-500 text-white":d.video_type==="lesson"?"bg-blue-500 text-white":"bg-gray-500 text-white"}`,children:d.video_type==="promo"?"🎓 Promo":d.video_type==="lesson"?"📚 Leçon":"📹 Classique"})})]}),o.jsx(er,{className:"pb-2",children:o.jsx(ur,{className:"text-lg line-clamp-2",children:d.title})}),o.jsxs(Rt,{children:[o.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:d.description}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[o.jsxs("span",{children:["👍 ",d.likes_count]}),o.jsxs("span",{children:["💬 ",d.comments_count]}),d.video_type==="promo"&&o.jsx("span",{children:"💰 Promo"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>c(d),className:"flex-1",children:[o.jsx(Pu,{size:14,className:"mr-1"}),"Modifier"]}),o.jsx(J,{variant:"destructive",size:"sm",onClick:()=>u(d.id),children:o.jsx(cs,{size:14})})]})]})]},d.id))}),s&&o.jsx(Br,{open:!!s,onOpenChange:()=>i(null),children:o.jsxs(Or,{className:"max-w-md",children:[o.jsx(hn,{children:o.jsx(fn,{children:"Modifier la vidéo"})}),o.jsx(XG,{video:s,onSuccess:l,onCancel:()=>i(null)})]})})]})},QG=[{title:"Statistiques",value:"stats",icon:Nz},{title:"Utilisateurs en ligne",value:"online-users",icon:WP},{title:"Créer Formation",value:"create-formation",icon:$o},{title:"Produits",value:"products",icon:zP},{title:"Vidéos",value:"videos",icon:Xo},{title:"Utilisateurs",value:"users",icon:pa}];function JG({activeTab:t,onTabChange:e}){const{state:r}=Vp(),n=r==="collapsed";return o.jsxs(HA,{className:"border-r",children:[o.jsx(XA,{className:"border-b p-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(zp,{className:"h-6 w-6 text-red-600"}),!n&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold",children:"Admin"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Tableau de bord"})]})]})}),o.jsx(KA,{children:o.jsxs(QA,{children:[o.jsx(JA,{children:"Navigation"}),o.jsx(ZA,{children:o.jsx(eT,{children:QG.map(s=>o.jsx(tT,{children:o.jsxs(rT,{onClick:()=>e(s.value),isActive:t===s.value,tooltip:n?s.title:void 0,children:[o.jsx(s.icon,{className:"h-4 w-4"}),!n&&o.jsx("span",{children:s.title})]})},s.value))})})]})})]})}function ZG({profileName:t,profileRole:e}){const{data:r}=Nt({queryKey:["admin-header-stats"],queryFn:async()=>{var c;const[n,s,i,a]=await Promise.all([ae.from("profiles").select("id",{count:"exact"}),ae.from("profiles").select("country").not("country","is",null),ae.from("profiles").select("id",{count:"exact"}).limit(89),ae.from("enrollment_requests").select("id",{count:"exact"}).eq("status","approved")]),l=new Set((c=s.data)==null?void 0:c.map(u=>u.country).filter(Boolean));return{users:n.count||0,countries:l.size,onlineUsers:89,students:a.count||0}},refetchInterval:3e4});return o.jsxs("div",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[o.jsxs("div",{className:"flex h-14 items-center px-4",children:[o.jsx(GA,{className:"mr-4"}),o.jsx("div",{className:"flex-1",children:o.jsx("h1",{className:"text-xl font-semibold",children:"Tableau de bord administrateur"})}),o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg px-3 py-1",children:o.jsxs("p",{className:"text-xs text-red-700",children:[o.jsx("strong",{children:t}),o.jsx("span",{className:"ml-2 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:e.toUpperCase()})]})})]}),o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[o.jsx(Mt,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:o.jsx(Rt,{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-blue-100 text-xs truncate",children:"Utilisateurs"}),o.jsx("p",{className:"text-xl font-bold",children:(r==null?void 0:r.users)||0})]}),o.jsx(pa,{className:"w-6 h-6 text-blue-200 flex-shrink-0"})]})})}),o.jsx(Mt,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:o.jsx(Rt,{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-green-100 text-xs truncate",children:"Pays"}),o.jsx("p",{className:"text-xl font-bold",children:(r==null?void 0:r.countries)||0})]}),o.jsx(zz,{className:"w-6 h-6 text-green-200 flex-shrink-0"})]})})}),o.jsx(Mt,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:o.jsx(Rt,{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-purple-100 text-xs truncate",children:"En ligne"}),o.jsx("p",{className:"text-xl font-bold",children:(r==null?void 0:r.onlineUsers)||0})]}),o.jsx(vz,{className:"w-6 h-6 text-purple-200 flex-shrink-0"})]})})}),o.jsx(Mt,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:o.jsx(Rt,{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-orange-100 text-xs truncate",children:"Élèves"}),o.jsx("p",{className:"text-xl font-bold",children:(r==null?void 0:r.students)||0})]}),o.jsx(k_,{className:"w-6 h-6 text-orange-200 flex-shrink-0"})]})})})]})})]})}const eY=()=>{const{user:t,profile:e,loading:r}=st(),[n,s]=y.useState("stats");if(r)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-edu-primary mx-auto mb-4"}),o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Chargement..."}),o.jsx("p",{className:"text-gray-600",children:"Vérification des permissions"})]})});if(!t)return o.jsx(A7,{to:"/auth",replace:!0});if(!e||e.role!=="admin")return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs(Mt,{className:"w-full max-w-md",children:[o.jsxs(er,{children:[o.jsxs(ur,{className:"text-red-600 flex items-center",children:[o.jsx(zp,{className:"mr-2",size:24}),"Accès refusé"]}),o.jsx(r6,{children:"Vous n'avez pas les permissions nécessaires pour accéder à cette page. Seuls les administrateurs peuvent accéder au tableau de bord."})]}),o.jsx(Rt,{children:o.jsxs("p",{className:"text-sm text-gray-500",children:["Rôle actuel: ",(e==null?void 0:e.role)||"Non défini"]})})]})});const i=()=>{switch(n){case"stats":return o.jsx(ZN,{});case"online-users":return o.jsx(fG,{});case"create-formation":return o.jsx(uG,{});case"products":return o.jsx(dG,{});case"videos":return o.jsx(KG,{});case"users":return o.jsx(hG,{});default:return o.jsx(ZN,{})}};return o.jsx(WA,{children:o.jsxs("div",{className:"min-h-screen flex w-full",children:[o.jsx(JG,{activeTab:n,onTabChange:s}),o.jsxs(YA,{children:[o.jsx(ZG,{profileName:`${e.first_name} ${e.last_name}`,profileRole:e.role}),o.jsx("div",{className:"flex-1 p-6",children:i()})]})]})})},tY=()=>o.jsx(eY,{}),rY=()=>{const[t,e]=y.useState({firstName:"",lastName:"",phone:"",country:"",gender:"",age:"",interests:[],wantToBeInstructor:!1,newPassword:"",language:"fr"}),[r,n]=y.useState(!1),[s,i]=y.useState(!1),[a,l]=y.useState(null),[c,u]=y.useState(!0),d=Mn(),{toast:h}=dA(),f=["France","Belgique","Suisse","Canada","Maroc","Tunisie","Algérie","Sénégal","Côte d'Ivoire","Autre"],m=["Technologie","Sciences","Littérature","Arts","Sport","Musique","Cinéma","Voyage","Cuisine","Photographie","Mode","Business"];y.useEffect(()=>{p()},[]);const p=async()=>{try{u(!0);const{data:{session:x},error:w}=await ae.auth.getSession();if(w){console.error("Session error:",w),d("/auth");return}if(!(x!=null&&x.user)){console.log("No user session found, redirecting to auth"),d("/auth");return}console.log("User session found:",x.user.id),l(x.user);const{data:_,error:S}=await ae.from("profiles").select("*").eq("id",x.user.id).single();S&&S.code!=="PGRST116"&&console.error("Profile fetch error:",S),_&&(console.log("Profile loaded:",_),e({firstName:_.first_name||"",lastName:_.last_name||"",phone:_.phone||"",country:_.country||"",gender:_.gender||"",age:_.age?_.age.toString():"",interests:_.interests||[],wantToBeInstructor:_.is_teacher||!1,newPassword:"",language:_.language||"fr"}))}catch(x){console.error("Error in checkUser:",x),h({title:"Erreur",description:"Erreur lors du chargement du profil",variant:"destructive"})}finally{u(!1)}},v=x=>{e(w=>({...w,interests:w.interests.includes(x)?w.interests.filter(_=>_!==x):[...w.interests,x]}))},b=async x=>{if(x.preventDefault(),!!a){i(!0);try{const{error:w}=await ae.from("profiles").upsert({id:a.id,first_name:t.firstName,last_name:t.lastName,phone:t.phone,country:t.country,gender:t.gender,age:t.age?parseInt(t.age):null,interests:t.interests,is_teacher:t.wantToBeInstructor,language:t.language,profile_completed:!0});if(w)throw w;if(t.newPassword){const{error:_}=await ae.auth.updateUser({password:t.newPassword});if(_)throw _}h({title:"Profil mis à jour !",description:"Votre profil a été complété avec succès."}),d("/cours")}catch(w){console.error("Submit error:",w),h({title:"Erreur",description:w.message||"Une erreur est survenue",variant:"destructive"})}finally{i(!1)}}};return c?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Chargement..."}),o.jsx("p",{className:"text-gray-600",children:"Initialisation du profil"})]})}):a?o.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:o.jsx("div",{className:"max-w-2xl mx-auto",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"Complétez votre profil"}),o.jsxs("form",{onSubmit:b,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[o.jsx(Ya,{className:"mr-2",size:20}),"Informations personnelles"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"firstName",children:"Prénom *"}),o.jsx(Ye,{id:"firstName",value:t.firstName,onChange:x=>e(w=>({...w,firstName:x.target.value})),required:!0})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"lastName",children:"Nom *"}),o.jsx(Ye,{id:"lastName",value:t.lastName,onChange:x=>e(w=>({...w,lastName:x.target.value})),required:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"phone",children:"Téléphone"}),o.jsxs("div",{className:"relative",children:[o.jsx(sf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),o.jsx(Ye,{id:"phone",type:"tel",value:t.phone,onChange:x=>e(w=>({...w,phone:x.target.value})),className:"pl-10"})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"country",children:"Pays"}),o.jsxs("select",{id:"country",value:t.country,onChange:x=>e(w=>({...w,country:x.target.value})),className:"w-full h-10 px-3 rounded-md border border-input bg-background",children:[o.jsx("option",{value:"",children:"Sélectionnez un pays"}),f.map(x=>o.jsx("option",{value:x,children:x},x))]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"gender",children:"Genre"}),o.jsxs("select",{id:"gender",value:t.gender,onChange:x=>e(w=>({...w,gender:x.target.value})),className:"w-full h-10 px-3 rounded-md border border-input bg-background",children:[o.jsx("option",{value:"",children:"Sélectionnez"}),o.jsx("option",{value:"homme",children:"Homme"}),o.jsx("option",{value:"femme",children:"Femme"}),o.jsx("option",{value:"autre",children:"Autre"}),o.jsx("option",{value:"prefere_ne_pas_dire",children:"Préfère ne pas dire"})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"age",children:"Âge (optionnel)"}),o.jsxs("div",{className:"relative",children:[o.jsx(jz,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),o.jsx(Ye,{id:"age",type:"number",value:t.age,onChange:x=>e(w=>({...w,age:x.target.value})),className:"pl-10",min:"13",max:"120"})]})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[o.jsx(rf,{className:"mr-2",size:20}),"Centres d'intérêt"]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map(x=>o.jsx("button",{type:"button",onClick:()=>v(x),className:`p-2 text-sm rounded-md border transition-colors ${t.interests.includes(x)?"bg-[#25d366] text-white border-[#25d366]":"bg-white text-gray-700 border-gray-300 hover:border-[#25d366]"}`,children:x},x))})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[o.jsx(L_,{className:"mr-2",size:20}),"Options"]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"instructor",checked:t.wantToBeInstructor,onChange:x=>e(w=>({...w,wantToBeInstructor:x.target.checked})),className:"w-4 h-4 text-[#25d366] border-gray-300 rounded focus:ring-[#25d366]"}),o.jsx(Ke,{htmlFor:"instructor",children:"Je souhaite devenir encadreur"})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"language",children:"Langue"}),o.jsxs("select",{id:"language",value:t.language,onChange:x=>e(w=>({...w,language:x.target.value})),className:"w-full h-10 px-3 rounded-md border border-input bg-background",children:[o.jsx("option",{value:"fr",children:"Français"}),o.jsx("option",{value:"en",children:"English"}),o.jsx("option",{value:"es",children:"Español"}),o.jsx("option",{value:"ar",children:"العربية"})]})]}),o.jsxs("div",{children:[o.jsx(Ke,{htmlFor:"newPassword",children:"Nouveau mot de passe (optionnel)"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ye,{id:"newPassword",type:r?"text":"password",value:t.newPassword,onChange:x=>e(w=>({...w,newPassword:x.target.value})),className:"pr-10"}),o.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:r?o.jsx(N_,{size:16}):o.jsx(Ga,{size:16})})]})]})]}),o.jsxs("div",{className:"flex justify-between pt-6",children:[o.jsx(J,{type:"button",variant:"outline",onClick:()=>d("/cours"),children:"Passer pour l'instant"}),o.jsx(J,{type:"submit",className:"bg-[#25d366] hover:bg-[#20c75a]",disabled:s,children:s?"Sauvegarde...":"Sauvegarder"})]})]})]})})}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Redirection..."}),o.jsx("p",{className:"text-gray-600",children:"Vous devez être connecté"})]})})},nY=()=>{const t=ma();return y.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),o.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),o.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},sY=()=>{const{user:t}=st();return Nt({queryKey:["unread-counts",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id))return{notifications:0,messages:0,total:0};const{data:e,error:r}=await ae.from("notifications").select("id",{count:"exact"}).or(`user_id.eq.${t.id},is_for_all_admins.eq.true`).eq("is_read",!1);r&&console.error("Error counting notifications:",r);const{data:n,error:s}=await ae.from("lesson_messages").select("id",{count:"exact"}).eq("receiver_id",t.id).eq("is_read",!1);s&&console.error("Error counting messages:",s);const i=(e==null?void 0:e.length)||0,a=(n==null?void 0:n.length)||0,l=i+a;return{notifications:i,messages:a,total:l}},enabled:!!(t!=null&&t.id),refetchInterval:3e4})},DL=y.createContext(void 0),iY=({children:t})=>{const[e,r]=y.useState("home");return o.jsx(DL.Provider,{value:{currentView:e,setCurrentView:r},children:t})},bj=()=>{const t=y.useContext(DL);if(t===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return t},aY=()=>{const t=Mn(),e=ma(),{currentView:r,setCurrentView:n}=bj(),{data:s}=sY(),i=[{icon:$z,label:"Accueil",view:"home",path:"/"},{icon:i9,label:"Shop",view:"shop",path:"/shop"},{icon:k_,label:"Cours",view:"cours",path:"/cours",special:!0},{icon:P_,label:"Messages",view:"messages",path:"/messages"},{icon:Ya,label:"Profil",view:"profil",path:"/profil"}],a=c=>{n(c.view),t(c.path)},l=c=>e.pathname===c||c==="/"&&e.pathname==="/home";return o.jsx("nav",{className:"bg-white border-t border-gray-200 px-4 py-2",children:o.jsx("div",{className:"flex justify-around items-center",children:i.map(c=>{const u=l(c.path),d=c.icon,h=c.view==="messages"&&s&&s.total>0;return o.jsxs("button",{onClick:()=>a(c),className:`flex flex-col items-center py-2 px-3 rounded-lg transition-all duration-200 relative ${u?"text-edu-primary bg-edu-primary/10":"text-gray-600 hover:text-edu-primary hover:bg-gray-50"} ${c.special?"scale-110":""}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx(d,{size:c.special?24:20,className:`mb-1 ${u?"animate-bounce-subtle":""} ${c.special?"text-[#25d366]":""}`}),h&&o.jsx(yr,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 flex items-center justify-center p-0 text-xs",children:s.total>99?"99+":s.total})]}),o.jsx("span",{className:`text-xs font-medium ${c.special?"font-bold":""}`,children:c.label})]},c.view)})})})},oY=({activeTab:t,onTabChange:e})=>{const r=[{id:"videos",label:"Vidéos",icon:Xo},{id:"posts",label:"Posts",icon:os},{id:"search",label:"Recherche",icon:bu}];return o.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-30",children:o.jsx("div",{className:"flex items-center bg-transparent backdrop-blur-md rounded-full p-1",children:r.map(n=>{const s=n.icon;return o.jsxs("button",{onClick:()=>e(n.id),className:`
                flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-200
                ${t===n.id?"bg-white/30 text-white shadow-lg backdrop-blur-sm":"text-white/70 hover:text-white hover:bg-white/10"}
              `,children:[o.jsx(s,{size:16}),o.jsx("span",{className:"hidden sm:inline",children:n.label})]},n.id)})})})},lY=({src:t,poster:e,className:r="",autoPlay:n=!1,muted:s=!0,loop:i=!0,onPlay:a,onPause:l})=>{const c=y.useRef(null),[u,d]=y.useState(!1),[h,f]=y.useState(s),[m,p]=y.useState(!1),[v,b]=y.useState(!1),[x,w]=y.useState("");y.useEffect(()=>{const E=/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,P=t.match(E);P&&(b(!0),w(P[1]))},[t]),y.useEffect(()=>{c.current&&!v&&(c.current.muted=h,n?c.current.play().then(()=>{d(!0),a==null||a()}).catch(console.error):(c.current.pause(),d(!1),l==null||l()))},[n,h,a,l,v]);const _=()=>{var E,P;!c.current&&!v||v||(u?((E=c.current)==null||E.pause(),d(!1),l==null||l()):(P=c.current)==null||P.play().then(()=>{d(!0),a==null||a()}).catch(console.error))},S=()=>{c.current&&(c.current.muted=!h,f(!h))},N=()=>{c.current&&(document.fullscreenElement?document.exitFullscreen():c.current.requestFullscreen())};return v?o.jsx("div",{className:`relative ${r}`,children:o.jsx("iframe",{src:`https://www.youtube.com/embed/${x}?autoplay=${n?1:0}&mute=${s?1:0}&loop=${i?1:0}&controls=0&showinfo=0&rel=0&modestbranding=1&playlist=${x}`,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):o.jsxs("div",{className:`relative group ${r}`,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[o.jsx("video",{ref:c,src:t,poster:e,className:"w-full h-full object-cover",muted:h,loop:i,playsInline:!0,onPlay:()=>{d(!0),a==null||a()},onPause:()=>{d(!1),l==null||l()}}),o.jsxs("div",{className:`absolute inset-0 bg-black bg-opacity-20 transition-opacity duration-300 ${m?"opacity-100":"opacity-0"}`,children:[o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("button",{onClick:_,className:"bg-black bg-opacity-50 rounded-full p-4 text-white hover:bg-opacity-70 transition-all",children:u?o.jsx(yw,{size:32}):o.jsx(oa,{size:32})})}),o.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:_,className:"text-white hover:text-gray-300 transition-colors",children:u?o.jsx(yw,{size:20}):o.jsx(oa,{size:20})}),o.jsx("button",{onClick:S,className:"text-white hover:text-gray-300 transition-colors",children:h?o.jsx(HP,{size:20}):o.jsx(i1,{size:20})})]}),o.jsx("button",{onClick:N,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx(Hz,{size:20})})]})]})]})};var wj="Avatar",[cY,tse]=Ko(wj),[uY,FL]=cY(wj),IL=y.forwardRef((t,e)=>{const{__scopeAvatar:r,...n}=t,[s,i]=y.useState("idle");return o.jsx(uY,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:o.jsx(vt.span,{...n,ref:e})})});IL.displayName=wj;var zL="AvatarImage",$L=y.forwardRef((t,e)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:s=()=>{},...i}=t,a=FL(zL,r),l=dY(n,i.referrerPolicy),c=An(u=>{s(u),a.onImageLoadingStatusChange(u)});return jn(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?o.jsx(vt.img,{...i,ref:e,src:n}):null});$L.displayName=zL;var BL="AvatarFallback",qL=y.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:n,...s}=t,i=FL(BL,r),[a,l]=y.useState(n===void 0);return y.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),a&&i.imageLoadingStatus!=="loaded"?o.jsx(vt.span,{...s,ref:e}):null});qL.displayName=BL;function dY(t,e){const[r,n]=y.useState("idle");return jn(()=>{if(!t){n("error");return}let s=!0;const i=new window.Image,a=l=>()=>{s&&n(l)};return n("loading"),i.onload=a("loaded"),i.onerror=a("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{s=!1}},[t,e]),r}var UL=IL,VL=$L,WL=qL;const Uh=y.forwardRef(({className:t,...e},r)=>o.jsx(UL,{ref:r,className:Be("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));Uh.displayName=UL.displayName;const Vh=y.forwardRef(({className:t,...e},r)=>o.jsx(VL,{ref:r,className:Be("aspect-square h-full w-full",t),...e}));Vh.displayName=VL.displayName;const Wh=y.forwardRef(({className:t,...e},r)=>o.jsx(WL,{ref:r,className:Be("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Wh.displayName=WL.displayName;const hY=({profile:t,showFollowButton:e=!1,className:r=""})=>{var a;const[n,s]=Fe.useState(!1),i=l=>{l.stopPropagation(),s(!n),me.success(n?"Désabonné":"Abonné !")};return o.jsx("div",{className:`flex flex-col items-center ${r}`,children:o.jsxs("div",{className:"relative",children:[o.jsxs(Uh,{className:"w-12 h-12 border-2 border-white",children:[o.jsx(Vh,{src:t==null?void 0:t.avatar_url}),o.jsx(Wh,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-sm",children:((a=t==null?void 0:t.first_name)==null?void 0:a[0])||"U"})]}),e&&o.jsx(J,{onClick:i,size:"sm",className:`absolute -bottom-1 -right-1 w-6 h-6 rounded-full text-xs font-bold ${n?"bg-gray-500 text-white":"bg-red-500 text-white hover:bg-red-600"}`,children:n?"✓":o.jsx(ls,{size:12})})]})})},fY=(t,e)=>{const{user:r}=st(),[n,s]=y.useState(!1),[i,a]=y.useState(e),[l,c]=y.useState(!1);y.useEffect(()=>{r&&t&&u()},[r,t]);const u=async()=>{if(r)try{const{data:h}=await ae.from("video_likes").select("id").eq("video_id",t).eq("user_id",r.id).maybeSingle();s(!!h)}catch(h){console.error("Error checking like status:",h)}};return{isLiked:n,likesCount:i,toggleLike:async()=>{if(!r){me.error("Connectez-vous pour liker cette vidéo");return}if(!l){c(!0);try{if(n){const{error:h}=await ae.from("video_likes").delete().eq("video_id",t).eq("user_id",r.id);if(h)throw h;a(f=>Math.max(0,f-1)),s(!1),me.success("Like retiré")}else{const{error:h}=await ae.from("video_likes").insert({video_id:t,user_id:r.id});if(h)throw h;a(f=>f+1),s(!0),me.success("Vidéo likée !")}}catch(h){console.error("Error toggling like:",h),me.error("Erreur lors du like")}finally{c(!1)}}},isLoading:l}},HL=({isActive:t,onComplete:e})=>{const[r,n]=y.useState([]),s=["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#54a0ff"],i=()=>{const a=[];for(let l=0;l<50;l++)a.push({id:l,x:Math.random()*window.innerWidth,y:-10,color:s[Math.floor(Math.random()*s.length)],size:Math.random()*8+4,speedX:(Math.random()-.5)*6,speedY:Math.random()*3+2,rotation:Math.random()*360,rotationSpeed:(Math.random()-.5)*10});return a};return y.useEffect(()=>{if(!t)return;n(i());const l=setInterval(()=>{n(u=>u.map(d=>({...d,x:d.x+d.speedX,y:d.y+d.speedY,rotation:d.rotation+d.rotationSpeed,speedY:d.speedY+.1})).filter(d=>d.y<window.innerHeight+50))},16),c=setTimeout(()=>{clearInterval(l),n([]),e()},2e3);return()=>{clearInterval(l),clearTimeout(c)}},[t,e]),t?o.jsx("div",{className:"fixed inset-0 pointer-events-none z-50",children:r.map(a=>o.jsx("div",{className:"absolute",style:{left:a.x,top:a.y,width:a.size,height:a.size,backgroundColor:a.color,transform:`rotate(${a.rotation}deg)`,borderRadius:Math.random()>.5?"50%":"0"}},a.id))}):null},mY=({videoId:t,initialLikesCount:e,onLikeWithConfetti:r})=>{const{isLiked:n,likesCount:s,toggleLike:i,isLoading:a}=fY(t,e),[l,c]=Fe.useState(!1),u=h=>{h.stopPropagation(),i(),n||(c(!0),r==null||r())},d=h=>h<1e3?h.toString():h<1e6?(h/1e3).toFixed(1)+"K":(h/1e6).toFixed(1)+"M";return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:u,disabled:a,className:`w-12 h-12 rounded-full bg-black/30 backdrop-blur-sm text-white hover:bg-black/50 transition-all duration-200 flex items-center justify-center border border-white/20 ${n?"text-red-500 bg-red-500/30":""}`,children:o.jsx(rf,{size:20,className:`${n?"fill-current":""}`})}),o.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:d(s)})]}),o.jsx(HL,{isActive:l,onComplete:()=>c(!1)})]})},pY=({videoId:t,initialIsSaved:e=!1})=>{const[r,n]=y.useState(e),s=i=>{i.stopPropagation(),n(!r),me.success(r?"Vidéo retirée des favoris":"Vidéo ajoutée aux favoris")};return o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:s,className:`w-12 h-12 rounded-full bg-black/30 backdrop-blur-sm text-white hover:bg-black/50 transition-all duration-200 flex items-center justify-center border border-white/20 ${r?"text-yellow-500 bg-yellow-500/30":""}`,children:o.jsx(_z,{size:20,className:`${r?"fill-current":""}`})}),o.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:r?"Sauvé":"Sauver"})]})},gY=({commentsCount:t,onCommentClick:e})=>{const r=n=>n<1e3?n.toString():n<1e6?(n/1e3).toFixed(1)+"K":(n/1e6).toFixed(1)+"M";return o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:e,className:"w-12 h-12 rounded-full bg-black/30 backdrop-blur-sm text-white hover:bg-black/50 transition-all duration-200 flex items-center justify-center border border-white/20",children:o.jsx(Zs,{size:20})}),o.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:r(t)})]})},vY=({isOpen:t,onClose:e,videoId:r,videoTitle:n})=>{var b;const{user:s}=st(),[i,a]=y.useState([]),[l,c]=y.useState(""),[u,d]=y.useState(!1),[h,f]=y.useState(!1);y.useEffect(()=>{t&&r&&m()},[t,r]);const m=async()=>{d(!0);try{const{data:x,error:w}=await ae.from("video_comments").select(`
          id,
          content,
          likes_count,
          created_at,
          profiles (
            first_name,
            last_name,
            username,
            avatar_url
          )
        `).eq("video_id",r).is("parent_comment_id",null).order("created_at",{ascending:!1});if(w)throw w;a(x||[])}catch(x){console.error("Error fetching comments:",x),me.error("Erreur lors du chargement des commentaires")}finally{d(!1)}},p=async x=>{if(x.preventDefault(),!(!s||!l.trim())){f(!0);try{const{error:w}=await ae.from("video_comments").insert({video_id:r,user_id:s.id,content:l.trim()});if(w)throw w;c(""),m(),me.success("Commentaire ajouté !")}catch(w){console.error("Error submitting comment:",w),me.error("Erreur lors de l'ajout du commentaire")}finally{f(!1)}}},v=x=>{const w=new Date(x),S=Math.floor((new Date().getTime()-w.getTime())/(1e3*60*60));return S<1?"À l'instant":S<24?`${S}h`:`${Math.floor(S/24)}j`};return o.jsx(Br,{open:t,onOpenChange:e,children:o.jsxs(Or,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[o.jsx(hn,{children:o.jsxs(fn,{className:"flex items-center gap-2",children:["Commentaires",n&&o.jsxs("span",{className:"text-sm text-gray-500",children:["- ",n]})]})}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[o.jsx("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4",children:u?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Chargement des commentaires..."})]}):i.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-gray-500",children:"Aucun commentaire pour le moment"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Soyez le premier à commenter !"})]}):i.map(x=>{var w,_,S;return o.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.jsxs(Uh,{className:"w-8 h-8",children:[o.jsx(Vh,{src:(w=x.profiles)==null?void 0:w.avatar_url}),o.jsx(Wh,{children:o.jsx(Ya,{size:16})})]}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[o.jsx("span",{className:"font-medium text-sm",children:((_=x.profiles)==null?void 0:_.first_name)||((S=x.profiles)==null?void 0:S.username)||"Utilisateur"}),o.jsx("span",{className:"text-xs text-gray-500",children:v(x.created_at)})]}),o.jsx("p",{className:"text-sm text-gray-700 mb-2",children:x.content}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("button",{className:"flex items-center space-x-1 text-gray-500 hover:text-red-500 transition-colors",children:[o.jsx(rf,{size:14}),o.jsx("span",{className:"text-xs",children:x.likes_count})]})})]})]},x.id)})}),s?o.jsx("form",{onSubmit:p,className:"border-t pt-4",children:o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs(Uh,{className:"w-8 h-8",children:[o.jsx(Vh,{src:(b=s.user_metadata)==null?void 0:b.avatar_url}),o.jsx(Wh,{children:o.jsx(Ya,{size:16})})]}),o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx(jr,{value:l,onChange:x=>c(x.target.value),placeholder:"Écrivez votre commentaire...",className:"min-h-[80px] resize-none",maxLength:500}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("span",{className:"text-xs text-gray-500",children:[l.length,"/500"]}),o.jsxs(J,{type:"submit",disabled:!l.trim()||h,size:"sm",className:"flex items-center gap-2",children:[o.jsx(xc,{size:14}),h?"Envoi...":"Commenter"]})]})]})]})}):o.jsx("div",{className:"text-center py-4 border-t",children:o.jsx("p",{className:"text-gray-500",children:"Connectez-vous pour laisser un commentaire"})})]})]})})},xY=({video:t,isActive:e,onLikeWithConfetti:r})=>{const n=Mn(),[s,i]=y.useState(!1),[a,l]=y.useState(!1),[c,u]=y.useState(!1);y.useEffect(()=>{i(!!e)},[e]);const d=()=>{i(v=>!v)},h=v=>{n(`/formation/${v}`)},f=()=>{u(!0)},m=v=>{v.stopPropagation(),navigator.share?navigator.share({title:"Regardez cette vidéo",url:window.location.href}).catch(console.error):(navigator.clipboard.writeText(window.location.href),me.success("Lien copié !"))},p=()=>{l(!a)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative h-screen w-full flex items-center justify-center bg-black",children:[o.jsxs("div",{onClick:d,className:"relative h-full w-auto max-w-full cursor-pointer",children:[o.jsx(lY,{src:t.video_url,poster:t.thumbnail_url,className:"h-full w-full object-cover",autoPlay:s,muted:a,loop:!0,onPlay:()=>i(!0),onPause:()=>i(!1)}),t.video_type==="promo"&&o.jsx(yr,{className:"absolute top-4 left-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold px-3 py-1 z-20",children:"🎓 Formation"}),o.jsx(J,{onClick:v=>{v.stopPropagation(),p()},variant:"ghost",size:"sm",className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-black/30 backdrop-blur-sm text-white hover:bg-black/50 z-20",children:a?o.jsx(HP,{size:20}):o.jsx(i1,{size:20})})]}),o.jsxs("div",{className:"absolute bottom-32 left-4 right-20 z-10 max-w-xs sm:max-w-sm",children:[o.jsx("p",{className:"text-white text-sm sm:text-base mb-2 leading-relaxed line-clamp-3",children:t.description}),o.jsxs("p",{className:"text-white/80 text-xs sm:text-sm",children:["#",t.title]}),t.video_type==="promo"&&t.formation_id&&o.jsxs("div",{className:"flex flex-col space-y-2 mt-3",children:[o.jsxs(J,{onClick:v=>{v.stopPropagation(),h(t.formation_id)},size:"sm",className:"bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold py-2 px-4 rounded-full flex items-center space-x-2 text-xs sm:text-sm z-50",children:[o.jsx(lx,{className:"w-3 h-3 sm:w-4 sm:h-4"}),o.jsx("span",{children:"Découvrir"})]}),t.price&&o.jsx(J,{onClick:v=>{v.stopPropagation(),h(t.formation_id)},size:"sm",className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold py-2 px-4 rounded-full flex items-center space-x-2 text-xs sm:text-sm z-50",children:o.jsxs("span",{children:["💰 Acheter ",t.price,"€/mois"]})})]})]}),o.jsxs("div",{className:"absolute right-2 sm:right-4 bottom-32 z-20 flex flex-col items-center space-y-4",children:[o.jsx(hY,{profile:t.profiles,showFollowButton:!0}),o.jsxs("div",{className:"flex flex-col items-center space-y-4 z-30",children:[o.jsx(mY,{videoId:t.id,initialLikesCount:t.likes_count,onLikeWithConfetti:r}),o.jsx(gY,{commentsCount:t.comments_count,onCommentClick:f}),o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:m,className:"w-12 h-12 rounded-full bg-black/30 backdrop-blur-sm text-white hover:bg-black/50 transition-all duration-200 flex items-center justify-center border border-white/20",children:o.jsx(qP,{size:20})}),o.jsx("span",{className:"text-white text-xs mt-1 font-medium",children:"Partager"})]}),o.jsx(pY,{videoId:t.id})]})]})]}),o.jsx(vY,{isOpen:c,onClose:()=>u(!1),videoId:t.id,videoTitle:t.title})]})},yY=()=>{var n,s;const{user:t}=st(),e=UI({queryKey:["infinite-videos",t==null?void 0:t.id],queryFn:async({pageParam:i=0})=>{const l=i*3,c=l+3-1;let u=[];if(t){const{data:m}=await ae.from("profiles").select("interests").eq("id",t.id).single();u=(m==null?void 0:m.interests)||[]}let d=ae.from("videos").select(`
          *,
          profiles:author_id (
            first_name,
            last_name,
            username,
            avatar_url
          )
        `).eq("is_active",!0).neq("video_type","lesson").range(l,c);u.length>0&&Math.random()<.8?d=d.order("likes_count",{ascending:!1}):Math.random()<.5?d=d.order("likes_count",{ascending:!1}):d=d.order("created_at",{ascending:!1});const{data:h,error:f}=await d;return f?(console.error("Error fetching videos:",f),[]):h||[]},getNextPageParam:(i,a)=>i.length===3?a.length:void 0,initialPageParam:0}),r=((s=(n=e.data)==null?void 0:n.pages)==null?void 0:s.flat())||[];return{...e,data:r}},tk=()=>{const{data:t,fetchNextPage:e,hasNextPage:r,isFetchingNextPage:n}=yY(),[s,i]=y.useState(0),[a,l]=y.useState(!1),c=y.useRef(null),u=y.useRef([]);y.useEffect(()=>{const h=new IntersectionObserver(f=>{f.forEach(m=>{const p=parseInt(m.target.getAttribute("data-video-index")||"0");m.isIntersecting&&m.intersectionRatio>.7&&i(p)})},{threshold:.7});return u.current.forEach(f=>{f&&h.observe(f)}),()=>h.disconnect()},[t.length]),y.useEffect(()=>{s>=t.length-2&&r&&!n&&e()},[s,t.length,r,n,e]);const d=()=>{l(!0)};return t.length?o.jsxs("div",{ref:c,className:"relative h-full w-full bg-black overflow-y-auto snap-y snap-mandatory",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[t.map((h,f)=>o.jsx("div",{ref:m=>u.current[f]=m,"data-video-index":f,className:"relative h-screen w-full snap-start snap-always",children:o.jsx(xY,{video:h,isActive:f===s,onLikeWithConfetti:d})},h.id)),n&&o.jsx("div",{className:"absolute bottom-32 left-1/2 transform -translate-x-1/2 z-50",children:o.jsx("div",{className:"bg-black/50 rounded-full p-2 sm:p-3",children:o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 sm:h-6 sm:w-6 border-b-2 border-white"})})}),o.jsx(HL,{isActive:a,onComplete:()=>l(!1)})]}):o.jsx("div",{className:"h-full flex items-center justify-center text-white",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})},bY=(t="all")=>Nt({queryKey:["posts",t],queryFn:async()=>{console.log("Fetching posts with filter:",t);let e=ae.from("posts").select("*").eq("is_active",!0).order("created_at",{ascending:!1});t!=="all"&&(e=e.eq("post_type",t));const{data:r,error:n}=await e;if(n)return console.error("Error fetching posts:",n),[];if(!r||r.length===0)return console.log("No posts found"),[];console.log("Posts fetched:",r);const s=[...new Set(r.map(c=>c.author_id))],{data:i,error:a}=await ae.from("profiles").select("id, first_name, last_name, username, avatar_url").in("id",s);if(a)return console.error("Error fetching profiles:",a),r.map(c=>({...c,profiles:{first_name:"Utilisateur",last_name:"",username:"user",avatar_url:""}}));const l=r.map(c=>{const u=i==null?void 0:i.find(d=>d.id===c.author_id);return{...c,profiles:u?{first_name:u.first_name||"",last_name:u.last_name||"",username:u.username||"",avatar_url:u.avatar_url||""}:{first_name:"Utilisateur",last_name:"",username:"user",avatar_url:""}}});return console.log("Posts with profiles:",l),l}}),wY=()=>{const t=br();return Vt({mutationFn:async({content:e,postType:r,imageFile:n,authorId:s})=>{let i=null;if(n){const c=n.name.split(".").pop(),u=`${Date.now()}.${c}`,{error:d}=await ae.storage.from("post-images").upload(u,n);if(d)throw console.error("Error uploading image:",d),new Error("Erreur lors de l'upload de l'image");const{data:{publicUrl:h}}=ae.storage.from("post-images").getPublicUrl(u);i=h}const{data:a,error:l}=await ae.from("posts").insert([{content:e,post_type:r,author_id:s,image_url:i,is_active:!0}]).select().single();if(l)throw console.error("Error creating post:",l),l;return a},onSuccess:()=>{t.invalidateQueries({queryKey:["posts"]}),me.success("Post créé avec succès !")},onError:e=>{console.error("Error creating post:",e),me.error("Erreur lors de la création du post")}})},_Y=({isOpen:t,onClose:e})=>{const[r,n]=y.useState(""),[s,i]=y.useState("general"),[a,l]=y.useState(null),[c,u]=y.useState(null),{user:d}=st(),{mutate:h,isPending:f}=wY(),m=[{value:"general",label:"Général",icon:Zs,color:"text-gray-400"},{value:"recruitment",label:"Recrutement",icon:C_,color:"text-blue-400"},{value:"info",label:"Information",icon:E_,color:"text-green-400"}],p=b=>{var w;const x=(w=b.target.files)==null?void 0:w[0];if(x){if(x.size>5*1024*1024){me.error("L'image ne doit pas dépasser 5MB");return}l(x);const _=new FileReader;_.onload=S=>{var N;u((N=S.target)==null?void 0:N.result)},_.readAsDataURL(x)}},v=()=>{if(!d){me.error("Vous devez être connecté pour créer un post");return}if(!r.trim()){me.error("Le contenu du post ne peut pas être vide");return}h({content:r.trim(),postType:s,imageFile:a,authorId:d.id},{onSuccess:()=>{me.success("Post créé avec succès !"),n(""),i("general"),l(null),u(null),e()},onError:b=>{console.error("Error creating post:",b),me.error("Erreur lors de la création du post")}})};return t?o.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-gray-900 rounded-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[o.jsx("h2",{className:"text-white text-lg font-semibold",children:"Créer un post"}),o.jsx(J,{variant:"ghost",size:"sm",onClick:e,className:"text-gray-400 hover:text-white",children:o.jsx(qr,{size:20})})]}),o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-white text-sm font-medium mb-2 block",children:"Type de publication"}),o.jsx("div",{className:"flex space-x-2",children:m.map(b=>{const x=b.icon;return o.jsxs("button",{onClick:()=>i(b.value),className:`flex items-center space-x-2 px-3 py-2 rounded-lg text-sm transition-colors ${s===b.value?"bg-edu-primary text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[o.jsx(x,{size:16,className:s===b.value?"text-white":b.color}),o.jsx("span",{children:b.label})]},b.value)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-white text-sm font-medium mb-2 block",children:"Contenu"}),o.jsx("textarea",{value:r,onChange:b=>n(b.target.value),placeholder:"Quoi de neuf ?",className:"w-full h-32 bg-gray-800 border border-gray-700 rounded-lg p-3 text-white placeholder-gray-400 focus:outline-none focus:border-edu-primary resize-none",maxLength:500}),o.jsxs("div",{className:"text-right text-xs text-gray-400 mt-1",children:[r.length,"/500"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-white text-sm font-medium mb-2 block",children:"Image (optionnel)"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:p,className:"hidden",id:"image-upload"}),o.jsxs("label",{htmlFor:"image-upload",className:"flex items-center space-x-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg cursor-pointer transition-colors",children:[o.jsx(nf,{size:16,className:"text-gray-400"}),o.jsx("span",{className:"text-gray-300 text-sm",children:"Ajouter une image"})]}),a&&o.jsx("span",{className:"text-sm text-gray-400",children:a.name})]}),c&&o.jsxs("div",{className:"mt-3 relative",children:[o.jsx("img",{src:c,alt:"Aperçu",className:"w-full h-40 object-cover rounded-lg"}),o.jsx("button",{onClick:()=>{l(null),u(null)},className:"absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1",children:o.jsx(qr,{size:16})})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-4 border-t border-gray-800",children:[o.jsx(J,{variant:"outline",onClick:e,className:"border-gray-600 text-gray-300 hover:bg-gray-800",children:"Annuler"}),o.jsx(J,{onClick:v,disabled:!r.trim()||f,className:"bg-edu-primary hover:bg-edu-primary/90 text-white",children:f?"Publication...":"Publier"})]})]})}):null};function tr(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Uo(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function jY(t,e){const r=tr(t);return isNaN(e)?Uo(t,NaN):(r.setDate(r.getDate()+e),r)}const GL=6048e5,SY=864e5,j0=43200,rk=1440;let CY={};function Gp(){return CY}function Cu(t,e){var l,c,u,d;const r=Gp(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=tr(t),i=s.getDay(),a=(i<n?7:0)+i-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function wx(t){return Cu(t,{weekStartsOn:1})}function YL(t){const e=tr(t),r=e.getFullYear(),n=Uo(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=wx(n),i=Uo(t,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=wx(i);return e.getTime()>=s.getTime()?r+1:e.getTime()>=a.getTime()?r:r-1}function _x(t){const e=tr(t);return e.setHours(0,0,0,0),e}function jx(t){const e=tr(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function NY(t,e){const r=_x(t),n=_x(e),s=+r-jx(r),i=+n-jx(n);return Math.round((s-i)/SY)}function kY(t){const e=YL(t),r=Uo(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),wx(r)}function bv(t,e){const r=tr(t),n=tr(e),s=r.getTime()-n.getTime();return s<0?-1:s>0?1:s}function Yp(t){return Uo(t,Date.now())}function XL(t,e){const r=_x(t),n=_x(e);return+r==+n}function EY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function KL(t){if(!EY(t)&&typeof t!="number")return!1;const e=tr(t);return!isNaN(Number(e))}function PY(t,e){const r=tr(t),n=tr(e),s=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return s*12+i}function AY(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function TY(t,e){return+tr(t)-+tr(e)}function LY(t){const e=tr(t);return e.setHours(23,59,59,999),e}function OY(t){const e=tr(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function MY(t){const e=tr(t);return+LY(e)==+OY(e)}function RY(t,e){const r=tr(t),n=tr(e),s=bv(r,n),i=Math.abs(PY(r,n));let a;if(i<1)a=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-s*i);let l=bv(r,n)===-s;MY(tr(t))&&i===1&&bv(t,n)===1&&(l=!1),a=s*(i-Number(l))}return a===0?0:a}function DY(t,e,r){const n=TY(t,e)/1e3;return AY(r==null?void 0:r.roundingMethod)(n)}function FY(t){const e=tr(t),r=Uo(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}const IY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},zY=(t,e,r)=>{let n;const s=IY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function lh(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const $Y={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},BY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},UY={date:lh({formats:$Y,defaultWidth:"full"}),time:lh({formats:BY,defaultWidth:"full"}),dateTime:lh({formats:qY,defaultWidth:"full"})},VY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},WY=(t,e,r,n)=>VY[t];function Fa(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):a;s=t.formattingValues[l]||t.formattingValues[a]}else{const a=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[a]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const HY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},GY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},KY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},QY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},JY=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ZY={ordinalNumber:JY,era:Fa({values:HY,defaultWidth:"wide"}),quarter:Fa({values:GY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Fa({values:YY,defaultWidth:"wide"}),day:Fa({values:XY,defaultWidth:"wide"}),dayPeriod:Fa({values:KY,defaultWidth:"wide",formattingValues:QY,defaultFormattingWidth:"wide"})};function Ia(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const a=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?tX(l,h=>h.test(a)):eX(l,h=>h.test(a));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(a.length);return{value:u,rest:d}}}function eX(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function tX(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function QL(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],i=e.match(t.parsePattern);if(!i)return null;let a=t.valueCallback?t.valueCallback(i[0]):i[0];a=r.valueCallback?r.valueCallback(a):a;const l=e.slice(s.length);return{value:a,rest:l}}}const rX=/^(\d+)(th|st|nd|rd)?/i,nX=/\d+/i,sX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},iX={any:[/^b/i,/^(a|c)/i]},aX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},oX={any:[/1/i,/2/i,/3/i,/4/i]},lX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},uX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},dX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},hX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},fX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mX={ordinalNumber:QL({matchPattern:rX,parsePattern:nX,valueCallback:t=>parseInt(t,10)}),era:Ia({matchPatterns:sX,defaultMatchWidth:"wide",parsePatterns:iX,defaultParseWidth:"any"}),quarter:Ia({matchPatterns:aX,defaultMatchWidth:"wide",parsePatterns:oX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ia({matchPatterns:lX,defaultMatchWidth:"wide",parsePatterns:cX,defaultParseWidth:"any"}),day:Ia({matchPatterns:uX,defaultMatchWidth:"wide",parsePatterns:dX,defaultParseWidth:"any"}),dayPeriod:Ia({matchPatterns:hX,defaultMatchWidth:"any",parsePatterns:fX,defaultParseWidth:"any"})},JL={code:"en-US",formatDistance:zY,formatLong:UY,formatRelative:WY,localize:ZY,match:mX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function pX(t){const e=tr(t);return NY(e,FY(e))+1}function gX(t){const e=tr(t),r=+wx(e)-+kY(e);return Math.round(r/GL)+1}function ZL(t,e){var d,h,f,m;const r=tr(t),n=r.getFullYear(),s=Gp(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,a=Uo(t,0);a.setFullYear(n+1,0,i),a.setHours(0,0,0,0);const l=Cu(a,e),c=Uo(t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=Cu(c,e);return r.getTime()>=l.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function vX(t,e){var l,c,u,d;const r=Gp(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=ZL(t,e),i=Uo(t,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),Cu(i,e)}function xX(t,e){const r=tr(t),n=+Cu(r,e)-+vX(r,e);return Math.round(n/GL)+1}function ar(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const gl={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return ar(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):ar(r+1,2)},d(t,e){return ar(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return ar(t.getHours()%12||12,e.length)},H(t,e){return ar(t.getHours(),e.length)},m(t,e){return ar(t.getMinutes(),e.length)},s(t,e){return ar(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return ar(s,e.length)}},bd={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},nk={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return gl.y(t,e)},Y:function(t,e,r,n){const s=ZL(t,n),i=s>0?s:1-s;if(e==="YY"){const a=i%100;return ar(a,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):ar(i,e.length)},R:function(t,e){const r=YL(t);return ar(r,e.length)},u:function(t,e){const r=t.getFullYear();return ar(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return ar(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return ar(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return gl.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return ar(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=xX(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):ar(s,e.length)},I:function(t,e,r){const n=gX(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):ar(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):gl.d(t,e)},D:function(t,e,r){const n=pX(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ar(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ar(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ar(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return ar(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=bd.noon:n===0?s=bd.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=bd.evening:n>=12?s=bd.afternoon:n>=4?s=bd.morning:s=bd.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return gl.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):gl.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ar(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):ar(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):gl.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):gl.s(t,e)},S:function(t,e){return gl.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return ik(n);case"XXXX":case"XX":return Bc(n);case"XXXXX":case"XXX":default:return Bc(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return ik(n);case"xxxx":case"xx":return Bc(n);case"xxxxx":case"xxx":default:return Bc(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+sk(n,":");case"OOOO":default:return"GMT"+Bc(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+sk(n,":");case"zzzz":default:return"GMT"+Bc(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return ar(n,e.length)},T:function(t,e,r){const n=t.getTime();return ar(n,e.length)}};function sk(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+e+ar(i,2)}function ik(t,e){return t%60===0?(t>0?"-":"+")+ar(Math.abs(t)/60,2):Bc(t,e)}function Bc(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=ar(Math.trunc(n/60),2),i=ar(n%60,2);return r+s+e+i}const ak=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},eO=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},yX=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return ak(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",ak(n,e)).replace("{{time}}",eO(s,e))},bX={p:eO,P:yX},wX=/^D+$/,_X=/^Y+$/,jX=["D","DD","YY","YYYY"];function SX(t){return wX.test(t)}function CX(t){return _X.test(t)}function NX(t,e,r){const n=kX(t,e,r);if(console.warn(n),jX.includes(t))throw new RangeError(n)}function kX(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const EX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,PX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,AX=/^'([^]*?)'?$/,TX=/''/g,LX=/[a-zA-Z]/;function z2(t,e,r){var d,h,f,m,p,v,b,x;const n=Gp(),s=(r==null?void 0:r.locale)??n.locale??JL,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(f=n.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,a=(r==null?void 0:r.weekStartsOn)??((v=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:v.weekStartsOn)??n.weekStartsOn??((x=(b=n.locale)==null?void 0:b.options)==null?void 0:x.weekStartsOn)??0,l=tr(t);if(!KL(l))throw new RangeError("Invalid time value");let c=e.match(PX).map(w=>{const _=w[0];if(_==="p"||_==="P"){const S=bX[_];return S(w,s.formatLong)}return w}).join("").match(EX).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const _=w[0];if(_==="'")return{isToken:!1,value:OX(w)};if(nk[_])return{isToken:!0,value:w};if(_.match(LX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return c.map(w=>{if(!w.isToken)return w.value;const _=w.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&CX(_)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&SX(_))&&NX(_,e,String(t));const S=nk[_[0]];return S(l,_,s.localize,u)}).join("")}function OX(t){const e=t.match(AX);return e?e[1].replace(TX,"'"):t}function MX(t,e,r){const n=Gp(),s=(r==null?void 0:r.locale)??n.locale??JL,i=2520,a=bv(t,e);if(isNaN(a))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:a});let c,u;a>0?(c=tr(e),u=tr(t)):(c=tr(t),u=tr(e));const d=DY(u,c),h=(jx(u)-jx(c))/1e3,f=Math.round((d-h)/60);let m;if(f<2)return r!=null&&r.includeSeconds?d<5?s.formatDistance("lessThanXSeconds",5,l):d<10?s.formatDistance("lessThanXSeconds",10,l):d<20?s.formatDistance("lessThanXSeconds",20,l):d<40?s.formatDistance("halfAMinute",0,l):d<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):f===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",f,l);if(f<45)return s.formatDistance("xMinutes",f,l);if(f<90)return s.formatDistance("aboutXHours",1,l);if(f<rk){const p=Math.round(f/60);return s.formatDistance("aboutXHours",p,l)}else{if(f<i)return s.formatDistance("xDays",1,l);if(f<j0){const p=Math.round(f/rk);return s.formatDistance("xDays",p,l)}else if(f<j0*2)return m=Math.round(f/j0),s.formatDistance("aboutXMonths",m,l)}if(m=RY(u,c),m<12){const p=Math.round(f/j0);return s.formatDistance("xMonths",p,l)}else{const p=m%12,v=Math.trunc(m/12);return p<3?s.formatDistance("aboutXYears",v,l):p<9?s.formatDistance("overXYears",v,l):s.formatDistance("almostXYears",v+1,l)}}function tO(t,e){return MX(t,Yp(t),e)}function RX(t,e,r){const n=Cu(t,r),s=Cu(e,r);return+n==+s}function DX(t,e){const r=tr(t),n=tr(e);return r.getFullYear()===n.getFullYear()}function FX(t,e){return RX(t,Yp(t),e)}function IX(t){return DX(t,Yp(t))}function zX(t){return XL(t,Yp(t))}function $X(t,e){return jY(t,-e)}function BX(t){return XL(t,$X(Yp(t),1))}const qX={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},UX=(t,e,r)=>{let n;const s=qX[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",String(e)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},VX={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},WX={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},HX={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},GX={date:lh({formats:VX,defaultWidth:"full"}),time:lh({formats:WX,defaultWidth:"full"}),dateTime:lh({formats:HX,defaultWidth:"full"})},YX={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},XX=(t,e,r,n)=>YX[t],KX={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},QX={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},JX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ZX={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},eK={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},tK=(t,e)=>{const r=Number(t),n=e==null?void 0:e.unit;if(r===0)return"0";const s=["year","week","hour","minute","second"];let i;return r===1?i=n&&s.includes(n)?"ère":"er":i="ème",r+i},rK=["MMM","MMMM"],nK={preprocessor:(t,e)=>t.getDate()===1||!e.some(n=>n.isToken&&rK.includes(n.value))?e:e.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:tK,era:Fa({values:KX,defaultWidth:"wide"}),quarter:Fa({values:QX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Fa({values:JX,defaultWidth:"wide"}),day:Fa({values:ZX,defaultWidth:"wide"}),dayPeriod:Fa({values:eK,defaultWidth:"wide"})},sK=/^(\d+)(ième|ère|ème|er|e)?/i,iK=/\d+/i,aK={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},oK={any:[/^av/i,/^ap/i]},lK={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},cK={any:[/1/i,/2/i,/3/i,/4/i]},uK={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},dK={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},hK={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},fK={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},mK={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},pK={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},gK={ordinalNumber:QL({matchPattern:sK,parsePattern:iK,valueCallback:t=>parseInt(t)}),era:Ia({matchPatterns:aK,defaultMatchWidth:"wide",parsePatterns:oK,defaultParseWidth:"any"}),quarter:Ia({matchPatterns:lK,defaultMatchWidth:"wide",parsePatterns:cK,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ia({matchPatterns:uK,defaultMatchWidth:"wide",parsePatterns:dK,defaultParseWidth:"any"}),day:Ia({matchPatterns:hK,defaultMatchWidth:"wide",parsePatterns:fK,defaultParseWidth:"any"}),dayPeriod:Ia({matchPatterns:mK,defaultMatchWidth:"any",parsePatterns:pK,defaultParseWidth:"any"})},Fm={code:"fr",formatDistance:UX,formatLong:GX,formatRelative:XX,localize:nK,match:gK,options:{weekStartsOn:1,firstWeekContainsDate:4}},vK=({post:t})=>{const[e,r]=y.useState(!1),[n,s]=y.useState(t.likes_count),{user:i}=st(),a=f=>{switch(f){case"recruitment":return o.jsx(C_,{size:16,className:"text-blue-400"});case"info":return o.jsx(E_,{size:16,className:"text-green-400"});default:return o.jsx(Zs,{size:16,className:"text-gray-400"})}},l=f=>{switch(f){case"recruitment":return"Recrutement";case"info":return"Information";default:return"Général"}},c=f=>{switch(f){case"recruitment":return"bg-blue-900/50 text-blue-400 border-blue-700";case"info":return"bg-green-900/50 text-green-400 border-green-700";default:return"bg-gray-900/50 text-gray-400 border-gray-700"}},u=()=>{i&&(r(!e),s(f=>e?f-1:f+1))},d=tO(new Date(t.created_at),{addSuffix:!0,locale:Fm}),h=`${t.profiles.first_name} ${t.profiles.last_name}`.trim()||t.profiles.username||"Utilisateur";return o.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-800",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden",children:t.profiles.avatar_url?o.jsx("img",{src:t.profiles.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):o.jsx(Ya,{size:20,className:"text-gray-400"})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-white font-medium text-sm",children:h}),o.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs border ${c(t.post_type)}`,children:[a(t.post_type),o.jsx("span",{children:l(t.post_type)})]})]}),o.jsx("span",{className:"text-gray-400 text-xs",children:d})]})]}),o.jsx(J,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:o.jsx(Oz,{size:16})})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("p",{className:"text-white leading-relaxed whitespace-pre-wrap",children:t.content}),t.image_url&&o.jsx("div",{className:"mt-3 rounded-lg overflow-hidden",children:o.jsx("img",{src:t.image_url,alt:"Image du post",className:"w-full h-auto object-cover max-h-96"})})]}),o.jsx("div",{className:"flex items-center justify-between pt-3 border-t border-gray-800",children:o.jsxs("div",{className:"flex items-center space-x-6",children:[o.jsxs("button",{onClick:u,className:`flex items-center space-x-2 transition-colors ${e?"text-red-500":"text-gray-400 hover:text-red-500"}`,children:[o.jsx(rf,{size:20,className:e?"fill-current":""}),o.jsx("span",{className:"text-sm",children:n})]}),o.jsxs("button",{className:"flex items-center space-x-2 text-gray-400 hover:text-blue-500 transition-colors",children:[o.jsx(Zs,{size:20}),o.jsx("span",{className:"text-sm",children:t.comments_count})]}),o.jsxs("button",{className:"flex items-center space-x-2 text-gray-400 hover:text-green-500 transition-colors",children:[o.jsx(qP,{size:20}),o.jsx("span",{className:"text-sm",children:"Partager"})]})]})})]})},xK=()=>{var c;const[t,e]=y.useState("all"),[r,n]=y.useState(!1),{user:s}=st(),{data:i,isLoading:a}=bY(t),l=[{key:"all",label:"Tous",icon:pa},{key:"recruitment",label:"Recrutement",icon:C_},{key:"info",label:"Infos",icon:E_},{key:"general",label:"Général",icon:Zs}];return a?o.jsx("div",{className:"p-4 pt-20",children:o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"text-white",children:"Chargement des posts..."})})}):o.jsxs("div",{className:"p-4 pt-20 pb-20 bg-black min-h-screen",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h1",{className:"text-white text-xl font-bold",children:"Publications"}),s&&o.jsx(J,{onClick:()=>n(!0),className:"bg-edu-primary hover:bg-edu-primary/90 text-white",size:"sm",children:"Créer un post"})]}),o.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:l.map(u=>{const d=u.icon;return o.jsxs("button",{onClick:()=>e(u.key),className:`flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${t===u.key?"bg-edu-primary text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[o.jsx(d,{size:16}),o.jsx("span",{children:u.label})]},u.key)})})]}),o.jsx("div",{className:"space-y-4",children:i&&i.length>0?i.map(u=>o.jsx(vK,{post:u},u.id)):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-gray-400 mb-4",children:t==="all"?"Aucune publication pour le moment":`Aucune publication de type "${(c=l.find(u=>u.key===t))==null?void 0:c.label}" pour le moment`}),s&&o.jsx(J,{onClick:()=>n(!0),variant:"outline",className:"border-gray-600 text-gray-300 hover:bg-gray-800",children:"Créer le premier post"})]})}),r&&o.jsx(_Y,{isOpen:r,onClose:()=>n(!1)})]})},yK=()=>{const[t,e]=y.useState(""),[r,n]=y.useState("all"),s=[{key:"all",label:"Tout"},{key:"videos",label:"Vidéos"},{key:"posts",label:"Posts"}];return o.jsxs("div",{className:"h-full bg-black text-white pt-20 px-4",children:[o.jsxs("div",{className:"relative mb-6",children:[o.jsx(bu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx(Ye,{type:"text",placeholder:"Rechercher des vidéos, posts...",value:t,onChange:i=>e(i.target.value),className:"pl-10 bg-gray-800 border-gray-700 text-white placeholder-gray-400 focus:border-white"})]}),o.jsx("div",{className:"flex space-x-3 mb-6",children:s.map(i=>o.jsx(J,{variant:r===i.key?"default":"outline",size:"sm",onClick:()=>n(i.key),className:r===i.key?"bg-white text-black":"border-gray-600 text-gray-300 hover:bg-gray-800",children:i.label},i.key))}),o.jsx("div",{className:"flex-1",children:t?o.jsx("div",{className:"text-center py-12",children:o.jsxs("p",{className:"text-gray-400",children:['Recherche pour "',t,'" en cours...']})}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx(bu,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-400 text-lg",children:"Recherchez des vidéos et posts"}),o.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Découvrez du contenu selon vos centres d'intérêt"})]})})]})},ok=()=>{const[t,e]=y.useState("videos"),r=()=>{switch(t){case"videos":return o.jsx("div",{className:"h-full overflow-y-auto snap-y snap-mandatory",children:o.jsx(tk,{})});case"posts":return o.jsx(xK,{});case"search":return o.jsx(yK,{});default:return o.jsx("div",{className:"h-full overflow-y-auto snap-y snap-mandatory",children:o.jsx(tk,{})})}};return o.jsxs("div",{className:"relative h-screen w-full bg-black overflow-hidden",children:[o.jsx(oY,{activeTab:t,onTabChange:e}),o.jsx("div",{className:"h-full w-full",children:r()})]})},bK=t=>Nt({queryKey:["shop-formations",t],queryFn:async()=>{let e=ae.from("formations").select(`
          *,
          profiles:author_id (
            first_name,
            last_name,
            username
          )
        `).eq("is_active",!0);const{data:r,error:n}=await e.order("created_at",{ascending:!1});if(n)throw n;return r||[]}}),wK=()=>Nt({queryKey:["formation-categories"],queryFn:async()=>[{id:"programmation",name:"programmation",label:"Programmation"},{id:"design",name:"design",label:"Design"},{id:"marketing",name:"marketing",label:"Marketing"},{id:"business",name:"business",label:"Business"}]}),_K=t=>Nt({queryKey:["products",t],queryFn:async()=>{let e=ae.from("products").select(`
          *,
          profiles:instructor_id (
            first_name,
            last_name,
            username
          ),
          categories (
            name,
            label
          )
        `).eq("is_active",!0).neq("product_type","formation");t&&t!=="all"&&(e=e.eq("categories.name",t));const{data:r,error:n}=await e.order("created_at",{ascending:!1});if(n)throw n;return r||[]}}),jK=()=>Nt({queryKey:["categories"],queryFn:async()=>{const{data:t,error:e}=await ae.from("categories").select("*").order("name");if(e)throw e;return t||[]}}),SK=({activeTab:t,setActiveTab:e,searchQuery:r,setSearchQuery:n,cartItemsCount:s=0})=>o.jsxs("div",{className:"bg-gradient-to-r from-blue-900 to-blue-700 text-white sticky top-0 md:top-16 z-40 shadow-lg",children:[o.jsxs("div",{className:"px-2 sm:px-4 py-2 sm:py-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[o.jsxs(J,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 w-8 h-8 sm:w-10 sm:h-10",children:[o.jsx(nN,{size:16,className:"sm:hidden"}),o.jsx(nN,{size:20,className:"hidden sm:block"})]}),o.jsx("h1",{className:"text-lg sm:text-xl font-bold",children:"EduShop"})]}),o.jsx("div",{className:"relative",children:o.jsxs(J,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 w-8 h-8 sm:w-10 sm:h-10",children:[o.jsx(lx,{size:16,className:"sm:hidden"}),o.jsx(lx,{size:20,className:"hidden sm:block"}),s>0&&o.jsx("span",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs rounded-full w-4 h-4 sm:w-5 sm:h-5 flex items-center justify-center font-bold text-[10px] sm:text-xs",children:s>9?"9+":s})]})})]}),o.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2",children:o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Ye,{type:"text",placeholder:`Rechercher des ${t==="formations"?"formations":"produits"}...`,value:r,onChange:i=>n(i.target.value),className:"w-full bg-white text-black border-0 focus:ring-2 focus:ring-orange-500 rounded-sm text-sm sm:text-base h-8 sm:h-10"}),o.jsxs(J,{size:"icon",className:"absolute right-0 top-0 h-full bg-orange-500 hover:bg-orange-600 rounded-l-none w-8 sm:w-10",children:[o.jsx(bu,{size:14,className:"sm:hidden"}),o.jsx(bu,{size:16,className:"hidden sm:block"})]})]})})]}),o.jsx("div",{className:"px-2 sm:px-4 pb-1 sm:pb-2",children:o.jsxs("div",{className:"flex space-x-4 sm:space-x-6 border-b border-white/20 overflow-x-auto",children:[o.jsx("button",{onClick:()=>e("formations"),className:`pb-1 sm:pb-2 px-1 font-medium transition-colors border-b-2 whitespace-nowrap text-sm sm:text-base ${t==="formations"?"border-orange-500 text-orange-200":"border-transparent text-white/80 hover:text-white"}`,children:"Formations"}),o.jsx("button",{onClick:()=>e("products"),className:`pb-1 sm:pb-2 px-1 font-medium transition-colors border-b-2 whitespace-nowrap text-sm sm:text-base ${t==="products"?"border-orange-500 text-orange-200":"border-transparent text-white/80 hover:text-white"}`,children:"Produits"})]})})]});var rO=["PageUp","PageDown"],nO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},pf="Slider",[Ww,CK,NK]=vT(pf),[iO,rse]=Ko(pf,[NK]),[kK,I1]=iO(pf),aO=y.forwardRef((t,e)=>{const{name:r,min:n=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[n],value:d,onValueChange:h=()=>{},onValueCommit:f=()=>{},inverted:m=!1,form:p,...v}=t,b=y.useRef(new Set),x=y.useRef(0),_=a==="horizontal"?EK:PK,[S=[],N]=ic({prop:d,defaultProp:u,onChange:T=>{var U;(U=[...b.current][x.current])==null||U.focus(),h(T)}}),E=y.useRef(S);function P(T){const O=MK(S,T);Y(T,O)}function A(T){Y(T,x.current)}function F(){const T=E.current[x.current];S[x.current]!==T&&f(S)}function Y(T,O,{commit:U}={commit:!1}){const q=IK(i),Z=zK(Math.round((T-n)/i)*i+n,q),H=mp(Z,[n,s]);N((Q=[])=>{const R=LK(Q,H,O);if(FK(R,c*i)){x.current=R.indexOf(H);const B=String(R)!==String(Q);return B&&U&&f(R),B?R:Q}else return Q})}return o.jsx(kK,{scope:t.__scopeSlider,name:r,disabled:l,min:n,max:s,valueIndexToChangeRef:x,thumbs:b.current,values:S,orientation:a,form:p,children:o.jsx(Ww.Provider,{scope:t.__scopeSlider,children:o.jsx(Ww.Slot,{scope:t.__scopeSlider,children:o.jsx(_,{"aria-disabled":l,"data-disabled":l?"":void 0,...v,ref:e,onPointerDown:ct(v.onPointerDown,()=>{l||(E.current=S)}),min:n,max:s,inverted:m,onSlideStart:l?void 0:P,onSlideMove:l?void 0:A,onSlideEnd:l?void 0:F,onHomeKeyDown:()=>!l&&Y(n,0,{commit:!0}),onEndKeyDown:()=>!l&&Y(s,S.length-1,{commit:!0}),onStepKeyDown:({event:T,direction:O})=>{if(!l){const Z=rO.includes(T.key)||T.shiftKey&&nO.includes(T.key)?10:1,H=x.current,Q=S[H],R=i*Z*O;Y(Q+R,H,{commit:!0})}}})})})})});aO.displayName=pf;var[oO,lO]=iO(pf,{startEdge:"left",endEdge:"right",size:"width",direction:1}),EK=y.forwardRef((t,e)=>{const{min:r,max:n,dir:s,inverted:i,onSlideStart:a,onSlideMove:l,onSlideEnd:c,onStepKeyDown:u,...d}=t,[h,f]=y.useState(null),m=Lt(e,_=>f(_)),p=y.useRef(),v=cj(s),b=v==="ltr",x=b&&!i||!b&&i;function w(_){const S=p.current||h.getBoundingClientRect(),N=[0,S.width],P=_j(N,x?[r,n]:[n,r]);return p.current=S,P(_-S.left)}return o.jsx(oO,{scope:t.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:o.jsx(cO,{dir:v,"data-orientation":"horizontal",...d,ref:m,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const S=w(_.clientX);a==null||a(S)},onSlideMove:_=>{const S=w(_.clientX);l==null||l(S)},onSlideEnd:()=>{p.current=void 0,c==null||c()},onStepKeyDown:_=>{const N=sO[x?"from-left":"from-right"].includes(_.key);u==null||u({event:_,direction:N?-1:1})}})})}),PK=y.forwardRef((t,e)=>{const{min:r,max:n,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,d=y.useRef(null),h=Lt(e,d),f=y.useRef(),m=!s;function p(v){const b=f.current||d.current.getBoundingClientRect(),x=[0,b.height],_=_j(x,m?[n,r]:[r,n]);return f.current=b,_(v-b.top)}return o.jsx(oO,{scope:t.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:o.jsx(cO,{"data-orientation":"vertical",...u,ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const b=p(v.clientY);i==null||i(b)},onSlideMove:v=>{const b=p(v.clientY);a==null||a(b)},onSlideEnd:()=>{f.current=void 0,l==null||l()},onStepKeyDown:v=>{const x=sO[m?"from-bottom":"from-top"].includes(v.key);c==null||c({event:v,direction:x?-1:1})}})})}),cO=y.forwardRef((t,e)=>{const{__scopeSlider:r,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:l,onStepKeyDown:c,...u}=t,d=I1(pf,r);return o.jsx(vt.span,{...u,ref:e,onKeyDown:ct(t.onKeyDown,h=>{h.key==="Home"?(a(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):rO.concat(nO).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:ct(t.onPointerDown,h=>{const f=h.target;f.setPointerCapture(h.pointerId),h.preventDefault(),d.thumbs.has(f)?f.focus():n(h)}),onPointerMove:ct(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&s(h)}),onPointerUp:ct(t.onPointerUp,h=>{const f=h.target;f.hasPointerCapture(h.pointerId)&&(f.releasePointerCapture(h.pointerId),i(h))})})}),uO="SliderTrack",dO=y.forwardRef((t,e)=>{const{__scopeSlider:r,...n}=t,s=I1(uO,r);return o.jsx(vt.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:e})});dO.displayName=uO;var Hw="SliderRange",hO=y.forwardRef((t,e)=>{const{__scopeSlider:r,...n}=t,s=I1(Hw,r),i=lO(Hw,r),a=y.useRef(null),l=Lt(e,a),c=s.values.length,u=s.values.map(f=>mO(f,s.min,s.max)),d=c>1?Math.min(...u):0,h=100-Math.max(...u);return o.jsx(vt.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:l,style:{...t.style,[i.startEdge]:d+"%",[i.endEdge]:h+"%"}})});hO.displayName=Hw;var Gw="SliderThumb",fO=y.forwardRef((t,e)=>{const r=CK(t.__scopeSlider),[n,s]=y.useState(null),i=Lt(e,l=>s(l)),a=y.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return o.jsx(AK,{...t,ref:i,index:a})}),AK=y.forwardRef((t,e)=>{const{__scopeSlider:r,index:n,name:s,...i}=t,a=I1(Gw,r),l=lO(Gw,r),[c,u]=y.useState(null),d=Lt(e,w=>u(w)),h=c?a.form||!!c.closest("form"):!0,f=S1(c),m=a.values[n],p=m===void 0?0:mO(m,a.min,a.max),v=OK(n,a.values.length),b=f==null?void 0:f[l.size],x=b?RK(b,p,l.direction):0;return y.useEffect(()=>{if(c)return a.thumbs.add(c),()=>{a.thumbs.delete(c)}},[c,a.thumbs]),o.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${p}% + ${x}px)`},children:[o.jsx(Ww.ItemSlot,{scope:t.__scopeSlider,children:o.jsx(vt.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:d,style:m===void 0?{display:"none"}:t.style,onFocus:ct(t.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),h&&o.jsx(TK,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},n)]})});fO.displayName=Gw;var TK=t=>{const{value:e,...r}=t,n=y.useRef(null),s=L1(e);return y.useEffect(()=>{const i=n.current,a=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==e&&c){const u=new Event("input",{bubbles:!0});c.call(i,e),i.dispatchEvent(u)}},[s,e]),o.jsx("input",{style:{display:"none"},...r,ref:n,defaultValue:e})};function LK(t=[],e,r){const n=[...t];return n[r]=e,n.sort((s,i)=>s-i)}function mO(t,e,r){const i=100/(r-e)*(t-e);return mp(i,[0,100])}function OK(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function MK(t,e){if(t.length===1)return 0;const r=t.map(s=>Math.abs(s-e)),n=Math.min(...r);return r.indexOf(n)}function RK(t,e,r){const n=t/2,i=_j([0,50],[0,n]);return(n-i(e)*r)*r}function DK(t){return t.slice(0,-1).map((e,r)=>t[r+1]-e)}function FK(t,e){if(e>0){const r=DK(t);return Math.min(...r)>=e}return!0}function _j(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(t[1]-t[0]);return e[0]+n*(r-t[0])}}function IK(t){return(String(t).split(".")[1]||"").length}function zK(t,e){const r=Math.pow(10,e);return Math.round(t*r)/r}var pO=aO,$K=dO,BK=hO,qK=fO;const Sx=y.forwardRef(({className:t,...e},r)=>o.jsxs(pO,{ref:r,className:Be("relative flex w-full touch-none select-none items-center",t),...e,children:[o.jsx($K,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:o.jsx(BK,{className:"absolute h-full bg-primary"})}),o.jsx(qK,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Sx.displayName=pO.displayName;const lk=({categories:t,activeCategory:e,setActiveCategory:r,priceRange:n,setPriceRange:s,isVisible:i,onClose:a})=>i?o.jsx("div",{className:"w-64 bg-white border-r border-gray-200 h-full overflow-y-auto",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h2",{className:"font-semibold text-lg flex items-center",children:[o.jsx(RP,{size:20,className:"mr-2"}),"Filtres"]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:a,className:"md:hidden",children:"×"})]}),o.jsxs(Mt,{className:"mb-4",children:[o.jsx(er,{className:"pb-2",children:o.jsx(ur,{className:"text-sm font-medium",children:"Catégories"})}),o.jsx(Rt,{className:"space-y-2",children:t.map(l=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(oh,{id:l.id,checked:e===l.name,onCheckedChange:()=>r(l.name)}),o.jsx("label",{htmlFor:l.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:l.label})]},l.id))})]}),o.jsxs(Mt,{className:"mb-4",children:[o.jsx(er,{className:"pb-2",children:o.jsx(ur,{className:"text-sm font-medium",children:"Prix"})}),o.jsx(Rt,{children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(Sx,{defaultValue:n,max:500,min:0,step:10,onValueChange:l=>s(l),className:"w-full"}),o.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[o.jsxs("span",{children:[n[0],"€"]}),o.jsxs("span",{children:[n[1],"€"]})]})]})})]}),o.jsxs(Mt,{children:[o.jsx(er,{className:"pb-2",children:o.jsx(ur,{className:"text-sm font-medium",children:"Notes"})}),o.jsx(Rt,{className:"space-y-2",children:[4,3,2,1].map(l=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(oh,{id:`rating-${l}`}),o.jsxs("label",{htmlFor:`rating-${l}`,className:"text-sm flex items-center cursor-pointer",children:[o.jsx("div",{className:"flex mr-2",children:[...Array(5)].map((c,u)=>o.jsx("span",{className:`text-sm ${u<l?"text-yellow-400":"text-gray-300"}`,children:"★"},u))}),"et plus"]})]},l))})]})]})}):null,UK=({categories:t,activeCategory:e,setActiveCategory:r,isLoading:n})=>n?null:o.jsx("div",{className:"p-2 sm:p-4 pt-0",children:o.jsx("div",{className:"flex space-x-1 sm:space-x-2 overflow-x-auto pb-2 scrollbar-hide",children:t.map(s=>o.jsx("button",{onClick:()=>r(s.name),className:`px-2 sm:px-4 py-1 sm:py-2 rounded-full whitespace-nowrap transition-all duration-200 text-xs sm:text-sm flex-shrink-0 ${e===s.name?"bg-edu-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s.label},s.id))})}),VK=({formation:t,onViewDetails:e,user:r})=>{const n=y.useCallback(i=>{if(!i)return"Auteur inconnu";const a=i.first_name||"",l=i.last_name||"";return`${a} ${l}`.trim()||i.username||"Auteur inconnu"},[]),s=y.useCallback(i=>{i.preventDefault(),i.stopPropagation(),console.log("FormationCard: handleViewDetailsClick called for formation:",t.id),e(t.id)},[t.id,e]);return o.jsxs(Mt,{className:"overflow-hidden hover:shadow-lg transition-shadow duration-200 bg-white",children:[o.jsx(er,{className:"p-0",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-edu-primary/10 to-edu-secondary/10 flex items-center justify-center",children:t.image_url||t.thumbnail_url?o.jsx("img",{src:t.image_url||t.thumbnail_url,alt:t.title||"Formation",className:"w-full h-full object-cover"}):o.jsx("span",{className:"text-gray-400",children:"Image formation"})}),o.jsx("div",{className:"absolute top-2 right-2 bg-edu-primary text-white px-2 py-1 rounded text-xs",children:"Formation"})]})}),o.jsxs(Rt,{className:"p-4",children:[o.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2",children:t.title||"Titre non disponible"}),o.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Par ",n(t.profiles)]}),t.description&&o.jsx("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2",children:t.description}),o.jsxs("div",{className:"flex items-center space-x-1 mb-3",children:[o.jsx("div",{className:"flex items-center",children:[...Array(5)].map((i,a)=>o.jsx(yc,{size:14,className:`${a<Math.floor(t.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},a))}),o.jsx("span",{className:"text-sm font-medium",children:t.rating||0}),o.jsxs("span",{className:"text-sm text-gray-500",children:["(",t.students_count||0,")"]})]}),o.jsx("div",{className:"flex items-center space-x-2 mb-3",children:o.jsxs("span",{className:"text-2xl font-bold text-edu-primary",children:[t.price||0,"€"]})})]}),o.jsx(R_,{className:"p-4 pt-0",children:o.jsx(J,{className:"w-full bg-edu-primary hover:bg-edu-primary/90",onClick:s,children:"Voir détails"})})]})},WK=({formations:t,onViewDetails:e,user:r})=>{const n=y.useCallback(s=>{console.log("FormationGrid: handleViewDetails called for formation:",s),e(s)},[e]);return t.length===0?o.jsx("div",{className:"text-center py-8 sm:py-12",children:o.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"Aucune formation trouvée"})}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2 sm:gap-4 px-2 sm:px-0",children:t.map(s=>o.jsx(VK,{formation:s,onViewDetails:n,user:r},s.id))})},HK=({product:t,user:e,onAddToCart:r})=>{const n=i=>{if(!i)return"Auteur inconnu";const a=i.first_name||"",l=i.last_name||"";return`${a} ${l}`.trim()||i.username||"Auteur inconnu"},s=t.original_price&&t.discount_percentage?t.original_price*(1-t.discount_percentage/100):t.price;return o.jsxs(Mt,{className:"group hover:shadow-xl transition-all duration-300 bg-white border border-gray-200 hover:border-orange-300 relative",children:[t.discount_percentage&&o.jsxs(yr,{className:"absolute top-2 left-2 z-10 bg-red-500 text-white",children:["-",t.discount_percentage,"%"]}),o.jsx(J,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 z-10 bg-white/80 hover:bg-white text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(rf,{size:16})}),o.jsx(er,{className:"p-0",children:o.jsx("div",{className:"relative overflow-hidden",children:o.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:t.image_url?o.jsx("img",{src:t.image_url,alt:t.title||"Produit",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):o.jsx("span",{className:"text-gray-400",children:"Image produit"})})})}),o.jsxs(Rt,{className:"p-4",children:[o.jsx("div",{className:"mb-2",children:o.jsx(yr,{variant:"outline",className:"text-xs",children:t.product_type==="formation"?"Formation":t.product_type==="article"?"Article":"Service"})}),o.jsx("h3",{className:"font-medium text-sm mb-2 line-clamp-2 text-gray-900 group-hover:text-blue-600 transition-colors",children:t.title||"Titre non disponible"}),o.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["par ",n(t.profiles)]}),t.rating&&o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("div",{className:"flex mr-1",children:[...Array(5)].map((i,a)=>o.jsx(yc,{size:12,className:`${a<Math.floor(t.rating||0)?"text-yellow-400 fill-current":"text-gray-300"}`},a))}),o.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.rating,")"]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[o.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[Math.round(s||0),"€"]}),t.original_price&&t.discount_percentage&&o.jsxs("span",{className:"text-sm text-gray-500 line-through",children:[t.original_price,"€"]})]})]}),o.jsx(R_,{className:"p-4 pt-0",children:o.jsxs(J,{className:"w-full bg-orange-500 hover:bg-orange-600 text-white",disabled:!e,onClick:()=>r==null?void 0:r(t.id),children:[o.jsx(lx,{size:16,className:"mr-2"}),e?"Ajouter au panier":"Connectez-vous"]})})]})},GK=({products:t,user:e,onAddToCart:r})=>t.length===0?o.jsx("div",{className:"text-center py-8 sm:py-12",children:o.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"Aucun produit trouvé"})}):o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-2 sm:gap-4 px-2 sm:px-0",children:t.map(n=>o.jsx(HK,{product:n,user:e,onAddToCart:r},n.id))}),YK=()=>{const[t,e]=y.useState("all"),[r,n]=y.useState(""),[s,i]=y.useState("formations"),[a,l]=y.useState(!1),[c,u]=y.useState([0,500]),{user:d}=st(),h=Mn(),{data:f,isLoading:m}=bK(t),{data:p,isLoading:v}=wK(),{data:b,isLoading:x}=_K(t),{data:w,isLoading:_}=jK(),S=y.useCallback(Y=>{console.log("Shop: Navigating to formation details:",Y),h(`/formation/${Y}`)},[h]),N=y.useCallback(Y=>{console.log("Adding to cart:",Y)},[]),E=(f==null?void 0:f.filter(Y=>{const T=Y.title||"",O=Y.description||"",U=r.toLowerCase();return T.toLowerCase().includes(U)||O.toLowerCase().includes(U)}))||[],P=(b==null?void 0:b.filter(Y=>{const T=Y.title||"",O=Y.description||"",U=r.toLowerCase(),q=Y.price>=c[0]&&Y.price<=c[1];return(T.toLowerCase().includes(U)||O.toLowerCase().includes(U))&&q}))||[],A=s==="formations"?[{id:"all",name:"all",label:"Tout"},...p||[]]:[{id:"all",name:"all",label:"Tout"},...w||[]],F=s==="formations"?m||v:x||_;return o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx(SK,{activeTab:s,setActiveTab:i,searchQuery:r,setSearchQuery:n,cartItemsCount:0}),o.jsxs("div",{className:"flex flex-col md:flex-row",children:[o.jsx("div",{className:"hidden md:block w-80 flex-shrink-0",children:o.jsx(lk,{categories:A,activeCategory:t,setActiveCategory:e,priceRange:c,setPriceRange:u,isVisible:!0,onClose:()=>{}})}),a&&o.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>l(!1)}),o.jsx("div",{className:"relative",children:o.jsx(lk,{categories:A,activeCategory:t,setActiveCategory:e,priceRange:c,setPriceRange:u,isVisible:!0,onClose:()=>l(!1)})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"md:hidden p-2 sm:p-4 bg-white border-b",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs(J,{variant:"outline",onClick:()=>l(!0),className:"flex items-center space-x-2 text-xs sm:text-sm",size:"sm",children:[o.jsx(RP,{size:14}),o.jsx("span",{children:"Filtres"})]}),o.jsx("div",{className:"flex-1 max-w-xs",children:o.jsx(UK,{categories:A.slice(0,3),activeCategory:t,setActiveCategory:e,isLoading:F})})]})}),o.jsx("div",{className:"p-2 sm:p-4 lg:p-6",children:F?o.jsx("div",{className:"flex justify-center py-12",children:o.jsx("div",{className:"text-gray-500",children:"Chargement..."})}):s==="formations"?o.jsx(WK,{formations:E,onViewDetails:S,user:d}):o.jsx(GK,{products:P,user:d,onAddToCart:N})})]})]})]})},gO=t=>{const{user:e}=st();return Nt({queryKey:["is-teacher-in-formation",e==null?void 0:e.id,t],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return!1;console.log("Checking if user is teacher in formation:",{userId:e.id,formationId:t});const{data:r}=await ae.from("profiles").select("is_teacher").eq("id",e.id).single();if(!(r!=null&&r.is_teacher))return console.log("User is not a teacher globally"),!1;const{data:n}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",t).single(),s=!!n;return console.log("User is teacher in this formation:",s),s},enabled:!!(e!=null&&e.id)&&!!t})},XK=(t,e)=>{const{user:r}=st(),{data:n=!1}=gO(e);return Nt({queryKey:["student-messages",t,e,r==null?void 0:r.id,n],queryFn:async()=>{if(!t||!e||!(r!=null&&r.id))return[];if(console.log("Fetching student messages for lesson:",t,"formation:",e,"user:",r.id,"isTeacher:",n),n){const{data:s,error:i}=await ae.from("lesson_messages").select(`
            *,
            profiles!sender_id(
              id,
              first_name,
              last_name,
              username,
              avatar_url,
              is_teacher
            )
          `).eq("lesson_id",t).eq("formation_id",e).order("created_at",{ascending:!0});return i?(console.error("Error fetching teacher messages:",i),[]):(console.log("Teacher messages found:",(s==null?void 0:s.length)||0),s||[])}else{const s=await KK(e);let i=ae.from("lesson_messages").select(`
            *,
            profiles!sender_id(
              id,
              first_name,
              last_name,
              username,
              avatar_url,
              is_teacher
            )
          `).eq("lesson_id",t).eq("formation_id",e);s.length>0?i=i.or(`sender_id.eq.${r.id},is_system_message.eq.true,sender_id.in.(${s.join(",")})`):i=i.or(`sender_id.eq.${r.id},is_system_message.eq.true`);const{data:a,error:l}=await i.order("created_at",{ascending:!0});return l?(console.error("Error fetching student messages:",l),[]):(console.log("Student messages found:",(a==null?void 0:a.length)||0),a||[])}},enabled:!!t&&!!e&&!!(r!=null&&r.id),refetchInterval:!1})};async function KK(t){const{data:e}=await ae.from("teachers").select(`
      user_id,
      teacher_formations!inner (
        formation_id
      )
    `).eq("teacher_formations.formation_id",t);return(e==null?void 0:e.map(r=>r.user_id))||[]}const QK=t=>Nt({queryKey:["lesson-exercises",t],queryFn:async()=>{if(!t)return[];console.log("Fetching exercises for lesson:",t);const{data:e,error:r}=await ae.from("exercises").select("*").eq("lesson_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching lesson exercises:",r),[]):(console.log("Lesson exercises found:",(e==null?void 0:e.length)||0),e||[])},enabled:!!t,refetchInterval:!1}),vO=(t,e)=>{const r=br(),{user:n}=st();return Vt({mutationFn:async({content:s,messageType:i="text",file:a,isExerciseSubmission:l=!1})=>{if(!(n!=null&&n.id))throw new Error("User not authenticated");let c=null,u=null,d=null;if(a&&a.uploadUrl)c=a.uploadUrl,u=a.name,d=a.type,console.log("Using pre-uploaded file:",{fileUrl:c,fileName:u,fileType:d});else if(a){console.log("Uploading file to students_exercises_submission_files bucket:",a.name,a.type);const m=a.name.split(".").pop(),p=`${n.id}/${t}/${Date.now()}.${m}`,{data:v,error:b}=await ae.storage.from("students_exercises_submission_files").upload(p,a);if(b)throw console.error("Error uploading file:",b),b;const{data:{publicUrl:x}}=ae.storage.from("students_exercises_submission_files").getPublicUrl(p);c=x,u=a.name,d=a.type,console.log("File uploaded successfully to students_exercises_submission_files:",{fileUrl:c,fileName:u,fileType:d})}console.log("Sending message:",{content:s,messageType:i,fileUrl:c,fileName:u,fileType:d});const{data:h,error:f}=await ae.from("lesson_messages").insert({lesson_id:t,formation_id:e,sender_id:n.id,content:s,message_type:i,file_url:c,file_name:u,file_type:d,is_exercise_submission:!1}).select().single();if(f)throw console.error("Error sending message:",f),f;return console.log("Message sent:",h),h},onSuccess:()=>{r.invalidateQueries({queryKey:["student-messages",t,e]}),r.invalidateQueries({queryKey:["teacher-messages",t,e]})}})},jj=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async({formationId:r,lessonId:n,studentId:s})=>{if(!(e!=null&&e.id))throw new Error("User not authenticated");console.log("Marking messages as read:",{formationId:r,lessonId:n,studentId:s,teacherId:e.id});const{error:i}=await ae.rpc("mark_messages_as_read_by_teachers",{p_formation_id:r,p_lesson_id:n,p_student_id:s,p_teacher_id:e.id});if(i)throw console.error("Error marking messages as read:",i),i;console.log("Messages marked as read successfully")},onSuccess:(r,n)=>{t.invalidateQueries({queryKey:["teacher-discussions-with-unread",n.formationId]}),t.invalidateQueries({queryKey:["teacher-student-messages",n.formationId,n.studentId]})}})},xO=t=>{const{user:e}=st();return Nt({queryKey:["user-role",e==null?void 0:e.id,t],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return null;console.log("Checking user role for:",e.id,"in formation:",t);const{data:r,error:n}=await ae.from("teachers").select(`
          id,
          user_id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",t).single();if(!n&&r)return console.log("User is teacher in this formation:",r),{role:"teacher",teacherId:r.id,formationId:r.teacher_formations[0].formation_id};const{data:s,error:i}=await ae.from("enrollment_requests").select("id, user_id, formation_id").eq("user_id",e.id).eq("formation_id",t).eq("status","approved").single();return!i&&s?(console.log("User is student in this formation"),{role:"student",formationId:s.formation_id}):(console.log("User has no role in this formation"),null)},enabled:!!(e!=null&&e.id)&&!!t})},Xp=t=>{const{user:e}=st(),{subscription:r}=q_(t),{pricingOptions:n}=B_(t),[s,i]=y.useState(null),a=n==null?void 0:n.find(f=>f.plan_type===(r==null?void 0:r.plan_type)&&f.is_active),l=f=>{const m={monday:"lundi",tuesday:"mardi",wednesday:"mercredi",thursday:"jeudi",friday:"vendredi",saturday:"samedi",sunday:"dimanche"};return f.map(p=>m[p.toLowerCase()]||p).join(" et ")},c=y.useCallback(()=>{if(!(a!=null&&a.allowed_call_days)||a.allowed_call_days.length===0)return!0;const f=new Date().toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();return a.allowed_call_days.some(m=>m.toLowerCase()===f)},[a]),u=y.useCallback(f=>{if(!a)return{allowed:!1,message:"Plan non trouvé. Veuillez vous inscrire à cette formation.",restrictionType:"no_plan",currentPlan:"none"};const m=a.plan_type;if(f==="message"&&a.plan_type==="standard"&&a.message_limit_per_day){const p=new Date().toDateString(),v=`messages_${e==null?void 0:e.id}_${t}_${p}`;if(parseInt(localStorage.getItem(v)||"0")>=a.message_limit_per_day)return{allowed:!1,message:`🚫 Vous avez atteint votre limite de ${a.message_limit_per_day} messages par jour pour le plan Standard.

Passez au plan Premium pour envoyer des messages illimités.`,restrictionType:"message_limit",currentPlan:m}}switch(f){case"message":if(!a.allow_discussion)return{allowed:!1,message:`💬 Les messages ne sont pas disponibles avec votre plan actuel.

Passez au plan Standard ou Premium pour échanger avec vos formateurs.`,restrictionType:"message_restriction",currentPlan:m};break;case"call":if(!a.allow_calls||a.call_type==="none")return{allowed:!1,message:`📞 Les appels audio ne sont pas disponibles avec votre plan actuel.

Passez au plan Standard ou Premium pour accéder aux appels.`,restrictionType:"call_restriction",currentPlan:m};if(!c())return{allowed:!1,message:`📅 Aujourd'hui n'est pas un jour d'appel autorisé pour votre plan.

Vos jours d'appel sont : ${l(a.allowed_call_days||[])}.

Passez au plan Premium pour appeler tous les jours.`,restrictionType:"call_day_restriction",currentPlan:m};break;case"video_call":if(!a.allow_calls||a.call_type!=="video"&&a.call_type!=="both")return{allowed:!1,message:`📹 Les appels vidéo ne sont pas disponibles avec votre plan actuel.

Passez au plan Premium pour accéder aux appels vidéo.`,restrictionType:"call_restriction",currentPlan:m};if(!c())return{allowed:!1,message:`📅 Aujourd'hui n'est pas un jour d'appel autorisé pour votre plan.

Vos jours d'appel sont : ${l(a.allowed_call_days||[])}.

Passez au plan Premium pour appeler tous les jours.`,restrictionType:"call_day_restriction",currentPlan:m};break}return{allowed:!0,currentPlan:m}},[a,e==null?void 0:e.id,t,c]);y.useEffect(()=>{if(!(a!=null&&a.time_limit_minutes_per_day)||!(e!=null&&e.id)){i(null);return}const f=`timeUsed_${e.id}_${t}_${new Date().toDateString()}`,m=parseInt(localStorage.getItem(f)||"0"),p=Math.max(0,a.time_limit_minutes_per_day-m);i(p)},[a,r==null?void 0:r.plan_type,e==null?void 0:e.id,t]);const d=y.useCallback(f=>{if(!(a!=null&&a.time_limit_minutes_per_day)||!(e!=null&&e.id))return;const m=`timeUsed_${e.id}_${t}_${new Date().toDateString()}`,v=parseInt(localStorage.getItem(m)||"0")+f;localStorage.setItem(m,v.toString());const b=Math.max(0,a.time_limit_minutes_per_day-v);i(b)},[a,e==null?void 0:e.id,t]),h=y.useCallback(()=>{if(!(e!=null&&e.id))return;const f=new Date().toDateString(),m=`messages_${e.id}_${t}_${f}`,p=parseInt(localStorage.getItem(m)||"0");localStorage.setItem(m,(p+1).toString())},[e==null?void 0:e.id,t]);return{canSendMessages:(a==null?void 0:a.allow_discussion)||!1,canMakeCalls:(a==null?void 0:a.allow_calls)||!1,canMakeVideoCalls:(a==null?void 0:a.allow_calls)&&((a==null?void 0:a.call_type)==="video"||(a==null?void 0:a.call_type)==="both")||!1,timeRemainingToday:s,dailyTimeLimit:(a==null?void 0:a.time_limit_minutes_per_day)||null,isLimitReached:s===0,checkPermission:u,updateTimeUsed:d,incrementMessageCount:h}},JK=({formationId:t,isPlaying:e=!1})=>{const{timeRemainingToday:r,dailyTimeLimit:n,isLimitReached:s}=Xp(t),[i,a]=y.useState(0),l=y.useRef(null),c=y.useRef(Date.now()),u=y.useCallback(h=>{if(!t)return;const f=`timeUsed_${t}_${new Date().toDateString()}`,p=parseInt(localStorage.getItem(f)||"0")+h;localStorage.setItem(f,p.toString())},[t]);return y.useEffect(()=>(e&&!s&&r!==null&&r>0?l.current=setInterval(()=>{const h=Date.now(),f=(h-c.current)/1e3;a(m=>{const p=m+f;return Math.floor(p)%30===0&&u(.5),p}),c.current=h},1e3):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[e,s,r,u]),y.useEffect(()=>()=>{if(i>0){const h=Math.ceil(i/60);u(h)}},[i,u]),{sessionTime:(h=>{const f=Math.floor(h/60),m=Math.floor(h%60);return`${f}:${m.toString().padStart(2,"0")}`})(i),timeRemainingToday:r,dailyTimeLimit:n,isLimitReached:s,canPlay:!s&&(r===null||r>0)}},ZK=(t,e=!1,r)=>{st();const{subscription:n}=q_(t),{pricingOptions:s}=B_(t),{timeRemainingToday:i,dailyTimeLimit:a,isLimitReached:l,checkPermission:c,incrementMessageCount:u}=Xp(t),{sessionTime:d,canPlay:h}=JK({formationId:t,isPlaying:e}),[f,m]=y.useState(!1),[p,v]=y.useState(""),[b,x]=y.useState("warning"),w=y.useCallback(()=>{m(!1)},[]),_=y.useCallback((E,P="warning")=>{v(E),x(P),m(!0)},[]),S=y.useCallback(E=>{if(!E.trim())return{allowed:!1};const P=c("message");return P.allowed?l?(_("Vous avez atteint votre limite de temps quotidienne. Revenez demain ou passez à un plan supérieur.","error"),{allowed:!1,showAlert:!0}):(u(),{allowed:!0}):(_(P.message||"Action non autorisée"),{allowed:!1,showAlert:!0})},[c,l,_,t]),N=y.useCallback(E=>{const A=c(E==="audio"?"call":"video_call");return A.allowed?l?(_("Vous avez atteint votre limite de temps quotidienne. Revenez demain ou passez à un plan supérieur.","error"),{allowed:!1,showAlert:!0}):{allowed:!0}:(_(A.message||"Appel non autorisé"),{allowed:!1,showAlert:!0})},[c,l,_]);return{subscription:n,pricing:s,timeRemainingToday:i,dailyTimeLimit:a,isLimitReached:l,sessionTime:d,canPlay:h,checkPermission:c,showAlert:f,alertMessage:p,alertVariant:b,hideAlert:w,handleSendMessage:S,handleCall:N,onUpgrade:r}},eQ=({formationId:t,lessonId:e,isActive:r=!0})=>{st();const{timeRemainingToday:n,dailyTimeLimit:s,isLimitReached:i,updateTimeUsed:a}=Xp(t),[l,c]=y.useState(0),[u,d]=y.useState(!1),h=y.useRef(null),f=y.useRef(Date.now());y.useEffect(()=>{r&&!i&&n!==null&&n>0?(d(!0),f.current=Date.now()):d(!1)},[r,i,n]),y.useEffect(()=>(u?h.current=setInterval(()=>{const v=Date.now(),b=(v-f.current)/1e3;c(x=>{const w=x+b;return Math.floor(w)%60===0&&Math.floor(w)>0&&a(1),w}),f.current=v},1e3):h.current&&(clearInterval(h.current),h.current=null),()=>{h.current&&clearInterval(h.current)}),[u,a]);const m=y.useCallback(()=>{if(l>0){const v=Math.ceil(l/60);a(v)}},[l,a]);return y.useEffect(()=>{const v=()=>{m()};return window.addEventListener("beforeunload",v),()=>{window.removeEventListener("beforeunload",v),m()}},[m]),{sessionTime:(v=>{const b=Math.floor(v/60),x=Math.floor(v%60);return`${b}:${x.toString().padStart(2,"0")}`})(l),timeRemainingToday:n,dailyTimeLimit:s,isLimitReached:i,isTimerActive:u,canContinue:!i&&(n===null||n>0)}},yO=t=>{const{user:e}=st(),{checkPermission:r}=Xp(t),[n,s]=y.useState(!1),[i,a]=y.useState(null),l=y.useCallback(async(u,d,h)=>{if(!e)return me.error("Vous devez être connecté pour passer un appel"),!1;const m=r(u==="audio"?"call":"video_call");if(!m.allowed)return me.error(m.message||"Appel non autorisé"),!1;try{const{data:p,error:v}=await ae.from("call_sessions").insert({caller_id:e.id,receiver_id:"",formation_id:t,lesson_id:h,call_type:u,status:"pending"}).select().single();if(v)return console.error("Erreur lors de la création de la session d'appel:",v),me.error("Impossible d'initier l'appel"),!1;a(p),s(!0),me.success(`Appel ${u==="audio"?"audio":"vidéo"} lancé`),me.info("En attente qu'un professeur réponde...");const b=ae.channel(`call-${p.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"call_sessions",filter:`id=eq.${p.id}`},x=>{const w=x.new;w.status==="accepted"?me.success("Un professeur a accepté votre appel !"):w.status==="rejected"&&(me.info("Appel terminé"),s(!1),a(null))}).subscribe();return setTimeout(()=>{ae.removeChannel(b),p.status==="pending"&&(c(),me.info("Aucun professeur n'est disponible pour le moment"))},12e4),!0}catch(p){return console.error("Erreur lors de l'initiation de l'appel:",p),me.error("Erreur lors de l'appel"),!1}},[e,r,t]),c=y.useCallback(async()=>{if(i)try{await ae.from("call_sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",i.id),s(!1),a(null),me.info("Appel terminé")}catch(u){console.error("Erreur lors de la fin de l'appel:",u)}},[i]);return{initiateCall:l,isCallActive:n,currentCall:i,endCall:c}},tQ=t=>{const{user:e}=st(),[r,n]=y.useState([]),[s,i]=y.useState(!1);y.useEffect(()=>{if(!(e!=null&&e.id)||!t)return;(async()=>{const{data:u}=await ae.from("teachers").select("id").eq("user_id",e.id).eq("formation_id",t).single();i(!!u)})()},[e==null?void 0:e.id,t]),y.useEffect(()=>{if(!s||!t)return;const c=ae.channel(`calls-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"call_sessions",filter:`formation_id=eq.${t}`},async u=>{const d=u.new;if(d.caller_id===(e==null?void 0:e.id))return;const{data:h}=await ae.from("profiles").select("first_name, last_name, username").eq("id",d.caller_id).single(),f=h&&(`${h.first_name||""} ${h.last_name||""}`.trim()||h.username)||"Utilisateur",m={id:d.id,caller_id:d.caller_id,formation_id:d.formation_id,lesson_id:d.lesson_id,call_type:d.call_type,caller_name:f,status:"pending"};n(p=>[...p,m]),me.info(`📞 Appel ${d.call_type==="video"?"vidéo":"audio"} entrant de ${f}`,{duration:3e4,action:{label:"Répondre",onClick:()=>a(m.id)}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"call_sessions",filter:`formation_id=eq.${t}`},u=>{const d=u.new;n(h=>h.map(f=>f.id===d.id?{...f,status:d.status}:f)),d.status==="accepted"&&d.receiver_id!==(e==null?void 0:e.id)&&(n(h=>h.filter(f=>f.id!==d.id)),me.info("Appel déjà pris par un autre professeur"))}).subscribe();return()=>{ae.removeChannel(c)}},[s,t,e==null?void 0:e.id]);const a=async c=>{try{const{error:u}=await ae.from("call_sessions").update({status:"accepted",receiver_id:e==null?void 0:e.id,started_at:new Date().toISOString()}).eq("id",c).eq("status","pending");if(u){me.error("Impossible d'accepter l'appel");return}n(d=>d.filter(h=>h.id!==c)),me.success("Appel accepté ! Connexion en cours...")}catch(u){console.error("Error accepting call:",u),me.error("Erreur lors de l'acceptation de l'appel")}},l=async c=>{try{const{error:u}=await ae.from("call_sessions").update({status:"rejected",ended_at:new Date().toISOString()}).eq("id",c);if(u){me.error("Erreur lors du rejet de l'appel");return}n(d=>d.filter(h=>h.id!==c)),me.info("Appel rejeté")}catch(u){console.error("Error rejecting call:",u)}};return{incomingCalls:r.filter(c=>c.status==="pending"),acceptCall:a,rejectCall:l,isTeacher:s}},rQ=(t,e)=>{const{user:r}=st(),n=y.useRef(),s=y.useRef(null),i=y.useRef(!1),a=y.useRef(),l=y.useRef(0),c=3,u=()=>{n.current&&clearTimeout(n.current),a.current&&clearTimeout(a.current),s.current&&(ae.removeChannel(s.current),s.current=null),i.current=!1},d=()=>{if(!r||!t||!e){console.log("Missing required data for typing indicator:",{user:!!r,lessonId:t,formationId:e});return}u();const v=`typing-${t}-${e}`;console.log("🎯 Setting up typing indicator channel:",v),s.current=ae.channel(v),s.current.subscribe(b=>{switch(console.log("⌨️ Typing indicator channel status:",b),b){case"SUBSCRIBED":i.current=!0,l.current=0,console.log("✅ Typing indicator channel ready for lesson:",t);break;case"CHANNEL_ERROR":case"TIMED_OUT":case"CLOSED":i.current=!1,console.error("❌ Typing indicator channel error:",b),h();break}})},h=()=>{if(l.current>=c){console.error("🚨 Max typing reconnection attempts reached");return}const v=1e3*Math.pow(2,l.current);l.current++,console.log(`🔄 Reconnecting typing indicator (attempt ${l.current}/${c})`),a.current=setTimeout(d,v)};y.useEffect(()=>(d(),u),[r==null?void 0:r.id,t,e]);const f=async v=>{var b,x,w;if(!(!r||!t||!e||!s.current||!i.current))try{const _={user_id:r.id,user_name:((b=r.user_metadata)==null?void 0:b.first_name)||((x=r.email)==null?void 0:x.split("@")[0])||"Utilisateur",is_teacher:((w=r.user_metadata)==null?void 0:w.is_teacher)||!1,lesson_id:t,formation_id:e},S=v?"typing_start":"typing_stop";await s.current.send({type:"broadcast",event:S,payload:_})}catch(_){console.error("Error sending typing status:",_),i.current&&h()}};return{startTyping:()=>{n.current&&clearTimeout(n.current),f(!0),n.current=setTimeout(()=>{f(!1)},3e3)},stopTyping:()=>{n.current&&clearTimeout(n.current),f(!1)},isSubscribed:i.current}},nQ=({onEmojiSelect:t,isOpen:e,onToggle:r})=>{const[n,s]=y.useState("smileys"),i={smileys:{icon:UP,emojis:["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","🥳"]},emotions:{icon:rf,emojis:["❤️","🧡","💛","💚","💙","💜","🖤","🤍","🤎","💔","❣️","💕","💞","💓","💗","💖","💘","💝","💟","♥️","💯","💢","💥","💫","💦","💨","🕳️","💣","💬","👁️‍🗨️","🗨️","🗯️","💭"]},nature:{icon:a9,emojis:["🌞","🌝","🌛","🌜","🌚","🌕","🌖","🌗","🌘","🌑","🌒","🌓","🌔","🌙","⭐","🌟","💫","✨","☄️","☀️","🌤️","⛅","🌥️","☁️","🌦️","🌧️","⛈️","🌩️","🌨️","❄️","☃️","⛄"]},food:{icon:Pz,emojis:["🍎","🍊","🍋","🍌","🍉","🍇","🍓","🍈","🍒","🍑","🥭","🍍","🥥","🥝","🍅","🍆","🥑","🥦","🥬","🥒","🌶️","🌽","🥕","🧄","🧅","🥔","🍠","🥐","🍞","🥖","🥨","🧀"]},transport:{icon:Cz,emojis:["🚗","🚕","🚙","🚌","🚎","🏎️","🚓","🚑","🚒","🚐","🛻","🚚","🚛","🚜","🏍️","🛵","🚲","🛴","🛹","🚁","🛸","✈️","🛩️","🛫","🛬","🚀","🛰️","💺","🚢","⛵","🛶","🚤"]},flags:{icon:Rz,emojis:["🏁","🚩","🎌","🏴","🏳️","🏳️‍🌈","🏳️‍⚧️","🏴‍☠️","🇫🇷","🇺🇸","🇬🇧","🇩🇪","🇪🇸","🇮🇹","🇯🇵","🇨🇳","🇰🇷","🇷🇺","🇧🇷","🇨🇦","🇦🇺","🇮🇳","🇲🇽","🇳🇱","🇸🇪","🇳🇴","🇩🇰","🇫🇮","🇵🇱","🇨🇭","🇦🇹"]},music:{icon:A_,emojis:["🎵","🎶","🎼","🎹","🥁","🎷","🎺","🎸","🪕","🎻","🪘","🎤","🎧","📻","🎙️","📢","📣","📯","🔔","🔕","🎚️","🎛️","🎨","🖌️","🖍️","🖊️","🖋️","✏️","✒️","🖇️","📎","🔗"]},symbols:{icon:yc,emojis:["⭐","🌟","💫","✨","🔥","💥","💢","💯","💢","💥","💫","💦","💨","🕳️","💣","💬","👁️‍🗨️","🗨️","🗯️","💭","💤","👋","🤚","🖐️","✋","🖖","👌","🤌","🤏","✌️","🤞","🤟"]}};return e?o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg w-80 max-h-72",children:[o.jsx("div",{className:"flex border-b border-gray-200 bg-gray-50 rounded-t-lg",children:Object.entries(i).map(([a,l])=>{const c=l.icon;return o.jsx("button",{onClick:()=>s(a),className:`flex-1 p-2 text-center hover:bg-gray-100 first:rounded-tl-lg last:rounded-tr-lg ${n===a?"bg-blue-100 text-blue-600":"text-gray-600"}`,children:o.jsx(c,{size:16,className:"mx-auto"})},a)})}),o.jsx("div",{className:"p-3 max-h-48 overflow-y-auto",children:o.jsx("div",{className:"grid grid-cols-8 gap-1",children:i[n].emojis.map((a,l)=>o.jsx("button",{onClick:()=>t(a),className:"w-8 h-8 flex items-center justify-center text-lg hover:bg-gray-100 rounded transition-colors",title:a,children:a},l))})})]}):null},sQ=({onRecordingComplete:t,disabled:e=!1})=>{const[r,n]=y.useState(!1),[s,i]=y.useState(0),[a,l]=y.useState(null),[c,u]=y.useState(null),d=y.useRef(null),h=y.useRef(null),f=y.useRef([]),m=y.useRef(null);y.useEffect(()=>()=>{h.current&&clearInterval(h.current)},[]);const p=async()=>{try{const _=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),S=new MediaRecorder(_,{mimeType:"audio/webm;codecs=opus"});d.current=S,f.current=[],S.ondataavailable=N=>{N.data.size>0&&f.current.push(N.data)},S.onstop=()=>{const N=new Blob(f.current,{type:"audio/webm"});l(N),u(URL.createObjectURL(N)),_.getTracks().forEach(E=>E.stop())},S.start(100),n(!0),i(0),h.current=setInterval(()=>{i(N=>N+1)},1e3)}catch(_){console.error("Erreur accès microphone:",_),alert("Impossible d'accéder au microphone. Vérifiez vos permissions.")}},v=()=>{d.current&&r&&(d.current.stop(),n(!1),h.current&&(clearInterval(h.current),h.current=null))},b=()=>{if(a){const _=new File([a],`vocal_${Date.now()}.webm`,{type:"audio/webm"});t(_),x()}},x=()=>{l(null),u(null),i(0),n(!1),h.current&&(clearInterval(h.current),h.current=null)},w=_=>{const S=Math.floor(_/60),N=_%60;return`${S}:${N.toString().padStart(2,"0")}`};return a&&!r?o.jsxs("div",{className:"flex items-center gap-2 bg-green-50 rounded-full px-3 py-2 border border-green-200",children:[o.jsx("audio",{ref:m,src:c||void 0,className:"hidden"}),o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:o.jsx(ax,{size:14,className:"text-white"})}),o.jsx("span",{className:"text-sm font-medium text-green-700",children:w(s)})]}),o.jsx(J,{onClick:x,variant:"ghost",size:"sm",className:"p-1 h-8 w-8 rounded-full hover:bg-red-100",children:o.jsx(qr,{size:14,className:"text-red-500"})}),o.jsx(J,{onClick:b,className:"bg-green-500 hover:bg-green-600 p-2 h-8 w-8 rounded-full",size:"sm",children:o.jsx(xc,{size:14,className:"text-white"})})]}):o.jsxs("div",{className:"flex items-center gap-2",children:[r&&o.jsxs("div",{className:"flex items-center gap-2 bg-red-50 rounded-full px-3 py-1",children:[o.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),o.jsx("span",{className:"text-sm text-red-600 font-medium",children:w(s)})]}),o.jsx(J,{onMouseDown:p,onMouseUp:v,onTouchStart:p,onTouchEnd:v,disabled:e,className:`
          rounded-full w-12 h-12 p-0 border-2 transition-all duration-200
          ${r?"bg-red-500 hover:bg-red-600 border-red-300 scale-110 shadow-lg animate-pulse":"bg-green-500 hover:bg-green-600 border-green-300 hover:scale-105"}
        `,title:r?"Relâchez pour arrêter":"Maintenez pour enregistrer",children:o.jsx(ax,{size:20,className:`text-white ${r?"animate-pulse":""}`})})]})};function ce(t,e,r){return(e=function(n){var s=function(i,a){if(typeof i!="object"||!i)return i;var l=i[Symbol.toPrimitive];if(l!==void 0){var c=l.call(i,a||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ck(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function pe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ck(Object(r),!0).forEach(function(n){ce(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ck(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Er(t,e){if(t==null)return{};var r,n,s=function(a,l){if(a==null)return{};var c={};for(var u in a)if({}.hasOwnProperty.call(a,u)){if(l.indexOf(u)>=0)continue;c[u]=a[u]}return c}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function ro(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}let uk=class{constructor(){ce(this,"browserShadowBlurConstant",1),ce(this,"DPI",96),ce(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),ce(this,"perfLimitSizeTotal",2097152),ce(this,"maxCacheSideLimit",4096),ce(this,"minCacheSideLimit",256),ce(this,"disableStyleCopyPaste",!1),ce(this,"enableGLFiltering",!0),ce(this,"textureSize",4096),ce(this,"forceGLPutImageData",!1),ce(this,"cachesBoundsOfCurve",!1),ce(this,"fontPaths",{}),ce(this,"NUM_FRACTION_DIGITS",4)}};const Xt=new class extends uk{constructor(t){super(),this.configure(t)}configure(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,t)}addFonts(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=pe(pe({},this.fontPaths),t)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>{delete this.fontPaths[t]})}clearFonts(){this.fontPaths={}}restoreDefaults(t){const e=new uk,r=(t==null?void 0:t.reduce((n,s)=>(n[s]=e[s],n),{}))||e;this.configure(r)}},uc=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return console[t]("fabric",...r)};let Ba=class extends Error{constructor(e,r){super("fabric: ".concat(e),r)}},iQ=class extends Ba{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},aQ=class{},oQ=class extends aQ{testPrecision(e,r){const n="precision ".concat(r,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const r=e.getContext("webgl");r&&(this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(r,n)),r.getExtension("WEBGL_lose_context").loseContext(),uc("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}};const lQ={};let dk;const Ja=()=>dk||(dk={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new oQ,dispose(){},copyPasteData:lQ}),gf=()=>Ja().document,z1=()=>Ja().window,bO=()=>{var t;return Math.max((t=Xt.devicePixelRatio)!==null&&t!==void 0?t:z1().devicePixelRatio,1)},Im=new class{constructor(){ce(this,"charWidthsCache",{}),ce(this,"boundsOfCurveCache",{})}getFontCache(t){let{fontFamily:e,fontStyle:r,fontWeight:n}=t;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(r.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(t){(t=(t||"").toLowerCase())?this.charWidthsCache[t]&&delete this.charWidthsCache[t]:this.charWidthsCache={}}limitDimsByArea(t){const{perfLimitSizeTotal:e}=Xt,r=Math.sqrt(e*t);return[Math.floor(r),Math.floor(e/r)]}},Yw="6.7.0";function wv(){}const Kp=Math.PI/2,Cx=2*Math.PI,Sj=Math.PI/180,us=Object.freeze([1,0,0,1,0,0]),Cj=16,vl=.4477152502,Tt="center",rr="left",Ps="top",Xw="bottom",Hr="right",As="none",Nj=/\r?\n/,wO="moving",$1="scaling",_O="rotating",kj="rotate",jO="skewing",vp="resizing",cQ="modifyPoly",uQ="modifyPath",Nx="changed",B1="scale",Ls="scaleX",Ci="scaleY",vf="skewX",xf="skewY",mn="fill",Ts="stroke",kx="modified",wd="json",$2="svg",et=new class{constructor(){this[wd]=new Map,this[$2]=new Map}has(t){return this[wd].has(t)}getClass(t){const e=this[wd].get(t);if(!e)throw new Ba("No class registered for ".concat(t));return e}setClass(t,e){e?this[wd].set(e,t):(this[wd].set(t.type,t),this[wd].set(t.type.toLowerCase(),t))}getSVGClass(t){return this[$2].get(t)}setSVGClass(t,e){this[$2].set(e??t.type.toLowerCase(),t)}},Ex=new class extends Array{remove(t){const e=this.indexOf(t);e>-1&&this.splice(e,1)}cancelAll(){const t=this.splice(0);return t.forEach(e=>e.abort()),t}cancelByCanvas(t){if(!t)return[];const e=this.filter(r=>{var n;return r.target===t||typeof r.target=="object"&&((n=r.target)===null||n===void 0?void 0:n.canvas)===t});return e.forEach(r=>r.abort()),e}cancelByTarget(t){if(!t)return[];const e=this.filter(r=>r.target===t);return e.forEach(r=>r.abort()),e}};let dQ=class{constructor(){ce(this,"__eventListeners",{})}on(e,r){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(r){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(r),()=>this.off(n,r)}return()=>!1}once(e,r){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,a]=s;n.push(this.once(i,a))}),()=>n.forEach(s=>s())}if(r){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];r.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,r){if(this.__eventListeners[e])if(r){const n=this.__eventListeners[e],s=n.indexOf(r);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,r){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,r)}fire(e,r){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,r||{})}};const kd=(t,e)=>{const r=t.indexOf(e);return r!==-1&&t.splice(r,1),t},Vo=t=>{if(t===0)return 1;switch(Math.abs(t)/Kp){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},Wo=t=>{if(t===0)return 0;const e=t/Kp,r=Math.sign(t);switch(e){case 1:return r;case 2:return 0;case 3:return-r}return Math.sin(t)};let Ne=class ts{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=r)}add(e){return new ts(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new ts(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new ts(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new ts(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new ts(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new ts(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new ts(this.x/e.x,this.y/e.y)}scalarDivide(e){return new ts(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return r=Math.max(Math.min(1,r),0),new ts(this.x+(e.x-this.x)*r,this.y+(e.y-this.y)*r)}distanceFrom(e){const r=this.x-e.x,n=this.y-e.y;return Math.sqrt(r*r+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new ts(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new ts(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,r){return this.x=e,this.y=r,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const r=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=r,e.y=n}clone(){return new ts(this.x,this.y)}rotate(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ej;const n=Wo(e),s=Vo(e),i=this.subtract(r);return new ts(i.x*s-i.y*n,i.x*n+i.y*s).add(r)}transform(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new ts(e[0]*this.x+e[2]*this.y+(r?0:e[4]),e[1]*this.x+e[3]*this.y+(r?0:e[5]))}};const Ej=new Ne(0,0),_v=t=>!!t&&Array.isArray(t._objects);function SO(t){class e extends t{constructor(){super(...arguments),ce(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const a=this._objects.push(...s);return s.forEach(l=>this._onObjectAdded(l)),a}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return this._objects.splice(n,0,...i),i.forEach(l=>this._onObjectAdded(l)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return a.forEach(c=>{const u=n.indexOf(c);u!==-1&&(n.splice(u,1),s.push(c),this._onObjectRemoved(c))}),s}forEachObject(n){this.getObjects().forEach((s,i,a)=>n(s,i,a))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(a=>a.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(kd(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(kd(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const a=this.findNewLowerIndex(n,i,s);return kd(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const a=this.findNewUpperIndex(n,i,s);return kd(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(kd(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let a;if(i){a=s;for(let l=s-1;l>=0;--l)if(n.isOverlapping(this._objects[l])){a=l;break}}else a=s-1;return a}findNewUpperIndex(n,s,i){let a;if(i){a=s;for(let l=s+1;l<this._objects.length;++l)if(n.isOverlapping(this._objects[l])){a=l;break}}else a=s+1;return a}collectObjects(n){let{left:s,top:i,width:a,height:l}=n,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const u=[],d=new Ne(s,i),h=d.add(new Ne(a,l));for(let f=this._objects.length-1;f>=0;f--){const m=this._objects[f];m.selectable&&m.visible&&(c&&m.intersectsWithRect(d,h)||m.isContainedWithinRect(d,h)||c&&m.containsPoint(d)||c&&m.containsPoint(h))&&u.push(m)}return u}}return e}let CO=class extends dQ{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const r in e)this.set(r,e[r])}_setObject(e){for(const r in e)this._set(r,e[r])}set(e,r){return typeof e=="object"?this._setObject(e):this._set(e,r),this}_set(e,r){this[e]=r}toggle(e){const r=this.get(e);return typeof r=="boolean"&&this.set(e,!r),this}get(e){return this[e]}};function jv(t){return z1().requestAnimationFrame(t)}function hQ(t){return z1().cancelAnimationFrame(t)}let fQ=0;const dc=()=>fQ++,Ho=()=>{const t=gf().createElement("canvas");if(!t||t.getContext===void 0)throw new Ba("Failed to create `canvas` element");return t},mQ=()=>gf().createElement("img"),Ni=t=>{const e=Ho();return e.width=t.width,e.height=t.height,e},NO=(t,e,r)=>t.toDataURL("image/".concat(e),r),kO=(t,e,r)=>new Promise((n,s)=>{t.toBlob(n,"image/".concat(e),r)}),Qr=t=>t*Sj,Go=t=>t/Sj,pQ=t=>t.every((e,r)=>e===us[r]),_s=(t,e,r)=>new Ne(t).transform(e,r),ea=t=>{const e=1/(t[0]*t[3]-t[1]*t[2]),r=[e*t[3],-e*t[1],-e*t[2],e*t[0],0,0],{x:n,y:s}=new Ne(t[4],t[5]).transform(r,!0);return r[4]=-n,r[5]=-s,r},Tn=(t,e,r)=>[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],r?0:t[0]*e[4]+t[2]*e[5]+t[4],r?0:t[1]*e[4]+t[3]*e[5]+t[5]],Pj=(t,e)=>t.reduceRight((r,n)=>n&&r?Tn(n,r,e):n||r,void 0)||us.concat(),EO=t=>{let[e,r]=t;return Math.atan2(r,e)},Px=t=>{const e=EO(t),r=Math.pow(t[0],2)+Math.pow(t[1],2),n=Math.sqrt(r),s=(t[0]*t[3]-t[2]*t[1])/n,i=Math.atan2(t[0]*t[2]+t[1]*t[3],r);return{angle:Go(e),scaleX:n,scaleY:s,skewX:Go(i),skewY:0,translateX:t[4]||0,translateY:t[5]||0}},Qp=function(t){return[1,0,0,1,t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function yf(){let{angle:t=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:r=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=Qr(t),s=Vo(n),i=Wo(n);return[s,i,-i,s,e?e-(s*e-i*r):0,r?r-(i*e+s*r):0]}const Aj=function(t){return[t,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,0,0]},PO=t=>Math.tan(Qr(t)),AO=t=>[1,0,PO(t),1,0,0],TO=t=>[1,PO(t),0,1,0,0],q1=t=>{let{scaleX:e=1,scaleY:r=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:a=0}=t,l=Aj(n?-e:e,s?-r:r);return i&&(l=Tn(l,AO(i),!0)),a&&(l=Tn(l,TO(a),!0)),l},gQ=t=>{const{translateX:e=0,translateY:r=0,angle:n=0}=t;let s=Qp(e,r);n&&(s=Tn(s,yf({angle:n})));const i=q1(t);return pQ(i)||(s=Tn(s,i)),s},Sv=function(t){let{signal:e,crossOrigin:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new iQ("loadImage"));const i=mQ();let a;e&&(a=function(c){i.src="",s(c)},e.addEventListener("abort",a,{once:!0}));const l=function(){i.onload=i.onerror=null,a&&(e==null||e.removeEventListener("abort",a)),n(i)};t?(i.onload=l,i.onerror=function(){a&&(e==null||e.removeEventListener("abort",a)),s(new Ba("Error loading ".concat(i.src)))},r&&(i.crossOrigin=r),i.src=t):l()})},xp=function(t){let{signal:e,reviver:r=wv}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(t.map(a=>et.getClass(a.type).fromObject(a,{signal:e}).then(l=>(r(a,l),i.push(l),l)))).then(n).catch(a=>{i.forEach(l=>{l.dispose&&l.dispose()}),s(a)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},U1=function(t){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(t).map(l=>l&&l.type&&et.has(l.type)?xp([l],{signal:e}).then(c=>{let[u]=c;return s.push(u),u}):l),a=Object.keys(t);Promise.all(i).then(l=>l.reduce((c,u,d)=>(c[a[d]]=u,c),{})).then(r).catch(l=>{s.forEach(c=>{c.dispose&&c.dispose()}),n(l)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},bf=function(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,r)=>(r in t&&(e[r]=t[r]),e),{})},Tj=(t,e)=>Object.keys(t).reduce((r,n)=>(e(t[n],n,t)&&(r[n]=t[n]),r),{}),vr=(t,e)=>parseFloat(Number(t).toFixed(e)),yp=t=>"matrix("+t.map(e=>vr(e,Xt.NUM_FRACTION_DIGITS)).join(" ")+")",yi=t=>!!t&&t.toLive!==void 0,hk=t=>!!t&&typeof t.toObject=="function",fk=t=>!!t&&t.offsetX!==void 0&&"source"in t,Vc=t=>!!t&&"multiSelectionStacking"in t;function LO(t){const e=t&&Zi(t);let r=0,n=0;if(!t||!e)return{left:r,top:n};let s=t;const i=e.documentElement,a=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(r=a.scrollLeft||i.scrollLeft||0,n=a.scrollTop||i.scrollTop||0):(r+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:r,top:n}}const Zi=t=>t.ownerDocument||null,OO=t=>{var e;return((e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},MO=function(t,e,r){let{width:n,height:s}=r,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;t.width=n,t.height=s,i>1&&(t.setAttribute("width",(n*i).toString()),t.setAttribute("height",(s*i).toString()),e.scale(i,i))},Kw=(t,e)=>{let{width:r,height:n}=e;r&&(t.style.width=typeof r=="number"?"".concat(r,"px"):r),n&&(t.style.height=typeof n=="number"?"".concat(n,"px"):n)};function mk(t){return t.onselectstart!==void 0&&(t.onselectstart=()=>!1),t.style.userSelect=As,t}let RO=class{constructor(e){ce(this,"_originalCanvasStyle",void 0),ce(this,"lower",void 0);const r=this.createLowerCanvas(e);this.lower={el:r,ctx:r.getContext("2d")}}createLowerCanvas(e){const r=(n=e)&&n.getContext!==void 0?e:e&&gf().getElementById(e)||Ho();var n;if(r.hasAttribute("data-fabric"))throw new Ba("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=r.style.cssText,r.setAttribute("data-fabric","main"),r.classList.add("lower-canvas"),r}cleanupDOM(e){let{width:r,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(r)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,r){const{el:n,ctx:s}=this.lower;MO(n,s,e,r)}setCSSDimensions(e){Kw(this.lower.el,e)}calcOffset(){return function(e){var r;const n=e&&Zi(e),s={left:0,top:0};if(!n)return s;const i=((r=OO(e))===null||r===void 0?void 0:r.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let a={left:0,top:0};const l=n.documentElement;e.getBoundingClientRect!==void 0&&(a=e.getBoundingClientRect());const c=LO(e);return{left:a.left+c.left-(l.clientLeft||0)+s.left,top:a.top+c.top-(l.clientTop||0)+s.top}}(this.lower.el)}dispose(){Ja().dispose(this.lower.el),delete this.lower}};const vQ={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...us]};let Lj=class DO extends SO(CO){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return DO.ownDefaults}constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(r),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new RO(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(uc("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?bO():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,r){return this.setDimensions({width:e},r)}setHeight(e,r){return this.setDimensions({height:e},r)}_setDimensionsImpl(e){let{cssOnly:r=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r){const s=pe({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,r){this._setDimensionsImpl(e,r),r&&r.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,r){const n=e,s=[...this.viewportTransform],i=_s(e,ea(s));s[0]=r,s[3]=r;const a=_s(i,s);s[4]+=n.x-a.x,s[5]+=n.y-a.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new Ne(0,0),e)}absolutePan(e){const r=[...this.viewportTransform];return r[4]=-e.x,r[5]=-e.y,this.setViewportTransform(r)}relativePan(e){return this.absolutePan(new Ne(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=jv(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,r=this.height,n=ea(this.viewportTransform),s=_s({x:0,y:0},n),i=_s({x:e,y:r},n),a=s.min(i),l=s.max(i);return this.vptCoords={tl:a,tr:new Ne(l.x,a.y),bl:new Ne(a.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(hQ(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,r){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,r),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,r){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",r.transform(e),e.scale(1/r.zoomX,1/r.zoomY),e.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),e.restore()}_renderObjects(e,r){for(let n=0,s=r.length;n<s;++n)r[n]&&r[n].render(e)}_renderBackgroundOrOverlay(e,r){const n=this["".concat(r,"Color")],s=this["".concat(r,"Image")],i=this.viewportTransform,a=this["".concat(r,"Vpt")];if(!n&&!s)return;const l=yi(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=l?n.toLive(e):n,a&&e.transform(...i),l){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const c=n.gradientTransform||n.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:c}=this;this.skipOffscreen=a,a&&e.transform(...i),s.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Ne(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Ne(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Ne(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Ne(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Ne(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return _s(this.getCenterPoint(),ea(this.viewportTransform))}_centerObject(e,r){e.setXY(r,Tt,Tt),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,r){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,r):null;return pe(pe(pe({version:Yw},bf(this,r)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,r))},this.__serializeBgOverlay(e,r)),s?{clipPath:s}:null)}_toObject(e,r,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[r](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,r){const n={},s=this.backgroundImage,i=this.overlayImage,a=this.backgroundColor,l=this.overlayColor;return yi(a)?a.excludeFromExport||(n.background=a.toObject(r)):a&&(n.background=a),yi(l)?l.excludeFromExport||(n.overlay=l.toObject(r)):l&&(n.overlay=l),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,r)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,r)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;e.reviver=r;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",r),this._setSVGObjects(n,r),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",r),n.push("</svg>"),n.join("")}_setSVGPreamble(e,r){r.suppressPreamble||e.push('<?xml version="1.0" encoding="',r.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,r){const n=r.width||"".concat(this.width),s=r.height||"".concat(this.height),i=Xt.NUM_FRACTION_DIGITS,a=r.viewBox;let l;if(a)l='viewBox="'.concat(a.x," ").concat(a.y," ").concat(a.width," ").concat(a.height,'" ');else if(this.svgViewportTransformation){const c=this.viewportTransform;l='viewBox="'.concat(vr(-c[4]/c[0],i)," ").concat(vr(-c[5]/c[3],i)," ").concat(vr(this.width/c[0],i)," ").concat(vr(this.height/c[3],i),'" ')}else l='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Yw,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(r),`</defs>
`)}createSVGClipPathMarkup(e){const r=this.clipPath;return r?(r.clipPathId="CLIPPATH_".concat(dc()),'<clipPath id="'.concat(r.clipPathId,`" >
`).concat(r.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const r=this["".concat(e,"Color")];if(yi(r)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return r.toSVG(i,{additionalTransform:n?yp(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],r={},n=Xt.fontPaths;this._objects.forEach(function i(a){e.push(a),_v(a)&&a._objects.forEach(i)}),e.forEach(i=>{if(!(a=i)||typeof a._renderText!="function")return;var a;const{styles:l,fontFamily:c}=i;!r[c]&&n[c]&&(r[c]=!0,l&&Object.values(l).forEach(u=>{Object.values(u).forEach(d=>{let{fontFamily:h=""}=d;!r[h]&&n[h]&&(r[h]=!0)})}))});const s=Object.keys(r).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,r){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,r)})}_setSVGObject(e,r,n){e.push(r.toSVG(n))}_setSVGBgOverlayImage(e,r,n){const s=this[r];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,r){const n=this["".concat(r,"Color")];if(n)if(yi(n)){const s=n.repeat||"",i=this.width,a=this.height,l=this["".concat(r,"Vpt")]?yp(ea(this.viewportTransform)):"";e.push('<rect transform="'.concat(l," translate(").concat(i/2,",").concat(a/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-a/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!fk(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!fk(n)?a:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,r){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Ba("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:a,background:l,overlayImage:c,overlay:u,clipPath:d}=s,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([xp(i,{reviver:r,signal:n}),U1({backgroundImage:a,backgroundColor:l,overlayImage:c,overlayColor:u,clipPath:d},{signal:n})]).then(f=>{let[m,p]=f;return this.clear(),this.add(...m),this.set(s),this.set(p),this.renderOnAddRemove=h,this})}clone(e){const r=this.toObject(e);return this.cloneWithoutData().loadFromJSON(r)}cloneWithoutData(){const e=Ni(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:r="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,a=s*(i?this.getRetinaScaling():1);return NO(this.toCanvasElement(a,e),r,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:r="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,a=s*(i?this.getRetinaScaling():1);return kO(this.toCanvasElement(a,e),r,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:r,height:n,left:s,top:i,filter:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=(r||this.width)*e,c=(n||this.height)*e,u=this.getZoom(),d=this.width,h=this.height,f=this.skipControlsDrawing,m=u*e,p=this.viewportTransform,v=[m,0,0,m,(p[4]-(s||0))*e,(p[5]-(i||0))*e],b=this.enableRetinaScaling,x=Ni({width:l,height:c}),w=a?this._objects.filter(_=>a(_)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=v,this.width=l,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),w),this.viewportTransform=p,this.width=d,this.height=h,this.calcViewportBoundaries(),this.enableRetinaScaling=b,this.skipControlsDrawing=f,x}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Ex.cancelByCanvas(this),this.disposed=!0,new Promise((e,r)=>{const n=()=>{this.destroy(),e(!0)};n.kill=r,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};ce(Lj,"ownDefaults",vQ);const xQ=["touchstart","touchmove","touchend"],yQ=t=>{const e=LO(t.target),r=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(t);return new Ne(r.clientX+e.left,r.clientY+e.top)},Qw=t=>xQ.includes(t.type)||t.pointerType==="touch",pk=t=>{t.preventDefault(),t.stopPropagation()},Oo=t=>{let e=0,r=0,n=0,s=0;for(let i=0,a=t.length;i<a;i++){const{x:l,y:c}=t[i];(l>n||!i)&&(n=l),(l<e||!i)&&(e=l),(c>s||!i)&&(s=c),(c<r||!i)&&(r=c)}return{left:e,top:r,width:n-e,height:s-r}},bQ=["translateX","translateY","scaleX","scaleY"],wQ=(t,e)=>Ax(t,Tn(e,t.calcOwnMatrix())),Ax=(t,e)=>{const r=Px(e),{translateX:n,translateY:s,scaleX:i,scaleY:a}=r,l=Er(r,bQ),c=new Ne(n,s);t.flipX=!1,t.flipY=!1,Object.assign(t,l),t.set({scaleX:i,scaleY:a}),t.setPositionByOrigin(c,Tt,Tt)},_Q=t=>{t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},FO=t=>({scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}),Oj=(t,e,r)=>{const n=t/2,s=e/2,i=[new Ne(-n,-s),new Ne(n,-s),new Ne(-n,s),new Ne(n,s)].map(l=>l.transform(r)),a=Oo(i);return new Ne(a.width,a.height)},V1=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:us;return Tn(ea(arguments.length>1&&arguments[1]!==void 0?arguments[1]:us),t)},ch=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:us,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:us;return t.transform(V1(e,r))},jQ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:us,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:us;return t.transform(V1(e,r),!0)},SQ=(t,e,r)=>{const n=V1(e,r);return Ax(t,Tn(n,t.calcOwnMatrix())),n},IO=(t,e)=>{var r;const{transform:{target:n}}=e;(r=n.canvas)===null||r===void 0||r.fire("object:".concat(t),pe(pe({},e),{},{target:n})),n.fire(t,e)},CQ={left:-.5,top:-.5,center:0,bottom:.5,right:.5},nn=t=>typeof t=="string"?CQ[t]:t-.5,Tx="not-allowed";function zO(t){return nn(t.originX)===nn(Tt)&&nn(t.originY)===nn(Tt)}function gk(t){return .5-nn(t)}const sa=(t,e)=>t[e],$O=(t,e,r,n)=>({e:t,transform:e,pointer:new Ne(r,n)});function BO(t,e){const r=t.getTotalAngle()+Go(Math.atan2(e.y,e.x))+360;return Math.round(r%360/45)}function Mj(t,e,r,n,s){var i;let{target:a,corner:l}=t;const c=a.controls[l],u=((i=a.canvas)===null||i===void 0?void 0:i.getZoom())||1,d=a.padding/u,h=function(f,m,p,v){const b=f.getRelativeCenterPoint(),x=p!==void 0&&v!==void 0?f.translateToGivenOrigin(b,Tt,Tt,p,v):new Ne(f.left,f.top);return(f.angle?m.rotate(-Qr(f.angle),b):m).subtract(x)}(a,new Ne(n,s),e,r);return h.x>=d&&(h.x-=d),h.x<=-d&&(h.x+=d),h.y>=d&&(h.y-=d),h.y<=d&&(h.y+=d),h.x-=c.offsetX,h.y-=c.offsetY,h}const NQ=(t,e,r,n)=>{const{target:s,offsetX:i,offsetY:a}=e,l=r-i,c=n-a,u=!sa(s,"lockMovementX")&&s.left!==l,d=!sa(s,"lockMovementY")&&s.top!==c;return u&&s.set(rr,l),d&&s.set(Ps,c),(u||d)&&IO(wO,$O(t,e,r,n)),u||d},vk={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},B2=(t,e,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t),xk=(t,e,r,n)=>{t/=255,e/=255,r/=255;const s=Math.max(t,e,r),i=Math.min(t,e,r);let a,l;const c=(s+i)/2;if(s===i)a=l=0;else{const u=s-i;switch(l=c>.5?u/(2-s-i):u/(s+i),s){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4}a/=6}return[Math.round(360*a),Math.round(100*l),Math.round(100*c),n]},yk=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(t)/(t.endsWith("%")?100:1)},S0=t=>Math.min(Math.round(t),255).toString(16).toUpperCase().padStart(2,"0"),bk=t=>{let[e,r,n,s=1]=t;const i=Math.round(.3*e+.59*r+.11*n);return[i,i,i,s]};let Os=class Un{constructor(e){if(ce(this,"isUnrecognised",!1),e)if(e instanceof Un)this.setSource([...e._source]);else if(Array.isArray(e)){const[r,n,s,i=1]=e;this.setSource([r,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in vk&&(e=vk[e]),e==="transparent"?[255,255,255,0]:Un.sourceFromHex(e)||Un.sourceFromRgb(e)||Un.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,r,n]=this.getSource();return"rgb(".concat(e,",").concat(r,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,r,n]=xk(...this.getSource());return"hsl(".concat(e,",").concat(r,"%,").concat(n,"%)")}toHsla(){const[e,r,n,s]=xk(...this.getSource());return"hsla(".concat(e,",").concat(r,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,r,n,s]=this.getSource();return"".concat(S0(e)).concat(S0(r)).concat(S0(n)).concat(S0(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(bk(this.getSource())),this}toBlackWhite(e){const[r,,,n]=bk(this.getSource()),s=r<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof Un||(e=new Un(e));const r=this.getSource(),n=e.getSource(),[s,i,a]=r.map((l,c)=>Math.round(.5*l+.5*n[c]));return this.setSource([s,i,a,r[3]]),this}static fromRgb(e){return Un.fromRgba(e)}static fromRgba(e){return new Un(Un.sourceFromRgb(e))}static sourceFromRgb(e){const r=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(r){const[n,s,i]=r.slice(1,4).map(a=>{const l=parseFloat(a);return a.endsWith("%")?Math.round(2.55*l):l});return[n,s,i,yk(r[4])]}}static fromHsl(e){return Un.fromHsla(e)}static fromHsla(e){return new Un(Un.sourceFromHsl(e))}static sourceFromHsl(e){const r=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!r)return;const n=(Un.parseAngletoDegrees(r[1])%360+360)%360/360,s=parseFloat(r[2])/100,i=parseFloat(r[3])/100;let a,l,c;if(s===0)a=l=c=i;else{const u=i<=.5?i*(s+1):i+s-i*s,d=2*i-u;a=B2(d,u,n+1/3),l=B2(d,u,n),c=B2(d,u,n-1/3)}return[Math.round(255*a),Math.round(255*l),Math.round(255*c),yk(r[4])]}static fromHex(e){return new Un(Un.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const r=e.slice(e.indexOf("#")+1);let n;n=r.length<=4?r.split("").map(c=>c+c):r.match(/.{2}/g);const[s,i,a,l=255]=n.map(c=>parseInt(c,16));return[s,i,a,l/255]}}static parseAngletoDegrees(e){const r=e.toLowerCase(),n=parseFloat(r);return r.includes("rad")?Go(n):r.includes("turn")?360*n:n}};const uh=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cj;const r=/\D{0,2}$/.exec(t),n=parseFloat(t),s=Xt.DPI;switch(r==null?void 0:r[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},kQ=t=>{const[e,r]=t.trim().split(" "),[n,s]=(i=e)&&i!==As?[i.slice(1,4),i.slice(5,8)]:i===As?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:r||"meet",alignX:n,alignY:s}},bp=function(t,e){let r,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)r="url(#SVGID_".concat(e.id,")");else{const i=new Os(e),a=i.getAlpha();r=i.toRgb(),a!==1&&(n=a.toString())}else r="none";return s?"".concat(t,": ").concat(r,"; ").concat(n?"".concat(t,"-opacity: ").concat(n,"; "):""):"".concat(t,'="').concat(r,'" ').concat(n?"".concat(t,'-opacity="').concat(n,'" '):"")};class qO{getSvgStyles(e){const r=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):As,i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",u=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),f=bp(mn,this.fill);return[bp(Ts,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",c,"; ",f,"fill-rule: ",r,"; ","opacity: ",u,";",h,d].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(yp(n));return"".concat(s).concat(r,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:r,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,r?r(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:r,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=r?"":'style="'.concat(this.getSvgStyles(),'" '),l=s?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=c&&c.absolutePositioned,h=this.stroke,f=this.fill,m=this.shadow,p=[],v=e.indexOf("COMMON_PARTS");let b;c&&(c.clipPathId="CLIPPATH_".concat(dc()),b='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(n),`</clipPath>
`)),d&&p.push("<g ",l,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),d?"":l+this.getSvgCommons(),` >
`);const x=[a,u,r?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[v]=x,yi(f)&&p.push(f.toSVG(this)),yi(h)&&p.push(h.toSVG(this)),m&&p.push(m.toSVG(this)),c&&p.push(b),p.push(e.join("")),p.push(`</g>
`),d&&p.push(`</g>
`),n?n(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==mn?' paint-order="'.concat(this.paintFirst,'" '):""}}function W1(t){return new RegExp("^("+t.join("|")+")\\b","i")}const Nu="textDecorationThickness",UO=["fontSize","fontWeight","fontFamily","fontStyle"],VO=["underline","overline","linethrough"],WO=[...UO,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],HO=[...WO,...VO,"textBackgroundColor","direction",Nu],EQ=[...UO,...VO,Ts,"strokeWidth",mn,"deltaY","textBackgroundColor",Nu],PQ={_reNewline:Nj,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:rr,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:rr,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Nu]:66.667},za="justify",Lx="justify-left",zm="justify-right",$m="justify-center";var wk,_k,jk;const ta=String.raw(wk||(wk=ro(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),q2=String.raw(_k||(_k=ro(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),AQ=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+ta+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+ta+"))?\\s+(.*)"),TQ={cx:rr,x:rr,r:"radius",cy:Ps,y:Ps,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Nu},U2="font-size",V2="clip-path";W1(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);W1(["symbol","image","marker","pattern","view","svg"]);const Sk=W1(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(jk||(jk=ro(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),ta,q2,ta,q2,ta,q2,ta));const LQ=new Ne(1,0),GO=new Ne,YO=(t,e)=>t.rotate(e),Jw=(t,e)=>new Ne(e).subtract(t),Zw=t=>t.distanceFrom(GO),e5=(t,e)=>Math.atan2(Bm(t,e),MQ(t,e)),OQ=t=>e5(LQ,t),Rj=t=>t.eq(GO)?t:t.scalarDivide(Zw(t)),XO=function(t){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Rj(new Ne(-t.y,t.x).scalarMultiply(e?1:-1))},Bm=(t,e)=>t.x*e.y-t.y*e.x,MQ=(t,e)=>t.x*e.x+t.y*e.y,Ck=(t,e,r)=>{if(t.eq(e)||t.eq(r))return!0;const n=Bm(e,r),s=Bm(e,t),i=Bm(r,t);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},Nk="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",kk=new RegExp("(?:\\s|^)"+Nk+Nk+"("+ta+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Wa{constructor(e){const r=typeof e=="string"?Wa.parseShadow(e):e;Object.assign(this,Wa.ownDefaults,r),this.id=dc()}static parseShadow(e){const r=e.trim(),[,n=0,s=0,i=0]=(kk.exec(r)||[]).map(a=>parseFloat(a)||0);return{color:(r.replace(kk,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const r=YO(new Ne(this.offsetX,this.offsetY),Qr(-e.angle)),n=new Os(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*vr((Math.abs(r.x)+this.blur)/e.width,Xt.NUM_FRACTION_DIGITS)+20,i=100*vr((Math.abs(r.y)+this.blur)/e.height,Xt.NUM_FRACTION_DIGITS)+20),e.flipX&&(r.x*=-1),e.flipY&&(r.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(vr(this.blur?this.blur/2:0,Xt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(vr(r.x,Xt.NUM_FRACTION_DIGITS),'" dy="').concat(vr(r.y,Xt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},r=Wa.ownDefaults;return this.includeDefaultValues?e:Tj(e,(n,s)=>n!==r[s])}static async fromObject(e){return new this(e)}}ce(Wa,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),ce(Wa,"type","shadow"),et.setClass(Wa,"shadow");const Hh=(t,e,r)=>Math.max(t,Math.min(e,r)),RQ=[Ps,rr,Ls,Ci,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",vf,xf],Qo=[mn,Ts,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],DQ={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:rr,originY:Ps,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:mn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},FQ=(t,e,r,n)=>-r*Math.cos(t/n*Kp)+r+e,IQ=()=>!1;class Dj{constructor(e){let{startValue:r,byValue:n,duration:s=500,delay:i=0,easing:a=FQ,onStart:l=wv,onChange:c=wv,onComplete:u=wv,abort:d=IQ,target:h}=e;ce(this,"_state","pending"),ce(this,"durationProgress",0),ce(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=a,this._onStart=l,this._onChange=c,this._onComplete=u,this._abort=d,this.target=h,this.startValue=r,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=r=>{this._state==="pending"&&(this.startTime=r||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>jv(e),this.delay):jv(e)}tick(e){const r=(e||+new Date)-this.startTime,n=Math.min(r,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):r>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),jv(this.tick)))}register(){Ex.push(this)}unregister(){Ex.remove(this)}abort(){this._state="aborted",this.unregister()}}const zQ=["startValue","endValue"];class $Q extends Dj{constructor(e){let{startValue:r=0,endValue:n=100}=e;super(pe(pe({},Er(e,zQ)),{},{startValue:r,byValue:n-r}))}calculate(e){const r=this.easing(e,this.startValue,this.byValue,this.duration);return{value:r,valueProgress:Math.abs((r-this.startValue)/this.byValue)}}}const BQ=["startValue","endValue"];class qQ extends Dj{constructor(e){let{startValue:r=[0],endValue:n=[100]}=e;super(pe(pe({},Er(e,BQ)),{},{startValue:r,byValue:n.map((s,i)=>s-r[i])}))}calculate(e){const r=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:r,valueProgress:Math.abs((r[0]-this.startValue[0])/this.byValue[0])}}}const UQ=["startValue","endValue","easing","onChange","onComplete","abort"],VQ=(t,e,r,n)=>e+r*(1-Math.cos(t/n*Kp)),W2=t=>t&&((e,r,n)=>t(new Os(e).toRgba(),r,n));class WQ extends Dj{constructor(e){let{startValue:r,endValue:n,easing:s=VQ,onChange:i,onComplete:a,abort:l}=e,c=Er(e,UQ);const u=new Os(r).getSource(),d=new Os(n).getSource();super(pe(pe({},c),{},{startValue:u,byValue:d.map((h,f)=>h-u[f]),easing:s,onChange:W2(i),onComplete:W2(a),abort:W2(l)}))}calculate(e){const[r,n,s,i]=this.startValue.map((l,c)=>this.easing(e,l,this.byValue[c],this.duration,c)),a=[...[r,n,s].map(Math.round),Hh(0,i,1)];return{value:a,valueProgress:a.map((l,c)=>this.byValue[c]!==0?Math.abs((l-this.startValue[c])/this.byValue[c]):0).find(l=>l!==0)||0}}}function KO(t){const e=(r=>Array.isArray(r.startValue)||Array.isArray(r.endValue))(t)?new qQ(t):new $Q(t);return e.start(),e}function HQ(t){const e=new WQ(t);return e.start(),e}class Ar{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(r=>r.eq(e))}append(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return this.points=this.points.concat(r.filter(s=>!this.includes(s))),this}static isPointContained(e,r,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(r.eq(n))return e.eq(r);if(r.x===n.x)return e.x===r.x&&(s||e.y>=Math.min(r.y,n.y)&&e.y<=Math.max(r.y,n.y));if(r.y===n.y)return e.y===r.y&&(s||e.x>=Math.min(r.x,n.x)&&e.x<=Math.max(r.x,n.x));{const i=Jw(r,n),a=Jw(r,e).divide(i);return s?Math.abs(a.x)===Math.abs(a.y):a.x===a.y&&a.x>=0&&a.x<=1}}static isPointInPolygon(e,r){const n=new Ne(e).setX(Math.min(e.x-1,...r.map(i=>i.x)));let s=0;for(let i=0;i<r.length;i++){const a=this.intersectSegmentSegment(r[i],r[(i+1)%r.length],e,n);if(a.includes(e))return!0;s+=+(a.status==="Intersection")}return s%2==1}static intersectLineLine(e,r,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const l=r.x-e.x,c=r.y-e.y,u=s.x-n.x,d=s.y-n.y,h=e.x-n.x,f=e.y-n.y,m=u*f-d*h,p=l*f-c*h,v=d*l-u*c;if(v!==0){const b=m/v,x=p/v;return(i||0<=b&&b<=1)&&(a||0<=x&&x<=1)?new Ar("Intersection").append(new Ne(e.x+b*l,e.y+b*c)):new Ar}if(m===0||p===0){const b=i||a||Ar.isPointContained(e,n,s)||Ar.isPointContained(r,n,s)||Ar.isPointContained(n,e,r)||Ar.isPointContained(s,e,r);return new Ar(b?"Coincident":void 0)}return new Ar("Parallel")}static intersectSegmentLine(e,r,n,s){return Ar.intersectLineLine(e,r,n,s,!1,!0)}static intersectSegmentSegment(e,r,n,s){return Ar.intersectLineLine(e,r,n,s,!1,!1)}static intersectLinePolygon(e,r,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new Ar,a=n.length;for(let l,c,u,d=0;d<a;d++){if(l=n[d],c=n[(d+1)%a],u=Ar.intersectLineLine(e,r,l,c,s,!1),u.status==="Coincident")return u;i.append(...u.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,r,n){return Ar.intersectLinePolygon(e,r,n,!1)}static intersectPolygonPolygon(e,r){const n=new Ar,s=e.length,i=[];for(let a=0;a<s;a++){const l=e[a],c=e[(a+1)%s],u=Ar.intersectSegmentPolygon(l,c,r);u.status==="Coincident"?(i.push(u),n.append(l,c)):n.append(...u.points)}return i.length>0&&i.length===e.length?new Ar("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,r,n){const s=r.min(n),i=r.max(n),a=new Ne(i.x,s.y),l=new Ne(s.x,i.y);return Ar.intersectPolygonPolygon(e,[s,a,i,l])}}class GQ extends CO{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?_s(e,this.group.calcTransformMatrix()):e}setXY(e,r,n){this.group&&(e=_s(e,ea(this.group.calcTransformMatrix()))),this.setRelativeXY(e,r,n)}getRelativeXY(){return new Ne(this.left,this.top)}setRelativeXY(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,r,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:r,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,r,n,s];if(this.group){const a=this.group.calcTransformMatrix();return i.map(l=>_s(l,a))}return i}intersectsWithRect(e,r){return Ar.intersectPolygonRectangle(this.getCoords(),e,r).status==="Intersection"}intersectsWithObject(e){const r=Ar.intersectPolygonPolygon(this.getCoords(),e.getCoords());return r.status==="Intersection"||r.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(r=>e.containsPoint(r))}isContainedWithinRect(e,r){const{left:n,top:s,width:i,height:a}=this.getBoundingRect();return n>=e.x&&n+i<=r.x&&s>=e.y&&s+a<=r.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Ar.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:r}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=r.x&&n.x>=e.x&&n.y<=r.y&&n.y>=e.y)||!!this.intersectsWithRect(e,r)||this.containsPoint(e.midPointFrom(r))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:r}=this.canvas.vptCoords;return this.intersectsWithRect(e,r)?!0:this.getCoords().every(n=>(n.x>=r.x||n.x<=e.x)&&(n.y>=r.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(r))}getBoundingRect(){return Oo(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Ls,e),this._set(Ci,e),this.setCoords()}scaleToWidth(e){const r=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/r)}scaleToHeight(e){const r=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/r)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Go(EO(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||us.concat()}calcACoords(){const e=yf({angle:this.angle}),{x:r,y:n}=this.getRelativeCenterPoint(),s=Qp(r,n),i=Tn(s,e),a=this._getTransformedDimensions(),l=a.x/2,c=a.y/2;return{tl:_s({x:-l,y:-c},i),tr:_s({x:l,y:-c},i),bl:_s({x:-l,y:c},i),br:_s({x:l,y:c},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=[];return!e&&this.group&&(r=this.group.transformMatrixKey(e)),r.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,nn(this.originX),nn(this.originY)),r}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=this.calcOwnMatrix();if(e||!this.group)return r;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,a)=>i===n[a])?s.value:(this.group&&(r=Tn(this.group.calcTransformMatrix(!1),r)),this.matrixCache={key:n,value:r},r)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),r=this.ownMatrixCache;if(r&&r.key===e)return r.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=gQ(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new Ne(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=pe({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=r.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const a=r.width+s,l=r.height+s;let c;return c=r.skewX===0&&r.skewY===0?new Ne(a*r.scaleX,l*r.scaleY):Oj(a,l,q1(r)),c.scalarAdd(i)}translateToGivenOrigin(e,r,n,s,i){let a=e.x,l=e.y;const c=nn(s)-nn(r),u=nn(i)-nn(n);if(c||u){const d=this._getTransformedDimensions();a+=c*d.x,l+=u*d.y}return new Ne(a,l)}translateToCenterPoint(e,r,n){if(r===Tt&&n===Tt)return e;const s=this.translateToGivenOrigin(e,r,n,Tt,Tt);return this.angle?s.rotate(Qr(this.angle),e):s}translateToOriginPoint(e,r,n){const s=this.translateToGivenOrigin(e,Tt,Tt,r,n);return this.angle?s.rotate(Qr(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?_s(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Ne(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,r){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,r)}setPositionByOrigin(e,r,n){const s=this.translateToCenterPoint(e,r,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),rr,Ps)}}const YQ=["type"],XQ=["extraParam"];let yo=class Cv extends GQ{static getDefaults(){return Cv.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){uc("warn","Setting type has no effect",e)}constructor(e){super(),ce(this,"_cacheContext",null),Object.assign(this,Cv.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Ho(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const r=e.width,n=e.height,s=Xt.maxCacheSideLimit,i=Xt.minCacheSideLimit;if(r<=s&&n<=s&&r*n<=Xt.perfLimitSizeTotal)return r<i&&(e.width=i),n<i&&(e.height=i),e;const a=r/n,[l,c]=Im.limitDimsByArea(a),u=Hh(i,l,s),d=Hh(i,c,s);return r>u&&(e.zoomX/=r/u,e.width=u,e.capped=!0),n>d&&(e.zoomY/=n/d,e.height=d,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),r=this._getTransformedDimensions({skewX:0,skewY:0}),n=r.x*e.x/this.scaleX,s=r.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,r=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:a,x:l,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),u=n!==e.width||s!==e.height,d=this.zoomX!==i||this.zoomY!==a;if(!e||!r)return!1;if(u||d){n!==e.width||s!==e.height?(e.width=n,e.height=s):(r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,e.width,e.height));const h=l/2,f=c/2;return this.cacheTranslationX=Math.round(e.width/2-h)+h,this.cacheTranslationY=Math.round(e.height/2-f)+f,r.translate(this.cacheTranslationX,this.cacheTranslationY),r.scale(i,a),this.zoomX=i,this.zoomY=a,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const r=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!r);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new Ne(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Px(this.calcTransformMatrix());return new Ne(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const r=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(r*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,r){e!==Ls&&e!==Ci||(r=this._constrainScale(r)),e===Ls&&r<0?(this.flipX=!this.flipX,r*=-1):e==="scaleY"&&r<0?(this.flipY=!this.flipY,r*=-1):e!=="shadow"||!r||r instanceof Wa||(r=new Wa(r));const n=this[e]!==r;return this[e]=r,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:r,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:a,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:r,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:a,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Ts&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,r,n){e.save(),r.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,r,n){const s=this.fill,i=this.stroke;r?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,r){const n=Ni(r),s=n.getContext("2d");if(s.translate(r.cacheTranslationX,r.cacheTranslationY),s.scale(r.zoomX,r.zoomY),e._cacheCanvas=n,r.parentClipPaths.forEach(i=>{i.transform(s)}),r.parentClipPaths.push(e),e.absolutePositioned){const i=ea(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,r),n}_drawClipPath(e,r,n){if(!r)return;r._transformDone=!0;const s=this.createClipPathLayer(r,n);this.drawClipPathOnCache(e,r,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const r=this._cacheCanvas,n=this._cacheContext;return!(!r||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(r&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.width,r.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const r=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,r){const n=r.stroke;n&&(e.lineWidth=r.strokeWidth,e.lineCap=r.strokeLineCap,e.lineDashOffset=r.strokeDashOffset,e.lineJoin=r.strokeLineJoin,e.miterLimit=r.strokeMiterLimit,yi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=r.stroke)}_setFillStyles(e,r){let{fill:n}=r;n&&(yi(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,r){r&&r.length!==0&&e.setLineDash(r)}_setShadow(e){if(!this.shadow)return;const r=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,a]=(n==null?void 0:n.viewportTransform)||us,l=i*s,c=a*s,u=r.nonScaling?new Ne(1,1):this.getObjectScaling();e.shadowColor=r.color,e.shadowBlur=r.blur*Xt.browserShadowBlurConstant*(l+c)*(u.x+u.y)/4,e.shadowOffsetX=r.offsetX*l*u.x,e.shadowOffsetY=r.offsetY*c*u.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,r){if(!yi(r))return{offsetX:0,offsetY:0};const n=r.gradientTransform||r.patternTransform,s=-this.width/2+r.offsetX||0,i=-this.height/2+r.offsetY||0;return r.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===Ts?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const r=this.getObjectScaling();e.scale(1/r.x,1/r.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,r){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),a=s.x/this.scaleX/i,l=s.y/this.scaleY/i,c=Ni({width:Math.ceil(a),height:Math.ceil(l)}),u=c.getContext("2d");u&&(u.beginPath(),u.moveTo(0,0),u.lineTo(a,0),u.lineTo(a,l),u.lineTo(0,l),u.closePath(),u.translate(a/2,l/2),u.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(u,r),u.fillStyle=r.toLive(e),u.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=u.createPattern(c,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new Ne(this.left+this.width/2,this.top+this.height/2)}clone(e){const r=this.toObject(e);return this.constructor.fromObject(r)}cloneAsImage(e){const r=this.toCanvasElement(e);return new(et.getClass("image"))(r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=FO(this),n=this.group,s=this.shadow,i=Math.abs,a=e.enableRetinaScaling?bO():1,l=(e.multiplier||1)*a,c=e.canvasProvider||(w=>new Lj(w,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&_Q(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&SQ(this,this.getViewportTransform()),this.setCoords();const u=Ho(),d=this.getBoundingRect(),h=this.shadow,f=new Ne;if(h){const w=h.blur,_=h.nonScaling?new Ne(1,1):this.getObjectScaling();f.x=2*Math.round(i(h.offsetX)+w)*i(_.x),f.y=2*Math.round(i(h.offsetY)+w)*i(_.y)}const m=d.width+f.x,p=d.height+f.y;u.width=Math.ceil(m),u.height=Math.ceil(p);const v=c(u);e.format==="jpeg"&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new Ne(v.width/2,v.height/2),Tt,Tt);const b=this.canvas;v._objects=[this],this.set("canvas",v),this.setCoords();const x=v.toCanvasElement(l||1,e);return this.set("canvas",b),this.shadow=s,n&&(this.group=n),this.set(r),this.setCoords(),v._objects=[],v.destroy(),x}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return NO(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return kO(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.includes(this.constructor.type)||r.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:r,originX:n,originY:s}=this;if(r){const{x:i,y:a}=this.getRelativeCenterPoint();this.originX=Tt,this.originY=Tt,this.left=i,this.top=a}if(this.set("angle",e),r){const{x:i,y:a}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=a,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Ex.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Ja().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,r){return Object.entries(e).reduce((n,s)=>{let[i,a]=s;return n[i]=this._animate(i,a,r),n},{})}_animate(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:a,startValue:l,onChange:c,onComplete:u}=n,d=pe(pe({},n),{},{target:this,startValue:l??s.reduce((h,f)=>h[f],this),endValue:r,abort:a==null?void 0:a.bind(this),onChange:(h,f,m)=>{s.reduce((p,v,b)=>(b===s.length-1&&(p[v]=h),p[v]),this),c&&c(h,f,m)},onComplete:(h,f,m)=>{this.setCoords(),u&&u(h,f,m)}});return i?HQ(d):KO(d)}isDescendantOf(e){const{parent:r,group:n}=this;return r===e||n===e||!!r&&r.isDescendantOf(e)||!!n&&n!==r&&n.isDescendantOf(e)}getAncestors(){const e=[];let r=this;do r=r.parent,r&&e.push(r);while(r);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const r=this.getAncestors(),n=e.getAncestors();if(r.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<r.length;i++){if(s=r[i],s===e)return{fork:[this,...r.slice(0,i)],otherFork:[],common:r.slice(i)};for(let a=0;a<n.length;a++){if(this===n[a])return{fork:[],otherFork:[e,...n.slice(0,a)],common:[this,...r]};if(s===n[a])return{fork:[this,...r.slice(0,i)],otherFork:[e,...n.slice(0,a)],common:r.slice(i)}}}return{fork:[this,...r],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const r=this.findCommonAncestors(e);return r&&!!r.common.length}isInFrontOf(e){if(this===e)return;const r=this.findCommonAncestors(e);if(r.fork.includes(e))return!0;if(r.otherFork.includes(this))return!1;const n=r.common[0]||this.canvas;if(!n)return;const s=r.fork.pop(),i=r.otherFork.pop(),a=n._objects.indexOf(s),l=n._objects.indexOf(i);return a>-1&&a>l}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Cv.customProperties,this.constructor.customProperties||[]);let r;const n=Xt.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:a,shadow:l,strokeDashArray:c,left:u,top:d,originX:h,originY:f,width:m,height:p,strokeWidth:v,strokeLineCap:b,strokeDashOffset:x,strokeLineJoin:w,strokeUniform:_,strokeMiterLimit:S,scaleX:N,scaleY:E,angle:P,flipX:A,flipY:F,opacity:Y,visible:T,backgroundColor:O,fillRule:U,paintFirst:q,globalCompositeOperation:Z,skewX:H,skewY:Q}=this;s&&!s.excludeFromExport&&(r=s.toObject(e.concat("inverted","absolutePositioned")));const R=X=>vr(X,n),B=pe(pe({},bf(this,e)),{},{type:this.constructor.type,version:Yw,originX:h,originY:f,left:R(u),top:R(d),width:R(m),height:R(p),fill:hk(i)?i.toObject():i,stroke:hk(a)?a.toObject():a,strokeWidth:R(v),strokeDashArray:c&&c.concat(),strokeLineCap:b,strokeDashOffset:x,strokeLineJoin:w,strokeUniform:_,strokeMiterLimit:R(S),scaleX:R(N),scaleY:R(E),angle:R(P),flipX:A,flipY:F,opacity:R(Y),shadow:l&&l.toObject(),visible:T,backgroundColor:O,fillRule:U,paintFirst:q,globalCompositeOperation:Z,skewX:R(H),skewY:R(Q)},r?{clipPath:r}:null);return this.includeDefaultValues?B:this._removeDefaultValues(B)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const r=this.constructor.getDefaults(),n=Object.keys(r).length>0?r:Object.getPrototypeOf(this);return Tj(e,(s,i)=>{if(i===rr||i===Ps||i==="type")return!0;const a=n[i];return s!==a&&!(Array.isArray(s)&&Array.isArray(a)&&s.length===0&&a.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let r=Er(e,YQ),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=Er(n,XQ);return U1(r,i).then(a=>s?(delete a[s],new this(r[s],a)):new this(a))}static fromObject(e,r){return this._fromObject(e,r)}};ce(yo,"stateProperties",RQ),ce(yo,"cacheProperties",Qo),ce(yo,"ownDefaults",DQ),ce(yo,"type","FabricObject"),ce(yo,"colorProperties",[mn,Ts,"backgroundColor"]),ce(yo,"customProperties",[]),et.setClass(yo),et.setClass(yo,"object");const wf=(t,e,r)=>(n,s,i,a)=>{const l=e(n,s,i,a);return l&&IO(t,pe(pe({},$O(n,s,i,a)),r)),l};function _f(t){return(e,r,n,s)=>{const{target:i,originX:a,originY:l}=r,c=i.getRelativeCenterPoint(),u=i.translateToOriginPoint(c,a,l),d=t(e,r,n,s);return i.setPositionByOrigin(u,r.originX,r.originY),d}}const Ek=wf(vp,_f((t,e,r,n)=>{const s=Mj(e,e.originX,e.originY,r,n);if(nn(e.originX)===nn(Tt)||nn(e.originX)===nn(Hr)&&s.x<0||nn(e.originX)===nn(rr)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),l=zO(e)?2:1,c=i.width,u=Math.abs(s.x*l/i.scaleX)-a;return i.set("width",Math.max(u,1)),c!==i.width}return!1}));function KQ(t,e,r,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,l=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,c=l?Ts:mn,u=!l&&(n.cornerStrokeColor||s.cornerStrokeColor);let d,h=e,f=r;t.save(),t.fillStyle=n.cornerColor||s.cornerColor||"",t.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>a?(d=i,t.scale(1,a/i),f=r*i/a):a>i?(d=a,t.scale(i/a,1),h=e*a/i):d=i,t.beginPath(),t.arc(h,f,d/2,0,Cx,!1),t[c](),u&&t.stroke(),t.restore()}function QQ(t,e,r,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,l=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,c=l?Ts:mn,u=!l&&(n.cornerStrokeColor||s.cornerStrokeColor),d=i/2,h=a/2;t.save(),t.fillStyle=n.cornerColor||s.cornerColor||"",t.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",t.translate(e,r);const f=s.getTotalAngle();t.rotate(Qr(f)),t["".concat(c,"Rect")](-d,-h,i,a),u&&t.strokeRect(-d,-h,i,a),t.restore()}class Vi{constructor(e){ce(this,"visible",!0),ce(this,"actionName",B1),ce(this,"angle",0),ce(this,"x",0),ce(this,"y",0),ce(this,"offsetX",0),ce(this,"offsetY",0),ce(this,"sizeX",0),ce(this,"sizeY",0),ce(this,"touchSizeX",0),ce(this,"touchSizeY",0),ce(this,"cursorStyle","crosshair"),ce(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,r,n,s){var i;let{tl:a,tr:l,br:c,bl:u}=s;return((i=r.canvas)===null||i===void 0?void 0:i.getActiveObject())===r&&r.isControlVisible(e)&&Ar.isPointInPolygon(n,[a,l,c,u])}getActionHandler(e,r,n){return this.actionHandler}getMouseDownHandler(e,r,n){return this.mouseDownHandler}getMouseUpHandler(e,r,n){return this.mouseUpHandler}cursorStyleHandler(e,r,n){return r.cursorStyle}getActionName(e,r,n){return r.actionName}getVisibility(e,r){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[r])!==null&&n!==void 0?n:this.visible}setVisibility(e,r,n){this.visible=e}positionHandler(e,r,n,s){return new Ne(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(r)}calcCornerCoords(e,r,n,s,i,a){const l=Pj([Qp(n,s),yf({angle:e}),Aj((i?this.touchSizeX:this.sizeX)||r,(i?this.touchSizeY:this.sizeY)||r)]);return{tl:new Ne(-.5,-.5).transform(l),tr:new Ne(.5,-.5).transform(l),br:new Ne(.5,.5).transform(l),bl:new Ne(-.5,.5).transform(l)}}render(e,r,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?KQ.call(this,e,r,n,s,i):QQ.call(this,e,r,n,s,i)}}const JQ=(t,e,r)=>r.lockRotation?Tx:e.cursorStyle,ZQ=wf(_O,_f((t,e,r,n)=>{let{target:s,ex:i,ey:a,theta:l,originX:c,originY:u}=e;const d=s.translateToOriginPoint(s.getRelativeCenterPoint(),c,u);if(sa(s,"lockRotation"))return!1;const h=Math.atan2(a-d.y,i-d.x),f=Math.atan2(n-d.y,r-d.x);let m=Go(f-h+l);if(s.snapAngle&&s.snapAngle>0){const v=s.snapAngle,b=s.snapThreshold||v,x=Math.ceil(m/v)*v,w=Math.floor(m/v)*v;Math.abs(m-w)<b?m=w:Math.abs(m-x)<b&&(m=x)}m<0&&(m=360+m),m%=360;const p=s.angle!==m;return s.angle=m,p}));function QO(t,e){const r=e.canvas,n=t[r.uniScaleKey];return r.uniformScaling&&!n||!r.uniformScaling&&n}function JO(t,e,r){const n=sa(t,"lockScalingX"),s=sa(t,"lockScalingY");if(n&&s||!e&&(n||s)&&r||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:a,strokeWidth:l}=t;return i===0&&l===0&&e!=="y"||a===0&&l===0&&e!=="x"}const eJ=["e","se","s","sw","w","nw","n","ne","e"],_m=(t,e,r)=>{const n=QO(t,r);if(JO(r,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Tx;const s=BO(r,e);return"".concat(eJ[s],"-resize")};function Fj(t,e,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,a=s.by,l=QO(t,i);let c,u,d,h,f,m;if(JO(i,a,l))return!1;if(e.gestureScale)u=e.scaleX*e.gestureScale,d=e.scaleY*e.gestureScale;else{if(c=Mj(e,e.originX,e.originY,r,n),f=a!=="y"?Math.sign(c.x||e.signX||1):1,m=a!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=f),e.signY||(e.signY=m),sa(i,"lockScalingFlip")&&(e.signX!==f||e.signY!==m))return!1;if(h=i._getTransformedDimensions(),l&&!a){const b=Math.abs(c.x)+Math.abs(c.y),{original:x}=e,w=b/(Math.abs(h.x*x.scaleX/i.scaleX)+Math.abs(h.y*x.scaleY/i.scaleY));u=x.scaleX*w,d=x.scaleY*w}else u=Math.abs(c.x*i.scaleX/h.x),d=Math.abs(c.y*i.scaleY/h.y);zO(e)&&(u*=2,d*=2),e.signX!==f&&a!=="y"&&(e.originX=gk(e.originX),u*=-1,e.signX=f),e.signY!==m&&a!=="x"&&(e.originY=gk(e.originY),d*=-1,e.signY=m)}const p=i.scaleX,v=i.scaleY;return a?(a==="x"&&i.set(Ls,u),a==="y"&&i.set(Ci,d)):(!sa(i,"lockScalingX")&&i.set(Ls,u),!sa(i,"lockScalingY")&&i.set(Ci,d)),p!==i.scaleX||v!==i.scaleY}const C0=wf($1,_f((t,e,r,n)=>Fj(t,e,r,n))),tJ=wf($1,_f((t,e,r,n)=>Fj(t,e,r,n,{by:"x"}))),rJ=wf($1,_f((t,e,r,n)=>Fj(t,e,r,n,{by:"y"}))),nJ=["target","ex","ey","skewingSide"],H2={x:{counterAxis:"y",scale:Ls,skew:vf,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Ci,skew:xf,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},sJ=["ns","nesw","ew","nwse"],iJ=(t,e,r)=>{if(e.x!==0&&sa(r,"lockSkewingY")||e.y!==0&&sa(r,"lockSkewingX"))return Tx;const n=BO(r,e)%4;return"".concat(sJ[n],"-resize")};function ZO(t,e,r,n,s){const{target:i}=r,{counterAxis:a,origin:l,lockSkewing:c,skew:u,flip:d}=H2[t];if(sa(i,c))return!1;const{origin:h,flip:f}=H2[a],m=nn(r[h])*(i[f]?-1:1),p=-Math.sign(m)*(i[d]?-1:1),v=.5*-((i[u]===0&&Mj(r,Tt,Tt,n,s)[t]>0||i[u]>0?1:-1)*p)+.5;return wf(jO,_f((x,w,_,S)=>function(N,E,P){let{target:A,ex:F,ey:Y,skewingSide:T}=E,O=Er(E,nJ);const{skew:U}=H2[N],q=P.subtract(new Ne(F,Y)).divide(new Ne(A.scaleX,A.scaleY))[N],Z=A[U],H=O[U],Q=Math.tan(Qr(H)),R=N==="y"?A._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:A._getTransformedDimensions({scaleX:1,scaleY:1}).y,B=2*q*T/Math.max(R,1)+Q,X=Go(Math.atan(B));A.set(U,X);const ie=Z!==A[U];if(ie&&N==="y"){const{skewX:M,scaleX:W}=A,K=A._getTransformedDimensions({skewY:Z}),ne=A._getTransformedDimensions(),se=M!==0?K.x/ne.x:1;se!==1&&A.set(Ls,se*W)}return ie}(t,w,new Ne(_,S))))(e,pe(pe({},r),{},{[l]:v,skewingSide:p}),n,s)}const aJ=(t,e,r,n)=>ZO("x",t,e,r,n),oJ=(t,e,r,n)=>ZO("y",t,e,r,n);function H1(t,e){return t[e.canvas.altActionKey]}const N0=(t,e,r)=>{const n=H1(t,r);return e.x===0?n?vf:Ci:e.y===0?n?xf:Ls:""},Vd=(t,e,r)=>H1(t,r)?iJ(0,e,r):_m(t,e,r),Pk=(t,e,r,n)=>H1(t,e.target)?oJ(t,e,r,n):tJ(t,e,r,n),Ak=(t,e,r,n)=>H1(t,e.target)?aJ(t,e,r,n):rJ(t,e,r,n),eM=()=>({ml:new Vi({x:-.5,y:0,cursorStyleHandler:Vd,actionHandler:Pk,getActionName:N0}),mr:new Vi({x:.5,y:0,cursorStyleHandler:Vd,actionHandler:Pk,getActionName:N0}),mb:new Vi({x:0,y:.5,cursorStyleHandler:Vd,actionHandler:Ak,getActionName:N0}),mt:new Vi({x:0,y:-.5,cursorStyleHandler:Vd,actionHandler:Ak,getActionName:N0}),tl:new Vi({x:-.5,y:-.5,cursorStyleHandler:_m,actionHandler:C0}),tr:new Vi({x:.5,y:-.5,cursorStyleHandler:_m,actionHandler:C0}),bl:new Vi({x:-.5,y:.5,cursorStyleHandler:_m,actionHandler:C0}),br:new Vi({x:.5,y:.5,cursorStyleHandler:_m,actionHandler:C0}),mtr:new Vi({x:0,y:-.5,actionHandler:ZQ,cursorStyleHandler:JQ,offsetY:-40,withConnection:!0,actionName:kj})}),lJ=()=>({mr:new Vi({x:.5,y:0,actionHandler:Ek,cursorStyleHandler:Vd,actionName:vp}),ml:new Vi({x:-.5,y:0,actionHandler:Ek,cursorStyleHandler:Vd,actionName:vp})}),cJ=()=>pe(pe({},eM()),lJ());class wp extends yo{static getDefaults(){return pe(pe({},super.getDefaults()),wp.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),wp.ownDefaults),this.setOptions(e)}static createControls(){return{controls:eM()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const r=e._currentTransform,n=r.target,s=r.action;if(this===n&&s&&s.startsWith(B1))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,a]=n[s],l=this.controls[i];if(l.shouldActivate(i,this,e,r?a.touchCorner:a.corner))return this.__corner=i,{key:i,control:l,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),r=this.getCenterPoint(),n=Qp(r.x,r.y),s=yf({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=Tn(n,s),a=Tn(e,i),l=Tn(a,[1/e[0],0,0,1/e[3],0,0]),c=this.group?Px(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));const u=this._calculateCurrentDimensions(c),d={};return this.forEachControl((h,f)=>{const m=h.positionHandler(u,l,this,h);d[f]=Object.assign(m,this._calcCornerCoords(h,m))}),d}_calcCornerCoords(e,r){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,r.x,r.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,r.x,r.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const r in this.controls)e(this.controls[r],r,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const r=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(r.x,r.y),e.scale(1/s[0],1/s[3]),e.rotate(Qr(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,r){e.strokeRect(-r.x/2,-r.y/2,r.x,r.y)}_drawBorders(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=pe({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,r),s.hasControls&&this.drawControlsConnectingLines(e,r),e.restore()}_renderControls(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=pe({hasBorders:n,hasControls:s},r),a=this.getViewportTransform(),l=i.hasBorders,c=i.hasControls,u=Tn(a,this.calcTransformMatrix()),d=Px(u);e.save(),e.translate(d.translateX,d.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),e.rotate(Qr(this.group?d.angle:this.angle)),l&&this.drawBorders(e,d,r),c&&this.drawControls(e,r),e.restore()}drawBorders(e,r,n){let s;if(n&&n.forActiveSelection||this.group){const i=Oj(this.width,this.height,q1(r)),a=this.isStrokeAccountedForInDimensions()?Ej:(this.strokeUniform?new Ne().scalarAdd(this.canvas?this.canvas.getZoom():1):new Ne(r.scaleX,r.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(a).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,r){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*r.x,s.y*r.y),e.lineTo(s.x*r.x+s.offsetX,s.y*r.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:a}=this,l=pe({cornerStrokeColor:s,cornerDashArray:i,cornerColor:a},r);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=l.cornerColor,this.transparentCorners||(e.strokeStyle=l.cornerStrokeColor),this._setLineDash(e,l.cornerDashArray),this.forEachControl((c,u)=>{if(c.getVisibility(this,u)){const d=this.oCoords[u];c.render(e,d.x,d.y,l,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,r){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=r}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(r=>{let[n,s]=r;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const r=this.canvas.contextTop;if(!r)return;const n=this.canvas.viewportTransform;r.save(),r.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(r);const s=this.width+4,i=this.height+4;return r.clearRect(-s/2,-i/2,s,i),e||r.restore(),r}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function tM(t,e){return e.forEach(r=>{Object.getOwnPropertyNames(r.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))})}),t}ce(wp,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Xn extends wp{}tM(Xn,[qO]),et.setClass(Xn),et.setClass(Xn,"object");const uJ=(t,e,r,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=t.getImageData(e-n,r-n,s,s);for(let a=3;a<i.length;a+=4)if(i[a]>0)return!1;return!0};class rM{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Ne(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Ne(1/this.options.scaleX,1/this.options.scaleY):new Ne(1,1)}createSideVector(e,r){const n=Jw(e,r);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,r,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,r,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const r=new Ne(e);return r.y+=r.x*Math.tan(Qr(this.options.skewY)),r.x+=r.y*Math.tan(Qr(this.options.skewX)),r}scaleUnitVector(e,r){return e.multiply(this.strokeUniformScalar).scalarMultiply(r)}}const dJ=new Ne;class dh extends rM{static getOrthogonalRotationFactor(e,r){const n=r?e5(e,r):OQ(e);return Math.abs(n)<Kp?-1:1}constructor(e,r,n,s){super(s),ce(this,"AB",void 0),ce(this,"AC",void 0),ce(this,"alpha",void 0),ce(this,"bisector",void 0),this.A=new Ne(e),this.B=new Ne(r),this.C=new Ne(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=e5(this.AB,this.AC),this.bisector=Rj(YO(this.AB.eq(dJ)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,r),i=XO(s),a=dh.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*a)}projectBevel(){const e=[];return(this.alpha%Cx==0?[this.B]:[this.B,this.C]).forEach(r=>{e.push(this.projectOrthogonally(this.A,r)),e.push(this.projectOrthogonally(this.A,r,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],r=Math.abs(this.alpha),n=1/Math.sin(r/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?Zw(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Zw(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,r){const n=[],s=new Ne(dh.getOrthogonalRotationFactor(this.bisector),dh.getOrthogonalRotationFactor(new Ne(this.bisector.y,this.bisector.x)));return[new Ne(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new Ne(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{Ck(i,e,r)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,r){const n=[],{skewX:s,skewY:i,scaleX:a,scaleY:l,strokeUniform:c}=this.options,u=new Ne(Math.tan(Qr(s)),Math.tan(Qr(i))),d=this.strokeProjectionMagnitude,h=c?d/l/Math.sqrt(1/l**2+1/a**2*u.y**2):d/Math.sqrt(1+u.y**2),f=new Ne(Math.sqrt(Math.max(d**2-h**2,0)),h),m=c?d/Math.sqrt(1+u.x**2*(1/l)**2/(1/a+1/a*u.x*u.y)**2):d/Math.sqrt(1+u.x**2/(1+u.x*u.y)**2),p=new Ne(m,Math.sqrt(Math.max(d**2-m**2,0)));return[p,p.scalarMultiply(-1),f,f.scalarMultiply(-1)].map(v=>this.applySkew(c?v.multiply(this.strokeUniformScalar):v)).forEach(v=>{Ck(v,e,r)&&n.push(this.applySkew(this.A).add(v))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const r=this.alpha%Cx==0,n=this.applySkew(this.A),s=e[r?0:2].subtract(n),i=e[r?1:0].subtract(n),a=r?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=Bm(s,a)>0,c=l?s:i,u=l?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,u)):e.push(...this.projectRoundNoSkew(c,u)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Tk extends rM{constructor(e,r,n){super(n),this.A=new Ne(e),this.T=new Ne(r)}calcOrthogonalProjection(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,r);return this.scaleUnitVector(XO(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const r=new Ne(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(r)),this.applySkew(this.A.subtract(r)))}else e.push(...new dh(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const r=new Ne(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(r),this.A.subtract(r))}else{const r=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(Rj(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(r),s.subtract(r))}return e.map(r=>this.applySkew(r))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const hJ=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(t.length===0)return n;const s=t.reduce((i,a)=>(i[i.length-1].eq(a)||i.push(new Ne(a)),i),[new Ne(t[0])]);if(s.length===1)r=!0;else if(!r){const i=s[0],a=((l,c)=>{for(let u=l.length-1;u>=0;u--)if(c(l[u],u,l))return u;return-1})(s,l=>!l.eq(i));s.splice(a+1)}return s.forEach((i,a,l)=>{let c,u;a===0?(u=l[1],c=r?i:l[l.length-1]):a===l.length-1?(c=l[a-1],u=r?i:l[0]):(c=l[a-1],u=l[a+1]),r&&l.length===1?n.push(...new Tk(i,i,e).project()):!r||a!==0&&a!==l.length-1?n.push(...new dh(i,c,u,e).project()):n.push(...new Tk(i,a===0?u:c,e).project())}),n},Ij=t=>{const e={};return Object.keys(t).forEach(r=>{e[r]={},Object.keys(t[r]).forEach(n=>{e[r][n]=pe({},t[r][n])})}),e},fJ=t=>t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let dm;const zj=t=>{if(dm||dm||(dm="Intl"in z1()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),dm){const e=dm.segment(t);return Array.from(e).map(r=>{let{segment:n}=r;return n})}return mJ(t)},mJ=t=>{const e=[];for(let r,n=0;n<t.length;n++)(r=pJ(t,n))!==!1&&e.push(r);return e},pJ=(t,e)=>{const r=t.charCodeAt(e);if(isNaN(r))return"";if(r<55296||r>57343)return t.charAt(e);if(55296<=r&&r<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";const s=t.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=t.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},$j=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.textDecorationThickness!==e.textDecorationThickness||t.textBackgroundColor!==e.textBackgroundColor||t.deltaY!==e.deltaY||r&&(t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough)},gJ=(t,e)=>{const r=e.split(`
`),n=[];let s=-1,i={};t=Ij(t);for(let a=0;a<r.length;a++){const l=zj(r[a]);if(t[a])for(let c=0;c<l.length;c++){s++;const u=t[a][c];u&&Object.keys(u).length>0&&($j(i,u,!0)?n.push({start:s,end:s+1,style:u}):n[n.length-1].end++),i=u||{}}else s+=l.length,i={}}return n},vJ=(t,e)=>{if(!Array.isArray(t))return Ij(t);const r=e.split(Nj),n={};let s=-1,i=0;for(let a=0;a<r.length;a++){const l=zj(r[a]);for(let c=0;c<l.length;c++)s++,t[i]&&t[i].start<=s&&s<t[i].end&&(n[a]=n[a]||{},n[a][c]=pe({},t[i].style),s===t[i].end-1&&i++)}return n},jc=["display","transform",mn,"fill-opacity","fill-rule","opacity",Ts,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Lk(t,e){const r=t.nodeName,n=t.getAttribute("class"),s=t.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let a;if(a=new RegExp("^"+r,"i"),e=e.replace(a,""),s&&e.length&&(a=new RegExp("#"+s+i,"i"),e=e.replace(a,"")),n&&e.length){const l=n.split(" ");for(let c=l.length;c--;)a=new RegExp("\\."+l[c]+i,"i"),e=e.replace(a,"")}return e.length===0}function xJ(t,e){let r=!0;const n=Lk(t,e.pop());return n&&e.length&&(r=function(s,i){let a,l=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)l&&(a=i.pop()),l=Lk(s=s.parentElement,a);return i.length===0}(t,e)),n&&r&&e.length===0}const yJ=t=>{var e;return(e=TQ[t])!==null&&e!==void 0?e:t},bJ=new RegExp("(".concat(ta,")"),"gi"),wJ=t=>t.replace(bJ," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Ok,Mk,Rk,Dk,Fk,Ik,zk;const is="(".concat(ta,")"),_J=String.raw(Ok||(Ok=ro(["(skewX)(",")"],["(skewX)\\(","\\)"])),is),jJ=String.raw(Mk||(Mk=ro(["(skewY)(",")"],["(skewY)\\(","\\)"])),is),SJ=String.raw(Rk||(Rk=ro(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),is,is,is),CJ=String.raw(Dk||(Dk=ro(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),is,is),NJ=String.raw(Fk||(Fk=ro(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),is,is),kJ=String.raw(Ik||(Ik=ro(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),is,is,is,is,is,is),Bj="(?:".concat(kJ,"|").concat(NJ,"|").concat(SJ,"|").concat(CJ,"|").concat(_J,"|").concat(jJ,")"),EJ="(?:".concat(Bj,"*)"),PJ=String.raw(zk||(zk=ro(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),EJ),AJ=new RegExp(PJ),TJ=new RegExp(Bj),LJ=new RegExp(Bj,"g");function t5(t){const e=[];if(!(t=wJ(t).replace(/\s*([()])\s*/gi,"$1"))||t&&!AJ.test(t))return[...us];for(const r of t.matchAll(LJ)){const n=TJ.exec(r[0]);if(!n)continue;let s=us;const i=n.filter(p=>!!p),[,a,...l]=i,[c,u,d,h,f,m]=l.map(p=>parseFloat(p));switch(a){case"translate":s=Qp(c,u);break;case kj:s=yf({angle:c},{x:u,y:d});break;case B1:s=Aj(c,u);break;case vf:s=AO(c);break;case xf:s=TO(c);break;case"matrix":s=[c,u,d,h,f,m]}e.push(s)}return Pj(e)}function OJ(t,e,r,n){const s=Array.isArray(e);let i,a=e;if(t!==mn&&t!==Ts||e!==As){if(t==="strokeUniform")return e==="non-scaling-stroke";if(t==="strokeDashArray")a=e===As?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(t==="transformMatrix")a=r&&r.transformMatrix?Tn(r.transformMatrix,t5(e)):t5(e);else if(t==="visible")a=e!==As&&e!=="hidden",r&&r.visible===!1&&(a=!1);else if(t==="opacity")a=parseFloat(e),r&&r.opacity!==void 0&&(a*=r.opacity);else if(t==="textAnchor")a=e==="start"?rr:e==="end"?Hr:Tt;else if(t==="charSpacing"||t===Nu)i=uh(e,n)/n*1e3;else if(t==="paintFirst"){const l=e.indexOf(mn),c=e.indexOf(Ts);a=mn,(l>-1&&c>-1&&c<l||l===-1&&c>-1)&&(a=Ts)}else{if(t==="href"||t==="xlink:href"||t==="font"||t==="id")return e;if(t==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(uh):uh(e,n)}}else a="";return!s&&isNaN(i)?a:i}function MJ(t,e){const r=t.match(AQ);if(!r)return;const n=r[1],s=r[3],i=r[4],a=r[5],l=r[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=uh(i)),l&&(e.fontFamily=l),a&&(e.lineHeight=a==="normal"?1:a)}function RJ(t,e){t.replace(/;\s*$/,"").split(";").forEach(r=>{if(!r)return;const[n,s]=r.split(":");e[n.trim().toLowerCase()]=s.trim()})}function DJ(t){const e={},r=t.getAttribute("style");return r&&(typeof r=="string"?RJ(r,e):function(n,s){Object.entries(n).forEach(i=>{let[a,l]=i;l!==void 0&&(s[a.toLowerCase()]=l)})}(r,e)),e}const FJ={stroke:"strokeOpacity",fill:"fillOpacity"};function Jo(t,e,r){if(!t)return{};let n,s={},i=Cj;t.parentNode&&Sk.test(t.parentNode.nodeName)&&(s=Jo(t.parentElement,e,r),s.fontSize&&(n=i=uh(s.fontSize)));const a=pe(pe(pe({},e.reduce((u,d)=>{const h=t.getAttribute(d);return h&&(u[d]=h),u},{})),function(u){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h={};for(const f in d)xJ(u,f.split(" "))&&(h=pe(pe({},h),d[f]));return h}(t,r)),DJ(t));a[V2]&&t.setAttribute(V2,a[V2]),a[U2]&&(n=uh(a[U2],i),a[U2]="".concat(n));const l={};for(const u in a){const d=yJ(u),h=OJ(d,a[u],s,n);l[d]=h}l&&l.font&&MJ(l.font,l);const c=pe(pe({},s),l);return Sk.test(t.nodeName)?c:function(u){const d=Xn.getDefaults();return Object.entries(FJ).forEach(h=>{let[f,m]=h;if(u[m]===void 0||u[f]==="")return;if(u[f]===void 0){if(!d[f])return;u[f]=d[f]}if(u[f].indexOf("url(")===0)return;const p=new Os(u[f]);u[f]=p.setAlpha(vr(p.getAlpha()*u[m],2)).toRgba()}),u}(c)}const IJ=["left","top","width","height","visible"],nM=["rx","ry"];class xi extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),xi.ownDefaults)}constructor(e){super(),Object.assign(this,xi.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:r}=this;e&&!r?this.ry=e:r&&!e&&(this.rx=r)}_render(e){const{width:r,height:n}=this,s=-r/2,i=-n/2,a=this.rx?Math.min(this.rx,r/2):0,l=this.ry?Math.min(this.ry,n/2):0,c=a!==0||l!==0;e.beginPath(),e.moveTo(s+a,i),e.lineTo(s+r-a,i),c&&e.bezierCurveTo(s+r-vl*a,i,s+r,i+vl*l,s+r,i+l),e.lineTo(s+r,i+n-l),c&&e.bezierCurveTo(s+r,i+n-vl*l,s+r-vl*a,i+n,s+r-a,i+n),e.lineTo(s+a,i+n),c&&e.bezierCurveTo(s+vl*a,i+n,s,i+n-vl*l,s,i+n-l),e.lineTo(s,i+l),c&&e.bezierCurveTo(s,i+vl*l,s+vl*a,i,s+a,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...nM,...e])}_toSVG(){const{width:e,height:r,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-r/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(r,`" />
`)]}static async fromElement(e,r,n){const s=Jo(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,width:l=0,height:c=0,visible:u=!0}=s,d=Er(s,IJ);return new this(pe(pe(pe({},r),d),{},{left:i,top:a,width:l,height:c,visible:!!(u&&l&&c)}))}}ce(xi,"type","Rect"),ce(xi,"cacheProperties",[...Qo,...nM]),ce(xi,"ownDefaults",{rx:0,ry:0}),ce(xi,"ATTRIBUTE_NAMES",[...jc,"x","y","rx","ry","width","height"]),et.setClass(xi),et.setSVGClass(xi);const Eo="initialization",Ox="added",qj="removed",Mx="imperative",sM=(t,e)=>{const{strokeUniform:r,strokeWidth:n,width:s,height:i,group:a}=e,l=a&&a!==t?V1(a.calcTransformMatrix(),t.calcTransformMatrix()):null,c=l?e.getRelativeCenterPoint().transform(l):e.getRelativeCenterPoint(),u=!e.isStrokeAccountedForInDimensions(),d=r&&u?jQ(new Ne(n,n),void 0,t.calcTransformMatrix()):Ej,h=!r&&u?n:0,f=Oj(s+h,i+h,Pj([l,e.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[c.subtract(f),c.add(f)]};class G1{calcLayoutResult(e,r){if(this.shouldPerformLayout(e))return this.calcBoundingBox(r,e)}shouldPerformLayout(e){let{type:r,prevStrategy:n,strategy:s}=e;return r===Eo||r===Mx||!!n&&s!==n}shouldLayoutClipPath(e){let{type:r,target:{clipPath:n}}=e;return r!==Eo&&n&&!n.absolutePositioned}getInitialSize(e,r){return r.size}calcBoundingBox(e,r){const{type:n,target:s}=r;if(n===Mx&&r.overrides)return r.overrides;if(e.length===0)return;const{left:i,top:a,width:l,height:c}=Oo(e.map(h=>sM(s,h)).reduce((h,f)=>h.concat(f),[])),u=new Ne(l,c),d=new Ne(i,a).add(u.scalarDivide(2));if(n===Eo){const h=this.getInitialSize(r,{size:u,center:d});return{center:d,relativeCorrection:new Ne(0,0),size:h}}return{center:d.transform(s.calcOwnMatrix()),size:u}}}ce(G1,"type","strategy");class r5 extends G1{shouldPerformLayout(e){return!0}}ce(r5,"type","fit-content"),et.setClass(r5);const zJ=["strategy"],$J=["target","strategy","bubbles","prevStrategy"],iM="layoutManager";class _p{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new r5;ce(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const r=pe(pe({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(r);const n=this.getLayoutResult(r);n&&this.commitLayout(r,n),this.onAfterLayout(r,n),this._prevLayoutStrategy=r.strategy}attachHandlers(e,r){const{target:n}=r;return[kx,wO,vp,_O,$1,jO,Nx,cQ,uQ].map(s=>e.on(s,i=>this.performLayout(s===kx?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,r){this.unsubscribe(e,r);const n=this.attachHandlers(e,r);this._subscriptions.set(e,n)}unsubscribe(e,r){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(r=>this.unsubscribe(r,e))}subscribeTargets(e){e.targets.forEach(r=>this.subscribe(r,e))}onBeforeLayout(e){const{target:r,type:n}=e,{canvas:s}=r;if(n===Eo||n===Ox?this.subscribeTargets(e):n===qj&&this.unsubscribeTargets(e),r.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:r,context:e}),n===Mx&&e.deep){const i=Er(e,zJ);r.forEachObject(a=>a.layoutManager&&a.layoutManager.performLayout(pe(pe({},i),{},{bubbles:!1,target:a})))}}getLayoutResult(e){const{target:r,strategy:n,type:s}=e,i=n.calcLayoutResult(e,r.getObjects());if(!i)return;const a=s===Eo?new Ne:r.getRelativeCenterPoint(),{center:l,correction:c=new Ne,relativeCorrection:u=new Ne}=i,d=a.subtract(l).add(c).transform(s===Eo?us:ea(r.calcOwnMatrix()),!0).add(u);return{result:i,prevCenter:a,nextCenter:l,offset:d}}commitLayout(e,r){const{target:n}=e,{result:{size:s},nextCenter:i}=r;var a,l;n.set({width:s.x,height:s.y}),this.layoutObjects(e,r),e.type===Eo?n.set({left:(a=e.x)!==null&&a!==void 0?a:i.x+s.x*nn(n.originX),top:(l=e.y)!==null&&l!==void 0?l:i.y+s.y*nn(n.originY)}):(n.setPositionByOrigin(i,Tt,Tt),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,r){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,r,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,r,n.clipPath)}layoutObject(e,r,n){let{offset:s}=r;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,r){const{target:n,strategy:s,bubbles:i,prevStrategy:a}=e,l=Er(e,$J),{canvas:c}=n;n.fire("layout:after",{context:e,result:r}),c&&c.fire("object:layout:after",{context:e,result:r,target:n});const u=n.parent;i&&u!=null&&u.layoutManager&&((l.path||(l.path=[])).push(n),u.layoutManager.performLayout(pe(pe({},l),{},{target:u}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(r=>r.forEach(n=>n())),e.clear()}toObject(){return{type:iM,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}et.setClass(_p,iM);const BJ=["type","objects","layoutManager"];class qJ extends _p{performLayout(){}}class du extends SO(Xn){static getDefaults(){return pe(pe({},super.getDefaults()),du.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),ce(this,"_activeObjects",[]),ce(this,"__objectSelectionTracker",void 0),ce(this,"__objectSelectionDisposer",void 0),Object.assign(this,du.ownDefaults),this.setOptions(r),this.groupInit(e,r)}groupInit(e,r){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=r.layoutManager)!==null&&n!==void 0?n:new _p,this.layoutManager.performLayout({type:Eo,target:this,targets:[...e],x:r.left,y:r.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(uc("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(uc("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((r,n,s)=>this.canEnterGroup(r)&&s.indexOf(r)===n)}add(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(r),i=super.add(...s);return this._onAfterObjectsChange(Ox,s),i}insertAt(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),a=super.insertAt(e,...i);return this._onAfterObjectsChange(Ox,i),a}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(qj,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,r){this.exitGroup(e,r),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,r){this.layoutManager.performLayout({type:e,targets:r,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,r){const n=this[e];return super._set(e,r),e==="canvas"&&n!==r&&(this._objects||[]).forEach(s=>{s._set(e,r)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,r){let{target:n}=r;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,r){e&&this._watchObject(!1,r),e?(r.on("selected",this.__objectSelectionTracker),r.on("deselected",this.__objectSelectionDisposer)):(r.off("selected",this.__objectSelectionTracker),r.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,r){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,r)}_enterGroup(e,r){r&&Ax(e,Tn(ea(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,r){this._exitGroup(e,r),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,r){e._set("group",void 0),r||(Ax(e,Tn(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Xn.prototype.shouldCache.call(this);if(e){for(let r=0;r<this._objects.length;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,r,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const a=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&a.group!==this?(e.save(),e.transform(...ea(this.calcTransformMatrix())),a.render(e),e.restore()):a.group===this&&a.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(pe({target:this,type:Mx},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,r){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const a=s[e||"toObject"](r);return s.includeDefaultValues=i,a})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=this.layoutManager.toObject();return pe(pe(pe({},super.toObject(["subTargetCheck","interactive",...e])),r.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:r}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const r=xi.prototype._toSVG.call(this),n=r.indexOf("COMMON_PARTS");r[n]='for="group" ';const s=r.join("");return e?e(s):s}_toSVG(e){const r=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&r.push("		",n);for(let s=0;s<this._objects.length;s++)r.push("		",this._objects[s].toSVG(e));return r.push(`</g>
`),r}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",r=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),r].join("")}toClipPathSVG(e){const r=[],n=this._createSVGBgRect(e);n&&r.push("	",n);for(let s=0;s<this._objects.length;s++)r.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(r,{reviver:e})}static fromObject(e,r){let{type:n,objects:s=[],layoutManager:i}=e,a=Er(e,BJ);return Promise.all([xp(s,r),U1(a,r)]).then(l=>{let[c,u]=l;const d=new this(c,pe(pe(pe({},a),u),{},{layoutManager:new qJ}));if(i){const h=et.getClass(i.type),f=et.getClass(i.strategy);d.layoutManager=new h(new f)}else d.layoutManager=new _p;return d.layoutManager.subscribeTargets({type:Eo,target:d,targets:d.getObjects()}),d.setCoords(),d})}}ce(du,"type","Group"),ce(du,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),et.setClass(du);const UJ=(t,e)=>Math.min(e.width/t.width,e.height/t.height),VJ=(t,e)=>Math.max(e.width/t.width,e.height/t.height),n5="\\s*,?\\s*",hm="".concat(n5,"(").concat(ta,")"),WJ="".concat(hm).concat(hm).concat(hm).concat(n5,"([01])").concat(n5,"([01])").concat(hm).concat(hm),HJ={m:"l",M:"L"},GJ=(t,e,r,n,s,i,a,l,c,u,d)=>{const h=Vo(t),f=Wo(t),m=Vo(e),p=Wo(e),v=r*s*m-n*i*p+a,b=n*s*m+r*i*p+l;return["C",u+c*(-r*s*f-n*i*h),d+c*(-n*s*f+r*i*h),v+c*(r*s*p+n*i*m),b+c*(n*s*p-r*i*m),v,b]},$k=(t,e,r,n)=>{const s=Math.atan2(e,t),i=Math.atan2(n,r);return i>=s?i-s:2*Math.PI-(s-i)};function Bk(t,e,r,n,s,i,a,l){let c;if(Xt.cachesBoundsOfCurve&&(c=[...arguments].join(),Im.boundsOfCurveCache[c]))return Im.boundsOfCurveCache[c];const u=Math.sqrt,d=Math.abs,h=[],f=[[0,0],[0,0]];let m=6*t-12*r+6*s,p=-3*t+9*r-9*s+3*a,v=3*r-3*t;for(let S=0;S<2;++S){if(S>0&&(m=6*e-12*n+6*i,p=-3*e+9*n-9*i+3*l,v=3*n-3*e),d(p)<1e-12){if(d(m)<1e-12)continue;const F=-v/m;0<F&&F<1&&h.push(F);continue}const N=m*m-4*v*p;if(N<0)continue;const E=u(N),P=(-m+E)/(2*p);0<P&&P<1&&h.push(P);const A=(-m-E)/(2*p);0<A&&A<1&&h.push(A)}let b=h.length;const x=b,w=aM(t,e,r,n,s,i,a,l);for(;b--;){const{x:S,y:N}=w(h[b]);f[0][b]=S,f[1][b]=N}f[0][x]=t,f[1][x]=e,f[0][x+1]=a,f[1][x+1]=l;const _=[new Ne(Math.min(...f[0]),Math.min(...f[1])),new Ne(Math.max(...f[0]),Math.max(...f[1]))];return Xt.cachesBoundsOfCurve&&(Im.boundsOfCurveCache[c]=_),_}const YJ=(t,e,r)=>{let[n,s,i,a,l,c,u,d]=r;const h=((f,m,p,v,b,x,w)=>{if(p===0||v===0)return[];let _=0,S=0,N=0;const E=Math.PI,P=w*Sj,A=Wo(P),F=Vo(P),Y=.5*(-F*f-A*m),T=.5*(-F*m+A*f),O=p**2,U=v**2,q=T**2,Z=Y**2,H=O*U-O*q-U*Z;let Q=Math.abs(p),R=Math.abs(v);if(H<0){const ve=Math.sqrt(1-H/(O*U));Q*=ve,R*=ve}else N=(b===x?-1:1)*Math.sqrt(H/(O*q+U*Z));const B=N*Q*T/R,X=-N*R*Y/Q,ie=F*B-A*X+.5*f,M=A*B+F*X+.5*m;let W=$k(1,0,(Y-B)/Q,(T-X)/R),K=$k((Y-B)/Q,(T-X)/R,(-Y-B)/Q,(-T-X)/R);x===0&&K>0?K-=2*E:x===1&&K<0&&(K+=2*E);const ne=Math.ceil(Math.abs(K/E*2)),se=[],le=K/ne,ye=8/3*Math.sin(le/4)*Math.sin(le/4)/Math.sin(le/2);let oe=W+le;for(let ve=0;ve<ne;ve++)se[ve]=GJ(W,oe,F,A,Q,R,ie,M,ye,_,S),_=se[ve][5],S=se[ve][6],W=oe,oe+=le;return se})(u-t,d-e,s,i,l,c,a);for(let f=0,m=h.length;f<m;f++)h[f][1]+=t,h[f][2]+=e,h[f][3]+=t,h[f][4]+=e,h[f][5]+=t,h[f][6]+=e;return h},XJ=t=>{let e=0,r=0,n=0,s=0;const i=[];let a,l=0,c=0;for(const u of t){const d=[...u];let h;switch(d[0]){case"l":d[1]+=e,d[2]+=r;case"L":e=d[1],r=d[2],h=["L",e,r];break;case"h":d[1]+=e;case"H":e=d[1],h=["L",e,r];break;case"v":d[1]+=r;case"V":r=d[1],h=["L",e,r];break;case"m":d[1]+=e,d[2]+=r;case"M":e=d[1],r=d[2],n=d[1],s=d[2],h=["M",e,r];break;case"c":d[1]+=e,d[2]+=r,d[3]+=e,d[4]+=r,d[5]+=e,d[6]+=r;case"C":l=d[3],c=d[4],e=d[5],r=d[6],h=["C",d[1],d[2],l,c,e,r];break;case"s":d[1]+=e,d[2]+=r,d[3]+=e,d[4]+=r;case"S":a==="C"?(l=2*e-l,c=2*r-c):(l=e,c=r),e=d[3],r=d[4],h=["C",l,c,d[1],d[2],e,r],l=h[3],c=h[4];break;case"q":d[1]+=e,d[2]+=r,d[3]+=e,d[4]+=r;case"Q":l=d[1],c=d[2],e=d[3],r=d[4],h=["Q",l,c,e,r];break;case"t":d[1]+=e,d[2]+=r;case"T":a==="Q"?(l=2*e-l,c=2*r-c):(l=e,c=r),e=d[1],r=d[2],h=["Q",l,c,e,r];break;case"a":d[6]+=e,d[7]+=r;case"A":YJ(e,r,d).forEach(f=>i.push(f)),e=d[6],r=d[7];break;case"z":case"Z":e=n,r=s,h=["Z"]}h?(i.push(h),a=h[0]):a=""}return i},Rx=(t,e,r,n)=>Math.sqrt((r-t)**2+(n-e)**2),aM=(t,e,r,n,s,i,a,l)=>c=>{const u=c**3,d=(m=>3*m**2*(1-m))(c),h=(m=>3*m*(1-m)**2)(c),f=(m=>(1-m)**3)(c);return new Ne(a*u+s*d+r*h+t*f,l*u+i*d+n*h+e*f)},oM=t=>t**2,lM=t=>2*t*(1-t),cM=t=>(1-t)**2,KJ=(t,e,r,n,s,i,a,l)=>c=>{const u=oM(c),d=lM(c),h=cM(c),f=3*(h*(r-t)+d*(s-r)+u*(a-s)),m=3*(h*(n-e)+d*(i-n)+u*(l-i));return Math.atan2(m,f)},QJ=(t,e,r,n,s,i)=>a=>{const l=oM(a),c=lM(a),u=cM(a);return new Ne(s*l+r*c+t*u,i*l+n*c+e*u)},JJ=(t,e,r,n,s,i)=>a=>{const l=1-a,c=2*(l*(r-t)+a*(s-r)),u=2*(l*(n-e)+a*(i-n));return Math.atan2(u,c)},qk=(t,e,r)=>{let n=new Ne(e,r),s=0;for(let i=1;i<=100;i+=1){const a=t(i/100);s+=Rx(n.x,n.y,a.x,a.y),n=a}return s},ZJ=(t,e)=>{let r,n=0,s=0,i={x:t.x,y:t.y},a=pe({},i),l=.01,c=0;const u=t.iterator,d=t.angleFinder;for(;s<e&&l>1e-4;)a=u(n),c=n,r=Rx(i.x,i.y,a.x,a.y),r+s>e?(n-=l,l/=2):(i=a,n+=l,s+=r);return pe(pe({},a),{},{angle:d(c)})},uM=t=>{let e,r,n=0,s=0,i=0,a=0,l=0;const c=[];for(const u of t){const d={x:s,y:i,command:u[0],length:0};switch(u[0]){case"M":r=d,r.x=a=s=u[1],r.y=l=i=u[2];break;case"L":r=d,r.length=Rx(s,i,u[1],u[2]),s=u[1],i=u[2];break;case"C":e=aM(s,i,u[1],u[2],u[3],u[4],u[5],u[6]),r=d,r.iterator=e,r.angleFinder=KJ(s,i,u[1],u[2],u[3],u[4],u[5],u[6]),r.length=qk(e,s,i),s=u[5],i=u[6];break;case"Q":e=QJ(s,i,u[1],u[2],u[3],u[4]),r=d,r.iterator=e,r.angleFinder=JJ(s,i,u[1],u[2],u[3],u[4]),r.length=qk(e,s,i),s=u[3],i=u[4];break;case"Z":r=d,r.destX=a,r.destY=l,r.length=Rx(s,i,a,l),s=a,i=l}n+=r.length,c.push(r)}return c.push({length:n,x:s,y:i}),c},eZ=function(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uM(t),n=0;for(;e-r[n].length>0&&n<r.length-2;)e-=r[n].length,n++;const s=r[n],i=e/s.length,a=t[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return pe(pe({},new Ne(s.x,s.y).lerp(new Ne(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return pe(pe({},new Ne(s.x,s.y).lerp(new Ne(a[1],a[2]),i)),{},{angle:Math.atan2(a[2]-s.y,a[1]-s.x)});case"C":case"Q":return ZJ(s,e)}},tZ=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Uk=new RegExp(WJ,"g"),rZ=new RegExp(ta,"gi"),nZ={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},sZ=t=>{var e;const r=[],n=(e=t.match(tZ))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){r.push([i]);continue}const a=nZ[i.toLowerCase()];let l=[];if(i==="a"||i==="A"){Uk.lastIndex=0;for(let c=null;c=Uk.exec(s);)l.push(...c.slice(1))}else l=s.match(rZ)||[];for(let c=0;c<l.length;c+=a){const u=new Array(a),d=HJ[i];u[0]=c>0&&d?d:i;for(let h=0;h<a;h++)u[h+1]=parseFloat(l[c+h]);r.push(u)}}return r},iZ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=new Ne(t[0]),n=new Ne(t[1]),s=1,i=0;const a=[],l=t.length,c=l>2;let u;for(c&&(s=t[2].x<n.x?-1:t[2].x===n.x?0:1,i=t[2].y<n.y?-1:t[2].y===n.y?0:1),a.push(["M",r.x-s*e,r.y-i*e]),u=1;u<l;u++){if(!r.eq(n)){const d=r.midPointFrom(n);a.push(["Q",r.x,r.y,d.x,d.y])}r=t[u],u+1<t.length&&(n=t[u+1])}return c&&(s=r.x>t[u-2].x?1:r.x===t[u-2].x?0:-1,i=r.y>t[u-2].y?1:r.y===t[u-2].y?0:-1),a.push(["L",r.x+s*e,r.y+i*e]),a},dM=(t,e)=>t.map(r=>r.map((n,s)=>s===0||e===void 0?n:vr(n,e)).join(" ")).join(" ");function s5(t,e){const r=t.style;r&&e&&(typeof e=="string"?r.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return r.setProperty(s,i)}))}class aZ extends RO{constructor(e){let{allowTouchScrolling:r=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),ce(this,"upper",void 0),ce(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:r}),this.applyCanvasStyle(i,{allowTouchScrolling:r,styles:{position:"absolute",left:"0",top:"0"}});const a=this.createContainerElement();a.classList.add(n),s.parentNode&&s.parentNode.replaceChild(a,s),a.append(s,i),this.container=a}createUpperCanvas(){const{el:e}=this.lower,r=Ho();return r.className=e.className,r.classList.remove("lower-canvas"),r.classList.add("upper-canvas"),r.setAttribute("data-fabric","top"),r.style.cssText=e.style.cssText,r.setAttribute("draggable","true"),r}createContainerElement(){const e=gf().createElement("div");return e.setAttribute("data-fabric","wrapper"),s5(e,{position:"relative"}),mk(e),e}applyCanvasStyle(e,r){const{styles:n,allowTouchScrolling:s}=r;s5(e,pe(pe({},n),{},{"touch-action":s?"manipulation":As})),mk(e)}setDimensions(e,r){super.setDimensions(e,r);const{el:n,ctx:s}=this.upper;MO(n,s,e,r)}setCSSDimensions(e){super.setCSSDimensions(e),Kw(this.upper.el,e),Kw(this.container,e)}cleanupDOM(e){const r=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),r.removeChild(s),r.removeChild(n),r.parentNode&&r.parentNode.replaceChild(n,r)}dispose(){super.dispose(),Ja().dispose(this.upper.el),delete this.upper,delete this.container}}class Y1 extends Lj{constructor(){super(...arguments),ce(this,"targets",[]),ce(this,"_hoveredTargets",[]),ce(this,"_objectsToRender",void 0),ce(this,"_currentTransform",null),ce(this,"_groupSelector",null),ce(this,"contextTopDirty",!1)}static getDefaults(){return pe(pe({},super.getDefaults()),Y1.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new aZ(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(r=>!r.group&&r!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const r=this.getRetinaScaling(),n=Math.ceil((2*e+1)*r);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(r,r)}isTargetTransparent(e,r,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-r+s,-n+s),i.transform(...this.viewportTransform);const a=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=a,i.restore();const l=Math.round(s*this.getRetinaScaling());return uJ(i,l,l,l)}_isSelectionKeyPressed(e){const r=this.selectionKey;return!!r&&(Array.isArray(r)?!!r.find(n=>!!n&&e[n]===!0):e[r])}_shouldClearSelection(e,r){const n=this.getActiveObjects(),s=this._activeObject;return!!(!r||r&&s&&n.length>1&&n.indexOf(r)===-1&&s!==r&&!this._isSelectionKeyPressed(e)||r&&!r.evented||r&&!r.selectable&&s&&s!==r)}_shouldCenterTransform(e,r,n){if(!e)return;let s;return r===B1||r===Ls||r===Ci||r===vp?s=this.centeredScaling||e.centeredScaling:r===kj&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,r){const n={x:e.originX,y:e.originY};return r&&(["ml","tl","bl"].includes(r)?n.x=Hr:["mr","tr","br"].includes(r)&&(n.x=rr),["tl","mt","tr"].includes(r)?n.y=Xw:["bl","mb","br"].includes(r)&&(n.y=Ps)),n}_setupCurrentTransform(e,r,n){var s;const i=r.group?ch(this.getScenePoint(e),void 0,r.group.calcTransformMatrix()):this.getScenePoint(e),{key:a="",control:l}=r.getActiveControl()||{},c=n&&l?(s=l.getActionHandler(e,r,l))===null||s===void 0?void 0:s.bind(l):NQ,u=((m,p,v,b)=>{if(!p||!m)return"drag";const x=b.controls[p];return x.getActionName(v,x,b)})(n,a,e,r),d=e[this.centeredKey],h=this._shouldCenterTransform(r,u,d)?{x:Tt,y:Tt}:this._getOriginFromCorner(r,a),f={target:r,action:u,actionHandler:c,actionPerformed:!1,corner:a,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:i.x-r.left,offsetY:i.y-r.top,originX:h.x,originY:h.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:Qr(r.angle),width:r.width,height:r.height,shiftKey:e.shiftKey,altKey:d,original:pe(pe({},FO(r)),{},{originX:h.x,originY:h.y})};this._currentTransform=f,this.fire("before:transform",{e,transform:f})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:r,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new Ne(r,n).transform(this.viewportTransform),l=new Ne(r+s,n+i).transform(this.viewportTransform),c=this.selectionLineWidth/2;let u=Math.min(a.x,l.x),d=Math.min(a.y,l.y),h=Math.max(a.x,l.x),f=Math.max(a.y,l.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(u,d,h-u,f-d)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,u+=c,d+=c,h-=c,f-=c,Xn.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(u,d,h-u,f-d))}findTarget(e){if(this.skipTargetFind)return;const r=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(r,Qw(e))||s.length>1&&this.searchPossibleTargets([n],r))return n;if(n===this.searchPossibleTargets([n],r)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const a=this.searchPossibleTargets(this._objects,r);return e[this.altSelectionKey]&&a&&a!==n?(this.targets=i,n):a}return n}}return this.searchPossibleTargets(this._objects,r)}_pointIsInObjectSelectionArea(e,r){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[a,l,c,u]=n,d=Math.atan2(l.y-a.y,l.x-a.x),h=Vo(d)*i,f=Wo(d)*i,m=h+f,p=h-f;n=[new Ne(a.x-p,a.y-m),new Ne(l.x+m,l.y-p),new Ne(c.x+p,c.y+m),new Ne(u.x-m,u.y+p)]}return Ar.isPointInPolygon(r,n)}_checkTarget(e,r){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ch(r,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,r.x,r.y)))}_searchPossibleTargets(e,r){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,r)){if(_v(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,r);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,r){const n=this._searchPossibleTargets(e,r);if(n&&_v(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const a=s[i];if(!_v(a)||!a.interactive)return a}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=yQ(e),a=s.width||0,l=s.height||0;a&&l||(Ps in s&&Xw in s&&(l=Math.abs(s.top-s.bottom)),Hr in s&&rr in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,r||(i=ch(i,void 0,this.viewportTransform));const c=this.getRetinaScaling();c!==1&&(i.x/=c,i.y/=c);const u=a===0||l===0?new Ne(1,1):new Ne(n.width/a,n.height/l);return i.multiply(u)}_setDimensionsImpl(e,r){this._resetTransformEventData(),super._setDimensionsImpl(e,r),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Ho(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Vc(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,r){let n=!1,s=!1;const i=this.getActiveObjects(),a=[],l=[];e.forEach(c=>{i.includes(c)||(n=!0,c.fire("deselected",{e:r,target:c}),l.push(c))}),i.forEach(c=>{e.includes(c)||(n=!0,c.fire("selected",{e:r,target:c}),a.push(c))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:r,selected:a,deselected:l})):i.length>0?(s=!0,this.fire("selection:created",{e:r,selected:a})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:r,deselected:l})),s&&(this._objectsToRender=void 0)}setActiveObject(e,r){const n=this.getActiveObjects(),s=this._setActiveObject(e,r);return this._fireSelectionEvents(n,r),s}_setActiveObject(e,r){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(r,e)&&this._activeObject)&&!e.onSelect({e:r})&&(this._activeObject=e,Vc(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,r){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:r})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Vc(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const r=this.getActiveObjects(),n=this.getActiveObject();r.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(r,e),s}endCurrentTransform(e){const r=this._currentTransform;this._finalizeCurrentTransform(e),r&&r.target&&(r.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const r=this._currentTransform,n=r.target,s={e,target:n,transform:r,action:r.action};n._scaling&&(n._scaling=!1),n.setCoords(),r.actionPerformed&&(this.fire("object:modified",s),n.fire(kx,s))}setViewportTransform(e){super.setViewportTransform(e);const r=this._activeObject;r&&r.setCoords()}destroy(){const e=this._activeObject;Vc(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const r=this._activeObject;r&&r._renderControls(e)}_toObject(e,r,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,r,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:r}=e;if(r&&Vc(r)&&this._activeObject===r){const n=bf(e,["angle","flipX","flipY",rr,Ls,Ci,vf,xf,Ps]);return wQ(e,r.calcOwnMatrix()),n}return{}}_setSVGObject(e,r,n){const s=this._realizeGroupTransformOnObject(r);super._setSVGObject(e,r,n),r.set(s)}}ce(Y1,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class oZ{constructor(e){ce(this,"targets",[]),ce(this,"__disposer",void 0);const r=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",r),this.__disposer=()=>n.removeEventListener("click",r)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),kd(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var r;!((r=this.target)===null||r===void 0)&&r.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const lZ=["target","oldTarget","fireCanvas","e"],Bs={passive:!1},_d=(t,e)=>{const r=t.getViewportPoint(e),n=t.getScenePoint(e);return{viewportPoint:r,scenePoint:n,pointer:r,absolutePointer:n}},xl=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.addEventListener(...r)},fi=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.removeEventListener(...r)},cZ={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Dx extends Y1{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),ce(this,"_isClick",void 0),ce(this,"textEditingManager",new oZ(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(r=>{this[r]=this[r].bind(this)}),this.addOrRemove(xl,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,r){const n=this.upperCanvasEl,s=this._getEventPrefix();e(OO(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,Bs),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Bs)}removeListeners(){this.addOrRemove(fi,"remove");const e=this._getEventPrefix(),r=Zi(this.upperCanvasEl);fi(r,"".concat(e,"up"),this._onMouseUp),fi(r,"touchend",this._onTouchEnd,Bs),fi(r,"".concat(e,"move"),this._onMouseMove,Bs),fi(r,"touchmove",this._onMouseMove,Bs),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const r=this._hoveredTarget,n=pe({e},_d(this,e));this.fire("mouse:out",pe(pe({},n),{},{target:r})),this._hoveredTarget=void 0,r&&r.fire("mouseout",pe({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",pe(pe({},n),{},{target:s})),s&&s.fire("mouseout",pe({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",pe({e},_d(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const r=this.getActiveObject();if(r&&r.onDragStart(e)){this._dragSource=r;const n={e,target:r};return this.fire("dragstart",n),r.fire("dragstart",n),void xl(this.upperCanvasEl,"drag",this._onDragProgress)}pk(e)}_renderDragEffects(e,r,n){let s=!1;const i=this._dropTarget;i&&i!==r&&i!==n&&(i.clearContextTop(),s=!0),r==null||r.clearContextTop(),n!==r&&(n==null||n.clearContextTop());const a=this.contextTop;a.save(),a.transform(...this.viewportTransform),r&&(a.save(),r.transform(a),r.renderDragSourceEffect(e),a.restore(),s=!0),n&&(a.save(),n.transform(a),n.renderDropTargetEffect(e),a.restore(),s=!0),a.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const r=!!e.dataTransfer&&e.dataTransfer.dropEffect!==As,n=r?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:r,dropTarget:n};fi(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const r={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",r),this._dragSource&&this._dragSource.fire("drag",r)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const r="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,a={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let l;this.fire(r,a),this._fireEnterLeaveEvents(n,a),n&&(n.canDrop(e)&&(l=n),n.fire(r,a));for(let c=0;c<s.length;c++){const u=s[c];u.canDrop(e)&&(l=u),u.fire(r,a)}this._renderDragEffects(e,i,l),this._dropTarget=l}_onDragEnter(e){const{target:r,targets:n}=this.findDragTargets(e),s={e,target:r,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(r,s)}_onDragLeave(e){const r={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",r),this._fireEnterLeaveEvents(void 0,r),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:r,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",pe({e,target:r,subTargets:n,dragSource:this._dragSource},_d(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const r=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:r,subTargets:n});return this.stopContextMenu&&pk(e),this._basicEventHandler("contextmenu",s),!1}_onClick(e){const r=e.detail;r>3||r<2||(this._cacheTransformEventData(e),r==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),r==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const r=e.changedTouches;return r?r[0]&&r[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let r=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(r=!0),r&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),a=Zi(s);xl(a,"touchend",this._onTouchEnd,Bs),r&&xl(a,"touchmove",this._onMouseMove,Bs),fi(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const r=this.upperCanvasEl,n=this._getEventPrefix();fi(r,"".concat(n,"move"),this._onMouseMove,Bs);const s=Zi(r);xl(s,"".concat(n,"up"),this._onMouseUp),xl(s,"".concat(n,"move"),this._onMouseMove,Bs)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const r=this._getEventPrefix(),n=Zi(this.upperCanvasEl);fi(n,"touchend",this._onTouchEnd,Bs),fi(n,"touchmove",this._onMouseMove,Bs),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{xl(this.upperCanvasEl,"".concat(r,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const r=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=Zi(this.upperCanvasEl);fi(s,"".concat(n,"up"),this._onMouseUp),fi(s,"".concat(n,"move"),this._onMouseMove,Bs),xl(r,"".concat(n,"move"),this._onMouseMove,Bs)}}_onMouseMove(e){const r=this.getActiveObject();!this.allowTouchScrolling&&(!r||!r.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const r=this.getActiveObject();return!!r!=!!e||r&&e&&r!==e}__onMouseUp(e){var r;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:a}=e;if(a)return(this.fireMiddleClick&&a===1||this.fireRightClick&&a===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let l,c,u=!1;if(n&&(this._finalizeCurrentTransform(e),u=n.actionPerformed),!s){const d=i===this._activeObject;this.handleSelection(e),u||(u=this._shouldRender(i)||!d&&i===this._activeObject)}if(i){const d=i.findControl(this.getViewportPoint(e),Qw(e)),{key:h,control:f}=d||{};if(c=h,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),u=!0;else if(f){const m=f.getMouseUpHandler(e,i,f);m&&(l=this.getScenePoint(e),m.call(f,e,n,l.x,l.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==c)){const d=n.target&&n.target.controls[n.corner],h=d&&d.getMouseUpHandler(e,n.target,d);l=l||this.getScenePoint(e),h&&h.call(d,e,n,l.x,l.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),u?this.requestRenderAll():s||(r=this._activeObject)!==null&&r!==void 0&&r.isEditing||this.renderTop()}_basicEventHandler(e,r){const{target:n,subTargets:s=[]}=r;this.fire(e,r),n&&n.fire(e,r);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,r);return r}_handleEvent(e,r,n){const s=this._target,i=this.targets||[],a=pe(pe(pe({e,target:s,subTargets:i},_d(this,e)),{},{transform:this._currentTransform},r==="up:before"||r==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),r==="down:before"||r==="down"?n:{});this.fire("mouse:".concat(r),a),s&&s.fire("mouse".concat(r),a);for(let l=0;l<i.length;l++)i[l]!==s&&i[l].fire("mouse".concat(r),a)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const r=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(r,{e,pointer:r}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const r=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(r,{e,pointer:r})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const r=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:r}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let r=this._target,n=!!r&&r===this._activeObject;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(r),a=!1;if(this.handleMultiSelection(e,r)?(r=this._activeObject,a=!0,i=!0):this._shouldClearSelection(e,r)&&this.discardActiveObject(e),this.selection&&(!r||!r.selectable&&!r.isEditing&&r!==this._activeObject)){const l=this.getScenePoint(e);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0}}if(n=!!r&&r===this._activeObject,r){r.selectable&&r.activeOn==="down"&&this.setActiveObject(r,e);const l=r.findControl(this.getViewportPoint(e),Qw(e));if(r===this._activeObject&&(l||!a)){this._setupCurrentTransform(e,r,n);const c=l?l.control:void 0,u=this.getScenePoint(e),d=c&&c.getMouseDownHandler(e,r,c);d&&d.call(c,e,this._currentTransform,u.x,u.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ch(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const r=this._groupSelector;if(r){const n=this.getScenePoint(e);r.deltaX=n.x-r.x,r.deltaY=n.y-r.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,r){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:r,oldTarget:n,fireCanvas:!0});for(let l=0;l<a;l++)this.fireSyntheticInOutEvents("mouse",{e,target:i[l],oldTarget:s[l]});this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,r){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",pe(pe({},r),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let l=0;l<a;l++)this.fireSyntheticInOutEvents("drag",pe(pe({},r),{},{target:i[l],oldTarget:s[l]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,r){let{target:n,oldTarget:s,fireCanvas:i,e:a}=r,l=Er(r,lZ);const{targetIn:c,targetOut:u,canvasIn:d,canvasOut:h}=cZ[e],f=s!==n;if(s&&f){const m=pe(pe({},l),{},{e:a,target:s,nextTarget:n},_d(this,a));i&&this.fire(h,m),s.fire(u,m)}if(n&&f){const m=pe(pe({},l),{},{e:a,target:n,previousTarget:s},_d(this,a));i&&this.fire(d,m),n.fire(c,m)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const r=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?ch(r,void 0,s.group.calcTransformMatrix()):r;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,r,n){const{action:s,actionHandler:i,target:a}=r,l=!!i&&i(e,r,n.x,n.y);l&&a.setCoords(),s==="drag"&&l&&(r.target.isMoving=!0,this.setCursor(r.target.moveCursor||this.moveCursor)),r.actionPerformed=r.actionPerformed||l}_setCursorFromEvent(e,r){if(!r)return void this.setCursor(this.defaultCursor);let n=r.hoverCursor||this.hoverCursor;const s=Vc(this._activeObject)?this._activeObject:null,i=(!s||r.group!==s)&&r.findControl(this.getViewportPoint(e));if(i){const a=i.control;this.setCursor(a.cursorStyleHandler(e,a,r))}else r.subTargetCheck&&this.targets.concat().reverse().map(a=>{n=a.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,r){const n=this._activeObject,s=Vc(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&r&&r.selectable&&(n!==r||s)&&(s||!r.isDescendantOf(n)&&!n.isDescendantOf(r))&&!r.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(r===n){const a=this.getViewportPoint(e);if(!(r=this.searchPossibleTargets(i,a)||this.searchPossibleTargets(this._objects,a))||!r.selectable)return!1}r.group===n?(n.remove(r),this._hoveredTarget=r,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(r),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(et.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,r),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:r,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new Ne(r,n),l=a.add(new Ne(s,i)),c=a.min(l),u=a.max(l).subtract(c),d=this.collectObjects({left:c.x,top:c.y,width:u.x,height:u.y},{includeIntersecting:!this.selectionFullyContained}),h=a.eq(l)?d[0]?[d[0]]:[]:d.length>1?d.filter(f=>!f.onSelect({e})).reverse():d;if(h.length===1)this.setActiveObject(h[0],e);else if(h.length>1){const f=et.getClass("ActiveSelection");this.setActiveObject(new f(h,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const hM={x1:0,y1:0,x2:0,y2:0},uZ=pe(pe({},hM),{},{r1:0,r2:0}),Wd=(t,e)=>isNaN(t)&&typeof e=="number"?e:t,dZ=/^(\d+\.\d+)%|(\d+)%$/;function fM(t){return t&&dZ.test(t)}function mM(t,e){const r=typeof t=="number"?t:typeof t=="string"?parseFloat(t)/(fM(t)?100:1):NaN;return Hh(0,Wd(r,e),1)}const hZ=/\s*;\s*/,fZ=/\s*:\s*/;function mZ(t,e){let r,n;const s=t.getAttribute("style");if(s){const a=s.split(hZ);a[a.length-1]===""&&a.pop();for(let l=a.length;l--;){const[c,u]=a[l].split(fZ).map(d=>d.trim());c==="stop-color"?r=u:c==="stop-opacity"&&(n=u)}}const i=new Os(r||t.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:mM(t.getAttribute("offset"),0),color:i.toRgb(),opacity:Wd(parseFloat(n||t.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function pZ(t,e){const r=[],n=t.getElementsByTagName("stop"),s=mM(e,1);for(let i=n.length;i--;)r.push(mZ(n[i],s));return r}function pM(t){return t.nodeName==="linearGradient"||t.nodeName==="LINEARGRADIENT"?"linear":"radial"}function gM(t){return t.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function zi(t,e){return t.getAttribute(e)}function gZ(t,e){return function(r,n){let s,{width:i,height:a,gradientUnits:l}=n;return Object.keys(r).reduce((c,u)=>{const d=r[u];return d==="Infinity"?s=1:d==="-Infinity"?s=0:(s=typeof d=="string"?parseFloat(d):d,typeof d=="string"&&fM(d)&&(s*=.01,l==="pixels"&&(u!=="x1"&&u!=="x2"&&u!=="r2"||(s*=i),u!=="y1"&&u!=="y2"||(s*=a)))),c[u]=s,c},{})}(pM(t)==="linear"?function(r){return{x1:zi(r,"x1")||0,y1:zi(r,"y1")||0,x2:zi(r,"x2")||"100%",y2:zi(r,"y2")||0}}(t):function(r){return{x1:zi(r,"fx")||zi(r,"cx")||"50%",y1:zi(r,"fy")||zi(r,"cy")||"50%",r1:0,x2:zi(r,"cx")||"50%",y2:zi(r,"cy")||"50%",r2:zi(r,"r")||"50%"}}(t),pe(pe({},e),{},{gradientUnits:gM(t)}))}class k0{constructor(e){const{type:r="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:a=0,offsetY:l=0,gradientTransform:c,id:u}=e||{};Object.assign(this,{type:r,gradientUnits:n,coords:pe(pe({},r==="radial"?uZ:hM),s),colorStops:i,offsetX:a,offsetY:l,gradientTransform:c,id:u?"".concat(u,"_").concat(dc()):dc()})}addColorStop(e){for(const r in e){const n=new Os(e[r]);this.colorStops.push({offset:parseFloat(r),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return pe(pe({},bf(this,e)),{},{type:this.type,coords:pe({},this.coords),colorStops:this.colorStops.map(r=>pe({},r)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():us.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",a=this.colorStops.map(h=>pe({},h)).sort((h,f)=>h.offset-f.offset);let l=-this.offsetX,c=-this.offsetY;var u;i==="objectBoundingBox"?(l/=e.width,c/=e.height):(l+=e.width/2,c+=e.height/2),(u=e)&&typeof u._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=e.pathOffset.x,c-=e.pathOffset.y),s[4]-=l,s[5]-=c;const d=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(r?r+" ":"").concat(yp(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:h,y1:f,x2:m,y2:p}=this.coords;n.push("<linearGradient ",d,' x1="',h,'" y1="',f,'" x2="',m,'" y2="',p,`">
`)}else if(this.type==="radial"){const{x1:h,y1:f,x2:m,y2:p,r1:v,r2:b}=this.coords,x=v>b;n.push("<radialGradient ",d,' cx="',x?h:m,'" cy="',x?f:p,'" r="',x?v:b,'" fx="',x?m:h,'" fy="',x?p:f,`">
`),x&&(a.reverse(),a.forEach(_=>{_.offset=1-_.offset}));const w=Math.min(v,b);if(w>0){const _=w/Math.max(v,b);a.forEach(S=>{S.offset+=_*(1-S.offset)})}}return a.forEach(h=>{let{color:f,offset:m,opacity:p}=h;n.push("<stop ",'offset="',100*m+"%",'" style="stop-color:',f,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:r,y1:n,x2:s,y2:i,r1:a,r2:l}=this.coords,c=this.type==="linear"?e.createLinearGradient(r,n,s,i):e.createRadialGradient(r,n,a,s,i,l);return this.colorStops.forEach(u=>{let{color:d,opacity:h,offset:f}=u;c.addColorStop(f,h!==void 0?new Os(d).setAlpha(h).toRgba():d)}),c}static async fromObject(e){const{colorStops:r,gradientTransform:n}=e;return new this(pe(pe({},e),{},{colorStops:r?r.map(s=>pe({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,r,n){const s=gM(e),i=r._findCenterFromElement();return new this(pe({id:e.getAttribute("id")||void 0,type:pM(e),coords:gZ(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:pZ(e,n.opacity),gradientUnits:s,gradientTransform:t5(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:r.width/2-i.x,offsetY:r.height/2-i.y}:{offsetX:0,offsetY:0}))}}ce(k0,"type","Gradient"),et.setClass(k0,"gradient"),et.setClass(k0,"linear"),et.setClass(k0,"radial");const vZ=["type","source","patternTransform"];class G2{get type(){return"pattern"}set type(e){uc("warn","Setting type has no effect",e)}constructor(e){ce(this,"repeat","repeat"),ce(this,"offsetX",0),ce(this,"offsetY",0),ce(this,"crossOrigin",""),this.id=dc(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:r,crossOrigin:n}=this;return pe(pe({},bf(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:r,crossOrigin:n,offsetX:vr(this.offsetX,Xt.NUM_FRACTION_DIGITS),offsetY:vr(this.offsetY,Xt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:r,height:n}=e;const{source:s,repeat:i,id:a}=this,l=Wd(this.offsetX/r,0),c=Wd(this.offsetY/n,0),u=i==="repeat-y"||i==="no-repeat"?1+Math.abs(l||0):Wd(s.width/r,0),d=i==="repeat-x"||i==="no-repeat"?1+Math.abs(c||0):Wd(s.height/n,0);return['<pattern id="SVGID_'.concat(a,'" x="').concat(l,'" y="').concat(c,'" width="').concat(u,'" height="').concat(d,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,r){let{type:n,source:s,patternTransform:i}=e,a=Er(e,vZ);const l=await Sv(s,pe(pe({},r),{},{crossOrigin:a.crossOrigin}));return new this(pe(pe({},a),{},{patternTransform:i&&i.slice(0),source:l}))}}ce(G2,"type","Pattern"),et.setClass(G2),et.setClass(G2,"pattern");class xZ{constructor(e){ce(this,"color","rgb(0, 0, 0)"),ce(this,"width",1),ce(this,"shadow",null),ce(this,"strokeLineCap","round"),ce(this,"strokeLineJoin","round"),ce(this,"strokeMiterLimit",10),ce(this,"strokeDashArray",null),ce(this,"limitedToCanvasSize",!1),this.canvas=e}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])}_saveAndTransform(e){const r=this.canvas.viewportTransform;e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}needsFullRender(){return new Os(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const e=this.canvas,r=this.shadow,n=e.contextTop,s=e.getZoom()*e.getRetinaScaling();n.shadowColor=r.color,n.shadowBlur=r.blur*s,n.shadowOffsetX=r.offsetX*s,n.shadowOffsetY=r.offsetY*s}_resetShadow(){const e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}}const yZ=["path","left","top"],bZ=["d"];class Al extends Xn{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=r,a=Er(r,yZ);super(),Object.assign(this,Al.ownDefaults),this.setOptions(a),this._setPath(e||[],!0),typeof s=="number"&&this.set(rr,s),typeof i=="number"&&this.set(Ps,i)}_setPath(e,r){this.path=XJ(Array.isArray(e)?e:sZ(e)),this.setBoundingBox(r)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Ne(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const r=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+r,s[2]+n);break;case"M":e.moveTo(s[1]+r,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+r,s[2]+n,s[3]+r,s[4]+n,s[5]+r,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+r,s[2]+n,s[3]+r,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return pe(pe({},super.toObject(e)),{},{path:this.path.map(r=>r.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=this.toObject(e);return this.sourcePath&&(delete r.path,r.sourcePath=this.sourcePath),r}_toSVG(){const e=dM(this.path,Xt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Xt.NUM_FRACTION_DIGITS;return" translate(".concat(vr(-this.pathOffset.x,e),", ").concat(vr(-this.pathOffset.y,e),")")}toClipPathSVG(e){const r=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:r})}toSVG(e){const r=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:r})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:r,height:n,pathOffset:s}=this._calcDimensions();this.set({width:r,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,Tt,Tt)}_calcBoundsFromPath(){const e=[];let r=0,n=0,s=0,i=0;for(const a of this.path)switch(a[0]){case"L":s=a[1],i=a[2],e.push({x:r,y:n},{x:s,y:i});break;case"M":s=a[1],i=a[2],r=s,n=i;break;case"C":e.push(...Bk(s,i,a[1],a[2],a[3],a[4],a[5],a[6])),s=a[5],i=a[6];break;case"Q":e.push(...Bk(s,i,a[1],a[2],a[1],a[2],a[3],a[4])),s=a[3],i=a[4];break;case"Z":s=r,i=n}return Oo(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return pe(pe({},e),{},{pathOffset:new Ne(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,r,n){const s=Jo(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,pe(pe(pe({},Er(s,bZ)),r),{},{left:void 0,top:void 0}))}}ce(Al,"type","Path"),ce(Al,"cacheProperties",[...Qo,"path","fillRule"]),ce(Al,"ATTRIBUTE_NAMES",[...jc,"d"]),et.setClass(Al),et.setSVGClass(Al);class jp extends xZ{constructor(e){super(e),ce(this,"decimate",.4),ce(this,"drawStraightLine",!1),ce(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(e,r,n){const s=r.midPointFrom(n);return e.quadraticCurveTo(r.x,r.y,s.x,s.y),s}onMouseDown(e,r){let{e:n}=r;this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render())}onMouseMove(e,r){let{e:n}=r;if(this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const s=this._points,i=s.length,a=this.canvas.contextTop;this._saveAndTransform(a),this.oldEnd&&(a.beginPath(),a.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=jp.drawSegment(a,s[i-2],s[i-1]),a.stroke(),a.restore()}}onMouseUp(e){let{e:r}=e;return!this.canvas._isMainEvent(r)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,r=this._points[0],n=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&r.x===n.x&&r.y===n.y){const s=this.width/1e3;r.x-=s,n.x+=s}e.moveTo(r.x,r.y);for(let s=1;s<this._points.length;s++)jp.drawSegment(e,r,n),r=this._points[s],n=this._points[s+1];e.lineTo(r.x,r.y),e.stroke(),e.restore()}convertPointsToSVGPath(e){const r=this.width/1e3;return iZ(e,r)}createPath(e){const r=new Al(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,r.shadow=new Wa(this.shadow)),r}decimatePoints(e,r){if(e.length<=2)return e;let n,s=e[0];const i=this.canvas.getZoom(),a=Math.pow(r/i,2),l=e.length-1,c=[s];for(let u=1;u<l-1;u++)n=Math.pow(s.x-e[u].x,2)+Math.pow(s.y-e[u].y,2),n>=a&&(s=e[u],c.push(s));return c.push(e[l]),c}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const e=this.convertPointsToSVGPath(this._points);if(function(n){return dM(n)==="M 0 0 Q 0 0 0 0 L 0 0"}(e))return void this.canvas.requestRenderAll();const r=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.requestRenderAll(),r.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:r})}}const wZ=["left","top","radius"],vM=["radius","startAngle","endAngle","counterClockwise"];class Hs extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),Hs.ownDefaults)}constructor(e){super(),Object.assign(this,Hs.ownDefaults),this.setOptions(e)}_set(e,r){return super._set(e,r),e==="radius"&&this.setRadius(r),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Qr(this.startAngle),Qr(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Ls)}getRadiusY(){return this.get("radius")*this.get(Ci)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...vM,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:r}=this,n=Qr(this.startAngle),s=Qr(this.endAngle),i=Vo(n)*r,a=Wo(n)*r,l=Vo(s)*r,c=Wo(s)*r,u=e>180?1:0,d=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(a," A ").concat(r," ").concat(r," 0 ").concat(u," ").concat(d," ").concat(l," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,r,n){const s=Jo(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,radius:l=0}=s;return new this(pe(pe({},Er(s,wZ)),{},{radius:l,left:i-l,top:a-l}))}static fromObject(e){return super._fromObject(e)}}ce(Hs,"type","Circle"),ce(Hs,"cacheProperties",[...Qo,...vM]),ce(Hs,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),ce(Hs,"ATTRIBUTE_NAMES",["cx","cy","r",...jc]),et.setClass(Hs),et.setSVGClass(Hs);const _Z=["x1","y1","x2","y2"],jZ=["x1","y1","x2","y2"],i5=["x1","x2","y1","y2"];class Wc extends Xn{constructor(){let[e,r,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Wc.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=r,this.y2=s,this._setWidthHeight();const{left:a,top:l}=i;typeof a=="number"&&this.set(rr,a),typeof l=="number"&&this.set(Ps,l)}_setWidthHeight(){const{x1:e,y1:r,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-r);const{left:i,top:a,width:l,height:c}=Oo([{x:e,y:r},{x:n,y:s}]),u=new Ne(i+l/2,a+c/2);this.setPositionByOrigin(u,Tt,Tt)}_set(e,r){return super._set(e,r),i5.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const r=this.calcLinePoints();e.moveTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;yi(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new Ne((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return pe(pe({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:r,y1:n,y2:s,width:i,height:a}=this,l=e<=r?-1:1,c=n<=s?-1:1;return{x1:l*i/2,x2:l*-i/2,y1:c*a/2,y2:c*-a/2}}_toSVG(){const{x1:e,x2:r,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(r,'" y2="').concat(s,`" />
`)]}static async fromElement(e,r,n){const s=Jo(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:a=0,x2:l=0,y2:c=0}=s;return new this([i,a,l,c],Er(s,_Z))}static fromObject(e){let{x1:r,y1:n,x2:s,y2:i}=e,a=Er(e,jZ);return this._fromObject(pe(pe({},a),{},{points:[r,n,s,i]}),{extraParam:"points"})}}ce(Wc,"type","Line"),ce(Wc,"cacheProperties",[...Qo,...i5]),ce(Wc,"ATTRIBUTE_NAMES",jc.concat(i5)),et.setClass(Wc),et.setSVGClass(Wc);class Jc extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),Jc.ownDefaults)}constructor(e){super(),Object.assign(this,Jc.ownDefaults),this.setOptions(e)}_render(e){const r=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-r,n),e.lineTo(0,-n),e.lineTo(r,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,r=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(r,",0 ").concat(-r,",").concat(e," ").concat(r),'" />']}}ce(Jc,"type","Triangle"),ce(Jc,"ownDefaults",{width:100,height:100}),et.setClass(Jc),et.setSVGClass(Jc);const xM=["rx","ry"];class jo extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),jo.ownDefaults)}constructor(e){super(),Object.assign(this,jo.ownDefaults),this.setOptions(e)}_set(e,r){switch(super._set(e,r),e){case"rx":this.rx=r,this.set("width",2*r);break;case"ry":this.ry=r,this.set("height",2*r)}return this}getRx(){return this.get("rx")*this.get(Ls)}getRy(){return this.get("ry")*this.get(Ci)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...xM,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Cx,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,r,n){const s=Jo(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function SZ(t){if(!t)return[];const e=t.replace(/,/g," ").trim().split(/\s+/),r=[];for(let n=0;n<e.length;n+=2)r.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return r}ce(jo,"type","Ellipse"),ce(jo,"cacheProperties",[...Qo,...xM]),ce(jo,"ownDefaults",{rx:0,ry:0}),ce(jo,"ATTRIBUTE_NAMES",[...jc,"cx","cy","rx","ry"]),et.setClass(jo),et.setSVGClass(jo);const CZ=["left","top"],yM={exactBoundingBox:!1};class Ki extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),Ki.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),ce(this,"strokeDiff",void 0),Object.assign(this,Ki.ownDefaults),this.setOptions(r),this.points=e;const{left:n,top:s}=r;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(rr,n),typeof s=="number"&&this.set(Ps,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return hJ(this.points,e,this.isOpen())}_calcDimensions(e){e=pe({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const r=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(u=>u.projectedPoint):this.points;if(r.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Ne,strokeOffset:new Ne,strokeDiff:new Ne};const n=Oo(r),s=q1(pe(pe({},e),{},{scaleX:1,scaleY:1})),i=Oo(this.points.map(u=>_s(u,s,!0))),a=new Ne(this.scaleX,this.scaleY);let l=n.left+n.width/2,c=n.top+n.height/2;return this.exactBoundingBox&&(l-=c*Math.tan(Qr(this.skewX)),c-=l*Math.tan(Qr(this.skewY))),pe(pe({},n),{},{pathOffset:new Ne(l,c),strokeOffset:new Ne(i.left,i.top).subtract(new Ne(n.left,n.top)).multiply(a),strokeDiff:new Ne(n.width,n.height).subtract(new Ne(i.width,i.height)).multiply(a)})}_findCenterFromElement(){const e=Oo(this.points);return new Ne(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:r,top:n,width:s,height:i,pathOffset:a,strokeOffset:l,strokeDiff:c}=this._calcDimensions();this.set({width:s,height:i,pathOffset:a,strokeOffset:l,strokeDiff:c}),e&&this.setPositionByOrigin(new Ne(r+s/2,n+i/2),Tt,Tt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Ne(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let a;if(Object.keys(e).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var r,n;const{width:l,height:c}=this._calcDimensions(e);a=new Ne((r=e.width)!==null&&r!==void 0?r:l,(n=e.height)!==null&&n!==void 0?n:c)}else{var s,i;a=new Ne((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return a.multiply(new Ne(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,r){const n=this.initialized&&this[e]!==r,s=super._set(e,r);return this.exactBoundingBox&&n&&((e===Ls||e===Ci)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return pe(pe({},super.toObject(e)),{},{points:this.points.map(r=>{let{x:n,y:s}=r;return{x:n,y:s}})})}_toSVG(){const e=[],r=this.pathOffset.x,n=this.pathOffset.y,s=Xt.NUM_FRACTION_DIGITS;for(let i=0,a=this.points.length;i<a;i++)e.push(vr(this.points[i].x-r,s),",",vr(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const r=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(r&&!isNaN(this.points[r-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<r;i++){const a=this.points[i];e.lineTo(a.x-n,a.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,r,n){return new this(SZ(e.getAttribute("points")),pe(pe({},Er(Jo(e,this.ATTRIBUTE_NAMES,n),CZ)),r))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}ce(Ki,"ownDefaults",yM),ce(Ki,"type","Polyline"),ce(Ki,"layoutProperties",[vf,xf,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),ce(Ki,"cacheProperties",[...Qo,"points"]),ce(Ki,"ATTRIBUTE_NAMES",[...jc]),et.setClass(Ki),et.setSVGClass(Ki);class E0 extends Ki{isOpen(){return!1}}ce(E0,"ownDefaults",yM),ce(E0,"type","Polygon"),et.setClass(E0),et.setSVGClass(E0);class bM extends Xn{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const r=e===void 0?this.styles:{line:this.styles[e]};for(const n in r)for(const s in r[n])for(const i in r[n][s])return!1;return!0}styleHas(e,r){if(!this.styles||r!==void 0&&!this.styles[r])return!1;const n=r===void 0?this.styles:{0:this.styles[r]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const r=this.styles;let n,s,i=0,a=!0,l=0;for(const c in r){n=0;for(const u in r[c]){const d=r[c][u]||{};i++,d[e]!==void 0?(s?d[e]!==s&&(a=!1):s=d[e],d[e]===this[e]&&delete d[e]):a=!1,Object.keys(d).length!==0?n++:delete r[c][u]}n===0&&delete r[c]}for(let c=0;c<this._textLines.length;c++)l+=this._textLines[c].length;a&&i===l&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const r=this.styles;let n,s,i;for(s in r){for(i in n=r[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete r[s]}}_extendStyles(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=Tj(pe(pe({},this._getStyleDeclaration(n,s)),r),a=>a!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,r,n){const s=[];for(let i=e;i<(r||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return r?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,r,n){for(let s=r;s<(n||r);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,r){var n;const s=this.styles&&this.styles[e];return s&&(n=s[r])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,r){return pe(pe({},bf(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,r))}_setStyleDeclaration(e,r,n){this.styles[e][r]=n}_deleteStyleDeclaration(e,r){delete this.styles[e][r]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}ce(bM,"_styleProperties",EQ);const NZ=/  +/g,kZ=/"/g;function Y2(t,e,r,n,s){return"		".concat(function(i,a){let{left:l,top:c,width:u,height:d}=a,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xt.NUM_FRACTION_DIGITS;const f=bp(mn,i,!1),[m,p,v,b]=[l,c,u,d].map(x=>vr(x,h));return"<rect ".concat(f,' x="').concat(m,'" y="').concat(p,'" width="').concat(v,'" height="').concat(b,'"></rect>')}(t,{left:e,top:r,width:n,height:s}),`
`)}const EZ=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let X2;class En extends bM{static getDefaults(){return pe(pe({},super.getDefaults()),En.ownDefaults)}constructor(e,r){super(),ce(this,"__charBounds",[]),Object.assign(this,En.ownDefaults),this.setOptions(r),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=uM(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(za)&&this.enlargeSpaces()}enlargeSpaces(){let e,r,n,s,i,a,l;for(let c=0,u=this._textLines.length;c<u;c++)if((this.textAlign===za||c!==u-1&&!this.isEndOfWrapping(c))&&(s=0,i=this._textLines[c],r=this.getLineWidth(c),r<this.width&&(l=this.textLines[c].match(this._reSpacesAndTabs)))){n=l.length,e=(this.width-r)/n;for(let d=0;d<=i.length;d++)a=this.__charBounds[c][d],this._reSpaceAndTab.test(i[d])?(a.width+=e,a.kernedWidth+=e,a.left+=s,s+=e):a.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,r){const n=r?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,r)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),r=this.fontSize;return e.width+=r*e.zoomX,e.height+=r*e.zoomY,e}_render(e){const r=this.path;r&&!r.isNotVisible()&&r._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Ts?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,r,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Tt:e.textBaseline="middle";break;case"ascender":e.textBaseline=Ps;break;case"descender":e.textBaseline=Xw}e.font=this._getFontDeclaration(r,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let r=1,n=this._textLines.length;r<n;r++){const s=this.getLineWidth(r);s>e&&(e=s)}return e}_renderTextLine(e,r,n,s,i,a){this._renderChars(e,r,n,s,i,a)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const r=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const l=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=l;continue}const c=this._textLines[i].length,u=this._getLineLeftOffset(i);let d,h,f=0,m=0,p=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let v=0;v<c;v++){const b=this.__charBounds[i][v];h=this.getValueOfPropertyAt(i,v,"textBackgroundColor"),this.path?(e.save(),e.translate(b.renderLeft,b.renderTop),e.rotate(b.angle),e.fillStyle=h,h&&e.fillRect(-b.width/2,-l/this.lineHeight*(1-this._fontSizeFraction),b.width,l/this.lineHeight),e.restore()):h!==p?(d=n+u+m,this.direction==="rtl"&&(d=this.width-d-f),e.fillStyle=p,p&&e.fillRect(d,s,f,l/this.lineHeight),m=b.left,f=b.width,p=h):f+=b.kernedWidth}h&&!this.path&&(d=n+u+m,this.direction==="rtl"&&(d=this.width-d-f),e.fillStyle=h,e.fillRect(d,s,f,l/this.lineHeight)),s+=l}e.fillStyle=r,this._removeShadow(e)}_measureChar(e,r,n,s){const i=Im.getFontCache(r),a=this._getFontDeclaration(r),l=n+e,c=n&&a===this._getFontDeclaration(s),u=r.fontSize/this.CACHE_FONT_SIZE;let d,h,f,m;if(n&&i[n]!==void 0&&(f=i[n]),i[e]!==void 0&&(m=d=i[e]),c&&i[l]!==void 0&&(h=i[l],m=h-f),d===void 0||f===void 0||h===void 0){const p=function(){return X2||(X2=Ni({width:0,height:0}).getContext("2d")),X2}();this._setTextStyles(p,r,!0),d===void 0&&(m=d=p.measureText(e).width,i[e]=d),f===void 0&&c&&n&&(f=p.measureText(n).width,i[n]=f),c&&h===void 0&&(h=p.measureText(l).width,i[l]=h,m=h-f)}return{width:d*u,kernedWidth:m*u}}getHeightOfChar(e,r){return this.getValueOfPropertyAt(e,r,"fontSize")}measureLine(e){const r=this._measureLine(e);return this.charSpacing!==0&&(r.width-=this._getWidthOfCharSpacing()),r.width<0&&(r.width=0),r}_measureLine(e){let r,n,s=0;const i=this.pathSide===Hr,a=this.path,l=this._textLines[e],c=l.length,u=new Array(c);this.__charBounds[e]=u;for(let d=0;d<c;d++){const h=l[d];n=this._getGraphemeBox(h,e,d,r),u[d]=n,s+=n.kernedWidth,r=h}if(u[c]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},a&&a.segmentsInfo){let d=0;const h=a.segmentsInfo[a.segmentsInfo.length-1].length;switch(this.textAlign){case rr:d=i?h-s:0;break;case Tt:d=(h-s)/2;break;case Hr:d=i?0:h-s}d+=this.pathStartOffset*(i?-1:1);for(let f=i?c-1:0;i?f>=0:f<c;i?f--:f++)n=u[f],d>h?d%=h:d<0&&(d+=h),this._setGraphemeOnPath(d,n),d+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,r){const n=e+r.kernedWidth/2,s=this.path,i=eZ(s.path,n,s.segmentsInfo);r.renderLeft=i.x-s.pathOffset.x,r.renderTop=i.y-s.pathOffset.y,r.angle=i.angle+(this.pathSide===Hr?Math.PI:0)}_getGraphemeBox(e,r,n,s,i){const a=this.getCompleteStyleDeclaration(r,n),l=s?this.getCompleteStyleDeclaration(r,n-1):{},c=this._measureChar(e,a,s,l);let u,d=c.kernedWidth,h=c.width;this.charSpacing!==0&&(u=this._getWidthOfCharSpacing(),h+=u,d+=u);const f={width:h,left:0,height:a.fontSize,kernedWidth:d,deltaY:a.deltaY};if(n>0&&!i){const m=this.__charBounds[r][n-1];f.left=m.left+m.width+c.kernedWidth-c.width}return f}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let r=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)r=Math.max(this.getHeightOfChar(e,n),r);return this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,r=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),r+=n===s-1?e/this.lineHeight:e;return r}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,r){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let a=0,l=this._textLines.length;a<l;a++){const c=this.getHeightOfLine(a),u=c/this.lineHeight,d=this._getLineLeftOffset(a);this._renderTextLine(r,e,this._textLines[a],s+d,i+n+u,a),n+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(mn))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,r,n,s,i,a){const l=this.getHeightOfLine(a),c=this.textAlign.includes(za),u=this.path,d=!c&&this.charSpacing===0&&this.isEmptyStyles(a)&&!u,h=this.direction==="ltr",f=this.direction==="ltr"?1:-1,m=r.direction;let p,v,b,x,w,_="",S=0;if(r.save(),m!==this.direction&&(r.canvas.setAttribute("dir",h?"ltr":"rtl"),r.direction=h?"ltr":"rtl",r.textAlign=h?rr:Hr),i-=l*this._fontSizeFraction/this.lineHeight,d)return this._renderChar(e,r,a,0,n.join(""),s,i),void r.restore();for(let N=0,E=n.length-1;N<=E;N++)x=N===E||this.charSpacing||u,_+=n[N],b=this.__charBounds[a][N],S===0?(s+=f*(b.kernedWidth-b.width),S+=b.width):S+=b.kernedWidth,c&&!x&&this._reSpaceAndTab.test(n[N])&&(x=!0),x||(p=p||this.getCompleteStyleDeclaration(a,N),v=this.getCompleteStyleDeclaration(a,N+1),x=$j(p,v,!1)),x&&(u?(r.save(),r.translate(b.renderLeft,b.renderTop),r.rotate(b.angle),this._renderChar(e,r,a,N,_,-S/2,0),r.restore()):(w=s,this._renderChar(e,r,a,N,_,w,i)),_="",p=v,s+=f*S,S=0);r.restore()}_applyPatternGradientTransformText(e){const r=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=Ni({width:r,height:n}),i=s.getContext("2d");return s.width=r,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(r,0),i.lineTo(r,n),i.lineTo(0,n),i.closePath(),i.translate(r/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,r,n){let s,i;return yi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[r]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[r]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[r]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,r){let{stroke:n,strokeWidth:s}=r;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,r){let{fill:n}=r;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,r,n,s,i,a,l){const c=this._getStyleDeclaration(n,s),u=this.getCompleteStyleDeclaration(n,s),d=e==="fillText"&&u.fill,h=e==="strokeText"&&u.stroke&&u.strokeWidth;if(h||d){if(r.save(),r.font=this._getFontDeclaration(u),c.textBackgroundColor&&this._removeShadow(r),c.deltaY&&(l+=c.deltaY),d){const f=this._setFillStyles(r,u);r.fillText(i,a-f.offsetX,l-f.offsetY)}if(h){const f=this._setStrokeStyles(r,u);r.strokeText(i,a-f.offsetX,l-f.offsetY)}r.restore()}}setSuperscript(e,r){this._setScript(e,r,this.superscript)}setSubscript(e,r){this._setScript(e,r,this.subscript)}_setScript(e,r,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),a=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),l={fontSize:i*n.size,deltaY:a+i*n.baseline};this.setSelectionStyles(l,e,r)}_getLineLeftOffset(e){const r=this.getLineWidth(e),n=this.width-r,s=this.textAlign,i=this.direction,a=this.isEndOfWrapping(e);let l=0;return s===za||s===$m&&!a||s===zm&&!a||s===Lx&&!a?0:(s===Tt&&(l=n/2),s===Hr&&(l=n),s===$m&&(l=n/2),s===zm&&(l=n),i==="rtl"&&(s===Hr||s===za||s===zm?l=0:s===rr||s===Lx?l=-n:s!==Tt&&s!==$m||(l=-n/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:r}=this.measureLine(e);return this.__lineWidths[e]=r,r}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,r,n){var s;return(s=this._getStyleDeclaration(e,r)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,r){if(!this[r]&&!this.styleHas(r))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,a=this._getWidthOfCharSpacing(),l=r==="linethrough"?.5:r==="overline"?1:0,c=this.offsets[r];for(let u=0,d=this._textLines.length;u<d;u++){const h=this.getHeightOfLine(u);if(!this[r]&&!this.styleHas(r,u)){n+=h;continue}const f=this._textLines[u],m=h/this.lineHeight,p=this._getLineLeftOffset(u);let v=0,b=0,x=this.getValueOfPropertyAt(u,0,r),w=this.getValueOfPropertyAt(u,0,mn),_=this.getValueOfPropertyAt(u,0,Nu),S=x,N=w,E=_;const P=n+m*(1-this._fontSizeFraction);let A=this.getHeightOfChar(u,0),F=this.getValueOfPropertyAt(u,0,"deltaY");for(let O=0,U=f.length;O<U;O++){const q=this.__charBounds[u][O];S=this.getValueOfPropertyAt(u,O,r),N=this.getValueOfPropertyAt(u,O,mn),E=this.getValueOfPropertyAt(u,O,Nu);const Z=this.getHeightOfChar(u,O),H=this.getValueOfPropertyAt(u,O,"deltaY");if(i&&S&&N){const Q=this.fontSize*E/1e3;e.save(),e.fillStyle=w,e.translate(q.renderLeft,q.renderTop),e.rotate(q.angle),e.fillRect(-q.kernedWidth/2,c*Z+H-l*Q,q.kernedWidth,Q),e.restore()}else if((S!==x||N!==w||Z!==A||E!==_||H!==F)&&b>0){const Q=this.fontSize*_/1e3;let R=s+p+v;this.direction==="rtl"&&(R=this.width-R-b),x&&w&&_&&(e.fillStyle=w,e.fillRect(R,P+c*A+F-l*Q,b,Q)),v=q.left,b=q.width,x=S,_=E,w=N,A=Z,F=H}else b+=q.kernedWidth}let Y=s+p+v;this.direction==="rtl"&&(Y=this.width-Y-b),e.fillStyle=N;const T=this.fontSize*E/1e3;S&&N&&E&&e.fillRect(Y,P+c*A+F-l*T,b-a,T),n+=h}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:r=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const a=e.includes("'")||e.includes('"')||e.includes(",")||En.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[r,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),a].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return zj(e)}_splitTextIntoLines(e){const r=e.split(this._reNewline),n=new Array(r.length),s=[`
`];let i=[];for(let a=0;a<r.length;a++)n[a]=this.graphemeSplit(r[a]),i=i.concat(n[a],s);return i.pop(),{_unwrappedLines:n,lines:r,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return pe(pe({},super.toObject([...HO,...e])),{},{styles:gJ(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,r){const{textLayoutProperties:n}=this.constructor;super.set(e,r);let s=!1,i=!1;if(typeof e=="object")for(const a in e)a==="path"&&this.setPathInfo(),s=s||n.includes(a),i=i||a==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,r,n){const s=Jo(e,En.ATTRIBUTE_NAMES,n),i=pe(pe({},r),s),{textAnchor:a=rr,textDecoration:l="",dx:c=0,dy:u=0,top:d=0,left:h=0,fontSize:f=Cj,strokeWidth:m=1}=i,p=Er(i,EZ),v=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),pe({left:h+c,top:d+u,underline:l.includes("underline"),overline:l.includes("overline"),linethrough:l.includes("line-through"),strokeWidth:0,fontSize:f},p)),b=v.getScaledHeight()/v.height,x=((v.height+v.strokeWidth)*v.lineHeight-v.height)*b,w=v.getScaledHeight()+x;let _=0;return a===Tt&&(_=v.getScaledWidth()/2),a===Hr&&(_=v.getScaledWidth()),v.set({left:v.left-_,top:v.top-(w-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:m}),v}static fromObject(e){return this._fromObject(pe(pe({},e),{},{styles:vJ(e.styles||{},e.text)}),{extraParam:"text"})}}ce(En,"textLayoutProperties",WO),ce(En,"cacheProperties",[...Qo,...HO]),ce(En,"ownDefaults",PQ),ce(En,"type","Text"),ce(En,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),ce(En,"ATTRIBUTE_NAMES",jc.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),tM(En,[class extends qO{_toSVG(){const t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(t){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0}),r=this.path;return r?e+r._createBaseSVGMarkup(r._toSVG(),{reviver:t,withShadow:!0,additionalTransform:yp(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(t){let{textBgRects:e,textSpans:r}=t;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(kZ,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",r.join(""),`</text>
`]}_getSVGTextAndBg(t,e){const r=[],n=[];let s,i=t;this.backgroundColor&&n.push(...Y2(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let a=0,l=this._textLines.length;a<l;a++)s=this._getLineLeftOffset(a),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(n,a,e+s,i),this._setSVGTextLineText(r,a,e+s,i),i+=this.getHeightOfLine(a);return{textSpans:r,textBgRects:n}}_createTextCharSpan(t,e,r,n,s){const i=Xt.NUM_FRACTION_DIGITS,a=this.getSvgSpanStyles(e,t!==t.trim()||!!t.match(NZ)),l=a?'style="'.concat(a,'"'):"",c=e.deltaY,u=c?' dy="'.concat(vr(c,i),'" '):"",{angle:d,renderLeft:h,renderTop:f,width:m}=s;let p="";if(h!==void 0){const v=m/2;d&&(p=' rotate="'.concat(vr(Go(d),i),'"'));const b=yf({angle:Go(d)});b[4]=h,b[5]=f;const x=new Ne(-v,0).transform(b);r=x.x,n=x.y}return'<tspan x="'.concat(vr(r,i),'" y="').concat(vr(n,i),'" ').concat(u).concat(p).concat(l,">").concat(fJ(t),"</tspan>")}_setSVGTextLineText(t,e,r,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(za),a=this._textLines[e];let l,c,u,d,h,f="",m=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,v=a.length-1;p<=v;p++)h=p===v||this.charSpacing||this.path,f+=a[p],u=this.__charBounds[e][p],m===0?(r+=u.kernedWidth-u.width,m+=u.width):m+=u.kernedWidth,i&&!h&&this._reSpaceAndTab.test(a[p])&&(h=!0),h||(l=l||this.getCompleteStyleDeclaration(e,p),c=this.getCompleteStyleDeclaration(e,p+1),h=$j(l,c,!0)),h&&(d=this._getStyleDeclaration(e,p),t.push(this._createTextCharSpan(f,d,r,n,u)),f="",l=c,this.direction==="rtl"?r-=m:r+=m,m=0)}_setSVGTextLineBg(t,e,r,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let a,l=0,c=0,u=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let d=0;d<s.length;d++){const{left:h,width:f,kernedWidth:m}=this.__charBounds[e][d];a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"),a!==u?(u&&t.push(...Y2(u,r+c,n,l,i)),c=h,l=f,u=a):l+=m}a&&t.push(...Y2(u,r+c,n,l,i))}_getSVGLineTopOffset(t){let e,r=0;for(e=0;e<t;e++)r+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:r,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(t){return"".concat(super.getSvgStyles(t)," text-decoration-thickness: ").concat(vr(this.textDecorationThickness*this.getObjectScaling().y/10,Xt.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(t,e){const{fontFamily:r,strokeWidth:n,stroke:s,fill:i,fontSize:a,fontStyle:l,fontWeight:c,deltaY:u,textDecorationThickness:d,linethrough:h,overline:f,underline:m}=t,p=this.getSvgTextDecoration({underline:m??this.underline,overline:f??this.overline,linethrough:h??this.linethrough}),v=d||this.textDecorationThickness;return[s?bp(Ts,s):"",n?"stroke-width: ".concat(n,"; "):"",r?"font-family: ".concat(r.includes("'")||r.includes('"')?r:"'".concat(r,"'"),"; "):"",a?"font-size: ".concat(a,"px; "):"",l?"font-style: ".concat(l,"; "):"",c?"font-weight: ".concat(c,"; "):"",p?"text-decoration: ".concat(p,"; text-decoration-thickness: ").concat(vr(v*this.getObjectScaling().y/10,Xt.NUM_FRACTION_DIGITS),"%; "):"",i?bp(mn,i):"",u?"baseline-shift: ".concat(-u,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(t){return["overline","underline","line-through"].filter(e=>t[e.replace("-","")]).join(" ")}}]),et.setClass(En),et.setSVGClass(En);class PZ{constructor(e){ce(this,"target",void 0),ce(this,"__mouseDownInPlace",!1),ce(this,"__dragStartFired",!1),ce(this,"__isDraggingOver",!1),ce(this,"__dragStartSelection",void 0),ce(this,"__dragImageDisposer",void 0),ce(this,"_dispose",void 0),this.target=e;const r=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{r.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const r=this.target,n=r.getSelectionStartFromPointer(e);return r.isEditing&&n>=r.selectionStart&&n<=r.selectionEnd&&r.selectionStart<r.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const r=this.isActive();return r&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,r}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,r){var n;let{selectionStart:s,selectionEnd:i}=r;const a=this.target,l=a.canvas,c=new Ne(a.flipX?-1:1,a.flipY?-1:1),u=a._getCursorBoundaries(s),d=new Ne(u.left+u.leftOffset,u.top+u.topOffset).multiply(c).transform(a.calcTransformMatrix()),h=l.getScenePoint(e).subtract(d),f=a.getCanvasRetinaScaling(),m=a.getBoundingRect(),p=d.subtract(new Ne(m.left,m.top)),v=l.viewportTransform,b=p.add(h).transform(v,!0),x=a.backgroundColor,w=Ij(a.styles);a.backgroundColor="";const _={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};a.setSelectionStyles(_,0,s),a.setSelectionStyles(_,i,a.text.length),a.dirty=!0;const S=a.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});a.backgroundColor=x,a.styles=w,a.dirty=!0,s5(S,{position:"fixed",left:"".concat(-S.width,"px"),border:As,width:"".concat(S.width/f,"px"),height:"".concat(S.height/f,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{S.remove()},Zi(e.target||this.target.hiddenTextarea).body.appendChild(S),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(S,b.x,b.y)}onDragStart(e){this.__dragStartFired=!0;const r=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:r.selectionStart,selectionEnd:r.selectionEnd},i=r._text.slice(s.selectionStart,s.selectionEnd).join(""),a=pe({text:r.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:r.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,a)}return r.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const r=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return r<n.selectionStart||r>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:r}=e;const n=this.targetCanDrop(r);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:r}=e,n=this.targetCanDrop(r);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(r.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var r;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(r=n.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain");if(i&&!s){const a=this.target,l=a.canvas;let c=a.getSelectionStartFromPointer(n);const{styles:u}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},d=i[Math.max(0,i.length-1)],h=0;if(this.__dragStartSelection){const f=this.__dragStartSelection.selectionStart,m=this.__dragStartSelection.selectionEnd;c>f&&c<=m?c=f:c>m&&(c-=m-f),a.removeChars(f,m),delete this.__dragStartSelection}a._reNewline.test(d)&&(a._reNewline.test(a._text[c])||c===a._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=a,a.insertChars(i,u,c),l.setActiveObject(a),a.enterEditing(n),a.selectionStart=Math.min(c+h,a._text.length),a.selectionEnd=Math.min(a.selectionStart+i.length,a._text.length),a.hiddenTextarea.value=a.text,a._updateTextarea(),a.hiddenTextarea.focus(),a.fire(Nx,{index:c+h,action:"drop"}),l.fire("text:changed",{target:a}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(e){let{e:r}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:a,selectionEnd:l}=this.__dragStartSelection,c=((n=r.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||As;c===As?(s.selectionStart=a,s.selectionEnd=l,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),c==="move"&&(s.removeChars(a,l),s.selectionStart=s.selectionEnd=a,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Nx,{index:a,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Vk=/[ \n\.,;!\?\-]/;class AZ extends En{constructor(){super(...arguments),ce(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:r,duration:n,delay:s,onComplete:i}=e;return KO({startValue:this._currentCursorOpacity,endValue:r,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:a=>{this._currentCursorOpacity=a,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(r=>{r&&!r.isDone()&&(e=!0,r.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let r=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)r++,n--;for(;/\S/.test(this._text[n])&&n>-1;)r++,n--;return e-r}findWordBoundaryRight(e){let r=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)r++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)r++,n++;return e+r}findLineBoundaryLeft(e){let r=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)r++,n--;return e-r}findLineBoundaryRight(e){let r=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)r++,n++;return e+r}searchWordBoundary(e,r){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(r===-1||!Nj.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!Vk.test(i);)s+=r,i=n[s];return r===-1&&Vk.test(i)&&s++,s}selectWord(e){var r;e=(r=e)!==null&&r!==void 0?r:this.selectionStart;const n=this.searchWordBoundary(e,-1),s=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var r;e=(r=e)!==null&&r!==void 0?r:this.selectionStart;const n=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const r=this.hiddenTextarea;Zi(r).activeElement!==r&&r.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,r,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===r)return{selectionStart:i,selectionEnd:i};const a=n.slice(e,r);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(a).length}}fromGraphemeToStringSelection(e,r,n){const s=n.slice(0,e).join("").length;return e===r?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,r).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const r=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=r.selectionEnd,this.inCompositionMode||(this.selectionStart=r.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,r=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,a=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,l=r.leftOffset,c=this.getCanvasRetinaScaling(),u=this.canvas.upperCanvasEl,d=u.width/c,h=u.height/c,f=d-a,m=h-a,p=new Ne(r.left+l,r.top+r.topOffset+a).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Ne(u.clientWidth/d,u.clientHeight/h));return p.x<0&&(p.x=0),p.x>f&&(p.x=f),p.y<0&&(p.y=0),p.y>m&&(p.y=m),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(a,"px"),charHeight:a}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(kx),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,r){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:a}=this.get2DCursorLocation(r,!0);if(n!==i){if(this.styles[n])for(let l=s;l<this._unwrappedTextLines[n].length;l++)delete this.styles[n][l];if(this.styles[i])for(let l=a;l<this._unwrappedTextLines[i].length;l++){const c=this.styles[i][l];c&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+l-a]=c)}for(let l=n+1;l<=i;l++)delete this.styles[l];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const l=this.styles[n],c=a-s;for(let u=s;u<a;u++)delete l[u];for(const u in this.styles[n]){const d=parseInt(u,10);d>=a&&(l[d-c]=l[u],delete l[u])}}}shiftLineStyles(e,r){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+r]=n[i],n[i-r]||delete this.styles[i])}}insertNewlineStyleObject(e,r,n,s){const i={},a=this._unwrappedTextLines[e].length,l=a===r;let c=!1;n||(n=1),this.shiftLineStyles(e,n);const u=this.styles[e]?this.styles[e][r===0?r:r-1]:void 0;for(const h in this.styles[e]){const f=parseInt(h,10);f>=r&&(c=!0,i[f-r]=this.styles[e][h],l&&r===0||delete this.styles[e][h])}let d=!1;for(c&&!l&&(this.styles[e+n]=i,d=!0),(d||a>r)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:pe({},s[n-1])}:u?this.styles[e+n]={0:pe({},u)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,r,n,s){this.styles||(this.styles={});const i=this.styles[e],a=i?pe({},i):{};n||(n=1);for(const c in a){const u=parseInt(c,10);u>=r&&(i[u+n]=a[u],a[u-n]||delete i[u])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][r+n]=pe({},s[n]));return}if(!i)return;const l=i[r?r-1:1];for(;l&&n--;)this.styles[e][r+n]=pe({},l)}insertNewStyleBlock(e,r,n){const s=this.get2DCursorLocation(r,!0),i=[0];let a,l=0;for(let c=0;c<e.length;c++)e[c]===`
`?(l++,i[l]=0):i[l]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),l&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],l),a=1;a<l;a++)i[a]>0?this.insertCharStyleObject(s.lineIndex+a,0,i[a],n):n&&this.styles[s.lineIndex+a]&&n[0]&&(this.styles[s.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);i[a]>0&&this.insertCharStyleObject(s.lineIndex+a,0,i[a],n)}removeChars(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,r),this._text.splice(e,r-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,r),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,r,n){n<=e?(r===e?this._selectionDirection=rr:this._selectionDirection===Hr&&(this._selectionDirection=rr,this.selectionEnd=e),this.selectionStart=n):n>e&&n<r?this._selectionDirection===Hr?this.selectionEnd=n:this.selectionStart=n:(r===e?this._selectionDirection=Hr:this._selectionDirection===rr&&(this._selectionDirection=Hr,this.selectionStart=r),this.selectionEnd=n)}}class TZ extends AZ{initHiddenTextarea(){const e=this.canvas&&Zi(this.canvas.getElement())||gf(),r=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(a=>{let[l,c]=a;return r.setAttribute(l,c)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();r.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(r),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(a=>{let[l,c]=a;return r.addEventListener(l,this[c].bind(this))}),this.hiddenTextarea=r}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in r)this[r[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const r=this.fromPaste,{value:n,selectionStart:s,selectionEnd:i}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const a=()=>{this.updateFromTextArea(),this.fire(Nx),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void a();const l=this._splitTextIntoLines(n).graphemeText,c=this._text.length,u=l.length,d=this.selectionStart,h=this.selectionEnd,f=d!==h;let m,p,v,b,x=u-c;const w=this.fromStringToGraphemeSelection(s,i,n),_=d>w.selectionStart;f?(p=this._text.slice(d,h),x+=h-d):u<c&&(p=_?this._text.slice(h+x,h):this._text.slice(d,d-x));const S=l.slice(w.selectionEnd-x,w.selectionEnd);if(p&&p.length&&(S.length&&(m=this.getSelectionStyles(d,d+1,!1),m=S.map(()=>m[0])),f?(v=d,b=h):_?(v=h-p.length,b=h):(v=h,b=h+p.length),this.removeStyleFromTo(v,b)),S.length){const{copyPasteData:N}=Ja();r&&S.join("")===N.copiedText&&!Xt.disableStyleCopyPaste&&(m=N.copiedTextStyle),this.insertNewStyleBlock(S,d,m)}a()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:r}=e;const{selectionStart:n,selectionEnd:s}=r;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Ja();e.copiedText=this.getSelectedText(),Xt.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,r){let n,s=this._getLineLeftOffset(e);return r>0&&(n=this.__charBounds[e][r-1],s+=n.left+n.width),s}getDownCursorOffset(e,r){const n=this._getSelectionForOffset(e,r),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const a=s.charIndex,l=this._getWidthBeforeCursor(i,a),c=this._getIndexOnLine(i+1,l);return this._textLines[i].slice(a).length+c+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,r){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,r){const n=this._getSelectionForOffset(e,r),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const a=s.charIndex,l=this._getWidthBeforeCursor(i,a),c=this._getIndexOnLine(i-1,l),u=this._textLines[i].slice(0,a),d=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+c-u.length+(1-d)}_getIndexOnLine(e,r){const n=this._textLines[e];let s,i,a=this._getLineLeftOffset(e),l=0;for(let c=0,u=n.length;c<u;c++)if(s=this.__charBounds[e][c].width,a+=s,a>r){i=!0;const d=a-s,h=a,f=Math.abs(d-r);l=Math.abs(h-r)<f?c:c-1;break}return i||(l=n.length-1),l}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,r){const n=this["get".concat(e,"CursorOffset")](r,this._selectionDirection===Hr);if(r.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=Hh(0,this.selectionStart,s),this.selectionEnd=Hh(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const r=this._selectionDirection===rr?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,r,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[r]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[r]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[r])}return s!==void 0&&this[r]!==s&&(this[r]=s,!0)}_moveLeft(e,r){return this._move(e,r,"Left")}_moveRight(e,r){return this._move(e,r,"Right")}moveCursorLeftWithoutShift(e){let r=!0;return this._selectionDirection=rr,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,r}moveCursorLeftWithShift(e){return this._selectionDirection===Hr&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=rr,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,r){const n="moveCursor".concat(e).concat(r.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===rr&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Hr,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let r=!0;return this._selectionDirection=Hr,this.selectionStart===this.selectionEnd?(r=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r}}const Wk=t=>!!t.button;class LZ extends TZ{constructor(){super(...arguments),ce(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new PZ(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:r,alreadySelected:n}=e;this.canvas&&this.editable&&!Wk(r)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(r)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(r)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:r,transform:n}=e;const s=this.draggableTextDelegate.end(r);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Wk(r)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(r),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const r=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const r=this.canvas.getScenePoint(e).transform(ea(this.calcTransformMatrix())).add(new Ne(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let u=0;u<this._textLines.length&&n<=r.y;u++)n+=this.getHeightOfLine(u),i=u,u>0&&(s+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));let a=Math.abs(this._getLineLeftOffset(i));const l=this._textLines[i].length,c=this.__charBounds[i];for(let u=0;u<l;u++){const d=a+c[u].kernedWidth;if(r.x<=d){Math.abs(r.x-d)<=Math.abs(r.x-a)&&s++;break}a=d,s++}return Math.min(this.flipX?l-s:s,this._text.length)}}const P0="moveCursorUp",A0="moveCursorDown",T0="moveCursorLeft",L0="moveCursorRight",O0="exitEditing",Hk=(t,e)=>{const r=e.getRetinaScaling();t.setTransform(r,0,0,r,0,0);const n=e.viewportTransform;t.transform(n[0],n[1],n[2],n[3],n[4],n[5])},OZ=pe({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:O0,27:O0,33:P0,34:A0,35:L0,36:T0,37:T0,38:P0,39:L0,40:A0},keysMapRtl:{9:O0,27:O0,33:P0,34:A0,35:T0,36:L0,37:L0,38:P0,39:T0,40:A0},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Po extends LZ{static getDefaults(){return pe(pe({},super.getDefaults()),Po.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,r){super(e,pe(pe({},Po.ownDefaults),r)),this.initBehavior()}_set(e,r){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=r,this):(e==="canvas"&&(this.canvas instanceof Dx&&this.canvas.textEditingManager.remove(this),r instanceof Dx&&r.textEditingManager.add(this)),super._set(e,r))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,r){this[e]!==r&&(this._fireSelectionChanged(),this[e]=r),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,r,n)}setSelectionStyles(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,r,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,r)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const r=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=r,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const r=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),s=n.length>0;let i,a=e;if(s){i=Ni(e.canvas),a=i.getContext("2d"),Hk(a,this.canvas);const l=this.calcTransformMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(a,r):this.renderCursor(a,r),s)for(const l of n){const c=l.clipPath,u=Ni(e.canvas),d=u.getContext("2d");if(Hk(d,this.canvas),!c.absolutePositioned){const h=l.calcTransformMatrix();d.transform(h[0],h[1],h[2],h[3],h[4],h[5])}c.transform(d),c.drawObject(d,!0,{}),this.drawClipPathOnCache(a,c,u)}s&&(e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let r=this;for(;r;)r.clipPath&&e.push(r),r=r.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,r);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,r){return r?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let r=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let u=0;u<i;u++)r+=this.getHeightOfLine(u);const a=this._getLineLeftOffset(i),l=this.__charBounds[i][s];l&&(n=l.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const c={top:r,left:a+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Hr||this.textAlign===za||this.textAlign===zm?c.left*=-1:this.textAlign===rr||this.textAlign===Lx?c.left=a-(n>0?n:0):this.textAlign!==Tt&&this.textAlign!==$m||(c.left=a-(n>0?n:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,r){this._renderCursor(e,r,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,a=this.getValueOfPropertyAt(s,i,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,u=this.getValueOfPropertyAt(s,i,"deltaY"),d=r.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:r.left+r.leftOffset-c/2,top:d+r.top+u,width:c,height:a}}_renderCursor(e,r,n){const{color:s,opacity:i,left:a,top:l,width:c,height:u}=this.getCursorRenderingData(n,r);e.fillStyle=s,e.globalAlpha=i,e.fillRect(a,l,c,u)}renderSelection(e,r){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,r)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const r=this.getSelectionStartFromPointer(e);this.renderCursorAt(r)}_renderSelection(e,r,n){const s=r.selectionStart,i=r.selectionEnd,a=this.textAlign.includes(za),l=this.get2DCursorLocation(s),c=this.get2DCursorLocation(i),u=l.lineIndex,d=c.lineIndex,h=l.charIndex<0?0:l.charIndex,f=c.charIndex<0?0:c.charIndex;for(let m=u;m<=d;m++){const p=this._getLineLeftOffset(m)||0;let v=this.getHeightOfLine(m),b=0,x=0,w=0;if(m===u&&(x=this.__charBounds[u][h].left),m>=u&&m<d)w=a&&!this.isEndOfWrapping(m)?this.width:this.getLineWidth(m)||5;else if(m===d)if(f===0)w=this.__charBounds[d][f].left;else{const P=this._getWidthOfCharSpacing();w=this.__charBounds[d][f-1].left+this.__charBounds[d][f-1].width-P}b=v,(this.lineHeight<1||m===d&&this.lineHeight>1)&&(v/=this.lineHeight);let _=n.left+p+x,S=v,N=0;const E=w-x;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",S=1,N=v):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Hr||this.textAlign===za||this.textAlign===zm?_=this.width-_-E:this.textAlign===rr||this.textAlign===Lx?_=n.left+p-w:this.textAlign!==Tt&&this.textAlign!==$m||(_=n.left+p-w)),e.fillRect(_,n.top+n.topOffset+N,E,S),n.topOffset+=b}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,mn)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),r=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:r}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}ce(Po,"ownDefaults",OZ),ce(Po,"type","IText"),et.setClass(Po),et.setClass(Po,"i-text");class Zc extends Po{static getDefaults(){return pe(pe({},super.getDefaults()),Zc.ownDefaults)}constructor(e,r){super(e,pe(pe({},Zc.ownDefaults),r))}static createControls(){return{controls:cJ()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(za)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let r=0,n=0,s=0;const i={};for(let a=0;a<e.graphemeLines.length;a++)e.graphemeText[s]===`
`&&a>0?(n=0,s++,r++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:r,offset:n},s+=e.graphemeLines[a].length,n+=e.graphemeLines[a].length;return i}styleHas(e,r){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[r];n&&(r=n.line)}return super.styleHas(e,r)}isEmptyStyles(e){if(!this.styles)return!0;let r,n=0,s=e+1,i=!1;const a=this._styleMap[e],l=this._styleMap[e+1];a&&(e=a.line,n=a.offset),l&&(s=l.line,i=s===e,r=l.offset);const c=e===void 0?this.styles:{line:this.styles[e]};for(const u in c)for(const d in c[u]){const h=parseInt(d,10);if(h>=n&&(!i||h<r))for(const f in c[u][d])return!1}return!0}_getStyleDeclaration(e,r){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,r=n.offset+r}return super._getStyleDeclaration(e,r)}_setStyleDeclaration(e,r,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+r,n)}_deleteStyleDeclaration(e,r){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+r)}_getLineStyle(e){const r=this._styleMap[e];return!!this.styles[r.line]}_setLineStyle(e){const r=this._styleMap[e];super._setLineStyle(r.line)}_wrapText(e,r){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,r,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const r=this.splitByGrapheme,n=r?"":" ";let s=0;return{wordsData:e.map((i,a)=>{let l=0;const c=r?this.graphemeSplit(i):this.wordSplit(i);return c.length===0?[{word:[],width:0}]:c.map(u=>{const d=r?[u]:this.graphemeSplit(u),h=this._measureWord(d,a,l);return s=Math.max(h,s),l+=d.length+n.length,{word:d,width:h}})}),largestWordWidth:s}}_measureWord(e,r){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let a=0,l=e.length;a<l;a++)i+=this._getGraphemeBox(e[a],r,a+s,n,!0).kernedWidth,n=e[a];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,r,n){let{largestWordWidth:s,wordsData:i}=n,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const l=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,u=[],d=c?"":" ";let h=0,f=[],m=0,p=0,v=!0;r-=a;const b=Math.max(r,s,this.dynamicMinWidth),x=i[e];let w;for(m=0,w=0;w<x.length;w++){const{word:_,width:S}=x[w];m+=_.length,h+=p+S-l,h>b&&!v?(u.push(f),f=[],h=S,v=!0):h+=l,v||c||f.push(d),f=f.concat(_),p=c?0:this._measureWord([d],e,m),m++,v=!1}return w&&u.push(f),s+a>this.dynamicMinWidth&&(this.dynamicMinWidth=s-l+a),u}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,r){return this.splitByGrapheme&&!r?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const r=super._splitTextIntoLines(e),n=this._wrapText(r.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return r.lines=s,r.graphemeLines=n,r}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const r in this._styleMap){const n=parseInt(r,10);if(this._textLines[n]){const s=this._styleMap[r].line;e.set("".concat(s),!0)}}for(const r in this.styles)e.has(r)||delete this.styles[r]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}ce(Zc,"type","Textbox"),ce(Zc,"textLayoutProperties",[...Po.textLayoutProperties,"width"]),ce(Zc,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),et.setClass(Zc);class Gk extends G1{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,r){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:a,height:l}=Oo(sM(n,s)),c=new Ne(a,l);if(s.absolutePositioned)return{center:ch(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:c};{const u=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:d=new Ne,correction:h=new Ne}=this.calcBoundingBox(r,e)||{};return{center:d.add(u),correction:h.subtract(u),size:c}}return{center:n.getRelativeCenterPoint().add(u),size:c}}}}ce(Gk,"type","clip-path"),et.setClass(Gk);class Yk extends G1{getInitialSize(e,r){let{target:n}=e,{size:s}=r;return new Ne(n.width||s.x,n.height||s.y)}}ce(Yk,"type","fixed"),et.setClass(Yk);class MZ extends _p{subscribeTargets(e){const r=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[r]})})}unsubscribeTargets(e){const r=e.target,n=r.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[r]})})}}class eu extends du{static getDefaults(){return pe(pe({},super.getDefaults()),eu.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,eu.ownDefaults),this.setOptions(r);const{left:n,top:s,layoutManager:i}=r;this.groupInit(e,{left:n,top:s,layoutManager:i??new MZ})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...r):r.forEach(s=>{const i=this._objects.findIndex(l=>l.isInFrontOf(s)),a=i===-1?this.size():i;this.insertAt(a,s)})}canEnterGroup(e){return this.getObjects().some(r=>r.isDescendantOf(e)||e.isDescendantOf(r))?(uc("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,r){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,r)}exitGroup(e,r){this._exitGroup(e,r),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,r){super._onAfterObjectsChange(e,r);const n=new Set;r.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===qj?n.forEach(s=>{s._onAfterObjectsChange(Ox,r)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,r,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=pe(pe({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,r),e.restore()}}ce(eu,"type","ActiveSelection"),ce(eu,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),et.setClass(eu),et.setClass(eu,"activeSelection");class RZ{constructor(){ce(this,"resources",{})}applyFilters(e,r,n,s,i){const a=i.getContext("2d");if(!a)return;a.drawImage(r,0,0,n,s);const l={sourceWidth:n,sourceHeight:s,imageData:a.getImageData(0,0,n,s),originalEl:r,originalImageData:a.getImageData(0,0,n,s),canvasEl:i,ctx:a,filterBackend:this};e.forEach(u=>{u.applyTo(l)});const{imageData:c}=l;return c.width===n&&c.height===s||(i.width=c.width,i.height=c.height),a.putImageData(c,0,0),l}}class wM{constructor(){let{tileSize:e=Xt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ce(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),ce(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,r){this.dispose(),this.createWebGLCanvas(e,r)}createWebGLCanvas(e,r){const n=Ni({width:e,height:r}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,r,n,s,i,a){const l=this.gl,c=i.getContext("2d");if(!l||!c)return;let u;a&&(u=this.getCachedTexture(a,r));const d={originalWidth:r.width||r.naturalWidth||0,originalHeight:r.height||r.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:l,sourceTexture:this.createTexture(l,n,s,u?void 0:r),targetTexture:this.createTexture(l,n,s),originalTexture:u||this.createTexture(l,n,s,u?void 0:r),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},h=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,h),e.forEach(f=>{f&&f.applyTo(d)}),function(f){const m=f.targetCanvas,p=m.width,v=m.height,b=f.destinationWidth,x=f.destinationHeight;p===b&&v===x||(m.width=b,m.height=x)}(d),this.copyGLTo2D(l,d),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(d.sourceTexture),l.deleteTexture(d.targetTexture),l.deleteFramebuffer(h),c.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,r,n,s,i){const{NEAREST:a,TEXTURE_2D:l,RGBA:c,UNSIGNED_BYTE:u,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:h,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:m,TEXTURE_WRAP_T:p}=e,v=e.createTexture();return e.bindTexture(l,v),e.texParameteri(l,h,i||a),e.texParameteri(l,f,i||a),e.texParameteri(l,m,d),e.texParameteri(l,p,d),s?e.texImage2D(l,0,c,c,u,s):e.texImage2D(l,0,c,r,n,0,c,u,null),v}getCachedTexture(e,r,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,r.width,r.height,r,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,r){const n=e.canvas,s=r.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const a=n.height-s.height;i.drawImage(n,0,a,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,r){const n=r.targetCanvas.getContext("2d"),s=r.destinationWidth,i=r.destinationHeight,a=s*i*4;if(!n)return;const l=new Uint8Array(this.imageBuffer,0,a),c=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,l);const u=new ImageData(c,s,i);n.putImageData(u,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,r={renderer:"",vendor:""};if(!e)return r;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(r.renderer=s.toLowerCase()),i&&(r.vendor=i.toLowerCase())}return this.gpuInfo=r,r}}let K2;function DZ(){const{WebGLProbe:t}=Ja();return t.queryWebGL(Ho()),Xt.enableGLFiltering&&t.isSupported(Xt.textureSize)?new wM({tileSize:Xt.textureSize}):new RZ}function Q2(){return!K2&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(K2=DZ()),K2}const FZ=["filters","resizeFilter","src","crossOrigin","type"],_M=["cropX","cropY"];class Hn extends Xn{static getDefaults(){return pe(pe({},super.getDefaults()),Hn.ownDefaults)}constructor(e,r){super(),ce(this,"_lastScaleX",1),ce(this,"_lastScaleY",1),ce(this,"_filterScalingX",1),ce(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Hn.ownDefaults),this.setOptions(r),this.cacheKey="texture".concat(dc()),this.setElement(typeof e=="string"?(this.canvas&&Zi(this.canvas.getElement())||gf()).getElementById(e):e,r)}getElement(){return this._element}setElement(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(r=e.classList)===null||r===void 0||r.add(Hn.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const r=Q2(!1);r instanceof wM&&r.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const r=this[e];r&&Ja().dispose(r),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const r=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-r,-n),e.lineTo(r,-n),e.lineTo(r,n),e.lineTo(-r,n),e.lineTo(-r,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const r=[];return this.filters.forEach(n=>{n&&r.push(n.toObject())}),pe(pe({},super.toObject([..._M,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:r},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],r=this._element,n=-this.width/2,s=-this.height/2;let i=[],a=[],l="",c="";if(!r)return[];if(this.hasCrop()){const u=dc();i.push('<clipPath id="imageCrop_'+u+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+u+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(r.width||r.naturalWidth,'" height="').concat(r.height||r.naturalHeight,'"').concat(c).concat(l,`></image>
`)),this.stroke||this.strokeDashArray){const u=this.fill;this.fill=null,a=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=u}return i=this.paintFirst!==mn?i.concat(a,e):i.concat(e,a),i}getSrc(e){const r=e?this._element:this._originalElement;return r?r.toDataURL?r.toDataURL():this.srcFromAttribute?r.getAttribute("src")||"":r.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:r,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Sv(e,{crossOrigin:r,signal:n}).then(s=>{r!==void 0&&this.set({crossOrigin:r}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,r=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>r&&i>r)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const l=Ni(a),{width:c,height:u}=a;this._element=l,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,Q2().applyFilters([e],a,c,u,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const r=this._originalElement,n=r.naturalWidth||r.width,s=r.naturalHeight||r.height;if(this._element===this._originalElement){const i=Ni({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);Q2().applyFilters(e,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const r=this._element;if(!r)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,l=Math.max(this.cropX,0),c=Math.max(this.cropY,0),u=r.naturalWidth||r.width,d=r.naturalHeight||r.height,h=l*n,f=c*s,m=Math.min(i*n,u-h),p=Math.min(a*s,d-f),v=-i/2,b=-a/2,x=Math.min(i,u/n-l),w=Math.min(a,d/s-c);r&&e.drawImage(r,h,f,m,p,v,b,x,w)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=r||n.height}parsePreserveAspectRatioAttribute(){const e=kQ(this.preserveAspectRatio||""),r=this.width,n=this.height,s={width:r,height:n};let i,a=this._element.width,l=this._element.height,c=1,u=1,d=0,h=0,f=0,m=0;return!e||e.alignX===As&&e.alignY===As?(c=r/a,u=n/l):(e.meetOrSlice==="meet"&&(c=u=UJ(this._element,s),i=(r-a*c)/2,e.alignX==="Min"&&(d=-i),e.alignX==="Max"&&(d=i),i=(n-l*u)/2,e.alignY==="Min"&&(h=-i),e.alignY==="Max"&&(h=i)),e.meetOrSlice==="slice"&&(c=u=VJ(this._element,s),i=a-r/c,e.alignX==="Mid"&&(f=i/2),e.alignX==="Max"&&(f=i),i=l-n/u,e.alignY==="Mid"&&(m=i/2),e.alignY==="Max"&&(m=i),a=r/c,l=n/u)),{width:a,height:l,scaleX:c,scaleY:u,offsetLeft:d,offsetTop:h,cropX:f,cropY:m}}static fromObject(e,r){let{filters:n,resizeFilter:s,src:i,crossOrigin:a,type:l}=e,c=Er(e,FZ);return Promise.all([Sv(i,pe(pe({},r),{},{crossOrigin:a})),n&&xp(n,r),s&&xp([s],r),U1(c,r)]).then(u=>{let[d,h=[],[f]=[],m={}]=u;return new this(d,pe(pe({},c),{},{src:i,filters:h,resizeFilter:f},m))})}static fromURL(e){let{crossOrigin:r=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Sv(e,{crossOrigin:r,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=Jo(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"]||s.href,r,s).catch(i=>(uc("log","Unable to parse Image",i),null))}}ce(Hn,"type","Image"),ce(Hn,"cacheProperties",[...Qo,..._M]),ce(Hn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),ce(Hn,"CSS_CANVAS","canvas-img"),ce(Hn,"ATTRIBUTE_NAMES",[...jc,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),et.setClass(Hn),et.setSVGClass(Hn);W1(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const X1=t=>t.webgl!==void 0,Uj="precision highp float",IZ=`
    `.concat(Uj,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),zZ=["type"],$Z=["type"],BZ=new RegExp(Uj,"g");class pn{get type(){return this.constructor.type}constructor(){let e=Er(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},zZ);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return IZ}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Ja();s!=="highp"&&(r=r.replace(BZ,Uj.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER),l=e.createProgram();if(!i||!a||!l)throw new Ba("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Ba("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(a,r),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new Ba("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.attachShader(l,i),e.attachShader(l,a),e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS))throw new Ba('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(l)));const c=this.getUniformLocations(e,l)||{};return c.uStepW=e.getUniformLocation(l,"uStepW"),c.uStepH=e.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(e,l),uniformLocations:c}}getAttributeLocations(e,r){return{aPosition:e.getAttribLocation(r,"aPosition")}}getUniformLocations(e,r){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(r,n[i]);return s}sendAttributeData(e,r,n){const s=r.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const r=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(r.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(r,n,s)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.targetTexture,0)}else r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish()}_swapTextures(e){e.passes--,e.pass++;const r=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=r}isNeutralState(e){return!1}applyTo(e){X1(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const r=this.getCacheKey();return e.programCache[r]||(e.programCache[r]=this.createProgram(e.context)),e.programCache[r]}applyToWebGL(e){const r=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?r.bindTexture(r.TEXTURE_2D,e.originalTexture):r.bindTexture(r.TEXTURE_2D,e.sourceTexture),r.useProgram(n.program),this.sendAttributeData(r,n.attributeLocations,e.aPosition),r.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),r.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(r,n.uniformLocations),r.viewport(0,0,e.destinationWidth,e.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,r,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,r),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,r){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:r,sourceHeight:n}=e,s=Ni({width:r,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return pe({type:this.type},e.reduce((r,n)=>(r[n]=this[n],r),{}))}toJSON(){return this.toObject()}static async fromObject(e,r){return new this(Er(e,$Z))}}ce(pn,"type","BaseFilter"),ce(pn,"uniformLocations",[]);const qZ={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class M0 extends pn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(qZ[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:r}}=e;const n=new Os(this.color).getSource(),s=this.alpha,i=n[0]*s,a=n[1]*s,l=n[2]*s,c=1-s;for(let u=0;u<r.length;u+=4){const d=r[u],h=r[u+1],f=r[u+2];let m,p,v;switch(this.mode){case"multiply":m=d*i/255,p=h*a/255,v=f*l/255;break;case"screen":m=255-(255-d)*(255-i)/255,p=255-(255-h)*(255-a)/255,v=255-(255-f)*(255-l)/255;break;case"add":m=d+i,p=h+a,v=f+l;break;case"difference":m=Math.abs(d-i),p=Math.abs(h-a),v=Math.abs(f-l);break;case"subtract":m=d-i,p=h-a,v=f-l;break;case"darken":m=Math.min(d,i),p=Math.min(h,a),v=Math.min(f,l);break;case"lighten":m=Math.max(d,i),p=Math.max(h,a),v=Math.max(f,l);break;case"overlay":m=i<128?2*d*i/255:255-2*(255-d)*(255-i)/255,p=a<128?2*h*a/255:255-2*(255-h)*(255-a)/255,v=l<128?2*f*l/255:255-2*(255-f)*(255-l)/255;break;case"exclusion":m=i+d-2*i*d/255,p=a+h-2*a*h/255,v=l+f-2*l*f/255;break;case"tint":m=i+d*c,p=a+h*c,v=l+f*c}r[u]=m,r[u+1]=p,r[u+2]=v}}sendUniformData(e,r){const n=new Os(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(r.uColor,n)}}ce(M0,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),ce(M0,"type","BlendColor"),ce(M0,"uniformLocations",["uColor"]),et.setClass(M0);const UZ={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},VZ=["type","image"];class R0 extends pn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return UZ[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const r=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(r,n,r.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(r,r.TEXTURE1)}createTexture(e,r){return e.getCachedTexture(r.cacheKey,r.getElement())}calculateMatrix(){const e=this.image,{width:r,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/r,-e.top/n,1]}applyTo2d(e){let{imageData:{data:r,width:n,height:s},filterBackend:{resources:i}}=e;const a=this.image;i.blendImage||(i.blendImage=Ho());const l=i.blendImage,c=l.getContext("2d");l.width!==n||l.height!==s?(l.width=n,l.height=s):c.clearRect(0,0,n,s),c.setTransform(a.scaleX,0,0,a.scaleY,a.left,a.top),c.drawImage(a.getElement(),0,0,n,s);const u=c.getImageData(0,0,n,s).data;for(let d=0;d<r.length;d+=4){const h=r[d],f=r[d+1],m=r[d+2],p=r[d+3],v=u[d],b=u[d+1],x=u[d+2],w=u[d+3];switch(this.mode){case"multiply":r[d]=h*v/255,r[d+1]=f*b/255,r[d+2]=m*x/255,r[d+3]=p*w/255;break;case"mask":r[d+3]=w}}}sendUniformData(e,r){const n=this.calculateMatrix();e.uniform1i(r.uImage,1),e.uniformMatrix3fv(r.uTransformMatrix,!1,n)}toObject(){return pe(pe({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,r){let{type:n,image:s}=e,i=Er(e,VZ);return Hn.fromObject(s,r).then(a=>new this(pe(pe({},i),{},{image:a})))}}ce(R0,"type","BlendImage"),ce(R0,"defaults",{mode:"multiply",alpha:1}),ce(R0,"uniformLocations",["uTransformMatrix","uImage"]),et.setClass(R0);class D0 extends pn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){X1(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:r,width:n,height:s}}=e;this.aspectRatio=n/s,this.horizontal=!0;let i=this.getBlurValue()*n;const a=new Uint8ClampedArray(r),l=15,c=4*n;for(let u=0;u<r.length;u+=4){let d=0,h=0,f=0,m=0,p=0;const v=u-u%c,b=v+c;for(let x=-14;x<l;x++){const w=x/l,_=4*Math.floor(i*w),S=1-Math.abs(w);let N=u+_;N<v?N=v:N>b&&(N=b);const E=r[N+3]*S;d+=r[N]*E,h+=r[N+1]*E,f+=r[N+2]*E,m+=E,p+=S}a[u]=d/m,a[u+1]=h/m,a[u+2]=f/m,a[u+3]=m/p}this.horizontal=!1,i=this.getBlurValue()*s;for(let u=0;u<a.length;u+=4){let d=0,h=0,f=0,m=0,p=0;const v=u%c,b=a.length-c+v;for(let x=-14;x<l;x++){const w=x/l,_=Math.floor(i*w)*c,S=1-Math.abs(w);let N=u+_;N<v?N=v:N>b&&(N=b);const E=a[N+3]*S;d+=a[N]*E,h+=a[N+1]*E,f+=a[N+2]*E,m+=E,p+=S}r[u]=d/m,r[u+1]=h/m,r[u+2]=f/m,r[u+3]=m/p}}sendUniformData(e,r){const n=this.chooseRightDelta();e.uniform2fv(r.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:r,aspectRatio:n}=this;return r?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}ce(D0,"type","Blur"),ce(D0,"defaults",{blur:0}),ce(D0,"uniformLocations",["uDelta"]),et.setClass(D0);class F0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<r.length;s+=4)r[s]+=n,r[s+1]+=n,r[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,r){e.uniform1f(r.uBrightness,this.brightness)}}ce(F0,"type","Brightness"),ce(F0,"defaults",{brightness:0}),ce(F0,"uniformLocations",["uBrightness"]),et.setClass(F0);const jM={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Hd extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const r=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<r.length;i+=4){const a=r[i],l=r[i+1],c=r[i+2];if(r[i]=a*n[0]+l*n[1]+c*n[2]+255*n[4],r[i+1]=a*n[5]+l*n[6]+c*n[7]+255*n[9],r[i+2]=a*n[10]+l*n[11]+c*n[12]+255*n[14],!s){const u=r[i+3];r[i]+=u*n[3],r[i+1]+=u*n[8],r[i+2]+=u*n[13],r[i+3]=a*n[15]+l*n[16]+c*n[17]+u*n[18]+255*n[19]}}}sendUniformData(e,r){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(r.uColorMatrix,!1,s),e.uniform4fv(r.uConstants,i)}toObject(){return pe(pe({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ru(t,e){var r;const n=(ce(r=class extends Hd{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",t),ce(r,"defaults",{colorsOnly:!1,matrix:e}),r);return et.setClass(n,t),n}ce(Hd,"type","ColorMatrix"),ce(Hd,"defaults",jM),ce(Hd,"uniformLocations",["uColorMatrix","uConstants"]),et.setClass(Hd);Ru("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Ru("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Ru("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Ru("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Ru("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Ru("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Ru("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Xk extends pn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){X1(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(r=>{r.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,r){return Promise.all((e.subFilters||[]).map(n=>et.getClass(n.type).fromObject(n,r))).then(n=>new this({subFilters:n}))}}ce(Xk,"type","Composed"),et.setClass(Xk);class I0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:r}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<r.length;i+=4)r[i]=s*(r[i]-128)+128,r[i+1]=s*(r[i+1]-128)+128,r[i+2]=s*(r[i+2]-128)+128}sendUniformData(e,r){e.uniform1f(r.uContrast,this.contrast)}}ce(I0,"type","Contrast"),ce(I0,"defaults",{contrast:0}),ce(I0,"uniformLocations",["uContrast"]),et.setClass(I0);const WZ={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class z0 extends pn{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return WZ[this.getCacheKey()]}applyTo2d(e){const r=e.imageData,n=r.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),a=Math.floor(i/2),l=r.width,c=r.height,u=e.ctx.createImageData(l,c),d=u.data,h=this.opaque?1:0;let f,m,p,v,b,x,w,_,S,N,E,P,A;for(E=0;E<c;E++)for(N=0;N<l;N++){for(b=4*(E*l+N),f=0,m=0,p=0,v=0,A=0;A<i;A++)for(P=0;P<i;P++)w=E+A-a,x=N+P-a,w<0||w>=c||x<0||x>=l||(_=4*(w*l+x),S=s[A*i+P],f+=n[_]*S,m+=n[_+1]*S,p+=n[_+2]*S,h||(v+=n[_+3]*S));d[b]=f,d[b+1]=m,d[b+2]=p,d[b+3]=h?n[b+3]:v}e.imageData=u}sendUniformData(e,r){e.uniform1fv(r.uMatrix,this.matrix)}toObject(){return pe(pe({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}ce(z0,"type","Convolute"),ce(z0,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),ce(z0,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),et.setClass(z0);const SM="Gamma";class $0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:r}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],a=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const l=this.rgbValues;for(let c=0;c<256;c++)l.r[c]=255*Math.pow(c/255,s),l.g[c]=255*Math.pow(c/255,i),l.b[c]=255*Math.pow(c/255,a);for(let c=0;c<r.length;c+=4)r[c]=l.r[r[c]],r[c+1]=l.g[r[c+1]],r[c+2]=l.b[r[c+2]]}sendUniformData(e,r){e.uniform3fv(r.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:SM,gamma:this.gamma.concat()}}}ce($0,"type",SM),ce($0,"defaults",{gamma:[1,1,1]}),ce($0,"uniformLocations",["uGamma"]),et.setClass($0);const HZ={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class B0 extends pn{applyTo2d(e){let{imageData:{data:r}}=e;for(let n,s=0;s<r.length;s+=4){const i=r[s],a=r[s+1],l=r[s+2];switch(this.mode){case"average":n=(i+a+l)/3;break;case"lightness":n=(Math.min(i,a,l)+Math.max(i,a,l))/2;break;case"luminosity":n=.21*i+.72*a+.07*l}r[s+2]=r[s+1]=r[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return HZ[this.mode]}sendUniformData(e,r){e.uniform1i(r.uMode,1)}isNeutralState(){return!1}}ce(B0,"type","Grayscale"),ce(B0,"defaults",{mode:"average"}),ce(B0,"uniformLocations",["uMode"]),et.setClass(B0);const GZ=pe(pe({},jM),{},{rotation:0});class J2 extends Hd{calculateMatrix(){const e=this.rotation*Math.PI,r=Vo(e),n=Wo(e),s=1/3,i=Math.sqrt(s)*n,a=1-r;this.matrix=[r+a/3,s*a-i,s*a+i,0,0,s*a+i,r+s*a,s*a-i,0,0,s*a-i,s*a+i,r+s*a,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}ce(J2,"type","HueRotation"),ce(J2,"defaults",GZ),et.setClass(J2);class q0 extends pn{applyTo2d(e){let{imageData:{data:r}}=e;for(let n=0;n<r.length;n+=4)r[n]=255-r[n],r[n+1]=255-r[n+1],r[n+2]=255-r[n+2],this.alpha&&(r[n+3]=255-r[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,r){e.uniform1i(r.uInvert,Number(this.invert)),e.uniform1i(r.uAlpha,Number(this.alpha))}}ce(q0,"type","Invert"),ce(q0,"defaults",{alpha:!1,invert:!0}),ce(q0,"uniformLocations",["uInvert","uAlpha"]),et.setClass(q0);class U0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=this.noise;for(let s=0;s<r.length;s+=4){const i=(.5-Math.random())*n;r[s]+=i,r[s+1]+=i,r[s+2]+=i}}sendUniformData(e,r){e.uniform1f(r.uNoise,this.noise/255),e.uniform1f(r.uSeed,Math.random())}isNeutralState(){return this.noise===0}}ce(U0,"type","Noise"),ce(U0,"defaults",{noise:0}),ce(U0,"uniformLocations",["uNoise","uSeed"]),et.setClass(U0);class V0 extends pn{applyTo2d(e){let{imageData:{data:r,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let a=0;a<n;a+=this.blocksize){const l=4*i*n+4*a,c=r[l],u=r[l+1],d=r[l+2],h=r[l+3];for(let f=i;f<Math.min(i+this.blocksize,s);f++)for(let m=a;m<Math.min(a+this.blocksize,n);m++){const p=4*f*n+4*m;r[p]=c,r[p+1]=u,r[p+2]=d,r[p+3]=h}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,r){e.uniform1f(r.uBlocksize,this.blocksize)}}ce(V0,"type","Pixelate"),ce(V0,"defaults",{blocksize:4}),ce(V0,"uniformLocations",["uBlocksize"]),et.setClass(V0);class W0 extends pn{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=255*this.distance,s=new Os(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],a=[s[0]+n,s[1]+n,s[2]+n];for(let l=0;l<r.length;l+=4){const c=r[l],u=r[l+1],d=r[l+2];c>i[0]&&u>i[1]&&d>i[2]&&c<a[0]&&u<a[1]&&d<a[2]&&(r[l+3]=0)}}sendUniformData(e,r){const n=new Os(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],a=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(r.uLow,i),e.uniform4fv(r.uHigh,a)}}ce(W0,"type","RemoveColor"),ce(W0,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),ce(W0,"uniformLocations",["uLow","uHigh"]),et.setClass(W0);class H0 extends pn{sendUniformData(e,r){e.uniform2fv(r.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(r.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),r=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*r);return s}generateShader(e){const r=new Array(e);for(let n=1;n<=e;n++)r[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(r.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){X1(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return r=>{if(r>=e||r<=-e)return 0;if(r<11920929e-14&&r>-11920929e-14)return 1;const n=(r*=Math.PI)/e;return Math.sin(r)/r*Math.sin(n)/n}}applyTo2d(e){const r=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=r.width,a=r.height,l=Math.round(i*n),c=Math.round(a*s);let u;u=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,a,l,c):this.resizeType==="hermite"?this.hermiteFastResize(e,i,a,l,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,a,l,c):this.resizeType==="lanczos"?this.lanczosResize(e,i,a,l,c):new ImageData(l,c),e.imageData=u}sliceByTwo(e,r,n,s,i){const a=e.imageData,l=.5;let c=!1,u=!1,d=r*l,h=n*l;const f=e.filterBackend.resources;let m=0,p=0;const v=r;let b=0;f.sliceByTwo||(f.sliceByTwo=Ho());const x=f.sliceByTwo;(x.width<1.5*r||x.height<n)&&(x.width=1.5*r,x.height=n);const w=x.getContext("2d");for(w.clearRect(0,0,1.5*r,n),w.putImageData(a,0,0),s=Math.floor(s),i=Math.floor(i);!c||!u;)r=d,n=h,s<Math.floor(d*l)?d=Math.floor(d*l):(d=s,c=!0),i<Math.floor(h*l)?h=Math.floor(h*l):(h=i,u=!0),w.drawImage(x,m,p,r,n,v,b,d,h),m=v,p=b,b+=h;return w.getImageData(m,p,s,i)}lanczosResize(e,r,n,s,i){const a=e.imageData.data,l=e.ctx.createImageData(s,i),c=l.data,u=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,h=this.rcpScaleY,f=2/this.rcpScaleX,m=2/this.rcpScaleY,p=Math.ceil(d*this.lanczosLobes/2),v=Math.ceil(h*this.lanczosLobes/2),b={},x={x:0,y:0},w={x:0,y:0};return function _(S){let N,E,P,A,F,Y,T,O,U,q,Z;for(x.x=(S+.5)*d,w.x=Math.floor(x.x),N=0;N<i;N++){for(x.y=(N+.5)*h,w.y=Math.floor(x.y),F=0,Y=0,T=0,O=0,U=0,E=w.x-p;E<=w.x+p;E++)if(!(E<0||E>=r)){q=Math.floor(1e3*Math.abs(E-x.x)),b[q]||(b[q]={});for(let H=w.y-v;H<=w.y+v;H++)H<0||H>=n||(Z=Math.floor(1e3*Math.abs(H-x.y)),b[q][Z]||(b[q][Z]=u(Math.sqrt(Math.pow(q*f,2)+Math.pow(Z*m,2))/1e3)),P=b[q][Z],P>0&&(A=4*(H*r+E),F+=P,Y+=P*a[A],T+=P*a[A+1],O+=P*a[A+2],U+=P*a[A+3]))}A=4*(N*s+S),c[A]=Y/F,c[A+1]=T/F,c[A+2]=O/F,c[A+3]=U/F}return++S<s?_(S):l}(0)}bilinearFiltering(e,r,n,s,i){let a,l,c,u,d,h,f,m,p,v,b,x,w,_=0;const S=this.rcpScaleX,N=this.rcpScaleY,E=4*(r-1),P=e.imageData.data,A=e.ctx.createImageData(s,i),F=A.data;for(f=0;f<i;f++)for(m=0;m<s;m++)for(d=Math.floor(S*m),h=Math.floor(N*f),p=S*m-d,v=N*f-h,w=4*(h*r+d),b=0;b<4;b++)a=P[w+b],l=P[w+4+b],c=P[w+E+b],u=P[w+E+4+b],x=a*(1-p)*(1-v)+l*p*(1-v)+c*v*(1-p)+u*p*v,F[_++]=x;return A}hermiteFastResize(e,r,n,s,i){const a=this.rcpScaleX,l=this.rcpScaleY,c=Math.ceil(a/2),u=Math.ceil(l/2),d=e.imageData.data,h=e.ctx.createImageData(s,i),f=h.data;for(let m=0;m<i;m++)for(let p=0;p<s;p++){const v=4*(p+m*s);let b=0,x=0,w=0,_=0,S=0,N=0,E=0;const P=(m+.5)*l;for(let A=Math.floor(m*l);A<(m+1)*l;A++){const F=Math.abs(P-(A+.5))/u,Y=(p+.5)*a,T=F*F;for(let O=Math.floor(p*a);O<(p+1)*a;O++){let U=Math.abs(Y-(O+.5))/c;const q=Math.sqrt(T+U*U);q>1&&q<-1||(b=2*q*q*q-3*q*q+1,b>0&&(U=4*(O+A*r),E+=b*d[U+3],w+=b,d[U+3]<255&&(b=b*d[U+3]/250),_+=b*d[U],S+=b*d[U+1],N+=b*d[U+2],x+=b))}}f[v]=_/x,f[v+1]=S/x,f[v+2]=N/x,f[v+3]=E/w}return h}}ce(H0,"type","Resize"),ce(H0,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),ce(H0,"uniformLocations",["uDelta","uTaps"]),et.setClass(H0);class G0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=-this.saturation;for(let s=0;s<r.length;s+=4){const i=r[s],a=r[s+1],l=r[s+2],c=Math.max(i,a,l);r[s]+=c!==i?(c-i)*n:0,r[s+1]+=c!==a?(c-a)*n:0,r[s+2]+=c!==l?(c-l)*n:0}}sendUniformData(e,r){e.uniform1f(r.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}ce(G0,"type","Saturation"),ce(G0,"defaults",{saturation:0}),ce(G0,"uniformLocations",["uSaturation"]),et.setClass(G0);class Y0 extends pn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:r}}=e;const n=-this.vibrance;for(let s=0;s<r.length;s+=4){const i=r[s],a=r[s+1],l=r[s+2],c=Math.max(i,a,l),u=(i+a+l)/3,d=2*Math.abs(c-u)/255*n;r[s]+=c!==i?(c-i)*d:0,r[s+1]+=c!==a?(c-a)*d:0,r[s+2]+=c!==l?(c-l)*d:0}}sendUniformData(e,r){e.uniform1f(r.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}ce(Y0,"type","Vibrance"),ce(Y0,"defaults",{vibrance:0}),ce(Y0,"uniformLocations",["uVibrance"]),et.setClass(Y0);function YZ(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function XZ(t,e=[]){let r=[];function n(i,a){const l=y.createContext(a),c=r.length;r=[...r,a];const u=h=>{var x;const{scope:f,children:m,...p}=h,v=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,b=y.useMemo(()=>p,Object.values(p));return o.jsx(v.Provider,{value:b,children:m})};u.displayName=i+"Provider";function d(h,f){var v;const m=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,p=y.useContext(m);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=r.map(a=>y.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return y.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[n,KZ(s,...e)]}function KZ(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return y.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}var Sp=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},QZ=Lp[" useInsertionEffect ".trim().toString()]||Sp;function JZ({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,i,a]=ZZ({defaultProp:e,onChange:r}),l=t!==void 0,c=l?t:s;{const d=y.useRef(t!==void 0);y.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=y.useCallback(d=>{var h;if(l){const f=eee(d)?d(t):d;f!==t&&((h=a.current)==null||h.call(a,f))}else i(d)},[l,t,i,a]);return[c,u]}function ZZ({defaultProp:t,onChange:e}){const[r,n]=y.useState(t),s=y.useRef(r),i=y.useRef(e);return QZ(()=>{i.current=e},[e]),y.useEffect(()=>{var a;s.current!==r&&((a=i.current)==null||a.call(i,r),s.current=r)},[r,s]),[r,n,i]}function eee(t){return typeof t=="function"}function Kk(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function CM(...t){return e=>{let r=!1;const n=t.map(s=>{const i=Kk(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Kk(t[s],null)}}}}function NM(...t){return y.useCallback(CM(...t),t)}function tee(t){const e=ree(t),r=y.forwardRef((n,s)=>{const{children:i,...a}=n,l=y.Children.toArray(i),c=l.find(see);if(c){const u=c.props.children,d=l.map(h=>h===c?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:h);return o.jsx(e,{...a,ref:s,children:y.isValidElement(u)?y.cloneElement(u,void 0,d):null})}return o.jsx(e,{...a,ref:s,children:i})});return r.displayName=`${t}.Slot`,r}function ree(t){const e=y.forwardRef((r,n)=>{const{children:s,...i}=r;if(y.isValidElement(s)){const a=aee(s),l=iee(i,s.props);return s.type!==y.Fragment&&(l.ref=n?CM(n,a):a),y.cloneElement(s,l)}return y.Children.count(s)>1?y.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var nee=Symbol("radix.slottable");function see(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===nee}function iee(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function aee(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var oee=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Vj=oee.reduce((t,e)=>{const r=tee(`Primitive.${e}`),n=y.forwardRef((s,i)=>{const{asChild:a,...l}=s,c=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function lee(t,e){return y.useReducer((r,n)=>e[r][n]??r,t)}var kM=t=>{const{present:e,children:r}=t,n=cee(e),s=typeof r=="function"?r({present:n.isPresent}):y.Children.only(r),i=NM(n.ref,uee(s));return typeof r=="function"||n.isPresent?y.cloneElement(s,{ref:i}):null};kM.displayName="Presence";function cee(t){const[e,r]=y.useState(),n=y.useRef(null),s=y.useRef(t),i=y.useRef("none"),a=t?"mounted":"unmounted",[l,c]=lee(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=X0(n.current);i.current=l==="mounted"?u:"none"},[l]),Sp(()=>{const u=n.current,d=s.current;if(d!==t){const f=i.current,m=X0(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Sp(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const v=X0(n.current).includes(m.animationName);if(m.target===e&&v&&(c("ANIMATION_END"),!s.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},f=m=>{m.target===e&&(i.current=X0(n.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:y.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function X0(t){return(t==null?void 0:t.animationName)||"none"}function uee(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var dee=Lp[" useId ".trim().toString()]||(()=>{}),hee=0;function fee(t){const[e,r]=y.useState(dee());return Sp(()=>{t||r(n=>n??String(hee++))},[t]),t||(e?`radix-${e}`:"")}var K1="Collapsible",[mee,dse]=XZ(K1),[pee,Wj]=mee(K1),EM=y.forwardRef((t,e)=>{const{__scopeCollapsible:r,open:n,defaultOpen:s,disabled:i,onOpenChange:a,...l}=t,[c,u]=JZ({prop:n,defaultProp:s??!1,onChange:a,caller:K1});return o.jsx(pee,{scope:r,disabled:i,contentId:fee(),open:c,onOpenToggle:y.useCallback(()=>u(d=>!d),[u]),children:o.jsx(Vj.div,{"data-state":Gj(c),"data-disabled":i?"":void 0,...l,ref:e})})});EM.displayName=K1;var PM="CollapsibleTrigger",AM=y.forwardRef((t,e)=>{const{__scopeCollapsible:r,...n}=t,s=Wj(PM,r);return o.jsx(Vj.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Gj(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:YZ(t.onClick,s.onOpenToggle)})});AM.displayName=PM;var Hj="CollapsibleContent",TM=y.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=Wj(Hj,t.__scopeCollapsible);return o.jsx(kM,{present:r||s.open,children:({present:i})=>o.jsx(gee,{...n,ref:e,present:i})})});TM.displayName=Hj;var gee=y.forwardRef((t,e)=>{const{__scopeCollapsible:r,present:n,children:s,...i}=t,a=Wj(Hj,r),[l,c]=y.useState(n),u=y.useRef(null),d=NM(e,u),h=y.useRef(0),f=h.current,m=y.useRef(0),p=m.current,v=a.open||l,b=y.useRef(v),x=y.useRef(void 0);return y.useEffect(()=>{const w=requestAnimationFrame(()=>b.current=!1);return()=>cancelAnimationFrame(w)},[]),Sp(()=>{const w=u.current;if(w){x.current=x.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const _=w.getBoundingClientRect();h.current=_.height,m.current=_.width,b.current||(w.style.transitionDuration=x.current.transitionDuration,w.style.animationName=x.current.animationName),c(n)}},[a.open,n]),o.jsx(Vj.div,{"data-state":Gj(a.open),"data-disabled":a.disabled?"":void 0,id:a.contentId,hidden:!v,...i,ref:d,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...t.style},children:v&&s})});function Gj(t){return t?"open":"closed"}var vee=EM,xee=AM,yee=TM;const Gd=vee,Yd=xee,Xd=yee;var Yj="Popover",[LM,hse]=Ko(Yj,[hf]),Jp=hf(),[bee,Sc]=LM(Yj),OM=t=>{const{__scopePopover:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!1}=t,l=Jp(e),c=y.useRef(null),[u,d]=y.useState(!1),[h=!1,f]=ic({prop:n,defaultProp:s,onChange:i});return o.jsx(sj,{...l,children:o.jsx(bee,{scope:e,contentId:Ql(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:y.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:y.useCallback(()=>d(!0),[]),onCustomAnchorRemove:y.useCallback(()=>d(!1),[]),modal:a,children:r})})};OM.displayName=Yj;var MM="PopoverAnchor",wee=y.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Sc(MM,r),i=Jp(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:l}=s;return y.useEffect(()=>(a(),()=>l()),[a,l]),o.jsx(C1,{...i,...n,ref:e})});wee.displayName=MM;var RM="PopoverTrigger",DM=y.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Sc(RM,r),i=Jp(r),a=Lt(e,s.triggerRef),l=o.jsx(vt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":BM(s.open),...n,ref:a,onClick:ct(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:o.jsx(C1,{asChild:!0,...i,children:l})});DM.displayName=RM;var Xj="PopoverPortal",[_ee,jee]=LM(Xj,{forceMount:void 0}),FM=t=>{const{__scopePopover:e,forceMount:r,children:n,container:s}=t,i=Sc(Xj,e);return o.jsx(_ee,{scope:e,forceMount:r,children:o.jsx(ki,{present:r||i.open,children:o.jsx(m1,{asChild:!0,container:s,children:n})})})};FM.displayName=Xj;var Gh="PopoverContent",IM=y.forwardRef((t,e)=>{const r=jee(Gh,t.__scopePopover),{forceMount:n=r.forceMount,...s}=t,i=Sc(Gh,t.__scopePopover);return o.jsx(ki,{present:n||i.open,children:i.modal?o.jsx(See,{...s,ref:e}):o.jsx(Cee,{...s,ref:e})})});IM.displayName=Gh;var See=y.forwardRef((t,e)=>{const r=Sc(Gh,t.__scopePopover),n=y.useRef(null),s=Lt(e,n),i=y.useRef(!1);return y.useEffect(()=>{const a=n.current;if(a)return V_(a)},[]),o.jsx(g1,{as:ei,allowPinchZoom:!0,children:o.jsx(zM,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ct(t.onCloseAutoFocus,a=>{var l;a.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ct(t.onPointerDownOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:ct(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),Cee=y.forwardRef((t,e)=>{const r=Sc(Gh,t.__scopePopover),n=y.useRef(!1),s=y.useRef(!1);return o.jsx(zM,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=t.onCloseAutoFocus)==null||a.call(t,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),zM=y.forwardRef((t,e)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=t,f=Sc(Gh,r),m=Jp(r);return U_(),o.jsx(f1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(qp,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:o.jsx(ij,{"data-state":BM(f.open),role:"dialog",id:f.contentId,...m,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),$M="PopoverClose",Nee=y.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Sc($M,r);return o.jsx(vt.button,{type:"button",...n,ref:e,onClick:ct(t.onClick,()=>s.onOpenChange(!1))})});Nee.displayName=$M;var kee="PopoverArrow",Eee=y.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Jp(r);return o.jsx(aj,{...s,...n,ref:e})});Eee.displayName=kee;function BM(t){return t?"open":"closed"}var Pee=OM,Aee=DM,Tee=FM,qM=IM;const a5=Pee,o5=Aee,Fx=y.forwardRef(({className:t,align:e="center",sideOffset:r=4,...n},s)=>o.jsx(Tee,{children:o.jsx(qM,{ref:s,align:e,sideOffset:r,className:Be("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Fx.displayName=qM.displayName;const Qk=["#ff0000","#ff6600","#ffff00","#00ff00","#0000ff","#8000ff","#000000","#ffffff","#ff69b4","#00ffff","#ffa500","#808080"],Jk=({activeColor:t,onColorChange:e,compact:r=!1})=>{const[n,s]=y.useState(t),i=a=>{const l=a.target.value;s(l),e(l)};return r?o.jsxs(a5,{children:[o.jsx(o5,{asChild:!0,children:o.jsxs(J,{variant:"ghost",size:"sm",className:"w-full justify-start p-2",children:[o.jsx("div",{className:"w-4 h-4 rounded border mr-2",style:{backgroundColor:t}}),o.jsx("span",{className:"text-xs",children:"Couleur"})]})}),o.jsx(Fx,{className:"w-64 p-3",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(Ke,{className:"text-sm font-medium",children:"Couleurs"}),o.jsx("div",{className:"grid grid-cols-6 gap-2",children:Qk.map(a=>o.jsx("button",{className:`w-8 h-8 rounded-full border-2 transition-all ${t===a?"border-gray-800 scale-110":"border-gray-300 hover:scale-105"}`,style:{backgroundColor:a},onClick:()=>e(a),title:a},a))}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Ye,{type:"color",value:n,onChange:i,className:"w-12 h-8 p-1 border rounded flex-shrink-0"}),o.jsx(Ye,{type:"text",value:n,onChange:a=>i(a),placeholder:"#000000",className:"flex-1 text-xs"})]})]})})]}):o.jsxs(a5,{children:[o.jsx(o5,{asChild:!0,children:o.jsxs(J,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:["🎨",o.jsx("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:t}}),o.jsx("span",{className:"hidden sm:inline",children:"Couleur"})]})}),o.jsx(Fx,{className:"w-64 p-3",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(Ke,{className:"text-sm font-medium",children:"Couleurs prédéfinies"}),o.jsx("div",{className:"grid grid-cols-6 gap-2",children:Qk.map(a=>o.jsx("button",{className:`w-8 h-8 rounded-full border-2 transition-all ${t===a?"border-gray-800 scale-110":"border-gray-300 hover:scale-105"}`,style:{backgroundColor:a},onClick:()=>e(a),title:a},a))}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{className:"text-sm font-medium",children:"Couleur personnalisée"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Ye,{type:"color",value:n,onChange:i,className:"w-12 h-8 p-1 border rounded"}),o.jsx(Ye,{type:"text",value:n,onChange:a=>i(a),placeholder:"#000000",className:"flex-1 text-xs"})]})]})]})})]})},Lee=({activeTool:t,activeColor:e,brushSize:r,fontSize:n,onToolChange:s,onColorChange:i,onBrushSizeChange:a,onFontSizeChange:l,onUndo:c,onClear:u,onSave:d,onDownloadImage:h,onDownloadPDF:f,isSaving:m})=>{const[p,v]=Fe.useState(!0),[b,x]=Fe.useState(!1),[w,_]=Fe.useState(!1),[S,N]=Fe.useState(!1);return o.jsxs("div",{className:"bg-white border-b p-2 sm:p-4 space-y-3",children:[o.jsxs("div",{className:"block lg:hidden space-y-2",children:[o.jsxs(Gd,{open:p,onOpenChange:v,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"ghost",className:"w-full justify-between",children:[o.jsx("span",{className:"flex items-center gap-2",children:"✍️ Outils de dessin"}),p?o.jsx(Kc,{size:16}):o.jsx($a,{size:16})]})}),o.jsxs(Xd,{className:"space-y-2",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(J,{variant:t==="select"?"default":"outline",size:"sm",onClick:()=>s("select"),children:[o.jsx(ox,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Sélect"})]}),o.jsxs(J,{variant:t==="draw"?"default":"outline",size:"sm",onClick:()=>s("draw"),children:[o.jsx(cp,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Crayon"})]}),o.jsxs(J,{variant:t==="highlight"?"default":"outline",size:"sm",onClick:()=>s("highlight"),className:"bg-yellow-200 hover:bg-yellow-300 text-yellow-800",children:["✏️",o.jsx("span",{className:"ml-1 text-xs",children:"Surlig"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Jk,{activeColor:e,onColorChange:i}),o.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[o.jsx("span",{children:"Taille:"}),o.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:E=>a(parseInt(E.target.value)),className:"w-16"}),o.jsx("span",{className:"w-6",children:r})]})]})]})]}),o.jsxs(Gd,{open:b,onOpenChange:x,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"ghost",className:"w-full justify-between",children:[o.jsx("span",{className:"flex items-center gap-2",children:"🅰️ Texte & Notes"}),b?o.jsx(Kc,{size:16}):o.jsx($a,{size:16})]})}),o.jsxs(Xd,{className:"space-y-2",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(J,{variant:t==="text"?"default":"outline",size:"sm",onClick:()=>s("text"),children:[o.jsx(wu,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Texte"})]}),o.jsxs(J,{variant:t==="note"?"default":"outline",size:"sm",onClick:()=>s("note"),children:[o.jsx(qd,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Note"})]})]}),o.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[o.jsx("span",{children:"Police:"}),o.jsx("input",{type:"range",min:"12",max:"72",value:n,onChange:E=>l(parseInt(E.target.value)),className:"w-16"}),o.jsxs("span",{className:"w-8",children:[n,"px"]})]})]})]}),o.jsxs(Gd,{open:w,onOpenChange:_,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"ghost",className:"w-full justify-between",children:[o.jsx("span",{className:"flex items-center gap-2",children:"📐 Formes"}),w?o.jsx(Kc,{size:16}):o.jsx($a,{size:16})]})}),o.jsx(Xd,{children:o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(J,{variant:t==="circle"?"default":"outline",size:"sm",onClick:()=>s("circle"),children:[o.jsx(lp,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Cercle"})]}),o.jsxs(J,{variant:t==="rectangle"?"default":"outline",size:"sm",onClick:()=>s("rectangle"),children:[o.jsx(nc,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Rect"})]})]})})]}),o.jsxs(Gd,{open:S,onOpenChange:N,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"ghost",className:"w-full justify-between",children:[o.jsx("span",{className:"flex items-center gap-2",children:"🗑️ Actions"}),S?o.jsx(Kc,{size:16}):o.jsx($a,{size:16})]})}),o.jsx(Xd,{children:o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:c,children:[o.jsx(up,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Annuler"})]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:u,children:[o.jsx(cs,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Effacer"})]}),o.jsxs(J,{variant:"default",size:"sm",onClick:d,disabled:m,children:[o.jsx(Fh,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"Sauver"}),m&&o.jsx("span",{className:"ml-1",children:"..."})]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:h,children:[o.jsx(Pn,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"IMG"})]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:f,children:[o.jsx(os,{size:16}),o.jsx("span",{className:"ml-1 text-xs",children:"PDF"})]})]})})]})]}),o.jsxs("div",{className:"hidden lg:flex items-center gap-2 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(J,{variant:t==="select"?"default":"outline",size:"sm",onClick:()=>s("select"),title:"Sélectionner",children:o.jsx(ox,{size:16})}),o.jsx(J,{variant:t==="draw"?"default":"outline",size:"sm",onClick:()=>s("draw"),title:"Crayon",children:o.jsx(cp,{size:16})}),o.jsx(J,{variant:t==="highlight"?"default":"outline",size:"sm",onClick:()=>s("highlight"),title:"Surligneur",className:"bg-yellow-200 hover:bg-yellow-300 text-yellow-800",children:"✏️"}),o.jsx(J,{variant:t==="text"?"default":"outline",size:"sm",onClick:()=>s("text"),title:"Texte",children:o.jsx(wu,{size:16})}),o.jsx(J,{variant:t==="circle"?"default":"outline",size:"sm",onClick:()=>s("circle"),title:"Cercle",children:o.jsx(lp,{size:16})}),o.jsx(J,{variant:t==="rectangle"?"default":"outline",size:"sm",onClick:()=>s("rectangle"),title:"Rectangle",children:o.jsx(nc,{size:16})}),o.jsx(J,{variant:t==="note"?"default":"outline",size:"sm",onClick:()=>s("note"),title:"Ajouter une note",children:o.jsx(qd,{size:16})})]}),o.jsx(Qc,{orientation:"vertical",className:"h-6"}),o.jsx(Jk,{activeColor:e,onColorChange:i}),o.jsx(Qc,{orientation:"vertical",className:"h-6"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm",children:"Taille:"}),o.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:E=>a(parseInt(E.target.value)),className:"w-20"}),o.jsx("span",{className:"text-sm w-6",children:r})]}),o.jsx(Qc,{orientation:"vertical",className:"h-6"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm",children:"Police:"}),o.jsx("input",{type:"range",min:"12",max:"72",value:n,onChange:E=>l(parseInt(E.target.value)),className:"w-20"}),o.jsxs("span",{className:"text-sm w-8",children:[n,"px"]})]}),o.jsx(Qc,{orientation:"vertical",className:"h-6"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(J,{variant:"outline",size:"sm",onClick:c,title:"Annuler",children:o.jsx(up,{size:16})}),o.jsx(J,{variant:"outline",size:"sm",onClick:u,title:"Tout effacer",children:o.jsx(cs,{size:16})}),o.jsxs(J,{variant:"default",size:"sm",onClick:d,disabled:m,title:"Sauvegarder",children:[o.jsx(Fh,{size:16}),m&&o.jsx("span",{className:"ml-1",children:"..."})]}),o.jsx(J,{variant:"outline",size:"sm",onClick:h,title:"Télécharger image",children:o.jsx(Pn,{size:16})}),o.jsx(J,{variant:"outline",size:"sm",onClick:f,title:"Télécharger PDF",children:o.jsx(os,{size:16})})]})]})]})},UM=({notes:t,isAddingNote:e,onAddNote:r,onCancelNote:n})=>{const[s,i]=y.useState(""),[a,l]=y.useState(!1),c=()=>{s.trim()&&(r(s.trim()),i(""))},u=()=>{i(""),n()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"block lg:hidden",children:o.jsxs(Gd,{open:a,onOpenChange:l,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"outline",className:"w-full justify-between border-t rounded-t-none",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(qd,{size:20}),o.jsxs("span",{children:["Notes (",t.length,")"]})]}),a?o.jsx($a,{size:16}):o.jsx(Kc,{size:16})]})}),o.jsx(Xd,{className:"border-t bg-white",children:o.jsxs("div",{className:"p-4 max-h-64 overflow-y-auto",children:[e&&o.jsxs("div",{className:"mb-4 p-3 border rounded-lg bg-blue-50",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Ajouter une note"}),o.jsx(jr,{value:s,onChange:d=>i(d.target.value),placeholder:"Tapez votre note ici...",className:"mb-2",rows:2,autoFocus:!0}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(J,{size:"sm",onClick:c,disabled:!s.trim(),children:[o.jsx(rc,{size:16,className:"mr-1"}),"Ajouter"]}),o.jsxs(J,{size:"sm",variant:"outline",onClick:u,children:[o.jsx(qr,{size:16,className:"mr-1"}),"Annuler"]})]})]}),o.jsx("div",{className:"space-y-2",children:t.length===0?o.jsxs("div",{className:"text-center text-gray-500 py-4",children:[o.jsx(qd,{size:24,className:"mx-auto mb-2 opacity-30"}),o.jsx("p",{className:"text-sm",children:"Aucune note ajoutée"})]}):t.map((d,h)=>o.jsxs(Mt,{className:"text-sm",children:[o.jsx(er,{className:"pb-1",children:o.jsxs(ur,{className:"text-xs flex items-center gap-2",children:[o.jsx("span",{className:"w-5 h-5 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs",children:h+1}),"Note #",h+1]})}),o.jsxs(Rt,{className:"pt-0",children:[o.jsx("p",{className:"mb-1 text-xs",children:d.text}),o.jsx("div",{className:"text-xs text-gray-500",children:o.jsxs("div",{children:[d.author," - ",d.timestamp]})})]})]},d.id))})]})})]})}),o.jsxs("div",{className:"hidden lg:block w-80 border-l bg-white flex flex-col",children:[o.jsx("div",{className:"p-4 border-b",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(qd,{size:20}),o.jsx("h3",{className:"font-semibold",children:"Notes d'annotation"})]})}),e&&o.jsxs("div",{className:"p-4 border-b bg-blue-50",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Ajouter une note"}),o.jsx(jr,{value:s,onChange:d=>i(d.target.value),placeholder:"Tapez votre note ici...",className:"mb-2",rows:3,autoFocus:!0}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(J,{size:"sm",onClick:c,disabled:!s.trim(),children:[o.jsx(rc,{size:16,className:"mr-1"}),"Ajouter"]}),o.jsxs(J,{size:"sm",variant:"outline",onClick:u,children:[o.jsx(qr,{size:16,className:"mr-1"}),"Annuler"]})]})]}),o.jsx(ko,{className:"flex-1",children:o.jsx("div",{className:"p-4 space-y-3",children:t.length===0?o.jsxs("div",{className:"text-center text-gray-500 py-8",children:[o.jsx(qd,{size:48,className:"mx-auto mb-2 opacity-30"}),o.jsx("p",{children:"Aucune note ajoutée"}),o.jsx("p",{className:"text-sm",children:"Cliquez sur l'outil note puis sur l'image"})]}):t.map((d,h)=>o.jsxs(Mt,{className:"text-sm",children:[o.jsx(er,{className:"pb-2",children:o.jsxs(ur,{className:"text-sm flex items-center gap-2",children:[o.jsx("span",{className:"w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs",children:h+1}),"Note #",h+1]})}),o.jsxs(Rt,{className:"pt-0",children:[o.jsx("p",{className:"mb-2",children:d.text}),o.jsxs("div",{className:"text-xs text-gray-500",children:[o.jsxs("div",{children:["Par: ",d.author]}),o.jsxs("div",{children:["Le: ",d.timestamp]}),o.jsxs("div",{children:["Position: (",Math.round(d.x),", ",Math.round(d.y),")"]})]})]})]},d.id))})})]})]})};function or(t){"@babel/helpers - typeof";return or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(t)}var Yn=Uint8Array,Ys=Uint16Array,Kj=Int32Array,Q1=new Yn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),J1=new Yn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l5=new Yn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VM=function(t,e){for(var r=new Ys(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new Kj(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},WM=VM(Q1,2),HM=WM.b,c5=WM.r;HM[28]=258,c5[258]=28;var GM=VM(J1,0),Oee=GM.b,Zk=GM.r,u5=new Ys(32768);for(var Sr=0;Sr<32768;++Sr){var yl=(Sr&43690)>>1|(Sr&21845)<<1;yl=(yl&52428)>>2|(yl&13107)<<2,yl=(yl&61680)>>4|(yl&3855)<<4,u5[Sr]=((yl&65280)>>8|(yl&255)<<8)>>1}var Ha=function(t,e,r){for(var n=t.length,s=0,i=new Ys(e);s<n;++s)t[s]&&++i[t[s]-1];var a=new Ys(e);for(s=1;s<e;++s)a[s]=a[s-1]+i[s-1]<<1;var l;if(r){l=new Ys(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],d=e-t[s],h=a[t[s]-1]++<<d,f=h|(1<<d)-1;h<=f;++h)l[u5[h]>>c]=u}else for(l=new Ys(n),s=0;s<n;++s)t[s]&&(l[s]=u5[a[t[s]-1]++]>>15-t[s]);return l},hc=new Yn(288);for(var Sr=0;Sr<144;++Sr)hc[Sr]=8;for(var Sr=144;Sr<256;++Sr)hc[Sr]=9;for(var Sr=256;Sr<280;++Sr)hc[Sr]=7;for(var Sr=280;Sr<288;++Sr)hc[Sr]=8;var Cp=new Yn(32);for(var Sr=0;Sr<32;++Sr)Cp[Sr]=5;var Mee=Ha(hc,9,0),Ree=Ha(hc,9,1),Dee=Ha(Cp,5,0),Fee=Ha(Cp,5,1),Z2=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},$i=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},eb=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Qj=function(t){return(t+7)/8|0},YM=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Yn(t.subarray(e,r))},Iee=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Hi=function(t,e,r){var n=new Error(e||Iee[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Hi),!r)throw n;return n},zee=function(t,e,r,n){var s=t.length,i=0;if(!s||e.f&&!e.l)return r||new Yn(0);var a=!r,l=a||e.i!=2,c=e.i;a&&(r=new Yn(s*3));var u=function(Se){var Ae=r.length;if(Se>Ae){var Ee=new Yn(Math.max(Ae*2,Se));Ee.set(r),r=Ee}},d=e.f||0,h=e.p||0,f=e.b||0,m=e.l,p=e.d,v=e.m,b=e.n,x=s*8;do{if(!m){d=$i(t,h,1);var w=$i(t,h+1,3);if(h+=3,w)if(w==1)m=Ree,p=Fee,v=9,b=5;else if(w==2){var E=$i(t,h,31)+257,P=$i(t,h+10,15)+4,A=E+$i(t,h+5,31)+1;h+=14;for(var F=new Yn(A),Y=new Yn(19),T=0;T<P;++T)Y[l5[T]]=$i(t,h+T*3,7);h+=P*3;for(var O=Z2(Y),U=(1<<O)-1,q=Ha(Y,O,1),T=0;T<A;){var Z=q[$i(t,h,U)];h+=Z&15;var _=Z>>4;if(_<16)F[T++]=_;else{var H=0,Q=0;for(_==16?(Q=3+$i(t,h,3),h+=2,H=F[T-1]):_==17?(Q=3+$i(t,h,7),h+=3):_==18&&(Q=11+$i(t,h,127),h+=7);Q--;)F[T++]=H}}var R=F.subarray(0,E),B=F.subarray(E);v=Z2(R),b=Z2(B),m=Ha(R,v,1),p=Ha(B,b,1)}else Hi(1);else{var _=Qj(h)+4,S=t[_-4]|t[_-3]<<8,N=_+S;if(N>s){c&&Hi(0);break}l&&u(f+S),r.set(t.subarray(_,N),f),e.b=f+=S,e.p=h=N*8,e.f=d;continue}if(h>x){c&&Hi(0);break}}l&&u(f+131072);for(var X=(1<<v)-1,ie=(1<<b)-1,M=h;;M=h){var H=m[eb(t,h)&X],W=H>>4;if(h+=H&15,h>x){c&&Hi(0);break}if(H||Hi(2),W<256)r[f++]=W;else if(W==256){M=h,m=null;break}else{var K=W-254;if(W>264){var T=W-257,ne=Q1[T];K=$i(t,h,(1<<ne)-1)+HM[T],h+=ne}var se=p[eb(t,h)&ie],le=se>>4;se||Hi(3),h+=se&15;var B=Oee[le];if(le>3){var ne=J1[le];B+=eb(t,h)&(1<<ne)-1,h+=ne}if(h>x){c&&Hi(0);break}l&&u(f+131072);var ye=f+K;if(f<B){var oe=i-B,ve=Math.min(B,ye);for(oe+f<0&&Hi(3);f<ve;++f)r[f]=n[oe+f]}for(;f<ye;++f)r[f]=r[f-B]}}e.l=m,e.p=M,e.b=f,e.f=d,m&&(d=1,e.m=v,e.d=p,e.n=b)}while(!d);return f!=r.length&&a?YM(r,0,f):r.subarray(0,f)},go=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},fm=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},tb=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,i=r.slice();if(!s)return{t:KM,l:0};if(s==1){var a=new Yn(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(N,E){return N.f-E.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[h].f?u++:h++],c=r[u!=d&&r[u].f<r[h].f?u++:h++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<s;++n)i[n].s>f&&(f=i[n].s);var m=new Ys(f+1),p=d5(r[d-1],m,0);if(p>e){var n=0,v=0,b=p-e,x=1<<b;for(i.sort(function(E,P){return m[P.s]-m[E.s]||E.f-P.f});n<s;++n){var w=i[n].s;if(m[w]>e)v+=x-(1<<p-m[w]),m[w]=e;else break}for(v>>=b;v>0;){var _=i[n].s;m[_]<e?v-=1<<e-m[_]++-1:++n}for(;n>=0&&v;--n){var S=i[n].s;m[S]==e&&(--m[S],++v)}p=e}return{t:new Yn(m),l:p}},d5=function(t,e,r){return t.s==-1?Math.max(d5(t.l,e,r+1),d5(t.r,e,r+1)):e[t.s]=r},e4=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ys(++e),n=0,s=t[0],i=1,a=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=t[l]}return{c:r.subarray(0,n),n:e}},mm=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},XM=function(t,e,r){var n=r.length,s=Qj(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<n;++i)t[s+i+4]=r[i];return(s+4+n)*8},t4=function(t,e,r,n,s,i,a,l,c,u,d){go(e,d++,r),++s[256];for(var h=tb(s,15),f=h.t,m=h.l,p=tb(i,15),v=p.t,b=p.l,x=e4(f),w=x.c,_=x.n,S=e4(v),N=S.c,E=S.n,P=new Ys(19),A=0;A<w.length;++A)++P[w[A]&31];for(var A=0;A<N.length;++A)++P[N[A]&31];for(var F=tb(P,7),Y=F.t,T=F.l,O=19;O>4&&!Y[l5[O-1]];--O);var U=u+5<<3,q=mm(s,hc)+mm(i,Cp)+a,Z=mm(s,f)+mm(i,v)+a+14+3*O+mm(P,Y)+2*P[16]+3*P[17]+7*P[18];if(c>=0&&U<=q&&U<=Z)return XM(e,d,t.subarray(c,c+u));var H,Q,R,B;if(go(e,d,1+(Z<q)),d+=2,Z<q){H=Ha(f,m,0),Q=f,R=Ha(v,b,0),B=v;var X=Ha(Y,T,0);go(e,d,_-257),go(e,d+5,E-1),go(e,d+10,O-4),d+=14;for(var A=0;A<O;++A)go(e,d+3*A,Y[l5[A]]);d+=3*O;for(var ie=[w,N],M=0;M<2;++M)for(var W=ie[M],A=0;A<W.length;++A){var K=W[A]&31;go(e,d,X[K]),d+=Y[K],K>15&&(go(e,d,W[A]>>5&127),d+=W[A]>>12)}}else H=Mee,Q=hc,R=Dee,B=Cp;for(var A=0;A<l;++A){var ne=n[A];if(ne>255){var K=ne>>18&31;fm(e,d,H[K+257]),d+=Q[K+257],K>7&&(go(e,d,ne>>23&31),d+=Q1[K]);var se=ne&31;fm(e,d,R[se]),d+=B[se],se>3&&(fm(e,d,ne>>5&8191),d+=J1[se])}else fm(e,d,H[ne]),d+=Q[ne]}return fm(e,d,H[256]),d+Q[256]},$ee=new Kj([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),KM=new Yn(0),Bee=function(t,e,r,n,s,i){var a=i.z||t.length,l=new Yn(n+a+5*(1+Math.ceil(a/7e3))+s),c=l.subarray(n,l.length-s),u=i.l,d=(i.r||0)&7;if(e){d&&(c[0]=i.r>>3);for(var h=$ee[e-1],f=h>>13,m=h&8191,p=(1<<r)-1,v=i.p||new Ys(32768),b=i.h||new Ys(p+1),x=Math.ceil(r/3),w=2*x,_=function($e){return(t[$e]^t[$e+1]<<x^t[$e+2]<<w)&p},S=new Kj(25e3),N=new Ys(288),E=new Ys(32),P=0,A=0,F=i.i||0,Y=0,T=i.w||0,O=0;F+2<a;++F){var U=_(F),q=F&32767,Z=b[U];if(v[q]=Z,b[U]=q,T<=F){var H=a-F;if((P>7e3||Y>24576)&&(H>423||!u)){d=t4(t,c,0,S,N,E,A,Y,O,F-O,d),Y=P=A=0,O=F;for(var Q=0;Q<286;++Q)N[Q]=0;for(var Q=0;Q<30;++Q)E[Q]=0}var R=2,B=0,X=m,ie=q-Z&32767;if(H>2&&U==_(F-ie))for(var M=Math.min(f,H)-1,W=Math.min(32767,F),K=Math.min(258,H);ie<=W&&--X&&q!=Z;){if(t[F+R]==t[F+R-ie]){for(var ne=0;ne<K&&t[F+ne]==t[F+ne-ie];++ne);if(ne>R){if(R=ne,B=ie,ne>M)break;for(var se=Math.min(ie,ne-2),le=0,Q=0;Q<se;++Q){var ye=F-ie+Q&32767,oe=v[ye],ve=ye-oe&32767;ve>le&&(le=ve,Z=ye)}}}q=Z,Z=v[q],ie+=q-Z&32767}if(B){S[Y++]=268435456|c5[R]<<18|Zk[B];var Se=c5[R]&31,Ae=Zk[B]&31;A+=Q1[Se]+J1[Ae],++N[257+Se],++E[Ae],T=F+R,++P}else S[Y++]=t[F],++N[t[F]]}}for(F=Math.max(F,T);F<a;++F)S[Y++]=t[F],++N[t[F]];d=t4(t,c,u,S,N,E,A,Y,O,F-O,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=b,i.p=v,i.i=F,i.w=T)}else{for(var F=i.w||0;F<a+u;F+=65535){var Ee=F+65535;Ee>=a&&(c[d/8|0]=u,Ee=a),d=XM(c,d+1,t.subarray(F,Ee))}i.i=a}return YM(l,0,n+Qj(d)+s)},QM=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,i=r.length|0,a=0;a!=i;){for(var l=Math.min(a+2655,i);a<l;++a)s+=n+=r[a];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},qee=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new Yn(i.length+t.length);a.set(i),a.set(t,i.length),t=a,s.w=i.length}return Bee(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},JM=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Uee=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=QM();s.p(e.dictionary),JM(t,2,s.d())}},Vee=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Hi(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&Hi(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function h5(t,e){e||(e={});var r=QM();r.p(t);var n=qee(t,e,e.dictionary?6:2,4);return Uee(n,e),JM(n,n.length-4,r.d()),n}function Wee(t,e){return zee(t.subarray(Vee(t,e),-4),{i:2},e,e)}var Hee=typeof TextDecoder<"u"&&new TextDecoder,Gee=0;try{Hee.decode(KM,{stream:!0}),Gee=1}catch{}var mt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function rb(){mt.console&&typeof mt.console.log=="function"&&mt.console.log.apply(mt.console,arguments)}var fr={log:rb,warn:function(t){mt.console&&(typeof mt.console.warn=="function"?mt.console.warn.apply(mt.console,arguments):rb.call(null,arguments))},error:function(t){mt.console&&(typeof mt.console.error=="function"?mt.console.error.apply(mt.console,arguments):rb(t))}};function nb(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){qc(n.response,e,r)},n.onerror=function(){fr.error("could not download file")},n.send()}function r4(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function K0(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var qm,f5,qc=mt.saveAs||((typeof window>"u"?"undefined":or(window))!=="object"||window!==mt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=mt.URL||mt.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?r4(s.href)?nb(t,e,r):K0(s,s.target="_blank"):K0(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){K0(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(r4(t))nb(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){K0(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:or(i)!=="object"&&(fr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return nb(t,e,r);var s=t.type==="application/octet-stream",i=/constructor/i.test(mt.HTMLElement)||mt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||s&&i)&&(typeof FileReader>"u"?"undefined":or(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=a?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=mt.URL||mt.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function ZM(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,a=s.exec(t);a&&(e=i(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function sb(t,e){var r=t[0],n=t[1],s=t[2],i=t[3];r=zn(r,n,s,i,e[0],7,-680876936),i=zn(i,r,n,s,e[1],12,-389564586),s=zn(s,i,r,n,e[2],17,606105819),n=zn(n,s,i,r,e[3],22,-1044525330),r=zn(r,n,s,i,e[4],7,-176418897),i=zn(i,r,n,s,e[5],12,1200080426),s=zn(s,i,r,n,e[6],17,-1473231341),n=zn(n,s,i,r,e[7],22,-45705983),r=zn(r,n,s,i,e[8],7,1770035416),i=zn(i,r,n,s,e[9],12,-1958414417),s=zn(s,i,r,n,e[10],17,-42063),n=zn(n,s,i,r,e[11],22,-1990404162),r=zn(r,n,s,i,e[12],7,1804603682),i=zn(i,r,n,s,e[13],12,-40341101),s=zn(s,i,r,n,e[14],17,-1502002290),r=$n(r,n=zn(n,s,i,r,e[15],22,1236535329),s,i,e[1],5,-165796510),i=$n(i,r,n,s,e[6],9,-1069501632),s=$n(s,i,r,n,e[11],14,643717713),n=$n(n,s,i,r,e[0],20,-373897302),r=$n(r,n,s,i,e[5],5,-701558691),i=$n(i,r,n,s,e[10],9,38016083),s=$n(s,i,r,n,e[15],14,-660478335),n=$n(n,s,i,r,e[4],20,-405537848),r=$n(r,n,s,i,e[9],5,568446438),i=$n(i,r,n,s,e[14],9,-1019803690),s=$n(s,i,r,n,e[3],14,-187363961),n=$n(n,s,i,r,e[8],20,1163531501),r=$n(r,n,s,i,e[13],5,-1444681467),i=$n(i,r,n,s,e[2],9,-51403784),s=$n(s,i,r,n,e[7],14,1735328473),r=Bn(r,n=$n(n,s,i,r,e[12],20,-1926607734),s,i,e[5],4,-378558),i=Bn(i,r,n,s,e[8],11,-2022574463),s=Bn(s,i,r,n,e[11],16,1839030562),n=Bn(n,s,i,r,e[14],23,-35309556),r=Bn(r,n,s,i,e[1],4,-1530992060),i=Bn(i,r,n,s,e[4],11,1272893353),s=Bn(s,i,r,n,e[7],16,-155497632),n=Bn(n,s,i,r,e[10],23,-1094730640),r=Bn(r,n,s,i,e[13],4,681279174),i=Bn(i,r,n,s,e[0],11,-358537222),s=Bn(s,i,r,n,e[3],16,-722521979),n=Bn(n,s,i,r,e[6],23,76029189),r=Bn(r,n,s,i,e[9],4,-640364487),i=Bn(i,r,n,s,e[12],11,-421815835),s=Bn(s,i,r,n,e[15],16,530742520),r=qn(r,n=Bn(n,s,i,r,e[2],23,-995338651),s,i,e[0],6,-198630844),i=qn(i,r,n,s,e[7],10,1126891415),s=qn(s,i,r,n,e[14],15,-1416354905),n=qn(n,s,i,r,e[5],21,-57434055),r=qn(r,n,s,i,e[12],6,1700485571),i=qn(i,r,n,s,e[3],10,-1894986606),s=qn(s,i,r,n,e[10],15,-1051523),n=qn(n,s,i,r,e[1],21,-2054922799),r=qn(r,n,s,i,e[8],6,1873313359),i=qn(i,r,n,s,e[15],10,-30611744),s=qn(s,i,r,n,e[6],15,-1560198380),n=qn(n,s,i,r,e[13],21,1309151649),r=qn(r,n,s,i,e[4],6,-145523070),i=qn(i,r,n,s,e[11],10,-1120210379),s=qn(s,i,r,n,e[2],15,718787259),n=qn(n,s,i,r,e[9],21,-343485551),t[0]=ql(r,t[0]),t[1]=ql(n,t[1]),t[2]=ql(s,t[2]),t[3]=ql(i,t[3])}function Z1(t,e,r,n,s,i){return e=ql(ql(e,t),ql(n,i)),ql(e<<s|e>>>32-s,r)}function zn(t,e,r,n,s,i,a){return Z1(e&r|~e&n,t,e,s,i,a)}function $n(t,e,r,n,s,i,a){return Z1(e&n|r&~n,t,e,s,i,a)}function Bn(t,e,r,n,s,i,a){return Z1(e^r^n,t,e,s,i,a)}function qn(t,e,r,n,s,i,a){return Z1(r^(e|~n),t,e,s,i,a)}function e8(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)sb(n,Yee(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(sb(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,sb(n,s),n}function Yee(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}qm=mt.atob.bind(mt),f5=mt.btoa.bind(mt);var n4="0123456789abcdef".split("");function Xee(t){for(var e="",r=0;r<4;r++)e+=n4[t>>8*r+4&15]+n4[t>>8*r&15];return e}function Kee(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function m5(t){return e8(t).map(Kee).join("")}var Qee=function(t){for(var e=0;e<t.length;e++)t[e]=Xee(t[e]);return t.join("")}(e8("hello"))!="5d41402abc4b2a76b9719d911017c592";function ql(t,e){if(Qee){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function p5(t,e){var r,n,s,i;if(t!==r){for(var a=(s=t,i=1+(256/t.length>>0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+a.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var h=e.length,f=0,m=0,p="";for(c=0;c<h;c++)m=(m+(d=l[f=(f+1)%256]))%256,l[f]=l[m],l[m]=d,a=l[(l[f]+l[m])%256],p+=String.fromCharCode(e.charCodeAt(c)^a);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var s4={print:4,modify:8,copy:16,"annot-forms":32};function Ed(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(s4.perm!==void 0)throw new Error("Invalid permission: "+l);s+=s4[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),a=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^s)),this.encryptionKey=m5(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=p5(this.encryptionKey,this.padding)}function Pd(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?e+="#"+("0"+s.toString(16)).slice(-2):e+=t[n]}return e}function i4(t){if(or(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[r]){var a=e[r][i];try{a[0].apply(t,n)}catch(l){mt.console&&fr.error("jsPDF PubSub Error",l.message,l)}a[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ix(t){if(!(this instanceof Ix))return new Ix(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function t8(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Hc(t,e,r,n,s){if(!(this instanceof Hc))return new Hc(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,t8.call(this,n,s)}function Kd(t,e,r,n,s){if(!(this instanceof Kd))return new Kd(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,t8.call(this,n,s)}function ht(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],a=[],l=1,c=16,u="S",d=null;or(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,i=t.compress||t.compressPdf||i,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),a=t.filters||(i===!0?["FlateEncode"]:a),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,f={},m={internal:{},__private__:{}};m.__private__.PubSub=i4;var p="1.3",v=m.__private__.getPdfVersion=function(){return p};m.__private__.setPdfVersion=function(C){p=C};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return b};var x=m.__private__.getPageFormat=function(C){return b[C]};s=s||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},_=w.COMPAT;function S(){this.saveGraphicsState(),te(new dt(He,0,0,-He,0,tl()*He).toString()+" cm"),this.setFontSize(this.getFontSize()/He),u="n",_=w.ADVANCED}function N(){this.restoreGraphicsState(),u="S",_=w.COMPAT}var E=m.__private__.combineFontStyleAndFontWeight=function(C,I){if(C=="bold"&&I=="normal"||C=="bold"&&I==400||C=="normal"&&I=="italic"||C=="bold"&&I=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return I&&(C=I==400||I==="normal"?C==="italic"?"italic":"normal":I!=700&&I!=="bold"||C!=="normal"?(I==700?"bold":I)+""+C:"bold"),C};m.advancedAPI=function(C){var I=_===w.COMPAT;return I&&S.call(this),typeof C!="function"||(C(this),I&&N.call(this)),this},m.compatAPI=function(C){var I=_===w.ADVANCED;return I&&N.call(this),typeof C!="function"||(C(this),I&&S.call(this)),this},m.isAdvancedAPI=function(){return _===w.ADVANCED};var P,A=function(C){if(_!==w.ADVANCED)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=m.roundToPrecision=m.__private__.roundToPrecision=function(C,I){var re=e||I;if(isNaN(C)||isNaN(re))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(re).replace(/0+$/,"")};P=m.hpf=m.__private__.hpf=typeof c=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return F(C,c)}:c==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return F(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return F(C,16)};var Y=m.f2=m.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return F(C,2)},T=m.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return F(C,3)},O=m.scale=m.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return _===w.COMPAT?C*He:_===w.ADVANCED?C:void 0},U=function(C){return _===w.COMPAT?tl()-C:_===w.ADVANCED?C:void 0},q=function(C){return O(U(C))};m.__private__.setPrecision=m.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(e=parseInt(C,10))};var Z,H="00000000000000000000000000000000",Q=m.__private__.getFileId=function(){return H},R=m.__private__.setFileId=function(C){return H=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():H.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Rn=new Ed(d.userPermissions,d.userPassword,d.ownerPassword,H)),H};m.setFileId=function(C){return R(C),this},m.getFileId=function(){return Q()};var B=m.__private__.convertDateToPDFDate=function(C){var I=C.getTimezoneOffset(),re=I<0?"+":"-",ue=Math.floor(Math.abs(I/60)),be=Math.abs(I%60),ke=[re,K(ue),"'",K(be),"'"].join("");return["D:",C.getFullYear(),K(C.getMonth()+1),K(C.getDate()),K(C.getHours()),K(C.getMinutes()),K(C.getSeconds()),ke].join("")},X=m.__private__.convertPDFDateToDate=function(C){var I=parseInt(C.substr(2,4),10),re=parseInt(C.substr(6,2),10)-1,ue=parseInt(C.substr(8,2),10),be=parseInt(C.substr(10,2),10),ke=parseInt(C.substr(12,2),10),De=parseInt(C.substr(14,2),10);return new Date(I,re,ue,be,ke,De,0)},ie=m.__private__.setCreationDate=function(C){var I;if(C===void 0&&(C=new Date),C instanceof Date)I=B(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");I=C}return Z=I},M=m.__private__.getCreationDate=function(C){var I=Z;return C==="jsDate"&&(I=X(Z)),I};m.setCreationDate=function(C){return ie(C),this},m.getCreationDate=function(C){return M(C)};var W,K=m.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},ne=m.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},se=0,le=[],ye=[],oe=0,ve=[],Se=[],Ae=!1,Ee=ye,$e=function(){se=0,oe=0,ye=[],le=[],ve=[],so=Zr(),Ai=Zr()};m.__private__.setCustomOutputDestination=function(C){Ae=!0,Ee=C};var je=function(C){Ae||(Ee=C)};m.__private__.resetCustomOutputDestination=function(){Ae=!1,Ee=ye};var te=m.__private__.out=function(C){return C=C.toString(),oe+=C.length+1,Ee.push(C),Ee},it=m.__private__.write=function(C){return te(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},Qe=m.__private__.getArrayBuffer=function(C){for(var I=C.length,re=new ArrayBuffer(I),ue=new Uint8Array(re);I--;)ue[I]=C.charCodeAt(I);return re},Te=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Te};var ze=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(C){return ze=_===w.ADVANCED?C/He:C,this};var qe,Ue=m.__private__.getFontSize=m.getFontSize=function(){return _===w.COMPAT?ze:ze*He},nt=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(C){return nt=C,this},m.__private__.getR2L=m.getR2L=function(){return nt};var pt,yt=m.__private__.setZoomMode=function(C){var I=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))qe=C;else if(isNaN(C)){if(I.indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');qe=C}else qe=parseInt(C,10)};m.__private__.getZoomMode=function(){return qe};var jt,Et=m.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');pt=C};m.__private__.getPageMode=function(){return pt};var Kt=m.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');jt=C};m.__private__.getLayoutMode=function(){return jt},m.__private__.setDisplayMode=m.setDisplayMode=function(C,I,re){return yt(C),Kt(I),Et(re),this};var ot={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(C){if(Object.keys(ot).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ot[C]},m.__private__.getDocumentProperties=function(){return ot},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(C){for(var I in ot)ot.hasOwnProperty(I)&&C[I]&&(ot[I]=C[I]);return this},m.__private__.setDocumentProperty=function(C,I){if(Object.keys(ot).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ot[C]=I};var Pt,He,an,It,Rs,Qt={},Wt={},si=[],Ge={},Ht={},ft={},Rr={},Jr=null,dr=0,gt=[],Zt=new i4(m),Cc=t.hotfixes||[],Sn={},ya={},ba=[],dt=function C(I,re,ue,be,ke,De){if(!(this instanceof C))return new C(I,re,ue,be,ke,De);isNaN(I)&&(I=1),isNaN(re)&&(re=0),isNaN(ue)&&(ue=0),isNaN(be)&&(be=1),isNaN(ke)&&(ke=0),isNaN(De)&&(De=0),this._matrix=[I,re,ue,be,ke,De]};Object.defineProperty(dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dt.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(C)},dt.prototype.multiply=function(C){var I=C.sx*this.sx+C.shy*this.shx,re=C.sx*this.shy+C.shy*this.sy,ue=C.shx*this.sx+C.sy*this.shx,be=C.shx*this.shy+C.sy*this.sy,ke=C.tx*this.sx+C.ty*this.shx+this.tx,De=C.tx*this.shy+C.ty*this.sy+this.ty;return new dt(I,re,ue,be,ke,De)},dt.prototype.decompose=function(){var C=this.sx,I=this.shy,re=this.shx,ue=this.sy,be=this.tx,ke=this.ty,De=Math.sqrt(C*C+I*I),Xe=(C/=De)*re+(I/=De)*ue;re-=C*Xe,ue-=I*Xe;var at=Math.sqrt(re*re+ue*ue);return Xe/=at,C*(ue/=at)<I*(re/=at)&&(C=-C,I=-I,Xe=-Xe,De=-De),{scale:new dt(De,0,0,at,0,0),translate:new dt(1,0,0,1,be,ke),rotate:new dt(C,I,-I,C,0,0),skew:new dt(1,0,Xe,1,0,0)}},dt.prototype.toString=function(C){return this.join(" ")},dt.prototype.inversed=function(){var C=this.sx,I=this.shy,re=this.shx,ue=this.sy,be=this.tx,ke=this.ty,De=1/(C*ue-I*re),Xe=ue*De,at=-I*De,_t=-re*De,bt=C*De;return new dt(Xe,at,_t,bt,-Xe*be-_t*ke,-at*be-bt*ke)},dt.prototype.applyToPoint=function(C){var I=C.x*this.sx+C.y*this.shx+this.tx,re=C.x*this.shy+C.y*this.sy+this.ty;return new Ku(I,re)},dt.prototype.applyToRectangle=function(C){var I=this.applyToPoint(C),re=this.applyToPoint(new Ku(C.x+C.w,C.y+C.h));return new Of(I.x,I.y,re.x-I.x,re.y-I.y)},dt.prototype.clone=function(){var C=this.sx,I=this.shy,re=this.shx,ue=this.sy,be=this.tx,ke=this.ty;return new dt(C,I,re,ue,be,ke)},m.Matrix=dt;var Pi=m.matrixMult=function(C,I){return I.multiply(C)},wa=new dt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=wa;var fs=function(C,I){if(!Ht[C]){var re=(I instanceof Hc?"Sh":"P")+(Object.keys(Ge).length+1).toString(10);I.id=re,Ht[C]=re,Ge[re]=I,Zt.publish("addPattern",I)}};m.ShadingPattern=Hc,m.TilingPattern=Kd,m.addShadingPattern=function(C,I){return A("addShadingPattern()"),fs(C,I),this},m.beginTilingPattern=function(C){A("beginTilingPattern()"),vg(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},m.endTilingPattern=function(C,I){A("endTilingPattern()"),I.stream=Se[W].join(`
`),fs(C,I),Zt.publish("endTilingPattern",I),ba.pop().restore()};var on=m.__private__.newObject=function(){var C=Zr();return Ds(C,!0),C},Zr=m.__private__.newObjectDeferred=function(){return se++,le[se]=function(){return oe},se},Ds=function(C,I){return I=typeof I=="boolean"&&I,le[C]=oe,I&&te(C+" 0 obj"),C},Fu=m.__private__.newAdditionalObject=function(){var C={objId:Zr(),content:""};return ve.push(C),C},so=Zr(),Ai=Zr(),Ti=m.__private__.decodeColorString=function(C){var I=C.split(" ");if(I.length!==2||I[1]!=="g"&&I[1]!=="G")I.length===5&&(I[4]==="k"||I[4]==="K")&&(I=[(1-I[0])*(1-I[3]),(1-I[1])*(1-I[3]),(1-I[2])*(1-I[3]),"r"]);else{var re=parseFloat(I[0]);I=[re,re,re,"r"]}for(var ue="#",be=0;be<3;be++)ue+=("0"+Math.floor(255*parseFloat(I[be])).toString(16)).slice(-2);return ue},Li=m.__private__.encodeColorString=function(C){var I;typeof C=="string"&&(C={ch1:C});var re=C.ch1,ue=C.ch2,be=C.ch3,ke=C.ch4,De=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof re=="string"&&re.charAt(0)!=="#"){var Xe=new ZM(re);if(Xe.ok)re=Xe.toHex();else if(!/^\d*\.?\d*$/.test(re))throw new Error('Invalid color "'+re+'" passed to jsPDF.encodeColorString.')}if(typeof re=="string"&&/^#[0-9A-Fa-f]{3}$/.test(re)&&(re="#"+re[1]+re[1]+re[2]+re[2]+re[3]+re[3]),typeof re=="string"&&/^#[0-9A-Fa-f]{6}$/.test(re)){var at=parseInt(re.substr(1),16);re=at>>16&255,ue=at>>8&255,be=255&at}if(ue===void 0||ke===void 0&&re===ue&&ue===be)if(typeof re=="string")I=re+" "+De[0];else switch(C.precision){case 2:I=Y(re/255)+" "+De[0];break;case 3:default:I=T(re/255)+" "+De[0]}else if(ke===void 0||or(ke)==="object"){if(ke&&!isNaN(ke.a)&&ke.a===0)return I=["1.","1.","1.",De[1]].join(" ");if(typeof re=="string")I=[re,ue,be,De[1]].join(" ");else switch(C.precision){case 2:I=[Y(re/255),Y(ue/255),Y(be/255),De[1]].join(" ");break;default:case 3:I=[T(re/255),T(ue/255),T(be/255),De[1]].join(" ")}}else if(typeof re=="string")I=[re,ue,be,ke,De[2]].join(" ");else switch(C.precision){case 2:I=[Y(re),Y(ue),Y(be),Y(ke),De[2]].join(" ");break;case 3:default:I=[T(re),T(ue),T(be),T(ke),De[2]].join(" ")}return I},_a=m.__private__.getFilters=function(){return a},ii=m.__private__.putStream=function(C){var I=(C=C||{}).data||"",re=C.filters||_a(),ue=C.alreadyAppliedFilters||[],be=C.addLength1||!1,ke=I.length,De=C.objectId,Xe=function(Dn){return Dn};if(d!==null&&De===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Xe=Rn.encryptor(De,0));var at={};re===!0&&(re=["FlateEncode"]);var _t=C.additionalKeyValues||[],bt=(at=ht.API.processDataByFilters!==void 0?ht.API.processDataByFilters(I,re):{data:I,reverseChain:[]}).reverseChain+(Array.isArray(ue)?ue.join(" "):ue.toString());if(at.data.length!==0&&(_t.push({key:"Length",value:at.data.length}),be===!0&&_t.push({key:"Length1",value:ke})),bt.length!=0)if(bt.split("/").length-1==1)_t.push({key:"Filter",value:bt});else{_t.push({key:"Filter",value:"["+bt+"]"});for(var qt=0;qt<_t.length;qt+=1)if(_t[qt].key==="DecodeParms"){for(var Pr=[],Dr=0;Dr<at.reverseChain.split("/").length-1;Dr+=1)Pr.push("null");Pr.push(_t[qt].value),_t[qt].value="["+Pr.join(" ")+"]"}}te("<<");for(var en=0;en<_t.length;en++)te("/"+_t[en].key+" "+_t[en].value);te(">>"),at.data.length!==0&&(te("stream"),te(Xe(at.data)),te("endstream"))},ja=m.__private__.putPage=function(C){var I=C.number,re=C.data,ue=C.objId,be=C.contentsObjId;Ds(ue,!0),te("<</Type /Page"),te("/Parent "+C.rootDictionaryObjId+" 0 R"),te("/Resources "+C.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(P(C.mediaBox.bottomLeftX))+" "+parseFloat(P(C.mediaBox.bottomLeftY))+" "+P(C.mediaBox.topRightX)+" "+P(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&te("/CropBox ["+P(C.cropBox.bottomLeftX)+" "+P(C.cropBox.bottomLeftY)+" "+P(C.cropBox.topRightX)+" "+P(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&te("/BleedBox ["+P(C.bleedBox.bottomLeftX)+" "+P(C.bleedBox.bottomLeftY)+" "+P(C.bleedBox.topRightX)+" "+P(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&te("/TrimBox ["+P(C.trimBox.bottomLeftX)+" "+P(C.trimBox.bottomLeftY)+" "+P(C.trimBox.topRightX)+" "+P(C.trimBox.topRightY)+"]"),C.artBox!==null&&te("/ArtBox ["+P(C.artBox.bottomLeftX)+" "+P(C.artBox.bottomLeftY)+" "+P(C.artBox.topRightX)+" "+P(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&te("/UserUnit "+C.userUnit),Zt.publish("putPage",{objId:ue,pageContext:gt[I],pageNumber:I,page:re}),te("/Contents "+be+" 0 R"),te(">>"),te("endobj");var ke=re.join(`
`);return _===w.ADVANCED&&(ke+=`
Q`),Ds(be,!0),ii({data:ke,filters:_a(),objectId:be}),te("endobj"),ue},Nc=m.__private__.putPages=function(){var C,I,re=[];for(C=1;C<=dr;C++)gt[C].objId=Zr(),gt[C].contentsObjId=Zr();for(C=1;C<=dr;C++)re.push(ja({number:C,data:Se[C],objId:gt[C].objId,contentsObjId:gt[C].contentsObjId,mediaBox:gt[C].mediaBox,cropBox:gt[C].cropBox,bleedBox:gt[C].bleedBox,trimBox:gt[C].trimBox,artBox:gt[C].artBox,userUnit:gt[C].userUnit,rootDictionaryObjId:so,resourceDictionaryObjId:Ai}));Ds(so,!0),te("<</Type /Pages");var ue="/Kids [";for(I=0;I<dr;I++)ue+=re[I]+" 0 R ";te(ue+"]"),te("/Count "+dr),te(">>"),te("endobj"),Zt.publish("postPutPages")},Iu=function(C){Zt.publish("putFont",{font:C,out:te,newObject:on,putStream:ii}),C.isAlreadyPutted!==!0&&(C.objectNumber=on(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Pd(C.postScriptName)),te("/Subtype /Type1"),typeof C.encoding=="string"&&te("/Encoding /"+C.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},zu=function(){for(var C in Qt)Qt.hasOwnProperty(C)&&(h===!1||h===!0&&f.hasOwnProperty(C))&&Iu(Qt[C])},$u=function(C){C.objectNumber=on();var I=[];I.push({key:"Type",value:"/XObject"}),I.push({key:"Subtype",value:"/Form"}),I.push({key:"BBox",value:"["+[P(C.x),P(C.y),P(C.x+C.width),P(C.y+C.height)].join(" ")+"]"}),I.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var re=C.pages[1].join(`
`);ii({data:re,additionalKeyValues:I,objectId:C.objectNumber}),te("endobj")},Bu=function(){for(var C in Sn)Sn.hasOwnProperty(C)&&$u(Sn[C])},Zp=function(C,I){var re,ue=[],be=1/(I-1);for(re=0;re<1;re+=be)ue.push(re);if(ue.push(1),C[0].offset!=0){var ke={offset:0,color:C[0].color};C.unshift(ke)}if(C[C.length-1].offset!=1){var De={offset:1,color:C[C.length-1].color};C.push(De)}for(var Xe="",at=0,_t=0;_t<ue.length;_t++){for(re=ue[_t];re>C[at+1].offset;)at++;var bt=C[at].offset,qt=(re-bt)/(C[at+1].offset-bt),Pr=C[at].color,Dr=C[at+1].color;Xe+=ne(Math.round((1-qt)*Pr[0]+qt*Dr[0]).toString(16))+ne(Math.round((1-qt)*Pr[1]+qt*Dr[1]).toString(16))+ne(Math.round((1-qt)*Pr[2]+qt*Dr[2]).toString(16))}return Xe.trim()},ey=function(C,I){I||(I=21);var re=on(),ue=Zp(C.colors,I),be=[];be.push({key:"FunctionType",value:"0"}),be.push({key:"Domain",value:"[0.0 1.0]"}),be.push({key:"Size",value:"["+I+"]"}),be.push({key:"BitsPerSample",value:"8"}),be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ii({data:ue,additionalKeyValues:be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:re}),te("endobj"),C.objectNumber=on(),te("<< /ShadingType "+C.type),te("/ColorSpace /DeviceRGB");var ke="/Coords ["+P(parseFloat(C.coords[0]))+" "+P(parseFloat(C.coords[1]))+" ";C.type===2?ke+=P(parseFloat(C.coords[2]))+" "+P(parseFloat(C.coords[3])):ke+=P(parseFloat(C.coords[2]))+" "+P(parseFloat(C.coords[3]))+" "+P(parseFloat(C.coords[4]))+" "+P(parseFloat(C.coords[5])),te(ke+="]"),C.matrix&&te("/Matrix ["+C.matrix.toString()+"]"),te("/Function "+re+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},ty=function(C,I){var re=Zr(),ue=on();I.push({resourcesOid:re,objectOid:ue}),C.objectNumber=ue;var be=[];be.push({key:"Type",value:"/Pattern"}),be.push({key:"PatternType",value:"1"}),be.push({key:"PaintType",value:"1"}),be.push({key:"TilingType",value:"1"}),be.push({key:"BBox",value:"["+C.boundingBox.map(P).join(" ")+"]"}),be.push({key:"XStep",value:P(C.xStep)}),be.push({key:"YStep",value:P(C.yStep)}),be.push({key:"Resources",value:re+" 0 R"}),C.matrix&&be.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),ii({data:C.stream,additionalKeyValues:be,objectId:C.objectNumber}),te("endobj")},qu=function(C){var I;for(I in Ge)Ge.hasOwnProperty(I)&&(Ge[I]instanceof Hc?ey(Ge[I]):Ge[I]instanceof Kd&&ty(Ge[I],C))},eg=function(C){for(var I in C.objectNumber=on(),te("<<"),C)switch(I){case"opacity":te("/ca "+Y(C[I]));break;case"stroke-opacity":te("/CA "+Y(C[I]))}te(">>"),te("endobj")},ry=function(){var C;for(C in ft)ft.hasOwnProperty(C)&&eg(ft[C])},jf=function(){for(var C in te("/XObject <<"),Sn)Sn.hasOwnProperty(C)&&Sn[C].objectNumber>=0&&te("/"+C+" "+Sn[C].objectNumber+" 0 R");Zt.publish("putXobjectDict"),te(">>")},ny=function(){Rn.oid=on(),te("<<"),te("/Filter /Standard"),te("/V "+Rn.v),te("/R "+Rn.r),te("/U <"+Rn.toHexString(Rn.U)+">"),te("/O <"+Rn.toHexString(Rn.O)+">"),te("/P "+Rn.P),te(">>"),te("endobj")},tg=function(){for(var C in te("/Font <<"),Qt)Qt.hasOwnProperty(C)&&(h===!1||h===!0&&f.hasOwnProperty(C))&&te("/"+C+" "+Qt[C].objectNumber+" 0 R");te(">>")},sy=function(){if(Object.keys(Ge).length>0){for(var C in te("/Shading <<"),Ge)Ge.hasOwnProperty(C)&&Ge[C]instanceof Hc&&Ge[C].objectNumber>=0&&te("/"+C+" "+Ge[C].objectNumber+" 0 R");Zt.publish("putShadingPatternDict"),te(">>")}},Uu=function(C){if(Object.keys(Ge).length>0){for(var I in te("/Pattern <<"),Ge)Ge.hasOwnProperty(I)&&Ge[I]instanceof m.TilingPattern&&Ge[I].objectNumber>=0&&Ge[I].objectNumber<C&&te("/"+I+" "+Ge[I].objectNumber+" 0 R");Zt.publish("putTilingPatternDict"),te(">>")}},iy=function(){if(Object.keys(ft).length>0){var C;for(C in te("/ExtGState <<"),ft)ft.hasOwnProperty(C)&&ft[C].objectNumber>=0&&te("/"+C+" "+ft[C].objectNumber+" 0 R");Zt.publish("putGStateDict"),te(">>")}},Ur=function(C){Ds(C.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),tg(),sy(),Uu(C.objectOid),iy(),jf(),te(">>"),te("endobj")},rg=function(){var C=[];zu(),ry(),Bu(),qu(C),Zt.publish("putResources"),C.forEach(Ur),Ur({resourcesOid:Ai,objectOid:Number.MAX_SAFE_INTEGER}),Zt.publish("postPutResources")},ng=function(){Zt.publish("putAdditionalObjects");for(var C=0;C<ve.length;C++){var I=ve[C];Ds(I.objId,!0),te(I.content),te("endobj")}Zt.publish("postPutAdditionalObjects")},sg=function(C){Wt[C.fontName]=Wt[C.fontName]||{},Wt[C.fontName][C.fontStyle]=C.id},Sf=function(C,I,re,ue,be){var ke={id:"F"+(Object.keys(Qt).length+1).toString(10),postScriptName:C,fontName:I,fontStyle:re,encoding:ue,isStandardFont:be||!1,metadata:{}};return Zt.publish("addFont",{font:ke,instance:this}),Qt[ke.id]=ke,sg(ke),ke.id},ay=function(C){for(var I=0,re=Te.length;I<re;I++){var ue=Sf.call(this,C[I][0],C[I][1],C[I][2],Te[I][3],!0);h===!1&&(f[ue]=!0);var be=C[I][0].split("-");sg({id:ue,fontName:be[0],fontStyle:be[1]||""})}Zt.publish("addFonts",{fonts:Qt,dictionary:Wt})},Oi=function(C){return C.foo=function(){try{return C.apply(this,arguments)}catch(ue){var I=ue.stack||"";~I.indexOf(" at ")&&(I=I.split(" at ")[1]);var re="Error in function "+I.split(`
`)[0].split("<")[0]+": "+ue.message;if(!mt.console)throw new Error(re);mt.console.error(re,ue),mt.alert&&alert(re)}},C.foo.bar=C,C.foo},Vu=function(C,I){var re,ue,be,ke,De,Xe,at,_t,bt;if(be=(I=I||{}).sourceEncoding||"Unicode",De=I.outputEncoding,(I.autoencode||De)&&Qt[Pt].metadata&&Qt[Pt].metadata[be]&&Qt[Pt].metadata[be].encoding&&(ke=Qt[Pt].metadata[be].encoding,!De&&Qt[Pt].encoding&&(De=Qt[Pt].encoding),!De&&ke.codePages&&(De=ke.codePages[0]),typeof De=="string"&&(De=ke[De]),De)){for(at=!1,Xe=[],re=0,ue=C.length;re<ue;re++)(_t=De[C.charCodeAt(re)])?Xe.push(String.fromCharCode(_t)):Xe.push(C[re]),Xe[re].charCodeAt(0)>>8&&(at=!0);C=Xe.join("")}for(re=C.length;at===void 0&&re!==0;)C.charCodeAt(re-1)>>8&&(at=!0),re--;if(!at)return C;for(Xe=I.noBOM?[]:[254,255],re=0,ue=C.length;re<ue;re++){if((bt=(_t=C.charCodeAt(re))>>8)>>8)throw new Error("Character at position "+re+" of string '"+C+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Xe.push(bt),Xe.push(_t-(bt<<8))}return String.fromCharCode.apply(void 0,Xe)},ms=m.__private__.pdfEscape=m.pdfEscape=function(C,I){return Vu(C,I).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Cf=m.__private__.beginPage=function(C){Se[++dr]=[],gt[dr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},ag(dr),je(Se[W])},ig=function(C,I){var re,ue,be;switch(r=I||r,typeof C=="string"&&(re=x(C.toLowerCase()),Array.isArray(re)&&(ue=re[0],be=re[1])),Array.isArray(C)&&(ue=C[0]*He,be=C[1]*He),isNaN(ue)&&(ue=s[0],be=s[1]),(ue>14400||be>14400)&&(fr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ue=Math.min(14400,ue),be=Math.min(14400,be)),s=[ue,be],r.substr(0,1)){case"l":be>ue&&(s=[be,ue]);break;case"p":ue>be&&(s=[be,ue])}Cf(s),hg(Pf),te(Mi),Tf!==0&&te(Tf+" J"),Lf!==0&&te(Lf+" j"),Zt.publish("addPage",{pageNumber:dr})},oy=function(C){C>0&&C<=dr&&(Se.splice(C,1),gt.splice(C,1),dr--,W>dr&&(W=dr),this.setPage(W))},ag=function(C){C>0&&C<=dr&&(W=C)},ly=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Se.length-1},og=function(C,I,re){var ue,be=void 0;return re=re||{},C=C!==void 0?C:Qt[Pt].fontName,I=I!==void 0?I:Qt[Pt].fontStyle,ue=C.toLowerCase(),Wt[ue]!==void 0&&Wt[ue][I]!==void 0?be=Wt[ue][I]:Wt[C]!==void 0&&Wt[C][I]!==void 0?be=Wt[C][I]:re.disableWarning===!1&&fr.warn("Unable to look up font label for font '"+C+"', '"+I+"'. Refer to getFontList() for available fonts."),be||re.noFallback||(be=Wt.times[I])==null&&(be=Wt.times.normal),be},cy=m.__private__.putInfo=function(){var C=on(),I=function(ue){return ue};for(var re in d!==null&&(I=Rn.encryptor(C,0)),te("<<"),te("/Producer ("+ms(I("jsPDF "+ht.version))+")"),ot)ot.hasOwnProperty(re)&&ot[re]&&te("/"+re.substr(0,1).toUpperCase()+re.substr(1)+" ("+ms(I(ot[re]))+")");te("/CreationDate ("+ms(I(Z))+")"),te(">>"),te("endobj")},Nf=m.__private__.putCatalog=function(C){var I=(C=C||{}).rootDictionaryObjId||so;switch(on(),te("<<"),te("/Type /Catalog"),te("/Pages "+I+" 0 R"),qe||(qe="fullwidth"),qe){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var re=""+qe;re.substr(re.length-1)==="%"&&(qe=parseInt(qe)/100),typeof qe=="number"&&te("/OpenAction [3 0 R /XYZ null null "+Y(qe)+"]")}switch(jt||(jt="continuous"),jt){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}pt&&te("/PageMode /"+pt),Zt.publish("putCatalog"),te(">>"),te("endobj")},uy=m.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(se+1)),te("/Root "+se+" 0 R"),te("/Info "+(se-1)+" 0 R"),d!==null&&te("/Encrypt "+Rn.oid+" 0 R"),te("/ID [ <"+H+"> <"+H+"> ]"),te(">>")},dy=m.__private__.putHeader=function(){te("%PDF-"+p),te("%ºß¬à")},hy=m.__private__.putXRef=function(){var C="0000000000";te("xref"),te("0 "+(se+1)),te("0000000000 65535 f ");for(var I=1;I<=se;I++)typeof le[I]=="function"?te((C+le[I]()).slice(-10)+" 00000 n "):le[I]!==void 0?te((C+le[I]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},io=m.__private__.buildDocument=function(){$e(),je(ye),Zt.publish("buildDocument"),dy(),Nc(),ng(),rg(),d!==null&&ny(),cy(),Nf();var C=oe;return hy(),uy(),te("startxref"),te(""+C),te("%%EOF"),je(Se[W]),ye.join(`
`)},Wu=m.__private__.getBlob=function(C){return new Blob([Qe(C)],{type:"application/pdf"})},Hu=m.output=m.__private__.output=Oi(function(C,I){switch(typeof(I=I||{})=="string"?I={filename:I}:I.filename=I.filename||"generated.pdf",C){case void 0:return io();case"save":m.save(I.filename);break;case"arraybuffer":return Qe(io());case"blob":return Wu(io());case"bloburi":case"bloburl":if(mt.URL!==void 0&&typeof mt.URL.createObjectURL=="function")return mt.URL&&mt.URL.createObjectURL(Wu(io()))||void 0;fr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var re="",ue=io();try{re=f5(ue)}catch{re=f5(unescape(encodeURIComponent(ue)))}return"data:application/pdf;filename="+I.filename+";base64,"+re;case"pdfobjectnewwindow":if(Object.prototype.toString.call(mt)==="[object Window]"){var be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';I.pdfObjectUrl&&(be=I.pdfObjectUrl,ke="");var De='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+be+'"'+ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(I)+");<\/script></body></html>",Xe=mt.open();return Xe!==null&&Xe.document.write(De),Xe}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(mt)==="[object Window]"){var at='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(I.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+I.filename+'" width="500px" height="400px" /></body></html>',_t=mt.open();if(_t!==null){_t.document.write(at);var bt=this;_t.document.documentElement.querySelector("#pdfViewer").onload=function(){_t.document.title=I.filename,_t.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(bt.output("bloburl"))}}return _t}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(mt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",I)+'"></iframe></body></html>',Pr=mt.open();if(Pr!==null&&(Pr.document.write(qt),Pr.document.title=I.filename),Pr||typeof safari>"u")return Pr;break;case"datauri":case"dataurl":return mt.document.location.href=this.output("datauristring",I);default:return null}}),lg=function(C){return Array.isArray(Cc)===!0&&Cc.indexOf(C)>-1};switch(n){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=lg("px_scaling")==1?.75:96/72;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);He=n}var Rn=null;ie(),R();var fy=function(C){return d!==null?Rn.encryptor(C,0):function(I){return I}},cg=m.__private__.getPageInfo=m.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:gt[C].objId,pageNumber:C,pageContext:gt[C]}},xt=m.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var I in gt)if(gt[I].objId===C)break;return cg(I)},my=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:gt[W].objId,pageNumber:W,pageContext:gt[W]}};m.addPage=function(){return ig.apply(this,arguments),this},m.setPage=function(){return ag.apply(this,arguments),je.call(this,Se[W]),this},m.insertPage=function(C){return this.addPage(),this.movePage(W,C),this},m.movePage=function(C,I){var re,ue;if(C>I){re=Se[C],ue=gt[C];for(var be=C;be>I;be--)Se[be]=Se[be-1],gt[be]=gt[be-1];Se[I]=re,gt[I]=ue,this.setPage(I)}else if(C<I){re=Se[C],ue=gt[C];for(var ke=C;ke<I;ke++)Se[ke]=Se[ke+1],gt[ke]=gt[ke+1];Se[I]=re,gt[I]=ue,this.setPage(I)}return this},m.deletePage=function(){return oy.apply(this,arguments),this},m.__private__.text=m.text=function(C,I,re,ue,be){var ke,De,Xe,at,_t,bt,qt,Pr,Dr,en=(ue=ue||{}).scope||this;if(typeof C=="number"&&typeof I=="number"&&(typeof re=="string"||Array.isArray(re))){var Dn=re;re=I,I=C,C=Dn}if(arguments[3]instanceof dt?(A("The transform parameter of text() with a Matrix value"),Dr=be):(Xe=arguments[4],at=arguments[5],or(qt=arguments[3])==="object"&&qt!==null||(typeof Xe=="string"&&(at=Xe,Xe=null),typeof qt=="string"&&(at=qt,qt=null),typeof qt=="number"&&(Xe=qt,qt=null),ue={flags:qt,angle:Xe,align:at})),isNaN(I)||isNaN(re)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return en;var gn="",Ri=!1,Fs=typeof ue.lineHeightFactor=="number"?ue.lineHeightFactor:Ec,Na=en.internal.scaleFactor;function xg(mr){return mr=mr.split("	").join(Array(ue.TabLen||9).join(" ")),ms(mr,qt)}function Ff(mr){for(var pr,Wr=mr.concat(),ln=[],uo=Wr.length;uo--;)typeof(pr=Wr.shift())=="string"?ln.push(pr):Array.isArray(mr)&&(pr.length===1||pr[1]===void 0&&pr[2]===void 0)?ln.push(pr[0]):ln.push([pr[0],pr[1],pr[2]]);return ln}function If(mr,pr){var Wr;if(typeof mr=="string")Wr=pr(mr)[0];else if(Array.isArray(mr)){for(var ln,uo,Hf=mr.concat(),od=[],jg=Hf.length;jg--;)typeof(ln=Hf.shift())=="string"?od.push(pr(ln)[0]):Array.isArray(ln)&&typeof ln[0]=="string"&&(uo=pr(ln[0],ln[1],ln[2]),od.push([uo[0],uo[1],uo[2]]));Wr=od}return Wr}var Ju=!1,zf=!0;if(typeof C=="string")Ju=!0;else if(Array.isArray(C)){var $f=C.concat();De=[];for(var Zu,Cn=$f.length;Cn--;)(typeof(Zu=$f.shift())!="string"||Array.isArray(Zu)&&typeof Zu[0]!="string")&&(zf=!1);Ju=zf}if(Ju===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var ed=ze/en.internal.scaleFactor,td=ed*(Fs-1);switch(ue.baseline){case"bottom":re-=td;break;case"top":re+=ed-td;break;case"hanging":re+=ed-2*td;break;case"middle":re+=ed/2-td}if((bt=ue.maxWidth||0)>0&&(typeof C=="string"?C=en.splitTextToSize(C,bt):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(mr,pr){return mr.concat(en.splitTextToSize(pr,bt))},[]))),ke={text:C,x:I,y:re,options:ue,mutex:{pdfEscape:ms,activeFontKey:Pt,fonts:Qt,activeFontSize:ze}},Zt.publish("preProcessText",ke),C=ke.text,Xe=(ue=ke.options).angle,!(Dr instanceof dt)&&Xe&&typeof Xe=="number"){Xe*=Math.PI/180,ue.rotationDirection===0&&(Xe=-Xe),_===w.ADVANCED&&(Xe=-Xe);var rd=Math.cos(Xe),Bf=Math.sin(Xe);Dr=new dt(rd,Bf,-Bf,rd,0,0)}else Xe&&Xe instanceof dt&&(Dr=Xe);_!==w.ADVANCED||Dr||(Dr=wa),(_t=ue.charSpace||Xu)!==void 0&&(gn+=P(O(_t))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Pr=ue.horizontalScale)!==void 0&&(gn+=P(100*Pr)+` Tz
`),ue.lang;var ps=-1,Sy=ue.renderingMode!==void 0?ue.renderingMode:ue.stroke,qf=en.internal.getCurrentPageInfo().pageContext;switch(Sy){case 0:case!1:case"fill":ps=0;break;case 1:case!0:case"stroke":ps=1;break;case 2:case"fillThenStroke":ps=2;break;case 3:case"invisible":ps=3;break;case 4:case"fillAndAddForClipping":ps=4;break;case 5:case"strokeAndAddPathForClipping":ps=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ps=6;break;case 7:case"addToPathForClipping":ps=7}var yg=qf.usedRenderingMode!==void 0?qf.usedRenderingMode:-1;ps!==-1?gn+=ps+` Tr
`:yg!==-1&&(gn+=`0 Tr
`),ps!==-1&&(qf.usedRenderingMode=ps),at=ue.align||"left";var ai,nd=ze*Fs,bg=en.internal.pageSize.getWidth(),wg=Qt[Pt];_t=ue.charSpace||Xu,bt=ue.maxWidth||0,qt=Object.assign({autoencode:!0,noBOM:!0},ue.flags);var rl=[],Tc=function(mr){return en.getStringUnitWidth(mr,{font:wg,charSpace:_t,fontSize:ze,doKerning:!1})*ze/Na};if(Object.prototype.toString.call(C)==="[object Array]"){var gs;De=Ff(C),at!=="left"&&(ai=De.map(Tc));var Qn,nl=0;if(at==="right"){I-=ai[0],C=[],Cn=De.length;for(var oo=0;oo<Cn;oo++)oo===0?(Qn=Ca(I),gs=ao(re)):(Qn=O(nl-ai[oo]),gs=-nd),C.push([De[oo],Qn,gs]),nl=ai[oo]}else if(at==="center"){I-=ai[0]/2,C=[],Cn=De.length;for(var lo=0;lo<Cn;lo++)lo===0?(Qn=Ca(I),gs=ao(re)):(Qn=O((nl-ai[lo])/2),gs=-nd),C.push([De[lo],Qn,gs]),nl=ai[lo]}else if(at==="left"){C=[],Cn=De.length;for(var sd=0;sd<Cn;sd++)C.push(De[sd])}else if(at==="justify"&&wg.encoding==="Identity-H"){C=[],Cn=De.length,bt=bt!==0?bt:bg;for(var co=0,Vr=0;Vr<Cn;Vr++)if(gs=Vr===0?ao(re):-nd,Qn=Vr===0?Ca(I):co,Vr<Cn-1){var Uf=O((bt-ai[Vr])/(De[Vr].split(" ").length-1)),Jn=De[Vr].split(" ");C.push([Jn[0]+" ",Qn,gs]),co=0;for(var oi=1;oi<Jn.length;oi++){var id=(Tc(Jn[oi-1]+" "+Jn[oi])-Tc(Jn[oi]))*Na+Uf;oi==Jn.length-1?C.push([Jn[oi],id,0]):C.push([Jn[oi]+" ",id,0]),co-=id}}else C.push([De[Vr],Qn,gs]);C.push(["",co,0])}else{if(at!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],Cn=De.length,bt=bt!==0?bt:bg,Vr=0;Vr<Cn;Vr++)gs=Vr===0?ao(re):-nd,Qn=Vr===0?Ca(I):0,Vr<Cn-1?rl.push(P(O((bt-ai[Vr])/(De[Vr].split(" ").length-1)))):rl.push(0),C.push([De[Vr],Qn,gs])}}var _g=typeof ue.R2L=="boolean"?ue.R2L:nt;_g===!0&&(C=If(C,function(mr,pr,Wr){return[mr.split("").reverse().join(""),pr,Wr]})),ke={text:C,x:I,y:re,options:ue,mutex:{pdfEscape:ms,activeFontKey:Pt,fonts:Qt,activeFontSize:ze}},Zt.publish("postProcessText",ke),C=ke.text,Ri=ke.mutex.isHex||!1;var Vf=Qt[Pt].encoding;Vf!=="WinAnsiEncoding"&&Vf!=="StandardEncoding"||(C=If(C,function(mr,pr,Wr){return[xg(mr),pr,Wr]})),De=Ff(C),C=[];for(var Lc,Oc,sl,Mc=0,ad=1,Rc=Array.isArray(De[0])?ad:Mc,il="",Wf=function(mr,pr,Wr){var ln="";return Wr instanceof dt?(Wr=typeof ue.angle=="number"?Pi(Wr,new dt(1,0,0,1,mr,pr)):Pi(new dt(1,0,0,1,mr,pr),Wr),_===w.ADVANCED&&(Wr=Pi(new dt(1,0,0,-1,0,0),Wr)),ln=Wr.join(" ")+` Tm
`):ln=P(mr)+" "+P(pr)+` Td
`,ln},li=0;li<De.length;li++){switch(il="",Rc){case ad:sl=(Ri?"<":"(")+De[li][0]+(Ri?">":")"),Lc=parseFloat(De[li][1]),Oc=parseFloat(De[li][2]);break;case Mc:sl=(Ri?"<":"(")+De[li]+(Ri?">":")"),Lc=Ca(I),Oc=ao(re)}rl!==void 0&&rl[li]!==void 0&&(il=rl[li]+` Tw
`),li===0?C.push(il+Wf(Lc,Oc,Dr)+sl):Rc===Mc?C.push(il+sl):Rc===ad&&C.push(il+Wf(Lc,Oc,Dr)+sl)}C=Rc===Mc?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var ci=`BT
/`;return ci+=Pt+" "+ze+` Tf
`,ci+=P(ze*Fs)+` TL
`,ci+=Pc+`
`,ci+=gn,ci+=C,te(ci+="ET"),f[Pt]=!0,en};var py=m.__private__.clip=m.clip=function(C){return te(C==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return py("evenodd")},m.__private__.discardPath=m.discardPath=function(){return te("n"),this};var Sa=m.__private__.isValidStyle=function(C){var I=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(I=!0),I};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(C){return Sa(C)&&(u=C),this};var ug=m.__private__.getStyle=m.getStyle=function(C){var I=u;switch(C){case"D":case"S":I="S";break;case"F":I="f";break;case"FD":case"DF":I="B";break;case"f":case"f*":case"B":case"B*":I=C}return I},dg=m.close=function(){return te("h"),this};m.stroke=function(){return te("S"),this},m.fill=function(C){return Gu("f",C),this},m.fillEvenOdd=function(C){return Gu("f*",C),this},m.fillStroke=function(C){return Gu("B",C),this},m.fillStrokeEvenOdd=function(C){return Gu("B*",C),this};var Gu=function(C,I){or(I)==="object"?vy(I,C):te(C)},kf=function(C){C===null||_===w.ADVANCED&&C===void 0||(C=ug(C),te(C))};function gy(C,I,re,ue,be){var ke=new Kd(I||this.boundingBox,re||this.xStep,ue||this.yStep,this.gState,be||this.matrix);ke.stream=this.stream;var De=C+"$$"+this.cloneIndex+++"$$";return fs(De,ke),ke}var vy=function(C,I){var re=Ht[C.key],ue=Ge[re];if(ue instanceof Hc)te("q"),te(xy(I)),ue.gState&&m.setGState(ue.gState),te(C.matrix.toString()+" cm"),te("/"+re+" sh"),te("Q");else if(ue instanceof Kd){var be=new dt(1,0,0,-1,0,tl());C.matrix&&(be=be.multiply(C.matrix||wa),re=gy.call(ue,C.key,C.boundingBox,C.xStep,C.yStep,be).id),te("q"),te("/Pattern cs"),te("/"+re+" scn"),ue.gState&&m.setGState(ue.gState),te(I),te("Q")}},xy=function(C){switch(C){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ef=m.moveTo=function(C,I){return te(P(O(C))+" "+P(q(I))+" m"),this},kc=m.lineTo=function(C,I){return te(P(O(C))+" "+P(q(I))+" l"),this},Zo=m.curveTo=function(C,I,re,ue,be,ke){return te([P(O(C)),P(q(I)),P(O(re)),P(q(ue)),P(O(be)),P(q(ke)),"c"].join(" ")),this};m.__private__.line=m.line=function(C,I,re,ue,be){if(isNaN(C)||isNaN(I)||isNaN(re)||isNaN(ue)||!Sa(be))throw new Error("Invalid arguments passed to jsPDF.line");return _===w.COMPAT?this.lines([[re-C,ue-I]],C,I,[1,1],be||"S"):this.lines([[re-C,ue-I]],C,I,[1,1]).stroke()},m.__private__.lines=m.lines=function(C,I,re,ue,be,ke){var De,Xe,at,_t,bt,qt,Pr,Dr,en,Dn,gn,Ri;if(typeof C=="number"&&(Ri=re,re=I,I=C,C=Ri),ue=ue||[1,1],ke=ke||!1,isNaN(I)||isNaN(re)||!Array.isArray(C)||!Array.isArray(ue)||!Sa(be)||typeof ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ef(I,re),De=ue[0],Xe=ue[1],_t=C.length,Dn=I,gn=re,at=0;at<_t;at++)(bt=C[at]).length===2?(Dn=bt[0]*De+Dn,gn=bt[1]*Xe+gn,kc(Dn,gn)):(qt=bt[0]*De+Dn,Pr=bt[1]*Xe+gn,Dr=bt[2]*De+Dn,en=bt[3]*Xe+gn,Dn=bt[4]*De+Dn,gn=bt[5]*Xe+gn,Zo(qt,Pr,Dr,en,Dn,gn));return ke&&dg(),kf(be),this},m.path=function(C){for(var I=0;I<C.length;I++){var re=C[I],ue=re.c;switch(re.op){case"m":Ef(ue[0],ue[1]);break;case"l":kc(ue[0],ue[1]);break;case"c":Zo.apply(this,ue);break;case"h":dg()}}return this},m.__private__.rect=m.rect=function(C,I,re,ue,be){if(isNaN(C)||isNaN(I)||isNaN(re)||isNaN(ue)||!Sa(be))throw new Error("Invalid arguments passed to jsPDF.rect");return _===w.COMPAT&&(ue=-ue),te([P(O(C)),P(q(I)),P(O(re)),P(O(ue)),"re"].join(" ")),kf(be),this},m.__private__.triangle=m.triangle=function(C,I,re,ue,be,ke,De){if(isNaN(C)||isNaN(I)||isNaN(re)||isNaN(ue)||isNaN(be)||isNaN(ke)||!Sa(De))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[re-C,ue-I],[be-re,ke-ue],[C-be,I-ke]],C,I,[1,1],De,!0),this},m.__private__.roundedRect=m.roundedRect=function(C,I,re,ue,be,ke,De){if(isNaN(C)||isNaN(I)||isNaN(re)||isNaN(ue)||isNaN(be)||isNaN(ke)||!Sa(De))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Xe=4/3*(Math.SQRT2-1);return be=Math.min(be,.5*re),ke=Math.min(ke,.5*ue),this.lines([[re-2*be,0],[be*Xe,0,be,ke-ke*Xe,be,ke],[0,ue-2*ke],[0,ke*Xe,-be*Xe,ke,-be,ke],[2*be-re,0],[-be*Xe,0,-be,-ke*Xe,-be,-ke],[0,2*ke-ue],[0,-ke*Xe,be*Xe,-ke,be,-ke]],C+be,I,[1,1],De,!0),this},m.__private__.ellipse=m.ellipse=function(C,I,re,ue,be){if(isNaN(C)||isNaN(I)||isNaN(re)||isNaN(ue)||!Sa(be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ke=4/3*(Math.SQRT2-1)*re,De=4/3*(Math.SQRT2-1)*ue;return Ef(C+re,I),Zo(C+re,I-De,C+ke,I-ue,C,I-ue),Zo(C-ke,I-ue,C-re,I-De,C-re,I),Zo(C-re,I+De,C-ke,I+ue,C,I+ue),Zo(C+ke,I+ue,C+re,I+De,C+re,I),kf(be),this},m.__private__.circle=m.circle=function(C,I,re,ue){if(isNaN(C)||isNaN(I)||isNaN(re)||!Sa(ue))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,I,re,re,ue)},m.setFont=function(C,I,re){return re&&(I=E(I,re)),Pt=og(C,I,{disableWarning:!1}),this};var yy=m.__private__.getFont=m.getFont=function(){return Qt[og.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var C,I,re={};for(C in Wt)if(Wt.hasOwnProperty(C))for(I in re[C]=[],Wt[C])Wt[C].hasOwnProperty(I)&&re[C].push(I);return re},m.addFont=function(C,I,re,ue,be){var ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ke.indexOf(arguments[3])!==-1?be=arguments[3]:arguments[3]&&ke.indexOf(arguments[3])==-1&&(re=E(re,ue)),be=be||"Identity-H",Sf.call(this,C,I,re,be)};var Ec,Pf=t.lineWidth||.200025,Yu=m.__private__.getLineWidth=m.getLineWidth=function(){return Pf},hg=m.__private__.setLineWidth=m.setLineWidth=function(C){return Pf=C,te(P(O(C))+" w"),this};m.__private__.setLineDash=ht.API.setLineDash=ht.API.setLineDashPattern=function(C,I){if(C=C||[],I=I||0,isNaN(I)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(re){return P(O(re))}).join(" "),I=P(O(I)),te("["+C+"] "+I+" d"),this};var fg=m.__private__.getLineHeight=m.getLineHeight=function(){return ze*Ec};m.__private__.getLineHeight=m.getLineHeight=function(){return ze*Ec};var mg=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(Ec=C),this},pg=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Ec};mg(t.lineHeight);var Ca=m.__private__.getHorizontalCoordinate=function(C){return O(C)},ao=m.__private__.getVerticalCoordinate=function(C){return _===w.ADVANCED?C:gt[W].mediaBox.topRightY-gt[W].mediaBox.bottomLeftY-O(C)},by=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(C){return P(Ca(C))},el=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(C){return P(ao(C))},Mi=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Ti(Mi)},m.__private__.setStrokeColor=m.setDrawColor=function(C,I,re,ue){return Mi=Li({ch1:C,ch2:I,ch3:re,ch4:ue,pdfColorType:"draw",precision:2}),te(Mi),this};var Af=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Ti(Af)},m.__private__.setFillColor=m.setFillColor=function(C,I,re,ue){return Af=Li({ch1:C,ch2:I,ch3:re,ch4:ue,pdfColorType:"fill",precision:2}),te(Af),this};var Pc=t.textColor||"0 g",wy=m.__private__.getTextColor=m.getTextColor=function(){return Ti(Pc)};m.__private__.setTextColor=m.setTextColor=function(C,I,re,ue){return Pc=Li({ch1:C,ch2:I,ch3:re,ch4:ue,pdfColorType:"text",precision:3}),this};var Xu=t.charSpace,_y=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Xu||0)};m.__private__.setCharSpace=m.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xu=C,this};var Tf=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(C){var I=m.CapJoinStyles[C];if(I===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tf=I,te(I+" J"),this};var Lf=0;m.__private__.setLineJoin=m.setLineJoin=function(C){var I=m.CapJoinStyles[C];if(I===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Lf=I,te(I+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(P(O(C))+" M"),this},m.GState=Ix,m.setGState=function(C){(C=typeof C=="string"?ft[Rr[C]]:gg(null,C)).equals(Jr)||(te("/"+C.id+" gs"),Jr=C)};var gg=function(C,I){if(!C||!Rr[C]){var re=!1;for(var ue in ft)if(ft.hasOwnProperty(ue)&&ft[ue].equals(I)){re=!0;break}if(re)I=ft[ue];else{var be="GS"+(Object.keys(ft).length+1).toString(10);ft[be]=I,I.id=be}return C&&(Rr[C]=I.id),Zt.publish("addGState",I),I}};m.addGState=function(C,I){return gg(C,I),this},m.saveGraphicsState=function(){return te("q"),si.push({key:Pt,size:ze,color:Pc}),this},m.restoreGraphicsState=function(){te("Q");var C=si.pop();return Pt=C.key,ze=C.size,Pc=C.color,Jr=null,this},m.setCurrentTransformationMatrix=function(C){return te(C.toString()+" cm"),this},m.comment=function(C){return te("#"+C),this};var Ku=function(C,I){var re=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return re},set:function(ke){isNaN(ke)||(re=parseFloat(ke))}});var ue=I||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ue},set:function(ke){isNaN(ke)||(ue=parseFloat(ke))}});var be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return be},set:function(ke){be=ke.toString()}}),this},Of=function(C,I,re,ue){Ku.call(this,C,I),this.type="rect";var be=re||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return be},set:function(De){isNaN(De)||(be=parseFloat(De))}});var ke=ue||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ke},set:function(De){isNaN(De)||(ke=parseFloat(De))}}),this},Mf=function(){this.page=dr,this.currentPage=W,this.pages=Se.slice(0),this.pagesContext=gt.slice(0),this.x=an,this.y=It,this.matrix=Rs,this.width=Ac(W),this.height=tl(W),this.outputDestination=Ee,this.id="",this.objectNumber=-1};Mf.prototype.restore=function(){dr=this.page,W=this.currentPage,gt=this.pagesContext,Se=this.pages,an=this.x,It=this.y,Rs=this.matrix,Rf(W,this.width),Df(W,this.height),Ee=this.outputDestination};var vg=function(C,I,re,ue,be){ba.push(new Mf),dr=W=0,Se=[],an=C,It=I,Rs=be,Cf([re,ue])},jy=function(C){if(ya[C])ba.pop().restore();else{var I=new Mf,re="Xo"+(Object.keys(Sn).length+1).toString(10);I.id=re,ya[C]=re,Sn[re]=I,Zt.publish("addFormObject",I),ba.pop().restore()}};for(var Qu in m.beginFormObject=function(C,I,re,ue,be){return vg(C,I,re,ue,be),this},m.endFormObject=function(C){return jy(C),this},m.doFormObject=function(C,I){var re=Sn[ya[C]];return te("q"),te(I.toString()+" cm"),te("/"+re.id+" Do"),te("Q"),this},m.getFormObject=function(C){var I=Sn[ya[C]];return{x:I.x,y:I.y,width:I.width,height:I.height,matrix:I.matrix}},m.save=function(C,I){return C=C||"generated.pdf",(I=I||{}).returnPromise=I.returnPromise||!1,I.returnPromise===!1?(qc(Wu(io()),C),typeof qc.unload=="function"&&mt.setTimeout&&setTimeout(qc.unload,911),this):new Promise(function(re,ue){try{var be=qc(Wu(io()),C);typeof qc.unload=="function"&&mt.setTimeout&&setTimeout(qc.unload,911),re(be)}catch(ke){ue(ke.message)}})},ht.API)ht.API.hasOwnProperty(Qu)&&(Qu==="events"&&ht.API.events.length?function(C,I){var re,ue,be;for(be=I.length-1;be!==-1;be--)re=I[be][0],ue=I[be][1],C.subscribe.apply(C,[re].concat(typeof ue=="function"?[ue]:ue))}(Zt,ht.API.events):m[Qu]=ht.API[Qu]);var Ac=m.getPageWidth=function(C){return(gt[C=C||W].mediaBox.topRightX-gt[C].mediaBox.bottomLeftX)/He},Rf=m.setPageWidth=function(C,I){gt[C].mediaBox.topRightX=I*He+gt[C].mediaBox.bottomLeftX},tl=m.getPageHeight=function(C){return(gt[C=C||W].mediaBox.topRightY-gt[C].mediaBox.bottomLeftY)/He},Df=m.setPageHeight=function(C,I){gt[C].mediaBox.topRightY=I*He+gt[C].mediaBox.bottomLeftY};return m.internal={pdfEscape:ms,getStyle:ug,getFont:yy,getFontSize:Ue,getCharSpace:_y,getTextColor:wy,getLineHeight:fg,getLineHeightFactor:pg,getLineWidth:Yu,write:it,getHorizontalCoordinate:Ca,getVerticalCoordinate:ao,getCoordinateString:by,getVerticalCoordinateString:el,collections:{},newObject:on,newAdditionalObject:Fu,newObjectDeferred:Zr,newObjectDeferredBegin:Ds,getFilters:_a,putStream:ii,events:Zt,scaleFactor:He,pageSize:{getWidth:function(){return Ac(W)},setWidth:function(C){Rf(W,C)},getHeight:function(){return tl(W)},setHeight:function(C){Df(W,C)}},encryptionOptions:d,encryption:Rn,getEncryptor:fy,output:Hu,getNumberOfPages:ly,pages:Se,out:te,f2:Y,f3:T,getPageInfo:cg,getPageInfoByObjId:xt,getCurrentPageInfo:my,getPDFVersion:v,Point:Ku,Rectangle:Of,Matrix:dt,hasHotfix:lg},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Ac(W)},set:function(C){Rf(W,C)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return tl(W)},set:function(C){Df(W,C)},enumerable:!0,configurable:!0}),ay.call(m,Te),Pt="F1",ig(s,r),Zt.publish("initialized"),m}Ed.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},Ed.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ed.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Ed.prototype.processOwnerPassword=function(t,e){return p5(m5(e).substr(0,5),t)},Ed.prototype.encryptor=function(t,e){var r=m5(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return p5(r,n)}},Ix.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||or(t)!==or(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},ht.API={events:[]},ht.version="3.0.1";var zr=ht.API,Jj=1,Du=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jd=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},wt=function(t){return t.toFixed(2)},bl=function(t){return t.toFixed(5)};zr.__acroform__={};var Ms=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},a4=function(t){return t*Jj},Pa=function(t){var e=new n8,r=rt.internal.getHeight(t)||0,n=rt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(wt(n)),Number(wt(r))],e},Jee=zr.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},Zee=zr.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},ete=zr.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Yr=zr.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return ete(t,e-1)},Xr=zr.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Jee(t,e-1)},Kr=zr.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Zee(t,e-1)},tte=zr.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],i=t[1],a=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+a)||0,c.upperRight_Y=n(i)||0,[Number(wt(c.lowerLeft_X)),Number(wt(c.lowerLeft_Y)),Number(wt(c.upperRight_X)),Number(wt(c.upperRight_Y))]},rte=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=g5(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+wt(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Pa(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},g5=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(T){return T.split(`
`)}):s.map(function(T){return[T]});var i=r,a=rt.internal.getHeight(t)||0;a=a<0?-a:a;var l=rt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(T,O,U){if(T+1<s.length){var q=O+" "+s[T+1][0];return Q0(q,t,U).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var u,d,h=Q0("3",t,i).height,f=t.multiline?a-i:(a-h)/2,m=f+=2,p=0,v=0,b=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Q0(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var x="",w=0,_=0;_<s.length;_++)if(s.hasOwnProperty(_)){var S=!1;if(s[_].length!==1&&b!==s[_].length-1){if((h+2)*(w+2)+2>a)continue e;x+=s[_][b],S=!0,v=_,_--}else{x=(x+=s[_][b]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var N=parseInt(_),E=c(N,x,i),P=_>=s.length-1;if(E&&!P){x+=" ",b=0;continue}if(E||P){if(P)v=N;else if(t.multiline&&(h+2)*(w+2)+2>a)continue e}else{if(!t.multiline||(h+2)*(w+2)+2>a)continue e;v=N}}for(var A="",F=p;F<=v;F++){var Y=s[F];if(t.multiline){if(F===v){A+=Y[b]+" ",b=(b+1)%Y.length;continue}if(F===p){A+=Y[Y.length-1]+" ";continue}}A+=Y[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,d=Q0(A,t,i).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;case"left":default:u=2}e+=wt(u)+" "+wt(m)+` Td
`,e+="("+Du(A)+`) Tj
`,e+=-wt(u)+` 0 Td
`,m=-(i+2),d=0,p=S?v:v+1,w++,x=""}break}return n.text=e,n.fontSize=i,n},Q0=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},nte={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ste=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},ite=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,s=t[r];e.internal.newObjectDeferredBegin(s.objId,!0),or(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete t[n]}},ate=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(va.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(nte)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Jj=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new s8,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&ste(i,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var a in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var l=n[a],c=[],u=l.Rect;if(l.Rect&&(l.Rect=tte(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=rt.createDefaultAppearanceStream(l),or(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=rte(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var h="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var m=l.appearanceStreamContent[f];if(h+="/"+f+" ",h+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var a in m)if(m.hasOwnProperty(a)){var p=m[a];typeof p=="function"&&(p=p.call(s,l)),h+="/"+a+" "+p+" ",s.internal.acroformPlugin.xForms.indexOf(p)>=0||s.internal.acroformPlugin.xForms.push(p)}}else typeof(p=m)=="function"&&(p=p.call(s,l)),h+="/"+a+" "+p,s.internal.acroformPlugin.xForms.indexOf(p)>=0||s.internal.acroformPlugin.xForms.push(p);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&ite(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},r8=zr.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(a){return a};if(Array.isArray(t)){for(var s="[",i=0;i<t.length;i++)switch(i!==0&&(s+=" "),or(t[i])){case"boolean":case"number":case"object":s+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+Du(n(t[i].toString()))+")"):s+=t[i].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ib=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Du(n(t))+")"},qa=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};qa.prototype.toString=function(){return this.objId+" 0 R"},qa.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},qa.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:r8(s,this.objId,this.scope)}):s instanceof qa?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var n8=function(){qa.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Ms(n8,qa);var s8=function(){qa.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Du(r(t))+")"}},set:function(r){t=r}})};Ms(s8,qa);var va=function t(){qa.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Yr(e,3)},set:function(x){x?this.F=Xr(e,3):this.F=Kr(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof zx)return;i="FieldObject"+t.FieldNum++}var x=function(w){return w};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Du(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Jj:u},set:function(x){u=x}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(x){d=x}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof zx||this instanceof hu))return ib(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=x}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof wn?f:ib(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=this instanceof wn?x:x.substr(0,1)==="("?jd(x.substr(1,x.length-2)):jd(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn?jd(f.substr(1,f.length-1)):f},set:function(x){x=x.toString(),f=this instanceof wn?"/"+x:x}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof wn?m:ib(m,this.objId,this.scope)},set:function(x){x=x.toString(),m=this instanceof wn?x:x.substr(0,1)==="("?jd(x.substr(1,x.length-2)):jd(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn?jd(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof wn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(x){x=!!x,v=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(x){p=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,1)},set:function(x){x?this.Ff=Xr(this.Ff,1):this.Ff=Kr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,2)},set:function(x){x?this.Ff=Xr(this.Ff,2):this.Ff=Kr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,3)},set:function(x){x?this.Ff=Xr(this.Ff,3):this.Ff=Kr(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');b=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(b){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Ms(va,qa);var hh=function(){va.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return r8(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,a,l){l||(l=1);for(var c,u=[];c=a.exec(i);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,18)},set:function(r){r?this.Ff=Xr(this.Ff,18):this.Ff=Kr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Xr(this.Ff,19):this.Ff=Kr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,20)},set:function(r){r?(this.Ff=Xr(this.Ff,20),e.sort()):this.Ff=Kr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,22)},set:function(r){r?this.Ff=Xr(this.Ff,22):this.Ff=Kr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,23)},set:function(r){r?this.Ff=Xr(this.Ff,23):this.Ff=Kr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,27)},set:function(r){r?this.Ff=Xr(this.Ff,27):this.Ff=Kr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ms(hh,va);var fh=function(){hh.call(this),this.fontName="helvetica",this.combo=!1};Ms(fh,hh);var mh=function(){fh.call(this),this.combo=!0};Ms(mh,fh);var Nv=function(){mh.call(this),this.edit=!0};Ms(Nv,mh);var wn=function(){va.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,15)},set:function(r){r?this.Ff=Xr(this.Ff,15):this.Ff=Kr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,16)},set:function(r){r?this.Ff=Xr(this.Ff,16):this.Ff=Kr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,17)},set:function(r){r?this.Ff=Xr(this.Ff,17):this.Ff=Kr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,26)},set:function(r){r?this.Ff=Xr(this.Ff,26):this.Ff=Kr(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Du(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){or(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Ms(wn,va);var kv=function(){wn.call(this),this.pushButton=!0};Ms(kv,wn);var ph=function(){wn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Ms(ph,wn);var zx=function(){var t,e;va.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),n)a.push("/"+i+" ("+Du(s(n[i]))+")");return a.push(">>"),a.join(`
`)},set:function(s){or(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ms(zx,va),ph.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},ph.prototype.createOption=function(t){var e=new zx;return e.Parent=this,e.optionName=t,this.Kids.push(e),ote.call(this.scope,e),e};var Ev=function(){wn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rt.CheckBox.createAppearanceStream()};Ms(Ev,wn);var hu=function(){va.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,13)},set:function(e){e?this.Ff=Xr(this.Ff,13):this.Ff=Kr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,21)},set:function(e){e?this.Ff=Xr(this.Ff,21):this.Ff=Kr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,23)},set:function(e){e?this.Ff=Xr(this.Ff,23):this.Ff=Kr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,24)},set:function(e){e?this.Ff=Xr(this.Ff,24):this.Ff=Kr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,25)},set:function(e){e?this.Ff=Xr(this.Ff,25):this.Ff=Kr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,26)},set:function(e){e?this.Ff=Xr(this.Ff,26):this.Ff=Kr(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ms(hu,va);var Pv=function(){hu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,14)},set:function(t){t?this.Ff=Xr(this.Ff,14):this.Ff=Kr(this.Ff,14)}}),this.password=!0};Ms(Pv,hu);var rt={CheckBox:{createAppearanceStream:function(){return{N:{On:rt.CheckBox.YesNormal},D:{On:rt.CheckBox.YesPushDown,Off:rt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=g5(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+wt(rt.internal.getWidth(t))+" "+wt(rt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+wt(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Pa(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],i=rt.internal.getHeight(t),a=rt.internal.getWidth(t),l=g5(t,t.caption);return s.push("1 g"),s.push("0 0 "+wt(a)+" "+wt(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+wt(a-1)+" "+wt(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+wt(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wt(rt.internal.getWidth(t))+" "+wt(rt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:rt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=rt.RadioButton.Circle.YesNormal,e.D[t]=rt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Pa(t);e.scope=t.scope;var r=[],n=rt.internal.getWidth(t)<=rt.internal.getHeight(t)?rt.internal.getWidth(t)/4:rt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=rt.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+bl(rt.internal.getWidth(t)/2)+" "+bl(rt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=[],n=rt.internal.getWidth(t)<=rt.internal.getHeight(t)?rt.internal.getWidth(t)/4:rt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*rt.internal.Bezier_C).toFixed(5)),a=Number((n*rt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+bl(rt.internal.getWidth(t)/2)+" "+bl(rt.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+bl(rt.internal.getWidth(t)/2)+" "+bl(rt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=[],n=rt.internal.getWidth(t)<=rt.internal.getHeight(t)?rt.internal.getWidth(t)/4:rt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*rt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+bl(rt.internal.getWidth(t)/2)+" "+bl(rt.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:rt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=rt.RadioButton.Cross.YesNormal,e.D[t]=rt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Pa(t);e.scope=t.scope;var r=[],n=rt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+wt(rt.internal.getWidth(t)-2)+" "+wt(rt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(wt(n.x1.x)+" "+wt(n.x1.y)+" m"),r.push(wt(n.x2.x)+" "+wt(n.x2.y)+" l"),r.push(wt(n.x4.x)+" "+wt(n.x4.y)+" m"),r.push(wt(n.x3.x)+" "+wt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=rt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+wt(rt.internal.getWidth(t))+" "+wt(rt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+wt(rt.internal.getWidth(t)-2)+" "+wt(rt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(wt(r.x1.x)+" "+wt(r.x1.y)+" m"),n.push(wt(r.x2.x)+" "+wt(r.x2.y)+" l"),n.push(wt(r.x4.x)+" "+wt(r.x4.y)+" m"),n.push(wt(r.x3.x)+" "+wt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Pa(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wt(rt.internal.getWidth(t))+" "+wt(rt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};rt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=rt.internal.getWidth(t),r=rt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},rt.internal.getWidth=function(t){var e=0;return or(t)==="object"&&(e=a4(t.Rect[2])),e},rt.internal.getHeight=function(t){var e=0;return or(t)==="object"&&(e=a4(t.Rect[3])),e};var ote=zr.addField=function(t){if(ate(this,t),!(t instanceof va))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};zr.AcroFormChoiceField=hh,zr.AcroFormListBox=fh,zr.AcroFormComboBox=mh,zr.AcroFormEditBox=Nv,zr.AcroFormButton=wn,zr.AcroFormPushButton=kv,zr.AcroFormRadioButton=ph,zr.AcroFormCheckBox=Ev,zr.AcroFormTextField=hu,zr.AcroFormPasswordField=Pv,zr.AcroFormAppearance=rt,zr.AcroForm={ChoiceField:hh,ListBox:fh,ComboBox:mh,EditBox:Nv,Button:wn,PushButton:kv,RadioButton:ph,CheckBox:Ev,TextField:hu,PasswordField:Pv,Appearance:rt},ht.AcroForm={ChoiceField:hh,ListBox:fh,ComboBox:mh,EditBox:Nv,Button:wn,PushButton:kv,RadioButton:ph,CheckBox:Ev,TextField:hu,PasswordField:Pv,Appearance:rt};function i8(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(T,O){var U,q,Z,H,Q,R=e;if((O=O||e)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(E(T))for(Q in r)for(Z=r[Q],U=0;U<Z.length;U+=1){for(H=!0,q=0;q<Z[U].length;q+=1)if(Z[U][q]!==void 0&&Z[U][q]!==T[q]){H=!1;break}if(H===!0){R=Q;break}}else for(Q in r)for(Z=r[Q],U=0;U<Z.length;U+=1){for(H=!0,q=0;q<Z[U].length;q+=1)if(Z[U][q]!==void 0&&Z[U][q]!==T.charCodeAt(q)){H=!1;break}if(H===!0){R=Q;break}}return R===e&&O!==e&&(R=O),R},s=function T(O){for(var U=this.internal.write,q=this.internal.putStream,Z=(0,this.internal.getFilters)();Z.indexOf("FlateEncode")!==-1;)Z.splice(Z.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var H=[];if(H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Image"}),H.push({key:"Width",value:O.width}),H.push({key:"Height",value:O.height}),O.colorSpace===b.INDEXED?H.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(H.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===b.DEVICE_CMYK&&H.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),H.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&H.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)){for(var Q="",R=0,B=O.transparency.length;R<B;R++)Q+=O.transparency[R]+" "+O.transparency[R]+" ";H.push({key:"Mask",value:"["+Q+"]"})}O.sMask!==void 0&&H.push({key:"SMask",value:O.objectId+1+" 0 R"});var X=O.filter!==void 0?["/"+O.filter]:void 0;if(q({data:O.data,additionalKeyValues:H,alreadyAppliedFilters:X,objectId:O.objectId}),U("endobj"),"sMask"in O&&O.sMask!==void 0){var ie="/Predictor "+O.predictor+" /Colors 1 /BitsPerComponent "+O.bitsPerComponent+" /Columns "+O.width,M={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:O.bitsPerComponent,decodeParameters:ie,data:O.sMask};"filter"in O&&(M.filter=O.filter),T.call(this,M)}if(O.colorSpace===b.INDEXED){var W=this.internal.newObject();q({data:A(new Uint8Array(O.palette)),objectId:W}),U("endobj")}},i=function(){var T=this.internal.collections.addImage_images;for(var O in T)s.call(this,T[O])},a=function(){var T,O=this.internal.collections.addImage_images,U=this.internal.write;for(var q in O)U("/I"+(T=O[q]).index,T.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",a))},c=function(){var T=this.internal.collections.addImage_images;return l.call(this),T},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(T){return typeof t["process"+T.toUpperCase()]=="function"},h=function(T){return or(T)==="object"&&T.nodeType===1},f=function(T,O){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var U=""+T.getAttribute("src");if(U.indexOf("data:image/")===0)return qm(unescape(U).split("base64,").pop());var q=t.loadFile(U,!0);if(q!==void 0)return q}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var Z;switch(O){case"PNG":Z="image/png";break;case"WEBP":Z="image/webp";break;case"JPEG":case"JPG":default:Z="image/jpeg"}return qm(T.toDataURL(Z,1).split("base64,").pop())}},m=function(T){var O=this.internal.collections.addImage_images;if(O){for(var U in O)if(T===O[U].alias)return O[U]}},p=function(T,O,U){return T||O||(T=-96,O=-96),T<0&&(T=-1*U.width*72/T/this.internal.scaleFactor),O<0&&(O=-1*U.height*72/O/this.internal.scaleFactor),T===0&&(T=O*U.width/U.height),O===0&&(O=T*U.height/U.width),[T,O]},v=function(T,O,U,q,Z,H){var Q=p.call(this,U,q,Z),R=this.internal.getCoordinateString,B=this.internal.getVerticalCoordinateString,X=c.call(this);if(U=Q[0],q=Q[1],X[Z.index]=Z,H){H*=Math.PI/180;var ie=Math.cos(H),M=Math.sin(H),W=function(ne){return ne.toFixed(4)},K=[W(ie),W(M),W(-1*M),W(ie),0,0,"cm"]}this.internal.write("q"),H?(this.internal.write([1,"0","0",1,R(T),B(O+q),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([R(U),"0","0",R(q),"0","0","cm"].join(" "))):this.internal.write([R(U),"0","0",R(q),R(T),B(O+q),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Z.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=t.__addimage__.sHashCode=function(T){var O,U,q=0;if(typeof T=="string")for(U=T.length,O=0;O<U;O++)q=(q<<5)-q+T.charCodeAt(O),q|=0;else if(E(T))for(U=T.byteLength/2,O=0;O<U;O++)q=(q<<5)-q+T[O],q|=0;return q},_=t.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var O=!0;return T.length===0&&(O=!1),T.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(O=!1),O},S=t.__addimage__.extractImageFromDataUrl=function(T){if(T==null||!(T=T.trim()).startsWith("data:"))return null;var O=T.indexOf(",");return O<0?null:T.substring(0,O).trim().endsWith("base64")?T.substring(O+1):null},N=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(T){return N()&&T instanceof ArrayBuffer};var E=t.__addimage__.isArrayBufferView=function(T){return N()&&typeof Uint32Array<"u"&&(T instanceof Int8Array||T instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array)},P=t.__addimage__.binaryStringToUint8Array=function(T){for(var O=T.length,U=new Uint8Array(O),q=0;q<O;q++)U[q]=T.charCodeAt(q);return U},A=t.__addimage__.arrayBufferToBinaryString=function(T){for(var O="",U=E(T)?T:new Uint8Array(T),q=0;q<U.length;q+=8192)O+=String.fromCharCode.apply(null,U.subarray(q,q+8192));return O};t.addImage=function(){var T,O,U,q,Z,H,Q,R,B;if(typeof arguments[1]=="number"?(O=e,U=arguments[1],q=arguments[2],Z=arguments[3],H=arguments[4],Q=arguments[5],R=arguments[6],B=arguments[7]):(O=arguments[1],U=arguments[2],q=arguments[3],Z=arguments[4],H=arguments[5],Q=arguments[6],R=arguments[7],B=arguments[8]),or(T=arguments[0])==="object"&&!h(T)&&"imageData"in T){var X=T;T=X.imageData,O=X.format||O||e,U=X.x||U||0,q=X.y||q||0,Z=X.w||X.width||Z,H=X.h||X.height||H,Q=X.alias||Q,R=X.compression||R,B=X.rotation||X.angle||B}var ie=this.internal.getFilters();if(R===void 0&&ie.indexOf("FlateEncode")!==-1&&(R="SLOW"),isNaN(U)||isNaN(q))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var M=F.call(this,T,O,Q,R);return v.call(this,U,q,Z,H,M,B),this};var F=function(T,O,U,q){var Z,H,Q;if(typeof T=="string"&&n(T)===e){T=unescape(T);var R=Y(T,!1);(R!==""||(R=t.loadFile(T,!0))!==void 0)&&(T=R)}if(h(T)&&(T=f(T,O)),O=n(T,O),!d(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((Q=U)==null||Q.length===0)&&(U=function(B){return typeof B=="string"||E(B)?w(B):E(B.data)?w(B.data):null}(T)),(Z=m.call(this,U))||(N()&&(T instanceof Uint8Array||O==="RGBA"||(H=T,T=P(T))),Z=this["process"+O.toUpperCase()](T,u.call(this),U,function(B){return B&&typeof B=="string"&&(B=B.toUpperCase()),B in t.image_compression?B:x.NONE}(q),H)),!Z)throw new Error("An unknown error occurred whilst processing the image.");return Z},Y=t.__addimage__.convertBase64ToBinaryString=function(T,O){O=typeof O!="boolean"||O;var U,q="";if(typeof T=="string"){var Z;U=(Z=S(T))!==null&&Z!==void 0?Z:T;try{q=qm(U)}catch(H){if(O)throw _(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+H.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};t.getImageProperties=function(T){var O,U,q="";if(h(T)&&(T=f(T)),typeof T=="string"&&n(T)===e&&((q=Y(T,!1))===""&&(q=t.loadFile(T)||""),T=q),U=n(T),!d(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(!N()||T instanceof Uint8Array||(T=P(T)),!(O=this["process"+U.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=U,O}})(ht.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};ht.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,i,a=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,h=0;h<u.length&&!d;h++)switch((n=u[h]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var f=0;f<u.length;f++){n=u[f];var m=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(v.objId),w=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+a(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(x(n.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+m(x(w))+") >>",v.content=i;var _=v.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+a(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(v.objId,"0 R",b.objId,"0 R");break;case"freetext":s="/Rect ["+a(n.bounds.x)+" "+l(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(p(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var N=this.annotations._nameMap[n.options.name];n.options.pageNumber=N.page,n.options.top=N.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var E=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+E+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,i,a){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+i)},options:a,type:"link"})},t.textWithLink=function(r,n,s,i){var a,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;a=Math.ceil(u*d)}else l=c,a=u;return this.text(r,n,s,i),s+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-u,l,a,i),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(ht.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},a=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},l=t.__arabicParser__.isArabicEndLetter=function(v){return a(v)&&i(v)&&e[v.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(v){return a(v)&&s.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return a(v)&&i(v)&&e[v.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return a(v)&&i(v)&&e[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return a(v)&&i(v)&&e[v.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return a(v)&&i(v)&&e[v.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(v){var b=0,x=r,w="",_=0;for(b=0;b<v.length;b+=1)x[v.charCodeAt(b)]!==void 0?(_++,typeof(x=x[v.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(x),x=r,_=0),b===v.length-1&&(x=r,w+=v.charAt(b-(_-1)),b-=_-1,_=0)):(x=r,w+=v.charAt(b-_),b-=_,_=0);return w};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var f=t.__arabicParser__.getCorrectForm=function(v,b,x){return a(v)?i(v)===!1?-1:!u(v)||!a(b)&&!a(x)||!a(x)&&l(b)||l(v)&&!a(b)||l(v)&&c(b)||l(v)&&l(b)?0:d(v)&&a(b)&&!l(b)&&a(x)&&u(x)?3:l(v)||!a(x)?1:2:-1},m=function(v){var b=0,x=0,w=0,_="",S="",N="",E=(v=v||"").split("\\s+"),P=[];for(b=0;b<E.length;b+=1){for(P.push(""),x=0;x<E[b].length;x+=1)_=E[b][x],S=E[b][x-1],N=E[b][x+1],a(_)?(w=f(_,S,N),P[b]+=w!==-1?String.fromCharCode(e[_.charCodeAt(0)][w]):_):P[b]+=_;P[b]=h(P[b])}return P.join(" ")},p=t.__arabicParser__.processArabic=t.processArabic=function(){var v,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(b)){var w=0;for(x=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?x.push([m(b[w][0]),b[w][1],b[w][2]]):x.push([m(b[w])]);v=x}else v=m(b);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",p])}(ht.API),ht.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(ht.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(v){p=v}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),f=u.scaleFactor||this.internal.scaleFactor,m=0,p=0,v=0,b=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=u.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(_,S){return _.concat(b.splitTextToSize(S,x))},[])):c=Array.isArray(c)?c:[c];for(var w=0;w<c.length;w++)m<(v=this.getStringUnitWidth(c[w],{font:h})*d)&&(m=v);return m!==0&&(p=c.length),{w:m/=f,h:Math.max((p*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/f,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,m&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,h,f){if(n.call(this),!d)throw new Error("No data for PDF table.");var m,p,v,b,x=[],w=[],_=[],S={},N={},E=[],P=[],A=(f=f||{}).autoSize||!1,F=f.printHeaders!==!1,Y=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,T=f.margins||Object.assign({width:this.getPageWidth()},e),O=typeof f.padding=="number"?f.padding:3,U=f.headerBackgroundColor||"#c8c8c8",q=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=q,this.setFontSize(Y),h==null)w=x=Object.keys(d[0]),_=x.map(function(){return"left"});else if(Array.isArray(h)&&or(h[0])==="object")for(x=h.map(function(X){return X.name}),w=h.map(function(X){return X.prompt||X.name||""}),_=h.map(function(X){return X.align||"left"}),m=0;m<h.length;m+=1)N[h[m].name]=h[m].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(w=x=h,_=x.map(function(){return"left"}));if(A||Array.isArray(h)&&typeof h[0]=="string")for(m=0;m<x.length;m+=1){for(S[b=x[m]]=d.map(function(X){return X[b]}),this.setFont(void 0,"bold"),E.push(this.getTextDimensions(w[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=S[b],this.setFont(void 0,"normal"),v=0;v<p.length;v+=1)E.push(this.getTextDimensions(p[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);N[b]=Math.max.apply(null,E)+O+O,E=[]}if(F){var Z={};for(m=0;m<x.length;m+=1)Z[x[m]]={},Z[x[m]].text=w[m],Z[x[m]].align=_[m];var H=l.call(this,Z,N);P=x.map(function(X){return new i(c,u,N[X],H,Z[X].text,void 0,Z[X].align)}),this.setTableHeaderRow(P),this.printHeaderRow(1,!1)}var Q=h.reduce(function(X,ie){return X[ie.name]=ie.align,X},{});for(m=0;m<d.length;m+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:m,data:d[m]},this);var R=l.call(this,d[m],N);for(v=0;v<x.length;v+=1){var B=d[m][x[v]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:m,col:v,data:B},this),a.call(this,new i(c,u,N[x[v]],R,B,m+2,Q[x[v]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(m){var p=c[m];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,u[m]-d-d)},this).map(function(m){return this.getLineHeightFactor()*m.length*h/f+d+d},this).reduce(function(m,p){return Math.max(m,p)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){d=this.internal.__cell__.tableHeaderRow[m].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,f.push(d)),d.lineNumber=c;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,d),this.setTextColor(p)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(ht.API);var a8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},o8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],v5=i8(o8),l8=[100,200,300,400,500,600,700,800,900],lte=i8(l8);function x5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return a8[i=i||"normal"]?i:"normal"}(t.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(t.weight),s=function(i){return typeof v5[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function o4(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var cte={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},l4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function c4(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function ute(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",s=Object.assign({},cte,r.genericFontFamilies||{}),i=null,a=null,l=0;l<e.length;++l)if(s[(i=x5(e[l])).family]&&(i.family=s[i.family]),t.hasOwnProperty(i.family)){a=t[i.family];break}if(!(a=a||t[n]))throw new Error("Could not find a font-family for the rule '"+c4(i)+"' and default family '"+n+"'.");if(a=function(c,u){if(u[c])return u[c];var d=v5[c],h=d<=v5.normal?-1:1,f=o4(u,o8,d,h);if(!f)throw new Error("Could not find a matching font-stretch value for "+c);return f}(i.stretch,a),a=function(c,u){if(u[c])return u[c];for(var d=a8[c],h=0;h<d.length;++h)if(u[d[h]])return u[d[h]];throw new Error("Could not find a matching font-style for "+c)}(i.style,a),!(a=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var d=lte[c],h=o4(u,l8,d,c<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+c);return h}(i.weight,a)))throw new Error("Failed to resolve a font for the rule '"+c4(i)+"'.");return a}function u4(t){return t.trimLeft()}function dte(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function hte(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var J0,d4,h4,ab=["times"];(function(t){var e,r,n,s,i,a,l,c,u,d=function(M){return M=M||{},this.isStrokeTransparent=M.isStrokeTransparent||!1,this.strokeOpacity=M.strokeOpacity||1,this.strokeStyle=M.strokeStyle||"#000000",this.fillStyle=M.fillStyle||"#000000",this.isFillTransparent=M.isFillTransparent||!1,this.fillOpacity=M.fillOpacity||1,this.font=M.font||"10px sans-serif",this.textBaseline=M.textBaseline||"alphabetic",this.textAlign=M.textAlign||"left",this.lineWidth=M.lineWidth||1,this.lineJoin=M.lineJoin||"miter",this.lineCap=M.lineCap||"butt",this.path=M.path||[],this.transform=M.transform!==void 0?M.transform.clone():new c,this.globalCompositeOperation=M.globalCompositeOperation||"normal",this.globalAlpha=M.globalAlpha||1,this.clip_path=M.clip_path||[],this.currentPoint=M.currentPoint||new a,this.miterLimit=M.miterLimit||10,this.lastPoint=M.lastPoint||new a,this.lineDashOffset=M.lineDashOffset||0,this.lineDash=M.lineDash||[],this.margin=M.margin||[0,0,0,0],this.prevPageLastElemOffset=M.prevPageLastElemOffset||0,this.ignoreClearRect=typeof M.ignoreClearRect!="boolean"||M.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var h=function(M){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=M;Object.defineProperty(this,"pdf",{get:function(){return W}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(je){K=!!je}});var ne=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ne},set:function(je){ne=!!je}});var se=0;Object.defineProperty(this,"posX",{get:function(){return se},set:function(je){isNaN(je)||(se=je)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(je){isNaN(je)||(le=je)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(je){var te;typeof je=="number"?te=[je,je,je,je]:((te=new Array(4))[0]=je[0],te[1]=je.length>=2?je[1]:te[0],te[2]=je.length>=3?je[2]:te[0],te[3]=je.length>=4?je[3]:te[1]),u.margin=te}});var ye=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ye},set:function(je){ye=je}});var oe=0;Object.defineProperty(this,"lastBreak",{get:function(){return oe},set:function(je){oe=je}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(je){ve=je}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(je){je instanceof d&&(u=je)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(je){u.path=je}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(je){Se=je}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(je){var te;te=f(je),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(je){var te=f(je);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(je){["butt","round","square"].indexOf(je)!==-1&&(this.ctx.lineCap=je,this.pdf.setLineCap(je))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(je){isNaN(je)||(this.ctx.lineWidth=je,this.pdf.setLineWidth(je))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(je){["bevel","round","miter"].indexOf(je)!==-1&&(this.ctx.lineJoin=je,this.pdf.setLineJoin(je))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(je){isNaN(je)||(this.ctx.miterLimit=je,this.pdf.setMiterLimit(je))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(je){this.ctx.textBaseline=je}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(je){["right","end","center","left","start"].indexOf(je)!==-1&&(this.ctx.textAlign=je)}});var Ae=null;function Ee(je,te){if(Ae===null){var it=function(Qe){var Te=[];return Object.keys(Qe).forEach(function(ze){Qe[ze].forEach(function(qe){var Ue=null;switch(qe){case"bold":Ue={family:ze,weight:"bold"};break;case"italic":Ue={family:ze,style:"italic"};break;case"bolditalic":Ue={family:ze,weight:"bold",style:"italic"};break;case"":case"normal":Ue={family:ze}}Ue!==null&&(Ue.ref={name:ze,style:qe},Te.push(Ue))})}),Te}(je.getFontList());Ae=function(Qe){for(var Te={},ze=0;ze<Qe.length;++ze){var qe=x5(Qe[ze]),Ue=qe.family,nt=qe.stretch,pt=qe.style,yt=qe.weight;Te[Ue]=Te[Ue]||{},Te[Ue][nt]=Te[Ue][nt]||{},Te[Ue][nt][pt]=Te[Ue][nt][pt]||{},Te[Ue][nt][pt][yt]=qe}return Te}(it.concat(te))}return Ae}var $e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(je){Ae=null,$e=je}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(je){var te;if(this.ctx.font=je,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(je))!==null){var it=te[1];te[2];var Qe=te[3],Te=te[4];te[5];var ze=te[6],qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Te)[2];Te=Math.floor(qe==="px"?parseFloat(Te)*this.pdf.internal.scaleFactor:qe==="em"?parseFloat(Te)*this.pdf.getFontSize():parseFloat(Te)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Te);var Ue=function(ot){var Pt,He,an=[],It=ot.trim();if(It==="")return ab;if(It in l4)return[l4[It]];for(;It!=="";){switch(He=null,Pt=(It=u4(It)).charAt(0)){case'"':case"'":He=dte(It.substring(1),Pt);break;default:He=hte(It)}if(He===null||(an.push(He[0]),(It=u4(He[1]))!==""&&It.charAt(0)!==","))return ab;It=It.replace(/^,/,"")}return an}(ze);if(this.fontFaces){var nt=ute(Ee(this.pdf,this.fontFaces),Ue.map(function(ot){return{family:ot,stretch:"normal",weight:Qe,style:it}}));this.pdf.setFont(nt.ref.name,nt.ref.style)}else{var pt="";(Qe==="bold"||parseInt(Qe,10)>=700||it==="bold")&&(pt="bold"),it==="italic"&&(pt+="italic"),pt.length===0&&(pt="normal");for(var yt="",jt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Et=0;Et<Ue.length;Et++){if(this.pdf.internal.getFont(Ue[Et],pt,{noFallback:!0,disableWarning:!0})!==void 0){yt=Ue[Et];break}if(pt==="bolditalic"&&this.pdf.internal.getFont(Ue[Et],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yt=Ue[Et],pt="bold";else if(this.pdf.internal.getFont(Ue[Et],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yt=Ue[Et],pt="normal";break}}if(yt===""){for(var Kt=0;Kt<Ue.length;Kt++)if(jt[Ue[Kt]]){yt=jt[Ue[Kt]];break}}yt=yt===""?"Times":yt,this.pdf.setFont(yt,pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(je){this.ctx.globalCompositeOperation=je}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(je){this.ctx.globalAlpha=je}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(je){this.ctx.lineDashOffset=je,ie.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(je){this.ctx.lineDash=je,ie.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(je){this.ctx.ignoreClearRect=!!je}})};h.prototype.setLineDash=function(M){this.lineDash=M},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){S.call(this,"fill",!1)},h.prototype.stroke=function(){S.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(M,W){if(isNaN(M)||isNaN(W))throw fr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new a(M,W));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new a(M,W)},h.prototype.closePath=function(){var M=new a(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&or(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){M=new a(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(M.x,M.y)},h.prototype.lineTo=function(M,W){if(isNaN(M)||isNaN(W))throw fr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new a(M,W));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new a(K.x,K.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},h.prototype.quadraticCurveTo=function(M,W,K,ne){if(isNaN(K)||isNaN(ne)||isNaN(M)||isNaN(W))throw fr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var se=this.ctx.transform.applyToPoint(new a(K,ne)),le=this.ctx.transform.applyToPoint(new a(M,W));this.path.push({type:"qct",x1:le.x,y1:le.y,x:se.x,y:se.y}),this.ctx.lastPoint=new a(se.x,se.y)},h.prototype.bezierCurveTo=function(M,W,K,ne,se,le){if(isNaN(se)||isNaN(le)||isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne))throw fr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ye=this.ctx.transform.applyToPoint(new a(se,le)),oe=this.ctx.transform.applyToPoint(new a(M,W)),ve=this.ctx.transform.applyToPoint(new a(K,ne));this.path.push({type:"bct",x1:oe.x,y1:oe.y,x2:ve.x,y2:ve.y,x:ye.x,y:ye.y}),this.ctx.lastPoint=new a(ye.x,ye.y)},h.prototype.arc=function(M,W,K,ne,se,le){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne)||isNaN(se))throw fr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var ye=this.ctx.transform.applyToPoint(new a(M,W));M=ye.x,W=ye.y;var oe=this.ctx.transform.applyToPoint(new a(0,K)),ve=this.ctx.transform.applyToPoint(new a(0,0));K=Math.sqrt(Math.pow(oe.x-ve.x,2)+Math.pow(oe.y-ve.y,2))}Math.abs(se-ne)>=2*Math.PI&&(ne=0,se=2*Math.PI),this.path.push({type:"arc",x:M,y:W,radius:K,startAngle:ne,endAngle:se,counterclockwise:le})},h.prototype.arcTo=function(M,W,K,ne,se){throw new Error("arcTo not implemented.")},h.prototype.rect=function(M,W,K,ne){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne))throw fr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(M,W),this.lineTo(M+K,W),this.lineTo(M+K,W+ne),this.lineTo(M,W+ne),this.lineTo(M,W),this.lineTo(M+K,W),this.lineTo(M,W)},h.prototype.fillRect=function(M,W,K,ne){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne))throw fr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var se={};this.lineCap!=="butt"&&(se.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(se.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(M,W,K,ne),this.fill(),se.hasOwnProperty("lineCap")&&(this.lineCap=se.lineCap),se.hasOwnProperty("lineJoin")&&(this.lineJoin=se.lineJoin)}},h.prototype.strokeRect=function(M,W,K,ne){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne))throw fr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(M,W,K,ne),this.stroke())},h.prototype.clearRect=function(M,W,K,ne){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne))throw fr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(M,W,K,ne))},h.prototype.save=function(M){M=typeof M!="boolean"||M;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),M){this.ctx.fontSize=this.pdf.internal.getFontSize();var ne=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ne}},h.prototype.restore=function(M){M=typeof M!="boolean"||M;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(W),M&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(M){var W,K,ne,se;if(M.isCanvasGradient===!0&&(M=M.getColor()),!M)return{r:0,g:0,b:0,a:0,style:M};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(M))W=0,K=0,ne=0,se=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(M);if(le!==null)W=parseInt(le[1]),K=parseInt(le[2]),ne=parseInt(le[3]),se=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(M))!==null)W=parseInt(le[1]),K=parseInt(le[2]),ne=parseInt(le[3]),se=parseFloat(le[4]);else{if(se=1,typeof M=="string"&&M.charAt(0)!=="#"){var ye=new ZM(M);M=ye.ok?ye.toHex():"#000000"}M.length===4?(W=M.substring(1,2),W+=W,K=M.substring(2,3),K+=K,ne=M.substring(3,4),ne+=ne):(W=M.substring(1,3),K=M.substring(3,5),ne=M.substring(5,7)),W=parseInt(W,16),K=parseInt(K,16),ne=parseInt(ne,16)}}return{r:W,g:K,b:ne,a:se,style:M}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(M,W,K,ne){if(isNaN(W)||isNaN(K)||typeof M!="string")throw fr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ne=isNaN(ne)?void 0:ne,!m.call(this)){var se=R(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;O.call(this,{text:M,x:W,y:K,scale:le,angle:se,align:this.textAlign,maxWidth:ne})}},h.prototype.strokeText=function(M,W,K,ne){if(isNaN(W)||isNaN(K)||typeof M!="string")throw fr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){ne=isNaN(ne)?void 0:ne;var se=R(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;O.call(this,{text:M,x:W,y:K,scale:le,renderingMode:"stroke",angle:se,align:this.textAlign,maxWidth:ne})}},h.prototype.measureText=function(M){if(typeof M!="string")throw fr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,K=this.pdf.internal.scaleFactor,ne=W.internal.getFontSize(),se=W.getStringUnitWidth(M)*ne/W.internal.scaleFactor,le=function(ye){var oe=(ye=ye||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return oe}}),this};return new le({width:se*=Math.round(96*K/72*1e4)/1e4})},h.prototype.scale=function(M,W){if(isNaN(M)||isNaN(W))throw fr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new c(M,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},h.prototype.rotate=function(M){if(isNaN(M))throw fr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new c(Math.cos(M),Math.sin(M),-Math.sin(M),Math.cos(M),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},h.prototype.translate=function(M,W){if(isNaN(M)||isNaN(W))throw fr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new c(1,0,0,1,M,W);this.ctx.transform=this.ctx.transform.multiply(K)},h.prototype.transform=function(M,W,K,ne,se,le){if(isNaN(M)||isNaN(W)||isNaN(K)||isNaN(ne)||isNaN(se)||isNaN(le))throw fr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ye=new c(M,W,K,ne,se,le);this.ctx.transform=this.ctx.transform.multiply(ye)},h.prototype.setTransform=function(M,W,K,ne,se,le){M=isNaN(M)?1:M,W=isNaN(W)?0:W,K=isNaN(K)?0:K,ne=isNaN(ne)?1:ne,se=isNaN(se)?0:se,le=isNaN(le)?0:le,this.ctx.transform=new c(M,W,K,ne,se,le)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(M,W,K,ne,se,le,ye,oe,ve){var Se=this.pdf.getImageProperties(M),Ae=1,Ee=1,$e=1,je=1;ne!==void 0&&oe!==void 0&&($e=oe/ne,je=ve/se,Ae=Se.width/ne*oe/ne,Ee=Se.height/se*ve/se),le===void 0&&(le=W,ye=K,W=0,K=0),ne!==void 0&&oe===void 0&&(oe=ne,ve=se),ne===void 0&&oe===void 0&&(oe=Se.width,ve=Se.height);for(var te,it=this.ctx.transform.decompose(),Qe=R(it.rotate.shx),Te=new c,ze=(Te=(Te=(Te=Te.multiply(it.translate)).multiply(it.skew)).multiply(it.scale)).applyToRectangle(new l(le-W*$e,ye-K*je,ne*Ae,se*Ee)),qe=b.call(this,ze),Ue=[],nt=0;nt<qe.length;nt+=1)Ue.indexOf(qe[nt])===-1&&Ue.push(qe[nt]);if(_(Ue),this.autoPaging)for(var pt=Ue[0],yt=Ue[Ue.length-1],jt=pt;jt<yt+1;jt++){this.pdf.setPage(jt);var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Kt=jt===1?this.posY+this.margin[0]:this.margin[0],ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],He=jt===1?0:ot+(jt-2)*Pt;if(this.ctx.clip_path.length!==0){var an=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(te,this.posX+this.margin[3],-He+Kt+this.ctx.prevPageLastElemOffset),N.call(this,"fill",!0),this.path=an}var It=JSON.parse(JSON.stringify(ze));It=w([It],this.posX+this.margin[3],-He+Kt+this.ctx.prevPageLastElemOffset)[0];var Rs=(jt>pt||jt<yt)&&v.call(this);Rs&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Pt,null).clip().discardPath()),this.pdf.addImage(M,"JPEG",It.x,It.y,It.w,It.h,null,null,Qe),Rs&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(M,"JPEG",ze.x,ze.y,ze.w,ze.h,null,null,Qe)};var b=function(M,W,K){var ne=[];W=W||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var se=this.posY+this.ctx.prevPageLastElemOffset;switch(M.type){default:case"mt":case"lt":ne.push(Math.floor((M.y+se)/K)+1);break;case"arc":ne.push(Math.floor((M.y+se-M.radius)/K)+1),ne.push(Math.floor((M.y+se+M.radius)/K)+1);break;case"qct":var le=B(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x,M.y);ne.push(Math.floor((le.y+se)/K)+1),ne.push(Math.floor((le.y+le.h+se)/K)+1);break;case"bct":var ye=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x2,M.y2,M.x,M.y);ne.push(Math.floor((ye.y+se)/K)+1),ne.push(Math.floor((ye.y+ye.h+se)/K)+1);break;case"rect":ne.push(Math.floor((M.y+se)/K)+1),ne.push(Math.floor((M.y+M.h+se)/K)+1)}for(var oe=0;oe<ne.length;oe+=1)for(;this.pdf.internal.getNumberOfPages()<ne[oe];)x.call(this);return ne},x=function(){var M=this.fillStyle,W=this.strokeStyle,K=this.font,ne=this.lineCap,se=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=M,this.strokeStyle=W,this.font=K,this.lineCap=ne,this.lineWidth=se,this.lineJoin=le},w=function(M,W,K){for(var ne=0;ne<M.length;ne++)switch(M[ne].type){case"bct":M[ne].x2+=W,M[ne].y2+=K;case"qct":M[ne].x1+=W,M[ne].y1+=K;case"mt":case"lt":case"arc":default:M[ne].x+=W,M[ne].y+=K}return M},_=function(M){return M.sort(function(W,K){return W-K})},S=function(M,W){for(var K,ne,se=this.fillStyle,le=this.strokeStyle,ye=this.lineCap,oe=this.lineWidth,ve=Math.abs(oe*this.ctx.transform.scaleX),Se=this.lineJoin,Ae=JSON.parse(JSON.stringify(this.path)),Ee=JSON.parse(JSON.stringify(this.path)),$e=[],je=0;je<Ee.length;je++)if(Ee[je].x!==void 0)for(var te=b.call(this,Ee[je]),it=0;it<te.length;it+=1)$e.indexOf(te[it])===-1&&$e.push(te[it]);for(var Qe=0;Qe<$e.length;Qe++)for(;this.pdf.internal.getNumberOfPages()<$e[Qe];)x.call(this);if(_($e),this.autoPaging)for(var Te=$e[0],ze=$e[$e.length-1],qe=Te;qe<ze+1;qe++){this.pdf.setPage(qe),this.fillStyle=se,this.strokeStyle=le,this.lineCap=ye,this.lineWidth=ve,this.lineJoin=Se;var Ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],nt=qe===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],jt=qe===1?0:pt+(qe-2)*yt;if(this.ctx.clip_path.length!==0){var Et=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(K,this.posX+this.margin[3],-jt+nt+this.ctx.prevPageLastElemOffset),N.call(this,M,!0),this.path=Et}if(ne=JSON.parse(JSON.stringify(Ae)),this.path=w(ne,this.posX+this.margin[3],-jt+nt+this.ctx.prevPageLastElemOffset),W===!1||qe===0){var Kt=(qe>Te||qe<ze)&&v.call(this);Kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,yt,null).clip().discardPath()),N.call(this,M,W),Kt&&this.pdf.restoreGraphicsState()}this.lineWidth=oe}else this.lineWidth=ve,N.call(this,M,W),this.lineWidth=oe;this.path=Ae},N=function(M,W){if((M!=="stroke"||W||!p.call(this))&&(M==="stroke"||W||!m.call(this))){for(var K,ne,se=[],le=this.path,ye=0;ye<le.length;ye++){var oe=le[ye];switch(oe.type){case"begin":se.push({begin:!0});break;case"close":se.push({close:!0});break;case"mt":se.push({start:oe,deltas:[],abs:[]});break;case"lt":var ve=se.length;if(le[ye-1]&&!isNaN(le[ye-1].x)&&(K=[oe.x-le[ye-1].x,oe.y-le[ye-1].y],ve>0)){for(;ve>=0;ve--)if(se[ve-1].close!==!0&&se[ve-1].begin!==!0){se[ve-1].deltas.push(K),se[ve-1].abs.push(oe);break}}break;case"bct":K=[oe.x1-le[ye-1].x,oe.y1-le[ye-1].y,oe.x2-le[ye-1].x,oe.y2-le[ye-1].y,oe.x-le[ye-1].x,oe.y-le[ye-1].y],se[se.length-1].deltas.push(K);break;case"qct":var Se=le[ye-1].x+2/3*(oe.x1-le[ye-1].x),Ae=le[ye-1].y+2/3*(oe.y1-le[ye-1].y),Ee=oe.x+2/3*(oe.x1-oe.x),$e=oe.y+2/3*(oe.y1-oe.y),je=oe.x,te=oe.y;K=[Se-le[ye-1].x,Ae-le[ye-1].y,Ee-le[ye-1].x,$e-le[ye-1].y,je-le[ye-1].x,te-le[ye-1].y],se[se.length-1].deltas.push(K);break;case"arc":se.push({deltas:[],abs:[],arc:!0}),Array.isArray(se[se.length-1].abs)&&se[se.length-1].abs.push(oe)}}ne=W?null:M==="stroke"?"stroke":"fill";for(var it=!1,Qe=0;Qe<se.length;Qe++)if(se[Qe].arc)for(var Te=se[Qe].abs,ze=0;ze<Te.length;ze++){var qe=Te[ze];qe.type==="arc"?A.call(this,qe.x,qe.y,qe.radius,qe.startAngle,qe.endAngle,qe.counterclockwise,void 0,W,!it):U.call(this,qe.x,qe.y),it=!0}else if(se[Qe].close===!0)this.pdf.internal.out("h"),it=!1;else if(se[Qe].begin!==!0){var Ue=se[Qe].start.x,nt=se[Qe].start.y;q.call(this,se[Qe].deltas,Ue,nt),it=!0}ne&&F.call(this,ne),W&&Y.call(this)}},E=function(M){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return M-K;case"top":return M+W-K;case"hanging":return M+W-2*K;case"middle":return M+W/2-K;case"ideographic":return M;case"alphabetic":default:return M}},P=function(M){return M+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var M=function(){};return M.colorStops=[],M.addColorStop=function(W,K){this.colorStops.push([W,K])},M.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},M.isCanvasGradient=!0,M},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(M,W,K,ne,se,le,ye,oe,ve){for(var Se=H.call(this,K,ne,se,le),Ae=0;Ae<Se.length;Ae++){var Ee=Se[Ae];Ae===0&&(ve?T.call(this,Ee.x1+M,Ee.y1+W):U.call(this,Ee.x1+M,Ee.y1+W)),Z.call(this,M,W,Ee.x2,Ee.y2,Ee.x3,Ee.y3,Ee.x4,Ee.y4)}oe?Y.call(this):F.call(this,ye)},F=function(M){switch(M){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(M,W){this.pdf.internal.out(r(M)+" "+n(W)+" m")},O=function(M){var W;switch(M.align){case"right":case"end":W="right";break;case"center":W="center";break;case"left":case"start":default:W="left"}var K=this.pdf.getTextDimensions(M.text),ne=E.call(this,M.y),se=P.call(this,ne)-K.h,le=this.ctx.transform.applyToPoint(new a(M.x,ne)),ye=this.ctx.transform.decompose(),oe=new c;oe=(oe=(oe=oe.multiply(ye.translate)).multiply(ye.skew)).multiply(ye.scale);for(var ve,Se,Ae,Ee=this.ctx.transform.applyToRectangle(new l(M.x,ne,K.w,K.h)),$e=oe.applyToRectangle(new l(M.x,se,K.w,K.h)),je=b.call(this,$e),te=[],it=0;it<je.length;it+=1)te.indexOf(je[it])===-1&&te.push(je[it]);if(_(te),this.autoPaging)for(var Qe=te[0],Te=te[te.length-1],ze=Qe;ze<Te+1;ze++){this.pdf.setPage(ze);var qe=ze===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[2],pt=nt-this.margin[0],yt=this.pdf.internal.pageSize.width-this.margin[1],jt=yt-this.margin[3],Et=ze===1?0:Ue+(ze-2)*pt;if(this.ctx.clip_path.length!==0){var Kt=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ve,this.posX+this.margin[3],-1*Et+qe),N.call(this,"fill",!0),this.path=Kt}var ot=w([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Et+qe+this.ctx.prevPageLastElemOffset)[0];M.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*M.scale),Ae=this.lineWidth,this.lineWidth=Ae*M.scale);var Pt=this.autoPaging!=="text";if(Pt||ot.y+ot.h<=nt){if(Pt||ot.y>=qe&&ot.x<=yt){var He=Pt?M.text:this.pdf.splitTextToSize(M.text,M.maxWidth||yt-ot.x)[0],an=w([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-Et+qe+this.ctx.prevPageLastElemOffset)[0],It=Pt&&(ze>Qe||ze<Te)&&v.call(this);It&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,pt,null).clip().discardPath()),this.pdf.text(He,an.x,an.y,{angle:M.angle,align:W,renderingMode:M.renderingMode}),It&&this.pdf.restoreGraphicsState()}}else ot.y<nt&&(this.ctx.prevPageLastElemOffset+=nt-ot.y);M.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=Ae)}else M.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*M.scale),Ae=this.lineWidth,this.lineWidth=Ae*M.scale),this.pdf.text(M.text,le.x+this.posX,le.y+this.posY,{angle:M.angle,align:W,renderingMode:M.renderingMode,maxWidth:M.maxWidth}),M.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=Ae)},U=function(M,W,K,ne){K=K||0,ne=ne||0,this.pdf.internal.out(r(M+K)+" "+n(W+ne)+" l")},q=function(M,W,K){return this.pdf.lines(M,W,K,null,null)},Z=function(M,W,K,ne,se,le,ye,oe){this.pdf.internal.out([e(s(K+M)),e(i(ne+W)),e(s(se+M)),e(i(le+W)),e(s(ye+M)),e(i(oe+W)),"c"].join(" "))},H=function(M,W,K,ne){for(var se=2*Math.PI,le=Math.PI/2;W>K;)W-=se;var ye=Math.abs(K-W);ye<se&&ne&&(ye=se-ye);for(var oe=[],ve=ne?-1:1,Se=W;ye>1e-5;){var Ae=Se+ve*Math.min(ye,le);oe.push(Q.call(this,M,Se,Ae)),ye-=Math.abs(Ae-Se),Se=Ae}return oe},Q=function(M,W,K){var ne=(K-W)/2,se=M*Math.cos(ne),le=M*Math.sin(ne),ye=se,oe=-le,ve=ye*ye+oe*oe,Se=ve+ye*se+oe*le,Ae=4/3*(Math.sqrt(2*ve*Se)-Se)/(ye*le-oe*se),Ee=ye-Ae*oe,$e=oe+Ae*ye,je=Ee,te=-$e,it=ne+W,Qe=Math.cos(it),Te=Math.sin(it);return{x1:M*Math.cos(W),y1:M*Math.sin(W),x2:Ee*Qe-$e*Te,y2:Ee*Te+$e*Qe,x3:je*Qe-te*Te,y3:je*Te+te*Qe,x4:M*Math.cos(K),y4:M*Math.sin(K)}},R=function(M){return 180*M/Math.PI},B=function(M,W,K,ne,se,le){var ye=M+.5*(K-M),oe=W+.5*(ne-W),ve=se+.5*(K-se),Se=le+.5*(ne-le),Ae=Math.min(M,se,ye,ve),Ee=Math.max(M,se,ye,ve),$e=Math.min(W,le,oe,Se),je=Math.max(W,le,oe,Se);return new l(Ae,$e,Ee-Ae,je-$e)},X=function(M,W,K,ne,se,le,ye,oe){var ve,Se,Ae,Ee,$e,je,te,it,Qe,Te,ze,qe,Ue,nt,pt=K-M,yt=ne-W,jt=se-K,Et=le-ne,Kt=ye-se,ot=oe-le;for(Se=0;Se<41;Se++)Qe=(te=(Ae=M+(ve=Se/40)*pt)+ve*(($e=K+ve*jt)-Ae))+ve*($e+ve*(se+ve*Kt-$e)-te),Te=(it=(Ee=W+ve*yt)+ve*((je=ne+ve*Et)-Ee))+ve*(je+ve*(le+ve*ot-je)-it),Se==0?(ze=Qe,qe=Te,Ue=Qe,nt=Te):(ze=Math.min(ze,Qe),qe=Math.min(qe,Te),Ue=Math.max(Ue,Qe),nt=Math.max(nt,Te));return new l(Math.round(ze),Math.round(qe),Math.round(Ue-ze),Math.round(nt-qe))},ie=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var M,W,K=(M=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:M,lineDashOffset:W}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(ht.API),function(t){var e=function(i){var a,l,c,u,d,h,f,m,p,v;for(l=[],c=0,u=(i+=a="\0\0\0\0".slice(i.length%4||4)).length;u>c;c+=4)(d=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(h=(d=((d=((d=((d=(d-(v=d%85))/85)-(p=d%85))/85)-(m=d%85))/85)-(f=d%85))/85)%85,l.push(h+33,f+33,m+33,p+33,v+33)):l.push(122);return function(b,x){for(var w=x;w>0;w--)b.pop()}(l,a.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var a,l,c,u,d,h=String,f="length",m=255,p="charCodeAt",v="slice",b="replace";for(i[v](-2),i=i[v](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),c=[],u=0,d=(i+=a="uuuuu"[v](i[f]%5||5))[f];d>u;u+=5)l=52200625*(i[p](u)-33)+614125*(i[p](u+1)-33)+7225*(i[p](u+2)-33)+85*(i[p](u+3)-33)+(i[p](u+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(x,w){for(var _=w;_>0;_--)x.pop()}(c,a[f]),h.fromCharCode.apply(h,c)},n=function(i){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),a.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},s=function(i){for(var a=new Uint8Array(i.length),l=i.length;l--;)a[l]=i.charCodeAt(l);return i=(a=h5(a)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(i,a){var l=0,c=i||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),l=0;l<a.length;l+=1)switch(a[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=s(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(ht.API),function(t){t.loadFile=function(e,r,n){return function(s,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var l=void 0;try{l=function(c,u,d){var h=new XMLHttpRequest,f=0,m=function(p){var v=p.length,b=[],x=String.fromCharCode;for(f=0;f<v;f+=1)b.push(x(255&p.charCodeAt(f)));return b.join("")};if(h.open("GET",c,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?d(m(this.responseText)):d(void 0)}),h.send(null),u&&h.status===200)return m(h.responseText)}(s,i,a)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(ht.API),function(t){function e(){return(mt.html2canvas?Promise.resolve(mt.html2canvas):sc(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function r(){return(mt.DOMPurify?Promise.resolve(mt.DOMPurify):sc(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var l=or(a);return l==="undefined"?"undefined":l==="string"||a instanceof String?"string":l==="number"||a instanceof Number?"number":l==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(a,l){var c=document.createElement(a);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},i=function a(l){var c=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,a,1,[a])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(a,l){return a.__proto__=l||i.prototype,a},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(a,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(r).then(function(c){return this.set({src:s("div",{innerHTML:a,dompurify:c})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},i.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,d){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),f=u.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||h.appendChild(c(f,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var f=0;f<u.length;++f){var m=u[f],p=m.src.find(function(v){return v.format==="truetype"});p&&c.addFont(p.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(a,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(a,l):this.outputPdf(a,l)},i.prototype.outputPdf=function(a,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,l)})},i.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},i.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(a){if(n(a)!=="object")return this;var l=Object.keys(a||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=a[c]};switch(c){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[c]=a[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(a,l){return this.then(function(){var c=a in i.template.prop?this.prop[a]:this.opt[a];return l?l(c):c})},i.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},i.prototype.setPageSize=function(a){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(a=a||ht.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:l(a.inner.width,a.k),height:l(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},i.prototype.setProgress=function(a,l,c,u){return a!=null&&(this.progress.val=a),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(a,l,c,u){return this.setProgress(a?this.progress.val+a:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(a,l){var c=this;return this.thenCore(a,l,function(u,d){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,u),h}).then(u,d).then(function(h){return c.updateProgress(1),h})})},i.prototype.thenCore=function(a,l,c){c=c||Promise.prototype.then,a&&(a=a.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=c.call(u,a,l);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(a,l){return Promise.prototype.then.call(this,a,l)},i.prototype.thenList=function(a){var l=this;return a.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(a){a&&(a=a.bind(this));var l=Promise.prototype.catch.call(this,a);return i.convert(l,this)},i.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},i.prototype.error=function(a){return this.then(function(){throw new Error(a)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,ht.getPageSize=function(a,l,c){if(or(a)==="object"){var u=a;a=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",a=(""+(a||"P")).toLowerCase();var d,h=(""+c).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var m,p=0,v=0;if(f.hasOwnProperty(h))p=f[h][1]/d,v=f[h][0]/d;else try{p=c[1],v=c[0]}catch{throw new Error("Invalid format: "+c)}if(a==="p"||a==="portrait")a="p",v>p&&(m=v,v=p,p=m);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",p>v&&(m=v,v=p,p=m)}return{width:v,height:p,unit:l,k:d,orientation:a}},t.html=function(a,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(x5):null;var c=new i(l);return l.worker?c:c.from(a).doCallback()}}(ht.API),ht.API.addJS=function(t){return h4=t,this.internal.events.subscribe("postPutResources",function(){J0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(J0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),d4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+h4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){J0!==void 0&&d4!==void 0&&this.internal.out("/Names <</JavaScript "+J0+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var a=s[i],l=n.exec(a);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(a)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var h=r.internal.newObject();d.push(h);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var a={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(a),a},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var a=n.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var l=this.count=this.count_r({count:0},a);if(l>0&&this.line("/Count "+l),a.options&&a.options.pageNumber){var c=r.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(ht.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,i,a,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=a||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(h){for(var f,m=256*h.charCodeAt(4)+h.charCodeAt(5),p=h.length,v={width:0,height:0,numcomponents:1},b=4;b<p;b+=2){if(b+=m,e.indexOf(h.charCodeAt(b+1))!==-1){f=256*h.charCodeAt(b+5)+h.charCodeAt(b+6),v={width:256*h.charCodeAt(b+7)+h.charCodeAt(b+8),height:f,numcomponents:h.charCodeAt(b+9)};break}m=256*h.charCodeAt(b+2)+h.charCodeAt(b+3)}return v}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(ht.API);var Sd,Z0,f4,m4,p4,fte=function(){var t,e,r;function n(i){var a,l,c,u,d,h,f,m,p,v,b,x,w,_;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(a=this.readUInt32(),p=(function(){var S,N;for(N=[],S=0;S<4;++S)N.push(String.fromCharCode(this.data[this.pos++]));return N}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,h.delay=1e3*d/u,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(p==="fdAT"&&(this.pos+=4,a-=4),i=(h!=null?h.data:void 0)||this.imgData,x=0;0<=a?x<a:x>a;0<=a?++x:--x)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((v=c-this.transparency.indexed.length)>0)for(w=0;0<=v?w<v:w>v;0<=v?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":f=(b=this.read(a)).indexOf(0),m=String.fromCharCode.apply(String,b.slice(0,f)),this.text[m]=String.fromCharCode.apply(String,b.slice(f+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var a,l;for(l=[],a=0;0<=i?a<i:a>i;0<=i?++a:--a)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var a=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*a),c=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(h,f,m,p){var v,b,x,w,_,S,N,E,P,A,F,Y,T,O,U,q,Z,H,Q,R,B,X=Math.ceil((u.width-h)/m),ie=Math.ceil((u.height-f)/p),M=u.width==X&&u.height==ie;for(O=a*X,Y=M?l:new Uint8Array(O*ie),S=i.length,T=0,b=0;T<ie&&c<S;){switch(i[c++]){case 0:for(w=Z=0;Z<O;w=Z+=1)Y[b++]=i[c++];break;case 1:for(w=H=0;H<O;w=H+=1)v=i[c++],_=w<a?0:Y[b-a],Y[b++]=(v+_)%256;break;case 2:for(w=Q=0;Q<O;w=Q+=1)v=i[c++],x=(w-w%a)/a,U=T&&Y[(T-1)*O+x*a+w%a],Y[b++]=(U+v)%256;break;case 3:for(w=R=0;R<O;w=R+=1)v=i[c++],x=(w-w%a)/a,_=w<a?0:Y[b-a],U=T&&Y[(T-1)*O+x*a+w%a],Y[b++]=(v+Math.floor((_+U)/2))%256;break;case 4:for(w=B=0;B<O;w=B+=1)v=i[c++],x=(w-w%a)/a,_=w<a?0:Y[b-a],T===0?U=q=0:(U=Y[(T-1)*O+x*a+w%a],q=x&&Y[(T-1)*O+(x-1)*a+w%a]),N=_+U-q,E=Math.abs(N-_),A=Math.abs(N-U),F=Math.abs(N-q),P=E<=A&&E<=F?_:A<=F?U:q,Y[b++]=(v+P)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!M){var W=((f+T*p)*u.width+h)*a,K=T*O;for(w=0;w<X;w+=1){for(var ne=0;ne<a;ne+=1)l[W++]=Y[K++];W+=(m-1)*a}}T++}}return i=Wee(i),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),l},n.prototype.decodePalette=function(){var i,a,l,c,u,d,h,f,m;for(l=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+l.length),c=0,i=0,a=h=0,f=l.length;h<f;a=h+=3)u[c++]=l[a],u[c++]=l[a+1],u[c++]=l[a+2],u[c++]=(m=d[i++])!=null?m:255;return u},n.prototype.copyToImageData=function(i,a){var l,c,u,d,h,f,m,p,v,b,x;if(c=this.colors,v=null,l=this.hasAlphaChannel,this.palette.length&&(v=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),c=4,l=!0),p=(u=i.data||i).length,h=v||a,d=f=0,c===1)for(;d<p;)m=v?4*a[d/4]:f,b=h[m++],u[d++]=b,u[d++]=b,u[d++]=b,u[d++]=l?h[m++]:255,f=m;else for(;d<p;)m=v?4*a[d/4]:f,u[d++]=h[m++],u[d++]=h[m++],u[d++]=h[m++],u[d++]=l?h[m++]:255,f=m},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var s=function(){if(Object.prototype.toString.call(mt)==="[object Window]"){try{e=mt.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(i){var a;if(s()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var a,l,c,u,d,h,f,m;if(this.animation){for(m=[],l=d=0,h=(f=this.animation.frames).length;d<h;l=++d)a=f[l],c=i.createImageData(a.width,a.height),u=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(c,u),a.imageData=c,m.push(a.image=t(c));return m}},n.prototype.renderFrame=function(i,a){var l,c,u;return l=(c=this.animation.frames)[a],u=c[a-1],a===0&&i.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var a,l,c,u,d,h,f=this;return l=0,h=this.animation,u=h.numFrames,c=h.frames,d=h.numPlays,(a=function(){var m,p;if(m=l++%u,p=c[m],f.renderFrame(i,m),u>1&&l/u<d)return f.animation._timeout=setTimeout(a,p.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var a,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,a=i.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(l=a.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),a.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function mte(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],i=s>>7,a=1<<(7&s)+1;t[e++],t[e++];var l=null,c=null;i&&(l=e,c=a,e+=3*a);var u=!0,d=[],h=0,f=null,m=0,p=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,p=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[e++];h=t[e++]|t[e++]<<8,f=t[e++],!(1&v)&&(f=null),m=v>>2&7,e++;break;case 254:for(;;){if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var b=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,S=t[e++],N=S>>6&1,E=1<<(7&S)+1,P=l,A=c,F=!1;S>>7&&(F=!0,P=e,A=E,e+=3*E);var Y=e;for(e++;;){var T;if(!((T=t[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}d.push({x:b,y:x,width:w,height:_,has_local_palette:F,palette_offset:P,palette_size:A,data_offset:Y,data_length:e-Y,transparent_index:f,interlaced:!!N,delay:h,disposal:m});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return p},this.frameInfo=function(O){if(O<0||O>=d.length)throw new Error("Frame index out of range.");return d[O]},this.decodeAndBlitFrameBGRA=function(O,U){var q=this.frameInfo(O),Z=q.width*q.height,H=new Uint8Array(Z);g4(t,q.data_offset,H,Z);var Q=q.palette_offset,R=q.transparent_index;R===null&&(R=256);var B=q.width,X=r-B,ie=B,M=4*(q.y*r+q.x),W=4*((q.y+q.height)*r+q.x),K=M,ne=4*X;q.interlaced===!0&&(ne+=4*r*7);for(var se=8,le=0,ye=H.length;le<ye;++le){var oe=H[le];if(ie===0&&(ie=B,(K+=ne)>=W&&(ne=4*X+4*r*(se-1),K=M+(B+X)*(se<<1),se>>=1)),oe===R)K+=4;else{var ve=t[Q+3*oe],Se=t[Q+3*oe+1],Ae=t[Q+3*oe+2];U[K++]=Ae,U[K++]=Se,U[K++]=ve,U[K++]=255}--ie}},this.decodeAndBlitFrameRGBA=function(O,U){var q=this.frameInfo(O),Z=q.width*q.height,H=new Uint8Array(Z);g4(t,q.data_offset,H,Z);var Q=q.palette_offset,R=q.transparent_index;R===null&&(R=256);var B=q.width,X=r-B,ie=B,M=4*(q.y*r+q.x),W=4*((q.y+q.height)*r+q.x),K=M,ne=4*X;q.interlaced===!0&&(ne+=4*r*7);for(var se=8,le=0,ye=H.length;le<ye;++le){var oe=H[le];if(ie===0&&(ie=B,(K+=ne)>=W&&(ne=4*X+4*r*(se-1),K=M+(B+X)*(se<<1),se>>=1)),oe===R)K+=4;else{var ve=t[Q+3*oe],Se=t[Q+3*oe+1],Ae=t[Q+3*oe+2];U[K++]=ve,U[K++]=Se,U[K++]=Ae,U[K++]=255}--ie}}}function g4(t,e,r,n){for(var s=t[e++],i=1<<s,a=i+1,l=a+1,c=s+1,u=(1<<c)-1,d=0,h=0,f=0,m=t[e++],p=new Int32Array(4096),v=null;;){for(;d<16&&m!==0;)h|=t[e++]<<d,d+=8,m===1?m=t[e++]:--m;if(d<c)break;var b=h&u;if(h>>=c,d-=c,b!==i){if(b===a)break;for(var x=b<l?b:v,w=0,_=x;_>i;)_=p[_]>>8,++w;var S=_;if(f+w+(x!==b?1:0)>n)return void fr.log("Warning, gif stream longer than expected.");r[f++]=S;var N=f+=w;for(x!==b&&(r[f++]=S),_=x;w--;)_=p[_],r[--N]=255&_,_>>=8;v!==null&&l<4096&&(p[l++]=v<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),v=b}else l=a+1,u=(1<<(c=s+1))-1,v=null}return f!==n&&fr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ob(t){var e,r,n,s,i,a=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),h=new Array(65535),f=new Array(65535),m=new Array(64),p=new Array(64),v=[],b=0,x=7,w=new Array(64),_=new Array(64),S=new Array(64),N=new Array(256),E=new Array(2048),P=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function H(M,W){for(var K=0,ne=0,se=new Array,le=1;le<=16;le++){for(var ye=1;ye<=M[le];ye++)se[W[ne]]=[],se[W[ne]][0]=K,se[W[ne]][1]=le,ne++,K++;K*=2}return se}function Q(M){for(var W=M[0],K=M[1]-1;K>=0;)W&1<<K&&(b|=1<<x),K--,--x<0&&(b==255?(R(255),R(0)):R(b),x=7,b=0)}function R(M){v.push(M)}function B(M){R(M>>8&255),R(255&M)}function X(M,W,K,ne,se){for(var le,ye=se[0],oe=se[240],ve=function(Te,ze){var qe,Ue,nt,pt,yt,jt,Et,Kt,ot,Pt,He=0;for(ot=0;ot<8;++ot){qe=Te[He],Ue=Te[He+1],nt=Te[He+2],pt=Te[He+3],yt=Te[He+4],jt=Te[He+5],Et=Te[He+6];var an=qe+(Kt=Te[He+7]),It=qe-Kt,Rs=Ue+Et,Qt=Ue-Et,Wt=nt+jt,si=nt-jt,Ge=pt+yt,Ht=pt-yt,ft=an+Ge,Rr=an-Ge,Jr=Rs+Wt,dr=Rs-Wt;Te[He]=ft+Jr,Te[He+4]=ft-Jr;var gt=.707106781*(dr+Rr);Te[He+2]=Rr+gt,Te[He+6]=Rr-gt;var Zt=.382683433*((ft=Ht+si)-(dr=Qt+It)),Cc=.5411961*ft+Zt,Sn=1.306562965*dr+Zt,ya=.707106781*(Jr=si+Qt),ba=It+ya,dt=It-ya;Te[He+5]=dt+Cc,Te[He+3]=dt-Cc,Te[He+1]=ba+Sn,Te[He+7]=ba-Sn,He+=8}for(He=0,ot=0;ot<8;++ot){qe=Te[He],Ue=Te[He+8],nt=Te[He+16],pt=Te[He+24],yt=Te[He+32],jt=Te[He+40],Et=Te[He+48];var Pi=qe+(Kt=Te[He+56]),wa=qe-Kt,fs=Ue+Et,on=Ue-Et,Zr=nt+jt,Ds=nt-jt,Fu=pt+yt,so=pt-yt,Ai=Pi+Fu,Ti=Pi-Fu,Li=fs+Zr,_a=fs-Zr;Te[He]=Ai+Li,Te[He+32]=Ai-Li;var ii=.707106781*(_a+Ti);Te[He+16]=Ti+ii,Te[He+48]=Ti-ii;var ja=.382683433*((Ai=so+Ds)-(_a=on+wa)),Nc=.5411961*Ai+ja,Iu=1.306562965*_a+ja,zu=.707106781*(Li=Ds+on),$u=wa+zu,Bu=wa-zu;Te[He+40]=Bu+Nc,Te[He+24]=Bu-Nc,Te[He+8]=$u+Iu,Te[He+56]=$u-Iu,He++}for(ot=0;ot<64;++ot)Pt=Te[ot]*ze[ot],m[ot]=Pt>0?Pt+.5|0:Pt-.5|0;return m}(M,W),Se=0;Se<64;++Se)p[P[Se]]=ve[Se];var Ae=p[0]-K;K=p[0],Ae==0?Q(ne[0]):(Q(ne[f[le=32767+Ae]]),Q(h[le]));for(var Ee=63;Ee>0&&p[Ee]==0;)Ee--;if(Ee==0)return Q(ye),K;for(var $e,je=1;je<=Ee;){for(var te=je;p[je]==0&&je<=Ee;)++je;var it=je-te;if(it>=16){$e=it>>4;for(var Qe=1;Qe<=$e;++Qe)Q(oe);it&=15}le=32767+p[je],Q(se[(it<<4)+f[le]]),Q(h[le]),je++}return Ee!=63&&Q(ye),K}function ie(M){M=Math.min(Math.max(M,1),100),i!=M&&(function(W){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ne=0;ne<64;ne++){var se=a((K[ne]*W+50)/100);se=Math.min(Math.max(se,1),255),l[P[ne]]=se}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ye=0;ye<64;ye++){var oe=a((le[ye]*W+50)/100);oe=Math.min(Math.max(oe,1),255),c[P[ye]]=oe}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,Ae=0;Ae<8;Ae++)for(var Ee=0;Ee<8;Ee++)u[Se]=1/(l[P[Se]]*ve[Ae]*ve[Ee]*8),d[Se]=1/(c[P[Se]]*ve[Ae]*ve[Ee]*8),Se++}(M<50?Math.floor(5e3/M):Math.floor(200-2*M)),i=M)}this.encode=function(M,W){W&&ie(W),v=new Array,b=0,x=7,B(65496),B(65504),B(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),B(1),B(1),R(0),R(0),function(){B(65499),B(132),R(0);for(var Ue=0;Ue<64;Ue++)R(l[Ue]);R(1);for(var nt=0;nt<64;nt++)R(c[nt])}(),function(Ue,nt){B(65472),B(17),R(8),B(nt),B(Ue),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)}(M.width,M.height),function(){B(65476),B(418),R(0);for(var Ue=0;Ue<16;Ue++)R(A[Ue+1]);for(var nt=0;nt<=11;nt++)R(F[nt]);R(16);for(var pt=0;pt<16;pt++)R(Y[pt+1]);for(var yt=0;yt<=161;yt++)R(T[yt]);R(1);for(var jt=0;jt<16;jt++)R(O[jt+1]);for(var Et=0;Et<=11;Et++)R(U[Et]);R(17);for(var Kt=0;Kt<16;Kt++)R(q[Kt+1]);for(var ot=0;ot<=161;ot++)R(Z[ot])}(),B(65498),B(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var K=0,ne=0,se=0;b=0,x=7,this.encode.displayName="_encode_";for(var le,ye,oe,ve,Se,Ae,Ee,$e,je,te=M.data,it=M.width,Qe=M.height,Te=4*it,ze=0;ze<Qe;){for(le=0;le<Te;){for(Se=Te*ze+le,Ee=-1,$e=0,je=0;je<64;je++)Ae=Se+($e=je>>3)*Te+(Ee=4*(7&je)),ze+$e>=Qe&&(Ae-=Te*(ze+1+$e-Qe)),le+Ee>=Te&&(Ae-=le+Ee-Te+4),ye=te[Ae++],oe=te[Ae++],ve=te[Ae++],w[je]=(E[ye]+E[oe+256>>0]+E[ve+512>>0]>>16)-128,_[je]=(E[ye+768>>0]+E[oe+1024>>0]+E[ve+1280>>0]>>16)-128,S[je]=(E[ye+1280>>0]+E[oe+1536>>0]+E[ve+1792>>0]>>16)-128;K=X(w,u,K,e,n),ne=X(_,d,ne,r,s),se=X(S,d,se,r,s),le+=32}ze+=8}if(x>=0){var qe=[];qe[1]=x+1,qe[0]=(1<<x+1)-1,Q(qe)}return B(65497),new Uint8Array(v)},t=t||50,function(){for(var M=String.fromCharCode,W=0;W<256;W++)N[W]=M(W)}(),e=H(A,F),r=H(O,U),n=H(Y,T),s=H(q,Z),function(){for(var M=1,W=2,K=1;K<=15;K++){for(var ne=M;ne<W;ne++)f[32767+ne]=K,h[32767+ne]=[],h[32767+ne][1]=K,h[32767+ne][0]=ne;for(var se=-(W-1);se<=-M;se++)f[32767+se]=K,h[32767+se]=[],h[32767+se][1]=K,h[32767+se][0]=W-1+se;M<<=1,W<<=1}}(),function(){for(var M=0;M<256;M++)E[M]=19595*M,E[M+256>>0]=38470*M,E[M+512>>0]=7471*M+32768,E[M+768>>0]=-11059*M,E[M+1024>>0]=-21709*M,E[M+1280>>0]=32768*M+8421375,E[M+1536>>0]=-27439*M,E[M+1792>>0]=-5329*M}(),ie(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Bi(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function v4(t){function e(A){if(!A)throw Error("assert :P")}function r(A,F,Y){for(var T=0;4>T;T++)if(A[F+T]!=Y.charCodeAt(T))return!0;return!1}function n(A,F,Y,T,O){for(var U=0;U<O;U++)A[F+U]=Y[T+U]}function s(A,F,Y,T){for(var O=0;O<T;O++)A[F+O]=Y}function i(A){return new Int32Array(A)}function a(A,F){for(var Y=[],T=0;T<A;T++)Y.push(new F);return Y}function l(A,F){var Y=[];return function T(O,U,q){for(var Z=q[U],H=0;H<Z&&(O.push(q.length>U+1?[]:new F),!(q.length<U+1));H++)T(O[H],U+1,q)}(Y,0,A),Y}var c=function(){var A=this;function F(g,j){for(var k=1<<j-1>>>0;g&k;)k>>>=1;return k?(g&k-1)+k:g}function Y(g,j,k,L,D){e(!(L%k));do g[j+(L-=k)]=D;while(0<L)}function T(g,j,k,L,D){if(e(2328>=D),512>=D)var z=i(512);else if((z=i(D))==null)return 0;return function($,V,G,ee,he,we){var _e,xe,Me=V,Ce=1<<G,fe=i(16),ge=i(16);for(e(he!=0),e(ee!=null),e($!=null),e(0<G),xe=0;xe<he;++xe){if(15<ee[xe])return 0;++fe[ee[xe]]}if(fe[0]==he)return 0;for(ge[1]=0,_e=1;15>_e;++_e){if(fe[_e]>1<<_e)return 0;ge[_e+1]=ge[_e]+fe[_e]}for(xe=0;xe<he;++xe)_e=ee[xe],0<ee[xe]&&(we[ge[_e]++]=xe);if(ge[15]==1)return(ee=new O).g=0,ee.value=we[0],Y($,Me,1,Ce,ee),Ce;var Le,Re=-1,Oe=Ce-1,Je=0,Ve=1,lt=1,We=1<<G;for(xe=0,_e=1,he=2;_e<=G;++_e,he<<=1){if(Ve+=lt<<=1,0>(lt-=fe[_e]))return 0;for(;0<fe[_e];--fe[_e])(ee=new O).g=_e,ee.value=we[xe++],Y($,Me+Je,he,We,ee),Je=F(Je,_e)}for(_e=G+1,he=2;15>=_e;++_e,he<<=1){if(Ve+=lt<<=1,0>(lt-=fe[_e]))return 0;for(;0<fe[_e];--fe[_e]){if(ee=new O,(Je&Oe)!=Re){for(Me+=We,Le=1<<(Re=_e)-G;15>Re&&!(0>=(Le-=fe[Re]));)++Re,Le<<=1;Ce+=We=1<<(Le=Re-G),$[V+(Re=Je&Oe)].g=Le+G,$[V+Re].value=Me-V-Re}ee.g=_e-G,ee.value=we[xe++],Y($,Me+(Je>>G),he,We,ee),Je=F(Je,_e)}}return Ve!=2*ge[15]-1?0:Ce}(g,j,k,L,D,z)}function O(){this.value=this.g=0}function U(){this.value=this.g=0}function q(){this.G=a(5,O),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Cn,U)}function Z(g,j,k,L){e(g!=null),e(j!=null),e(2147483648>L),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=j,g.pa=k,g.Jd=j,g.Yc=k+L,g.Zc=4<=L?k+L-4+1:k,le(g)}function H(g,j){for(var k=0;0<j--;)k|=oe(g,128)<<j;return k}function Q(g,j){var k=H(g,j);return ye(g)?-k:k}function R(g,j,k,L){var D,z=0;for(e(g!=null),e(j!=null),e(4294967288>L),g.Sb=L,g.Ra=0,g.u=0,g.h=0,4<L&&(L=4),D=0;D<L;++D)z+=j[k+D]<<8*D;g.Ra=z,g.bb=L,g.oa=j,g.pa=k}function B(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<rd-8>>>0,++g.bb,g.u-=8;K(g)&&(g.h=1,g.u=0)}function X(g,j){if(e(0<=j),!g.h&&j<=td){var k=W(g)&ed[j];return g.u+=j,B(g),k}return g.h=1,g.u=0}function ie(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function M(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(g){return g.Ra>>>(g.u&rd-1)>>>0}function K(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>rd}function ne(g,j){g.u=j,g.h=K(g)}function se(g){g.u>=Bf&&(e(g.u>=Bf),B(g))}function le(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function ye(g){return H(g,1)}function oe(g,j){var k=g.Ca;0>g.b&&le(g);var L=g.b,D=k*j>>>8,z=(g.I>>>L>D)+0;for(z?(k-=D,g.I-=D+1<<L>>>0):k=D+1,L=k,D=0;256<=L;)D+=8,L>>=8;return L=7^D+ps[L],g.b-=L,g.Ca=(k<<L)-1,z}function ve(g,j,k){g[j+0]=k>>24&255,g[j+1]=k>>16&255,g[j+2]=k>>8&255,g[j+3]=k>>0&255}function Se(g,j){return g[j+0]<<0|g[j+1]<<8}function Ae(g,j){return Se(g,j)|g[j+2]<<16}function Ee(g,j){return Se(g,j)|Se(g,j+2)<<16}function $e(g,j){var k=1<<j;return e(g!=null),e(0<j),g.X=i(k),g.X==null?0:(g.Mb=32-j,g.Xa=j,1)}function je(g,j){e(g!=null),e(j!=null),e(g.Xa==j.Xa),n(j.X,0,g.X,0,1<<j.Xa)}function te(){this.X=[],this.Xa=this.Mb=0}function it(g,j,k,L){e(k!=null),e(L!=null);var D=k[0],z=L[0];return D==0&&(D=(g*z+j/2)/j),z==0&&(z=(j*D+g/2)/g),0>=D||0>=z?0:(k[0]=D,L[0]=z,1)}function Qe(g,j){return g+(1<<j)-1>>>j}function Te(g,j){return((4278255360&g)+(4278255360&j)>>>0&4278255360)+((16711935&g)+(16711935&j)>>>0&16711935)>>>0}function ze(g,j){A[j]=function(k,L,D,z,$,V,G){var ee;for(ee=0;ee<$;++ee){var he=A[g](V[G+ee-1],D,z+ee);V[G+ee]=Te(k[L+ee],he)}}}function qe(){this.ud=this.hd=this.jd=0}function Ue(g,j){return((4278124286&(g^j))>>>1)+(g&j)>>>0}function nt(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function pt(g,j){return nt(g+(g-j+.5>>1))}function yt(g,j,k){return Math.abs(j-k)-Math.abs(g-k)}function jt(g,j,k,L,D,z,$){for(L=z[$-1],k=0;k<D;++k)z[$+k]=L=Te(g[j+k],L)}function Et(g,j,k,L,D){var z;for(z=0;z<k;++z){var $=g[j+z],V=$>>8&255,G=16711935&(G=(G=16711935&$)+((V<<16)+V));L[D+z]=(4278255360&$)+G>>>0}}function Kt(g,j){j.jd=g>>0&255,j.hd=g>>8&255,j.ud=g>>16&255}function ot(g,j,k,L,D,z){var $;for($=0;$<L;++$){var V=j[k+$],G=V>>>8,ee=V,he=255&(he=(he=V>>>16)+((g.jd<<24>>24)*(G<<24>>24)>>>5));ee=255&(ee=(ee=ee+((g.hd<<24>>24)*(G<<24>>24)>>>5))+((g.ud<<24>>24)*(he<<24>>24)>>>5)),D[z+$]=(4278255360&V)+(he<<16)+ee}}function Pt(g,j,k,L,D){A[j]=function(z,$,V,G,ee,he,we,_e,xe){for(G=we;G<_e;++G)for(we=0;we<xe;++we)ee[he++]=D(V[L(z[$++])])},A[g]=function(z,$,V,G,ee,he,we){var _e=8>>z.b,xe=z.Ea,Me=z.K[0],Ce=z.w;if(8>_e)for(z=(1<<z.b)-1,Ce=(1<<_e)-1;$<V;++$){var fe,ge=0;for(fe=0;fe<xe;++fe)fe&z||(ge=L(G[ee++])),he[we++]=D(Me[ge&Ce]),ge>>=_e}else A["VP8LMapColor"+k](G,ee,Me,Ce,he,we,$,V,xe)}}function He(g,j,k,L,D){for(k=j+k;j<k;){var z=g[j++];L[D++]=z>>16&255,L[D++]=z>>8&255,L[D++]=z>>0&255}}function an(g,j,k,L,D){for(k=j+k;j<k;){var z=g[j++];L[D++]=z>>16&255,L[D++]=z>>8&255,L[D++]=z>>0&255,L[D++]=z>>24&255}}function It(g,j,k,L,D){for(k=j+k;j<k;){var z=($=g[j++])>>16&240|$>>12&15,$=$>>0&240|$>>28&15;L[D++]=z,L[D++]=$}}function Rs(g,j,k,L,D){for(k=j+k;j<k;){var z=($=g[j++])>>16&248|$>>13&7,$=$>>5&224|$>>3&31;L[D++]=z,L[D++]=$}}function Qt(g,j,k,L,D){for(k=j+k;j<k;){var z=g[j++];L[D++]=z>>0&255,L[D++]=z>>8&255,L[D++]=z>>16&255}}function Wt(g,j,k,L,D,z){if(z==0)for(k=j+k;j<k;)ve(L,((z=g[j++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),D+=32;else n(L,D,g,j,k)}function si(g,j){A[j][0]=A[g+"0"],A[j][1]=A[g+"1"],A[j][2]=A[g+"2"],A[j][3]=A[g+"3"],A[j][4]=A[g+"4"],A[j][5]=A[g+"5"],A[j][6]=A[g+"6"],A[j][7]=A[g+"7"],A[j][8]=A[g+"8"],A[j][9]=A[g+"9"],A[j][10]=A[g+"10"],A[j][11]=A[g+"11"],A[j][12]=A[g+"12"],A[j][13]=A[g+"13"],A[j][14]=A[g+"0"],A[j][15]=A[g+"0"]}function Ge(g){return g==ky||g==Ey||g==Pg||g==Py}function Ht(){this.eb=[],this.size=this.A=this.fb=0}function ft(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Rr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ht,this.f.kb=new ft,this.sd=null}function Jr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function dr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function gt(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function Zt(g,j){var k=g.T,L=j.ba.f.RGBA,D=L.eb,z=L.fb+g.ka*L.A,$=di[j.ba.S],V=g.y,G=g.O,ee=g.f,he=g.N,we=g.ea,_e=g.W,xe=j.cc,Me=j.dc,Ce=j.Mc,fe=j.Nc,ge=g.ka,Le=g.ka+g.T,Re=g.U,Oe=Re+1>>1;for(ge==0?$(V,G,null,null,ee,he,we,_e,ee,he,we,_e,D,z,null,null,Re):($(j.ec,j.fc,V,G,xe,Me,Ce,fe,ee,he,we,_e,D,z-L.A,D,z,Re),++k);ge+2<Le;ge+=2)xe=ee,Me=he,Ce=we,fe=_e,he+=g.Rc,_e+=g.Rc,z+=2*L.A,$(V,(G+=2*g.fa)-g.fa,V,G,xe,Me,Ce,fe,ee,he,we,_e,D,z-L.A,D,z,Re);return G+=g.fa,g.j+Le<g.o?(n(j.ec,j.fc,V,G,Re),n(j.cc,j.dc,ee,he,Oe),n(j.Mc,j.Nc,we,_e,Oe),k--):1&Le||$(V,G,null,null,ee,he,we,_e,ee,he,we,_e,D,z+L.A,null,null,Re),k}function Cc(g,j,k){var L=g.F,D=[g.J];if(L!=null){var z=g.U,$=j.ba.S,V=$==Eg||$==Pg;j=j.ba.f.RGBA;var G=[0],ee=g.ka;G[0]=g.T,g.Kb&&(ee==0?--G[0]:(--ee,D[0]-=g.width),g.j+g.ka+g.T==g.o&&(G[0]=g.o-g.j-ee));var he=j.eb;ee=j.fb+ee*j.A,g=pr(L,D[0],g.width,z,G,he,ee+(V?0:3),j.A),e(k==G),g&&Ge($)&&ci(he,ee,V,z,G,j.A)}return 0}function Sn(g){var j=g.ma,k=j.ba.S,L=11>k,D=k==Ng||k==kg||k==Eg||k==Ny||k==12||Ge(k);if(j.memory=null,j.Ib=null,j.Jb=null,j.Nd=null,!zf(j.Oa,g,D?11:12))return 0;if(D&&Ge(k)&&De(),g.da)alert("todo:use_scaling");else{if(L){if(j.Ib=gt,g.Kb){if(k=g.U+1>>1,j.memory=i(g.U+2*k),j.memory==null)return 0;j.ec=j.memory,j.fc=0,j.cc=j.ec,j.dc=j.fc+g.U,j.Mc=j.cc,j.Nc=j.dc+k,j.Ib=Zt,De()}}else alert("todo:EmitYUV");D&&(j.Jb=Cc,L&&be())}if(L&&!fS){for(g=0;256>g;++g)$8[g]=89858*(g-128)+Tg>>Ag,U8[g]=-22014*(g-128)+Tg,q8[g]=-45773*(g-128),B8[g]=113618*(g-128)+Tg>>Ag;for(g=Yf;g<Ly;++g)j=76283*(g-16)+Tg>>Ag,V8[g-Yf]=Fs(j,255),W8[g-Yf]=Fs(j+8>>4,15);fS=1}return 1}function ya(g){var j=g.ma,k=g.U,L=g.T;return e(!(1&g.ka)),0>=k||0>=L?0:(k=j.Ib(g,j),j.Jb!=null&&j.Jb(g,j,k),j.Dc+=k,1)}function ba(g){g.ma.memory=null}function dt(g,j,k,L){return X(g,8)!=47?0:(j[0]=X(g,14)+1,k[0]=X(g,14)+1,L[0]=X(g,1),X(g,3)!=0?0:!g.h)}function Pi(g,j){if(4>g)return g+1;var k=g-2>>1;return(2+(1&g)<<k)+X(j,k)+1}function wa(g,j){return 120<j?j-120:1<=(k=((k=N8[j-1])>>4)*g+(8-(15&k)))?k:1;var k}function fs(g,j,k){var L=W(k),D=g[j+=255&L].g-8;return 0<D&&(ne(k,k.u+8),L=W(k),j+=g[j].value,j+=L&(1<<D)-1),ne(k,k.u+g[j].g),g[j].value}function on(g,j,k){return k.g+=g.g,k.value+=g.value<<j>>>0,e(8>=k.g),g.g}function Zr(g,j,k){var L=g.xc;return e((j=L==0?0:g.vc[g.md*(k>>L)+(j>>L)])<g.Wb),g.Ya[j]}function Ds(g,j,k,L){var D=g.ab,z=g.c*j,$=g.C;j=$+j;var V=k,G=L;for(L=g.Ta,k=g.Ua;0<D--;){var ee=g.gc[D],he=$,we=j,_e=V,xe=G,Me=(G=L,V=k,ee.Ea);switch(e(he<we),e(we<=ee.nc),ee.hc){case 2:yg(_e,xe,(we-he)*Me,G,V);break;case 0:var Ce=he,fe=we,ge=G,Le=V,Re=(We=ee).Ea;Ce==0&&(Sy(_e,xe,null,null,1,ge,Le),jt(_e,xe+1,0,0,Re-1,ge,Le+1),xe+=Re,Le+=Re,++Ce);for(var Oe=1<<We.b,Je=Oe-1,Ve=Qe(Re,We.b),lt=We.K,We=We.w+(Ce>>We.b)*Ve;Ce<fe;){var Jt=lt,sr=We,Gt=1;for(qf(_e,xe,ge,Le-Re,1,ge,Le);Gt<Re;){var Ft=(Gt&~Je)+Oe;Ft>Re&&(Ft=Re),(0,rl[Jt[sr++]>>8&15])(_e,xe+ +Gt,ge,Le+Gt-Re,Ft-Gt,ge,Le+Gt),Gt=Ft}xe+=Re,Le+=Re,++Ce&Je||(We+=Ve)}we!=ee.nc&&n(G,V-Me,G,V+(we-he-1)*Me,Me);break;case 1:for(Me=_e,fe=xe,Re=(_e=ee.Ea)-(Le=_e&~(ge=(xe=1<<ee.b)-1)),Ce=Qe(_e,ee.b),Oe=ee.K,ee=ee.w+(he>>ee.b)*Ce;he<we;){for(Je=Oe,Ve=ee,lt=new qe,We=fe+Le,Jt=fe+_e;fe<We;)Kt(Je[Ve++],lt),Tc(lt,Me,fe,xe,G,V),fe+=xe,V+=xe;fe<Jt&&(Kt(Je[Ve++],lt),Tc(lt,Me,fe,Re,G,V),fe+=Re,V+=Re),++he&ge||(ee+=Ce)}break;case 3:if(_e==G&&xe==V&&0<ee.b){for(fe=G,_e=Me=V+(we-he)*Me-(Le=(we-he)*Qe(ee.Ea,ee.b)),xe=G,ge=V,Ce=[],Le=(Re=Le)-1;0<=Le;--Le)Ce[Le]=xe[ge+Le];for(Le=Re-1;0<=Le;--Le)fe[_e+Le]=Ce[Le];ai(ee,he,we,G,Me,G,V)}else ai(ee,he,we,_e,xe,G,V)}V=L,G=k}G!=k&&n(L,k,V,G,z)}function Fu(g,j){var k=g.V,L=g.Ba+g.c*g.C,D=j-g.C;if(e(j<=g.l.o),e(16>=D),0<D){var z=g.l,$=g.Ta,V=g.Ua,G=z.width;if(Ds(g,D,k,L),D=V=[V],e((k=g.C)<(L=j)),e(z.v<z.va),L>z.o&&(L=z.o),k<z.j){var ee=z.j-k;k=z.j,D[0]+=ee*G}if(k>=L?k=0:(D[0]+=4*z.v,z.ka=k-z.j,z.U=z.va-z.v,z.T=L-k,k=1),k){if(V=V[0],11>(k=g.ca).S){var he=k.f.RGBA,we=(L=k.S,D=z.U,z=z.T,ee=he.eb,he.A),_e=z;for(he=he.fb+g.Ma*he.A;0<_e--;){var xe=$,Me=V,Ce=D,fe=ee,ge=he;switch(L){case Cg:gs(xe,Me,Ce,fe,ge);break;case Ng:Qn(xe,Me,Ce,fe,ge);break;case ky:Qn(xe,Me,Ce,fe,ge),ci(fe,ge,0,Ce,1,0);break;case nS:lo(xe,Me,Ce,fe,ge);break;case kg:Wt(xe,Me,Ce,fe,ge,1);break;case Ey:Wt(xe,Me,Ce,fe,ge,1),ci(fe,ge,0,Ce,1,0);break;case Eg:Wt(xe,Me,Ce,fe,ge,0);break;case Pg:Wt(xe,Me,Ce,fe,ge,0),ci(fe,ge,1,Ce,1,0);break;case Ny:nl(xe,Me,Ce,fe,ge);break;case Py:nl(xe,Me,Ce,fe,ge),mr(fe,ge,Ce,1,0);break;case sS:oo(xe,Me,Ce,fe,ge);break;default:e(0)}V+=G,he+=we}g.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=k.height)}}g.C=j,e(g.C<=g.i)}function so(g){var j;if(0<g.ua)return 0;for(j=0;j<g.Wb;++j){var k=g.Ya[j].G,L=g.Ya[j].H;if(0<k[1][L[1]+0].g||0<k[2][L[2]+0].g||0<k[3][L[3]+0].g)return 0}return 1}function Ai(g,j,k,L,D,z){if(g.Z!=0){var $=g.qd,V=g.rd;for(e(ol[g.Z]!=null);j<k;++j)ol[g.Z]($,V,L,D,L,D,z),$=L,V=D,D+=z;g.qd=$,g.rd=V}}function Ti(g,j){var k=g.l.ma,L=k.Z==0||k.Z==1?g.l.j:g.C;if(L=g.C<L?L:g.C,e(j<=g.l.o),j>L){var D=g.l.width,z=k.ca,$=k.tb+D*L,V=g.V,G=g.Ba+g.c*L,ee=g.gc;e(g.ab==1),e(ee[0].hc==3),bg(ee[0],L,j,V,G,z,$),Ai(k,L,j,z,$,D)}g.C=g.Ma=j}function Li(g,j,k,L,D,z,$){var V=g.$/L,G=g.$%L,ee=g.m,he=g.s,we=k+g.$,_e=we;D=k+L*D;var xe=k+L*z,Me=280+he.ua,Ce=g.Pb?V:16777216,fe=0<he.ua?he.Wa:null,ge=he.wc,Le=we<xe?Zr(he,G,V):null;e(g.C<z),e(xe<=D);var Re=!1;e:for(;;){for(;Re||we<xe;){var Oe=0;if(V>=Ce){var Je=we-k;e((Ce=g).Pb),Ce.wd=Ce.m,Ce.xd=Je,0<Ce.s.ua&&je(Ce.s.Wa,Ce.s.vb),Ce=V+E8}if(G&ge||(Le=Zr(he,G,V)),e(Le!=null),Le.Qb&&(j[we]=Le.qb,Re=!0),!Re)if(se(ee),Le.jc){Oe=ee,Je=j;var Ve=we,lt=Le.pd[W(Oe)&Cn-1];e(Le.jc),256>lt.g?(ne(Oe,Oe.u+lt.g),Je[Ve]=lt.value,Oe=0):(ne(Oe,Oe.u+lt.g-256),e(256<=lt.value),Oe=lt.value),Oe==0&&(Re=!0)}else Oe=fs(Le.G[0],Le.H[0],ee);if(ee.h)break;if(Re||256>Oe){if(!Re)if(Le.nd)j[we]=(Le.qb|Oe<<8)>>>0;else{if(se(ee),Re=fs(Le.G[1],Le.H[1],ee),se(ee),Je=fs(Le.G[2],Le.H[2],ee),Ve=fs(Le.G[3],Le.H[3],ee),ee.h)break;j[we]=(Ve<<24|Re<<16|Oe<<8|Je)>>>0}if(Re=!1,++we,++G>=L&&(G=0,++V,$!=null&&V<=z&&!(V%16)&&$(g,V),fe!=null))for(;_e<we;)Oe=j[_e++],fe.X[(506832829*Oe&4294967295)>>>fe.Mb]=Oe}else if(280>Oe){if(Oe=Pi(Oe-256,ee),Je=fs(Le.G[4],Le.H[4],ee),se(ee),Je=wa(L,Je=Pi(Je,ee)),ee.h)break;if(we-k<Je||D-we<Oe)break e;for(Ve=0;Ve<Oe;++Ve)j[we+Ve]=j[we+Ve-Je];for(we+=Oe,G+=Oe;G>=L;)G-=L,++V,$!=null&&V<=z&&!(V%16)&&$(g,V);if(e(we<=D),G&ge&&(Le=Zr(he,G,V)),fe!=null)for(;_e<we;)Oe=j[_e++],fe.X[(506832829*Oe&4294967295)>>>fe.Mb]=Oe}else{if(!(Oe<Me))break e;for(Re=Oe-280,e(fe!=null);_e<we;)Oe=j[_e++],fe.X[(506832829*Oe&4294967295)>>>fe.Mb]=Oe;Oe=we,e(!(Re>>>(Je=fe).Xa)),j[Oe]=Je.X[Re],Re=!0}Re||e(ee.h==K(ee))}if(g.Pb&&ee.h&&we<D)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&je(g.s.vb,g.s.Wa);else{if(ee.h)break e;$!=null&&$(g,V>z?z:V),g.a=0,g.$=we-k}return 1}return g.a=3,0}function _a(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var j=g.Wa;j!=null&&(j.X=null),g.vb=null,e(g!=null)}function ii(){var g=new jy;return g==null?null:(g.a=0,g.xb=oS,si("Predictor","VP8LPredictors"),si("Predictor","VP8LPredictors_C"),si("PredictorAdd","VP8LPredictorsAdd"),si("PredictorAdd","VP8LPredictorsAdd_C"),yg=Et,Tc=ot,gs=He,Qn=an,nl=It,oo=Rs,lo=Qt,A.VP8LMapColor32b=nd,A.VP8LMapColor8b=wg,g)}function ja(g,j,k,L,D){var z=1,$=[g],V=[j],G=L.m,ee=L.s,he=null,we=0;e:for(;;){if(k)for(;z&&X(G,1);){var _e=$,xe=V,Me=L,Ce=1,fe=Me.m,ge=Me.gc[Me.ab],Le=X(fe,2);if(Me.Oc&1<<Le)z=0;else{switch(Me.Oc|=1<<Le,ge.hc=Le,ge.Ea=_e[0],ge.nc=xe[0],ge.K=[null],++Me.ab,e(4>=Me.ab),Le){case 0:case 1:ge.b=X(fe,3)+2,Ce=ja(Qe(ge.Ea,ge.b),Qe(ge.nc,ge.b),0,Me,ge.K),ge.K=ge.K[0];break;case 3:var Re,Oe=X(fe,8)+1,Je=16<Oe?0:4<Oe?1:2<Oe?2:3;if(_e[0]=Qe(ge.Ea,Je),ge.b=Je,Re=Ce=ja(Oe,1,0,Me,ge.K)){var Ve,lt=Oe,We=ge,Jt=1<<(8>>We.b),sr=i(Jt);if(sr==null)Re=0;else{var Gt=We.K[0],Ft=We.w;for(sr[0]=We.K[0][0],Ve=1;Ve<1*lt;++Ve)sr[Ve]=Te(Gt[Ft+Ve],sr[Ve-1]);for(;Ve<4*Jt;++Ve)sr[Ve]=0;We.K[0]=null,We.K[0]=sr,Re=1}}Ce=Re;break;case 2:break;default:e(0)}z=Ce}}if($=$[0],V=V[0],z&&X(G,1)&&!(z=1<=(we=X(G,4))&&11>=we)){L.a=3;break e}var hr;if(hr=z)t:{var cr,St,tn,vs=L,rn=$,xs=V,ir=we,zs=k,$s=vs.m,vn=vs.s,Nn=[null],Zn=1,hi=0,ka=k8[ir];r:for(;;){if(zs&&X($s,1)){var xn=X($s,3)+2,fo=Qe(rn,xn),Dc=Qe(xs,xn),ld=fo*Dc;if(!ja(fo,Dc,0,vs,Nn))break r;for(Nn=Nn[0],vn.xc=xn,cr=0;cr<ld;++cr){var ll=Nn[cr]>>8&65535;Nn[cr]=ll,ll>=Zn&&(Zn=ll+1)}}if($s.h)break r;for(St=0;5>St;++St){var Fr=iS[St];!St&&0<ir&&(Fr+=1<<ir),hi<Fr&&(hi=Fr)}var Oy=a(Zn*ka,O),gS=Zn,vS=a(gS,q);if(vS==null)var Og=null;else e(65536>=gS),Og=vS;var Xf=i(hi);if(Og==null||Xf==null||Oy==null){vs.a=1;break r}var Mg=Oy;for(cr=tn=0;cr<Zn;++cr){var Fi=Og[cr],cd=Fi.G,ud=Fi.H,xS=0,Rg=1,yS=0;for(St=0;5>St;++St){Fr=iS[St],cd[St]=Mg,ud[St]=tn,!St&&0<ir&&(Fr+=1<<ir);s:{var Dg,My=Fr,Fg=vs,Kf=Xf,Y8=Mg,X8=tn,Ry=0,cl=Fg.m,K8=X(cl,1);if(s(Kf,0,0,My),K8){var Q8=X(cl,1)+1,J8=X(cl,1),bS=X(cl,J8==0?1:8);Kf[bS]=1,Q8==2&&(Kf[bS=X(cl,8)]=1);var Ig=1}else{var wS=i(19),_S=X(cl,4)+4;if(19<_S){Fg.a=3;var zg=0;break s}for(Dg=0;Dg<_S;++Dg)wS[C8[Dg]]=X(cl,3);var Dy=void 0,Qf=void 0,jS=Fg,Z8=wS,$g=My,SS=Kf,Fy=0,ul=jS.m,CS=8,NS=a(128,O);n:for(;T(NS,0,7,Z8,19);){if(X(ul,1)){var eR=2+2*X(ul,3);if((Dy=2+X(ul,eR))>$g)break n}else Dy=$g;for(Qf=0;Qf<$g&&Dy--;){se(ul);var kS=NS[0+(127&W(ul))];ne(ul,ul.u+kS.g);var dd=kS.value;if(16>dd)SS[Qf++]=dd,dd!=0&&(CS=dd);else{var tR=dd==16,ES=dd-16,rR=j8[ES],PS=X(ul,_8[ES])+rR;if(Qf+PS>$g)break n;for(var nR=tR?CS:0;0<PS--;)SS[Qf++]=nR}}Fy=1;break n}Fy||(jS.a=3),Ig=Fy}(Ig=Ig&&!cl.h)&&(Ry=T(Y8,X8,8,Kf,My)),Ig&&Ry!=0?zg=Ry:(Fg.a=3,zg=0)}if(zg==0)break r;if(Rg&&S8[St]==1&&(Rg=Mg[tn].g==0),xS+=Mg[tn].g,tn+=zg,3>=St){var Jf,Iy=Xf[0];for(Jf=1;Jf<Fr;++Jf)Xf[Jf]>Iy&&(Iy=Xf[Jf]);yS+=Iy}}if(Fi.nd=Rg,Fi.Qb=0,Rg&&(Fi.qb=(cd[3][ud[3]+0].value<<24|cd[1][ud[1]+0].value<<16|cd[2][ud[2]+0].value)>>>0,xS==0&&256>cd[0][ud[0]+0].value&&(Fi.Qb=1,Fi.qb+=cd[0][ud[0]+0].value<<8)),Fi.jc=!Fi.Qb&&6>yS,Fi.jc){var Bg,mo=Fi;for(Bg=0;Bg<Cn;++Bg){var dl=Bg,hl=mo.pd[dl],qg=mo.G[0][mo.H[0]+dl];256<=qg.value?(hl.g=qg.g+256,hl.value=qg.value):(hl.g=0,hl.value=0,dl>>=on(qg,8,hl),dl>>=on(mo.G[1][mo.H[1]+dl],16,hl),dl>>=on(mo.G[2][mo.H[2]+dl],0,hl),on(mo.G[3][mo.H[3]+dl],24,hl))}}}vn.vc=Nn,vn.Wb=Zn,vn.Ya=Og,vn.yc=Oy,hr=1;break t}hr=0}if(!(z=hr)){L.a=3;break e}if(0<we){if(ee.ua=1<<we,!$e(ee.Wa,we)){L.a=1,z=0;break e}}else ee.ua=0;var zy=L,AS=$,sR=V,$y=zy.s,By=$y.xc;if(zy.c=AS,zy.i=sR,$y.md=Qe(AS,By),$y.wc=By==0?-1:(1<<By)-1,k){L.xb=R8;break e}if((he=i($*V))==null){L.a=1,z=0;break e}z=(z=Li(L,he,0,$,V,V,null))&&!G.h;break e}return z?(D!=null?D[0]=he:(e(he==null),e(k)),L.$=0,k||_a(ee)):_a(ee),z}function Nc(g,j){var k=g.c*g.i,L=k+j+16*j;return e(g.c<=j),g.V=i(L),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+k+j,1)}function Iu(g,j){var k=g.C,L=j-k,D=g.V,z=g.Ba+g.c*k;for(e(j<=g.l.o);0<L;){var $=16<L?16:L,V=g.l.ma,G=g.l.width,ee=G*$,he=V.ca,we=V.tb+G*k,_e=g.Ta,xe=g.Ua;Ds(g,$,D,z),Wr(_e,xe,he,we,ee),Ai(V,k,k+$,he,we,G),L-=$,D+=$*g.c,k+=$}e(k==j),g.C=g.Ma=j}function zu(){this.ub=this.yd=this.td=this.Rb=0}function $u(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Bu(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Zp(){this.Yb=function(){var g=[];return function j(k,L,D){for(var z=D[L],$=0;$<z&&(k.push(D.length>L+1?[]:0),!(D.length<L+1));$++)j(k[$],L+1,D)}(g,0,[3,11]),g}()}function ey(){this.jb=i(3),this.Wc=l([4,8],Zp),this.Xc=l([4,17],Zp)}function ty(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function qu(){this.ld=this.La=this.dd=this.tc=0}function eg(){this.Na=this.la=0}function ry(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function jf(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ny(){this.uc=this.M=this.Nb=0,this.wa=Array(new qu),this.Y=0,this.ya=Array(new jf),this.aa=0,this.l=new Uu}function tg(){this.y=i(16),this.f=i(8),this.ea=i(8)}function sy(){this.cb=this.a=0,this.sc="",this.m=new ie,this.Od=new zu,this.Kc=new $u,this.ed=new ty,this.Qa=new Bu,this.Ic=this.$c=this.Aa=0,this.D=new ny,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,ie),this.ia=0,this.pb=a(4,ry),this.Pa=new ey,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new tg),this.Hd=0,this.rb=Array(new eg),this.sb=0,this.wa=Array(new qu),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new jf),this.L=this.aa=0,this.gd=l([4,2],qu),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Uu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function iy(){var g=new sy;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,Gf||(Gf=sg)),g}function Ur(g,j,k){return g.a==0&&(g.a=j,g.sc=k,g.cb=0),0}function rg(g,j,k){return 3<=k&&g[j+0]==157&&g[j+1]==1&&g[j+2]==42}function ng(g,j){if(g==null)return 0;if(g.a=0,g.sc="OK",j==null)return Ur(g,2,"null VP8Io passed to VP8GetHeaders()");var k=j.data,L=j.w,D=j.ha;if(4>D)return Ur(g,7,"Truncated header.");var z=k[L+0]|k[L+1]<<8|k[L+2]<<16,$=g.Od;if($.Rb=!(1&z),$.td=z>>1&7,$.yd=z>>4&1,$.ub=z>>5,3<$.td)return Ur(g,3,"Incorrect keyframe parameters.");if(!$.yd)return Ur(g,4,"Frame not displayable.");L+=3,D-=3;var V=g.Kc;if($.Rb){if(7>D)return Ur(g,7,"cannot parse picture header");if(!rg(k,L,D))return Ur(g,3,"Bad code word");V.c=16383&(k[L+4]<<8|k[L+3]),V.Td=k[L+4]>>6,V.i=16383&(k[L+6]<<8|k[L+5]),V.Ud=k[L+6]>>6,L+=7,D-=7,g.za=V.c+15>>4,g.Ub=V.i+15>>4,j.width=V.c,j.height=V.i,j.Da=0,j.j=0,j.v=0,j.va=j.width,j.o=j.height,j.da=0,j.ib=j.width,j.hb=j.height,j.U=j.width,j.T=j.height,s((z=g.Pa).jb,0,255,z.jb.length),e((z=g.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,s(z.Zb,0,0,z.Zb.length),s(z.Lb,0,0,z.Lb)}if($.ub>D)return Ur(g,7,"bad partition length");Z(z=g.m,k,L,$.ub),L+=$.ub,D-=$.ub,$.Rb&&(V.Ld=ye(z),V.Kd=ye(z)),V=g.Qa;var G,ee=g.Pa;if(e(z!=null),e(V!=null),V.Cb=ye(z),V.Cb){if(V.Bb=ye(z),ye(z)){for(V.Fb=ye(z),G=0;4>G;++G)V.Zb[G]=ye(z)?Q(z,7):0;for(G=0;4>G;++G)V.Lb[G]=ye(z)?Q(z,6):0}if(V.Bb)for(G=0;3>G;++G)ee.jb[G]=ye(z)?H(z,8):255}else V.Bb=0;if(z.Ka)return Ur(g,3,"cannot parse segment header");if((V=g.ed).zd=ye(z),V.Tb=H(z,6),V.wb=H(z,3),V.Pc=ye(z),V.Pc&&ye(z)){for(ee=0;4>ee;++ee)ye(z)&&(V.vd[ee]=Q(z,6));for(ee=0;4>ee;++ee)ye(z)&&(V.od[ee]=Q(z,6))}if(g.L=V.Tb==0?0:V.zd?1:2,z.Ka)return Ur(g,3,"cannot parse filter header");var he=D;if(D=G=L,L=G+he,V=he,g.Xb=(1<<H(g.m,2))-1,he<3*(ee=g.Xb))k=7;else{for(G+=3*ee,V-=3*ee,he=0;he<ee;++he){var we=k[D+0]|k[D+1]<<8|k[D+2]<<16;we>V&&(we=V),Z(g.Jc[+he],k,G,we),G+=we,V-=we,D+=3}Z(g.Jc[+ee],k,G,V),k=G<L?0:5}if(k!=0)return Ur(g,k,"cannot parse partitions");for(k=H(G=g.m,7),D=ye(G)?Q(G,4):0,L=ye(G)?Q(G,4):0,V=ye(G)?Q(G,4):0,ee=ye(G)?Q(G,4):0,G=ye(G)?Q(G,4):0,he=g.Qa,we=0;4>we;++we){if(he.Cb){var _e=he.Zb[we];he.Fb||(_e+=k)}else{if(0<we){g.pb[we]=g.pb[0];continue}_e=k}var xe=g.pb[we];xe.Sc[0]=Ay[Fs(_e+D,127)],xe.Sc[1]=Ty[Fs(_e+0,127)],xe.Eb[0]=2*Ay[Fs(_e+L,127)],xe.Eb[1]=101581*Ty[Fs(_e+V,127)]>>16,8>xe.Eb[1]&&(xe.Eb[1]=8),xe.Qc[0]=Ay[Fs(_e+ee,117)],xe.Qc[1]=Ty[Fs(_e+G,127)],xe.lc=_e+G}if(!$.Rb)return Ur(g,4,"Not a key frame.");for(ye(z),$=g.Pa,k=0;4>k;++k){for(D=0;8>D;++D)for(L=0;3>L;++L)for(V=0;11>V;++V)ee=oe(z,O8[k][D][L][V])?H(z,8):T8[k][D][L][V],$.Wc[k][D].Yb[L][V]=ee;for(D=0;17>D;++D)$.Xc[k][D]=$.Wc[k][M8[D]]}return g.kc=ye(z),g.kc&&(g.Bd=H(z,8)),g.cb=1}function sg(g,j,k,L,D,z,$){var V=j[D].Yb[k];for(k=0;16>D;++D){if(!oe(g,V[k+0]))return D;for(;!oe(g,V[k+1]);)if(V=j[++D].Yb[0],k=0,D==16)return 16;var G=j[D+1].Yb;if(oe(g,V[k+2])){var ee=g,he=0;if(oe(ee,(_e=V)[(we=k)+3]))if(oe(ee,_e[we+6])){for(V=0,we=2*(he=oe(ee,_e[we+8]))+(_e=oe(ee,_e[we+9+he])),he=0,_e=P8[we];_e[V];++V)he+=he+oe(ee,_e[V]);he+=3+(8<<we)}else oe(ee,_e[we+7])?(he=7+2*oe(ee,165),he+=oe(ee,145)):he=5+oe(ee,159);else he=oe(ee,_e[we+4])?3+oe(ee,_e[we+5]):2;V=G[2]}else he=1,V=G[1];G=$+A8[D],0>(ee=g).b&&le(ee);var we,_e=ee.b,xe=(we=ee.Ca>>1)-(ee.I>>_e)>>31;--ee.b,ee.Ca+=xe,ee.Ca|=1,ee.I-=(we+1&xe)<<_e,z[G]=((he^xe)-xe)*L[(0<D)+0]}return 16}function Sf(g){var j=g.rb[g.sb-1];j.la=0,j.Na=0,s(g.zc,0,0,g.zc.length),g.ja=0}function ay(g,j){if(g==null)return 0;if(j==null)return Ur(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!ng(g,j))return 0;if(e(g.cb),j.ac==null||j.ac(j)){j.ob&&(g.L=0);var k=Lg[g.L];if(g.L==2?(g.yb=0,g.zb=0):(g.yb=j.v-k>>4,g.zb=j.j-k>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=j.o+15+k>>4,g.Hb=j.va+15+k>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var L=g.ed;for(k=0;4>k;++k){var D;if(g.Qa.Cb){var z=g.Qa.Lb[k];g.Qa.Fb||(z+=L.Tb)}else z=L.Tb;for(D=0;1>=D;++D){var $=g.gd[k][D],V=z;if(L.Pc&&(V+=L.vd[0],D&&(V+=L.od[0])),0<(V=0>V?0:63<V?63:V)){var G=V;0<L.wb&&(G=4<L.wb?G>>2:G>>1)>9-L.wb&&(G=9-L.wb),1>G&&(G=1),$.dd=G,$.tc=2*V+G,$.ld=40<=V?2:15<=V?1:0}else $.tc=0;$.La=D}}}k=0}else Ur(g,6,"Frame setup failed"),k=g.a;if(k=k==0){if(k){g.$c=0,0<g.Aa||(g.Ic=G8);e:{k=g.Ic,L=4*(G=g.za);var ee=32*G,he=G+1,we=0<g.L?G*(0<g.Aa?2:1):0,_e=(g.Aa==2?2:1)*G;if(($=L+832+(D=3*(16*k+Lg[g.L])/2*ee)+(z=g.Fa!=null&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=$)k=0;else{if($>g.Vb){if(g.Vb=0,g.Ec=i($),g.Fc=0,g.Ec==null){k=Ur(g,1,"no memory during frame initialization.");break e}g.Vb=$}$=g.Ec,V=g.Fc,g.Ac=$,g.Bc=V,V+=L,g.Gd=a(ee,tg),g.Hd=0,g.rb=a(he+1,eg),g.sb=1,g.wa=we?a(we,qu):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=G),e(!0),g.oc=$,g.pc=V,V+=832,g.ya=a(_e,jf),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,g.Aa==2&&(g.D.aa+=G),g.R=16*G,g.B=8*G,G=(ee=Lg[g.L])*g.R,ee=ee/2*g.B,g.sa=$,g.ta=V+G,g.qa=g.sa,g.ra=g.ta+16*k*g.R+ee,g.Ha=g.qa,g.Ia=g.ra+8*k*g.B+ee,g.$c=0,V+=D,g.mb=z?$:null,g.nb=z?V:null,e(V+z<=g.Fc+g.Vb),Sf(g),s(g.Ac,g.Bc,0,L),k=1}}if(k){if(j.ka=0,j.y=g.sa,j.O=g.ta,j.f=g.qa,j.N=g.ra,j.ea=g.Ha,j.Vd=g.Ia,j.fa=g.R,j.Rc=g.B,j.F=null,j.J=0,!jg){for(k=-255;255>=k;++k)ln[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)uo[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)Hf[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)od[255+k]=0>k?0:255<k?255:k;jg=1}sd=cy,co=oy,Uf=ag,Jn=ly,oi=og,Vr=ig,id=Af,_g=Pc,Vf=_y,Lc=Tf,Oc=wy,sl=Xu,Mc=Lf,ad=gg,Rc=pg,il=Ca,Wf=ao,li=by,Di[0]=Sa,Di[1]=uy,Di[2]=my,Di[3]=py,Di[4]=ug,Di[5]=Gu,Di[6]=dg,Di[7]=kf,Di[8]=vy,Di[9]=gy,al[0]=lg,al[1]=hy,al[2]=io,al[3]=Wu,al[4]=Rn,al[5]=fy,al[6]=cg,ho[0]=Zo,ho[1]=dy,ho[2]=xy,ho[3]=Ef,ho[4]=Ec,ho[5]=yy,ho[6]=Pf,k=1}else k=0}k&&(k=function(xe,Me){for(xe.M=0;xe.M<xe.Va;++xe.M){var Ce,fe=xe.Jc[xe.M&xe.Xb],ge=xe.m,Le=xe;for(Ce=0;Ce<Le.za;++Ce){var Re=ge,Oe=Le,Je=Oe.Ac,Ve=Oe.Bc+4*Ce,lt=Oe.zc,We=Oe.ya[Oe.aa+Ce];if(Oe.Qa.Bb?We.$b=oe(Re,Oe.Pa.jb[0])?2+oe(Re,Oe.Pa.jb[2]):oe(Re,Oe.Pa.jb[1]):We.$b=0,Oe.kc&&(We.Ad=oe(Re,Oe.Bd)),We.Za=!oe(Re,145)+0,We.Za){var Jt=We.Ob,sr=0;for(Oe=0;4>Oe;++Oe){var Gt,Ft=lt[0+Oe];for(Gt=0;4>Gt;++Gt){Ft=L8[Je[Ve+Gt]][Ft];for(var hr=aS[oe(Re,Ft[0])];0<hr;)hr=aS[2*hr+oe(Re,Ft[hr])];Ft=-hr,Je[Ve+Gt]=Ft}n(Jt,sr,Je,Ve,4),sr+=4,lt[0+Oe]=Ft}}else Ft=oe(Re,156)?oe(Re,128)?1:3:oe(Re,163)?2:0,We.Ob[0]=Ft,s(Je,Ve,Ft,4),s(lt,0,Ft,4);We.Dd=oe(Re,142)?oe(Re,114)?oe(Re,183)?1:3:2:0}if(Le.m.Ka)return Ur(xe,7,"Premature end-of-partition0 encountered.");for(;xe.ja<xe.za;++xe.ja){if(Le=fe,Re=(ge=xe).rb[ge.sb-1],Je=ge.rb[ge.sb+ge.ja],Ce=ge.ya[ge.aa+ge.ja],Ve=ge.kc?Ce.Ad:0)Re.la=Je.la=0,Ce.Za||(Re.Na=Je.Na=0),Ce.Hc=0,Ce.Gc=0,Ce.ia=0;else{var cr,St;if(Re=Je,Je=Le,Ve=ge.Pa.Xc,lt=ge.ya[ge.aa+ge.ja],We=ge.pb[lt.$b],Oe=lt.ad,Jt=0,sr=ge.rb[ge.sb-1],Ft=Gt=0,s(Oe,Jt,0,384),lt.Za)var tn=0,vs=Ve[3];else{hr=i(16);var rn=Re.Na+sr.Na;if(rn=Gf(Je,Ve[1],rn,We.Eb,0,hr,0),Re.Na=sr.Na=(0<rn)+0,1<rn)sd(hr,0,Oe,Jt);else{var xs=hr[0]+3>>3;for(hr=0;256>hr;hr+=16)Oe[Jt+hr]=xs}tn=1,vs=Ve[0]}var ir=15&Re.la,zs=15&sr.la;for(hr=0;4>hr;++hr){var $s=1&zs;for(xs=St=0;4>xs;++xs)ir=ir>>1|($s=(rn=Gf(Je,vs,rn=$s+(1&ir),We.Sc,tn,Oe,Jt))>tn)<<7,St=St<<2|(3<rn?3:1<rn?2:Oe[Jt+0]!=0),Jt+=16;ir>>=4,zs=zs>>1|$s<<7,Gt=(Gt<<8|St)>>>0}for(vs=ir,tn=zs>>4,cr=0;4>cr;cr+=2){for(St=0,ir=Re.la>>4+cr,zs=sr.la>>4+cr,hr=0;2>hr;++hr){for($s=1&zs,xs=0;2>xs;++xs)rn=$s+(1&ir),ir=ir>>1|($s=0<(rn=Gf(Je,Ve[2],rn,We.Qc,0,Oe,Jt)))<<3,St=St<<2|(3<rn?3:1<rn?2:Oe[Jt+0]!=0),Jt+=16;ir>>=2,zs=zs>>1|$s<<5}Ft|=St<<4*cr,vs|=ir<<4<<cr,tn|=(240&zs)<<cr}Re.la=vs,sr.la=tn,lt.Hc=Gt,lt.Gc=Ft,lt.ia=43690&Ft?0:We.ia,Ve=!(Gt|Ft)}if(0<ge.L&&(ge.wa[ge.Y+ge.ja]=ge.gd[Ce.$b][Ce.Za],ge.wa[ge.Y+ge.ja].La|=!Ve),Le.Ka)return Ur(xe,7,"Premature end-of-file encountered.")}if(Sf(xe),ge=Me,Le=1,Ce=(fe=xe).D,Re=0<fe.L&&fe.M>=fe.zb&&fe.M<=fe.Va,fe.Aa==0)e:{if(Ce.M=fe.M,Ce.uc=Re,If(fe,Ce),Le=1,Ce=(St=fe.D).Nb,Re=(Ft=Lg[fe.L])*fe.R,Je=Ft/2*fe.B,hr=16*Ce*fe.R,xs=8*Ce*fe.B,Ve=fe.sa,lt=fe.ta-Re+hr,We=fe.qa,Oe=fe.ra-Je+xs,Jt=fe.Ha,sr=fe.Ia-Je+xs,zs=(ir=St.M)==0,Gt=ir>=fe.Va-1,fe.Aa==2&&If(fe,St),St.uc)for($s=(rn=fe).D.M,e(rn.D.uc),St=rn.yb;St<rn.Hb;++St){tn=St,vs=$s;var vn=(Nn=(Fr=rn).D).Nb;cr=Fr.R;var Nn=Nn.wa[Nn.Y+tn],Zn=Fr.sa,hi=Fr.ta+16*vn*cr+16*tn,ka=Nn.dd,xn=Nn.tc;if(xn!=0)if(e(3<=xn),Fr.L==1)0<tn&&il(Zn,hi,cr,xn+4),Nn.La&&li(Zn,hi,cr,xn),0<vs&&Rc(Zn,hi,cr,xn+4),Nn.La&&Wf(Zn,hi,cr,xn);else{var fo=Fr.B,Dc=Fr.qa,ld=Fr.ra+8*vn*fo+8*tn,ll=Fr.Ha,Fr=Fr.Ia+8*vn*fo+8*tn;vn=Nn.ld,0<tn&&(_g(Zn,hi,cr,xn+4,ka,vn),Lc(Dc,ld,ll,Fr,fo,xn+4,ka,vn)),Nn.La&&(sl(Zn,hi,cr,xn,ka,vn),ad(Dc,ld,ll,Fr,fo,xn,ka,vn)),0<vs&&(id(Zn,hi,cr,xn+4,ka,vn),Vf(Dc,ld,ll,Fr,fo,xn+4,ka,vn)),Nn.La&&(Oc(Zn,hi,cr,xn,ka,vn),Mc(Dc,ld,ll,Fr,fo,xn,ka,vn))}}if(fe.ia&&alert("todo:DitherRow"),ge.put!=null){if(St=16*ir,ir=16*(ir+1),zs?(ge.y=fe.sa,ge.O=fe.ta+hr,ge.f=fe.qa,ge.N=fe.ra+xs,ge.ea=fe.Ha,ge.W=fe.Ia+xs):(St-=Ft,ge.y=Ve,ge.O=lt,ge.f=We,ge.N=Oe,ge.ea=Jt,ge.W=sr),Gt||(ir-=Ft),ir>ge.o&&(ir=ge.o),ge.F=null,ge.J=null,fe.Fa!=null&&0<fe.Fa.length&&St<ir&&(ge.J=Df(fe,ge,St,ir-St),ge.F=fe.mb,ge.F==null&&ge.F.length==0)){Le=Ur(fe,3,"Could not decode alpha data.");break e}St<ge.j&&(Ft=ge.j-St,St=ge.j,e(!(1&Ft)),ge.O+=fe.R*Ft,ge.N+=fe.B*(Ft>>1),ge.W+=fe.B*(Ft>>1),ge.F!=null&&(ge.J+=ge.width*Ft)),St<ir&&(ge.O+=ge.v,ge.N+=ge.v>>1,ge.W+=ge.v>>1,ge.F!=null&&(ge.J+=ge.v),ge.ka=St-ge.j,ge.U=ge.va-ge.v,ge.T=ir-St,Le=ge.put(ge))}Ce+1!=fe.Ic||Gt||(n(fe.sa,fe.ta-Re,Ve,lt+16*fe.R,Re),n(fe.qa,fe.ra-Je,We,Oe+8*fe.B,Je),n(fe.Ha,fe.Ia-Je,Jt,sr+8*fe.B,Je))}if(!Le)return Ur(xe,6,"Output aborted.")}return 1}(g,j)),j.bc!=null&&j.bc(j),k&=1}return k?(g.cb=0,k):0}function Oi(g,j,k,L,D){D=g[j+k+32*L]+(D>>3),g[j+k+32*L]=-256&D?0>D?0:255:D}function Vu(g,j,k,L,D,z){Oi(g,j,0,k,L+D),Oi(g,j,1,k,L+z),Oi(g,j,2,k,L-z),Oi(g,j,3,k,L-D)}function ms(g){return(20091*g>>16)+g}function Cf(g,j,k,L){var D,z=0,$=i(16);for(D=0;4>D;++D){var V=g[j+0]+g[j+8],G=g[j+0]-g[j+8],ee=(35468*g[j+4]>>16)-ms(g[j+12]),he=ms(g[j+4])+(35468*g[j+12]>>16);$[z+0]=V+he,$[z+1]=G+ee,$[z+2]=G-ee,$[z+3]=V-he,z+=4,j++}for(D=z=0;4>D;++D)V=(g=$[z+0]+4)+$[z+8],G=g-$[z+8],ee=(35468*$[z+4]>>16)-ms($[z+12]),Oi(k,L,0,0,V+(he=ms($[z+4])+(35468*$[z+12]>>16))),Oi(k,L,1,0,G+ee),Oi(k,L,2,0,G-ee),Oi(k,L,3,0,V-he),z++,L+=32}function ig(g,j,k,L){var D=g[j+0]+4,z=35468*g[j+4]>>16,$=ms(g[j+4]),V=35468*g[j+1]>>16;Vu(k,L,0,D+$,g=ms(g[j+1]),V),Vu(k,L,1,D+z,g,V),Vu(k,L,2,D-z,g,V),Vu(k,L,3,D-$,g,V)}function oy(g,j,k,L,D){Cf(g,j,k,L),D&&Cf(g,j+16,k,L+4)}function ag(g,j,k,L){co(g,j+0,k,L,1),co(g,j+32,k,L+128,1)}function ly(g,j,k,L){var D;for(g=g[j+0]+4,D=0;4>D;++D)for(j=0;4>j;++j)Oi(k,L,j,D,g)}function og(g,j,k,L){g[j+0]&&Jn(g,j+0,k,L),g[j+16]&&Jn(g,j+16,k,L+4),g[j+32]&&Jn(g,j+32,k,L+128),g[j+48]&&Jn(g,j+48,k,L+128+4)}function cy(g,j,k,L){var D,z=i(16);for(D=0;4>D;++D){var $=g[j+0+D]+g[j+12+D],V=g[j+4+D]+g[j+8+D],G=g[j+4+D]-g[j+8+D],ee=g[j+0+D]-g[j+12+D];z[0+D]=$+V,z[8+D]=$-V,z[4+D]=ee+G,z[12+D]=ee-G}for(D=0;4>D;++D)$=(g=z[0+4*D]+3)+z[3+4*D],V=z[1+4*D]+z[2+4*D],G=z[1+4*D]-z[2+4*D],ee=g-z[3+4*D],k[L+0]=$+V>>3,k[L+16]=ee+G>>3,k[L+32]=$-V>>3,k[L+48]=ee-G>>3,L+=64}function Nf(g,j,k){var L,D=j-32,z=Is,$=255-g[D-1];for(L=0;L<k;++L){var V,G=z,ee=$+g[j-1];for(V=0;V<k;++V)g[j+V]=G[ee+g[D+V]];j+=32}}function uy(g,j){Nf(g,j,4)}function dy(g,j){Nf(g,j,8)}function hy(g,j){Nf(g,j,16)}function io(g,j){var k;for(k=0;16>k;++k)n(g,j+32*k,g,j-32,16)}function Wu(g,j){var k;for(k=16;0<k;--k)s(g,j,g[j-1],16),j+=32}function Hu(g,j,k){var L;for(L=0;16>L;++L)s(j,k+32*L,g,16)}function lg(g,j){var k,L=16;for(k=0;16>k;++k)L+=g[j-1+32*k]+g[j+k-32];Hu(L>>5,g,j)}function Rn(g,j){var k,L=8;for(k=0;16>k;++k)L+=g[j-1+32*k];Hu(L>>4,g,j)}function fy(g,j){var k,L=8;for(k=0;16>k;++k)L+=g[j+k-32];Hu(L>>4,g,j)}function cg(g,j){Hu(128,g,j)}function xt(g,j,k){return g+2*j+k+2>>2}function my(g,j){var k,L=j-32;for(L=new Uint8Array([xt(g[L-1],g[L+0],g[L+1]),xt(g[L+0],g[L+1],g[L+2]),xt(g[L+1],g[L+2],g[L+3]),xt(g[L+2],g[L+3],g[L+4])]),k=0;4>k;++k)n(g,j+32*k,L,0,L.length)}function py(g,j){var k=g[j-1],L=g[j-1+32],D=g[j-1+64],z=g[j-1+96];ve(g,j+0,16843009*xt(g[j-1-32],k,L)),ve(g,j+32,16843009*xt(k,L,D)),ve(g,j+64,16843009*xt(L,D,z)),ve(g,j+96,16843009*xt(D,z,z))}function Sa(g,j){var k,L=4;for(k=0;4>k;++k)L+=g[j+k-32]+g[j-1+32*k];for(L>>=3,k=0;4>k;++k)s(g,j+32*k,L,4)}function ug(g,j){var k=g[j-1+0],L=g[j-1+32],D=g[j-1+64],z=g[j-1-32],$=g[j+0-32],V=g[j+1-32],G=g[j+2-32],ee=g[j+3-32];g[j+0+96]=xt(L,D,g[j-1+96]),g[j+1+96]=g[j+0+64]=xt(k,L,D),g[j+2+96]=g[j+1+64]=g[j+0+32]=xt(z,k,L),g[j+3+96]=g[j+2+64]=g[j+1+32]=g[j+0+0]=xt($,z,k),g[j+3+64]=g[j+2+32]=g[j+1+0]=xt(V,$,z),g[j+3+32]=g[j+2+0]=xt(G,V,$),g[j+3+0]=xt(ee,G,V)}function dg(g,j){var k=g[j+1-32],L=g[j+2-32],D=g[j+3-32],z=g[j+4-32],$=g[j+5-32],V=g[j+6-32],G=g[j+7-32];g[j+0+0]=xt(g[j+0-32],k,L),g[j+1+0]=g[j+0+32]=xt(k,L,D),g[j+2+0]=g[j+1+32]=g[j+0+64]=xt(L,D,z),g[j+3+0]=g[j+2+32]=g[j+1+64]=g[j+0+96]=xt(D,z,$),g[j+3+32]=g[j+2+64]=g[j+1+96]=xt(z,$,V),g[j+3+64]=g[j+2+96]=xt($,V,G),g[j+3+96]=xt(V,G,G)}function Gu(g,j){var k=g[j-1+0],L=g[j-1+32],D=g[j-1+64],z=g[j-1-32],$=g[j+0-32],V=g[j+1-32],G=g[j+2-32],ee=g[j+3-32];g[j+0+0]=g[j+1+64]=z+$+1>>1,g[j+1+0]=g[j+2+64]=$+V+1>>1,g[j+2+0]=g[j+3+64]=V+G+1>>1,g[j+3+0]=G+ee+1>>1,g[j+0+96]=xt(D,L,k),g[j+0+64]=xt(L,k,z),g[j+0+32]=g[j+1+96]=xt(k,z,$),g[j+1+32]=g[j+2+96]=xt(z,$,V),g[j+2+32]=g[j+3+96]=xt($,V,G),g[j+3+32]=xt(V,G,ee)}function kf(g,j){var k=g[j+0-32],L=g[j+1-32],D=g[j+2-32],z=g[j+3-32],$=g[j+4-32],V=g[j+5-32],G=g[j+6-32],ee=g[j+7-32];g[j+0+0]=k+L+1>>1,g[j+1+0]=g[j+0+64]=L+D+1>>1,g[j+2+0]=g[j+1+64]=D+z+1>>1,g[j+3+0]=g[j+2+64]=z+$+1>>1,g[j+0+32]=xt(k,L,D),g[j+1+32]=g[j+0+96]=xt(L,D,z),g[j+2+32]=g[j+1+96]=xt(D,z,$),g[j+3+32]=g[j+2+96]=xt(z,$,V),g[j+3+64]=xt($,V,G),g[j+3+96]=xt(V,G,ee)}function gy(g,j){var k=g[j-1+0],L=g[j-1+32],D=g[j-1+64],z=g[j-1+96];g[j+0+0]=k+L+1>>1,g[j+2+0]=g[j+0+32]=L+D+1>>1,g[j+2+32]=g[j+0+64]=D+z+1>>1,g[j+1+0]=xt(k,L,D),g[j+3+0]=g[j+1+32]=xt(L,D,z),g[j+3+32]=g[j+1+64]=xt(D,z,z),g[j+3+64]=g[j+2+64]=g[j+0+96]=g[j+1+96]=g[j+2+96]=g[j+3+96]=z}function vy(g,j){var k=g[j-1+0],L=g[j-1+32],D=g[j-1+64],z=g[j-1+96],$=g[j-1-32],V=g[j+0-32],G=g[j+1-32],ee=g[j+2-32];g[j+0+0]=g[j+2+32]=k+$+1>>1,g[j+0+32]=g[j+2+64]=L+k+1>>1,g[j+0+64]=g[j+2+96]=D+L+1>>1,g[j+0+96]=z+D+1>>1,g[j+3+0]=xt(V,G,ee),g[j+2+0]=xt($,V,G),g[j+1+0]=g[j+3+32]=xt(k,$,V),g[j+1+32]=g[j+3+64]=xt(L,k,$),g[j+1+64]=g[j+3+96]=xt(D,L,k),g[j+1+96]=xt(z,D,L)}function xy(g,j){var k;for(k=0;8>k;++k)n(g,j+32*k,g,j-32,8)}function Ef(g,j){var k;for(k=0;8>k;++k)s(g,j,g[j-1],8),j+=32}function kc(g,j,k){var L;for(L=0;8>L;++L)s(j,k+32*L,g,8)}function Zo(g,j){var k,L=8;for(k=0;8>k;++k)L+=g[j+k-32]+g[j-1+32*k];kc(L>>4,g,j)}function yy(g,j){var k,L=4;for(k=0;8>k;++k)L+=g[j+k-32];kc(L>>3,g,j)}function Ec(g,j){var k,L=4;for(k=0;8>k;++k)L+=g[j-1+32*k];kc(L>>3,g,j)}function Pf(g,j){kc(128,g,j)}function Yu(g,j,k){var L=g[j-k],D=g[j+0],z=3*(D-L)+Cy[1020+g[j-2*k]-g[j+k]],$=Sg[112+(z+4>>3)];g[j-k]=Is[255+L+Sg[112+(z+3>>3)]],g[j+0]=Is[255+D-$]}function hg(g,j,k,L){var D=g[j+0],z=g[j+k];return ui[255+g[j-2*k]-g[j-k]]>L||ui[255+z-D]>L}function fg(g,j,k,L){return 4*ui[255+g[j-k]-g[j+0]]+ui[255+g[j-2*k]-g[j+k]]<=L}function mg(g,j,k,L,D){var z=g[j-3*k],$=g[j-2*k],V=g[j-k],G=g[j+0],ee=g[j+k],he=g[j+2*k],we=g[j+3*k];return 4*ui[255+V-G]+ui[255+$-ee]>L?0:ui[255+g[j-4*k]-z]<=D&&ui[255+z-$]<=D&&ui[255+$-V]<=D&&ui[255+we-he]<=D&&ui[255+he-ee]<=D&&ui[255+ee-G]<=D}function pg(g,j,k,L){var D=2*L+1;for(L=0;16>L;++L)fg(g,j+L,k,D)&&Yu(g,j+L,k)}function Ca(g,j,k,L){var D=2*L+1;for(L=0;16>L;++L)fg(g,j+L*k,1,D)&&Yu(g,j+L*k,1)}function ao(g,j,k,L){var D;for(D=3;0<D;--D)pg(g,j+=4*k,k,L)}function by(g,j,k,L){var D;for(D=3;0<D;--D)Ca(g,j+=4,k,L)}function el(g,j,k,L,D,z,$,V){for(z=2*z+1;0<D--;){if(mg(g,j,k,z,$))if(hg(g,j,k,V))Yu(g,j,k);else{var G=g,ee=j,he=k,we=G[ee-2*he],_e=G[ee-he],xe=G[ee+0],Me=G[ee+he],Ce=G[ee+2*he],fe=27*(Le=Cy[1020+3*(xe-_e)+Cy[1020+we-Me]])+63>>7,ge=18*Le+63>>7,Le=9*Le+63>>7;G[ee-3*he]=Is[255+G[ee-3*he]+Le],G[ee-2*he]=Is[255+we+ge],G[ee-he]=Is[255+_e+fe],G[ee+0]=Is[255+xe-fe],G[ee+he]=Is[255+Me-ge],G[ee+2*he]=Is[255+Ce-Le]}j+=L}}function Mi(g,j,k,L,D,z,$,V){for(z=2*z+1;0<D--;){if(mg(g,j,k,z,$))if(hg(g,j,k,V))Yu(g,j,k);else{var G=g,ee=j,he=k,we=G[ee-he],_e=G[ee+0],xe=G[ee+he],Me=Sg[112+((Ce=3*(_e-we))+4>>3)],Ce=Sg[112+(Ce+3>>3)],fe=Me+1>>1;G[ee-2*he]=Is[255+G[ee-2*he]+fe],G[ee-he]=Is[255+we+Ce],G[ee+0]=Is[255+_e-Me],G[ee+he]=Is[255+xe-fe]}j+=L}}function Af(g,j,k,L,D,z){el(g,j,k,1,16,L,D,z)}function Pc(g,j,k,L,D,z){el(g,j,1,k,16,L,D,z)}function wy(g,j,k,L,D,z){var $;for($=3;0<$;--$)Mi(g,j+=4*k,k,1,16,L,D,z)}function Xu(g,j,k,L,D,z){var $;for($=3;0<$;--$)Mi(g,j+=4,1,k,16,L,D,z)}function _y(g,j,k,L,D,z,$,V){el(g,j,D,1,8,z,$,V),el(k,L,D,1,8,z,$,V)}function Tf(g,j,k,L,D,z,$,V){el(g,j,1,D,8,z,$,V),el(k,L,1,D,8,z,$,V)}function Lf(g,j,k,L,D,z,$,V){Mi(g,j+4*D,D,1,8,z,$,V),Mi(k,L+4*D,D,1,8,z,$,V)}function gg(g,j,k,L,D,z,$,V){Mi(g,j+4,1,D,8,z,$,V),Mi(k,L+4,1,D,8,z,$,V)}function Ku(){this.ba=new Rr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new dr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Of(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Mf(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vg(){this.ua=0,this.Wa=new te,this.vb=new te,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new O}function jy(){this.xb=this.a=0,this.l=new Uu,this.ca=new Rr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new M,this.Pb=0,this.wd=new M,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vg,this.ab=0,this.gc=a(4,Mf),this.Oc=0}function Qu(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Uu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ac(g,j,k,L,D,z,$){for(g=g==null?0:g[j+0],j=0;j<$;++j)D[z+j]=g+k[L+j]&255,g=D[z+j]}function Rf(g,j,k,L,D,z,$){var V;if(g==null)Ac(null,null,k,L,D,z,$);else for(V=0;V<$;++V)D[z+V]=g[j+V]+k[L+V]&255}function tl(g,j,k,L,D,z,$){if(g==null)Ac(null,null,k,L,D,z,$);else{var V,G=g[j+0],ee=G,he=G;for(V=0;V<$;++V)ee=he+(G=g[j+V])-ee,he=k[L+V]+(-256&ee?0>ee?0:255:ee)&255,ee=G,D[z+V]=he}}function Df(g,j,k,L){var D=j.width,z=j.o;if(e(g!=null&&j!=null),0>k||0>=L||k+L>z)return null;if(!g.Cc){if(g.ga==null){var $;if(g.ga=new Qu,($=g.ga==null)||($=j.width*j.o,e(g.Gb.length==0),g.Gb=i($),g.Uc=0,g.Gb==null?$=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,$=1),$=!$),!$){$=g.ga;var V=g.Fa,G=g.P,ee=g.qc,he=g.mb,we=g.nb,_e=G+1,xe=ee-1,Me=$.l;if(e(V!=null&&he!=null&&j!=null),ol[0]=null,ol[1]=Ac,ol[2]=Rf,ol[3]=tl,$.ca=he,$.tb=we,$.c=j.width,$.i=j.height,e(0<$.c&&0<$.i),1>=ee)j=0;else if($.$a=V[G+0]>>0&3,$.Z=V[G+0]>>2&3,$.Lc=V[G+0]>>4&3,G=V[G+0]>>6&3,0>$.$a||1<$.$a||4<=$.Z||1<$.Lc||G)j=0;else if(Me.put=ya,Me.ac=Sn,Me.bc=ba,Me.ma=$,Me.width=j.width,Me.height=j.height,Me.Da=j.Da,Me.v=j.v,Me.va=j.va,Me.j=j.j,Me.o=j.o,$.$a)e:{e($.$a==1),j=ii();t:for(;;){if(j==null){j=0;break e}if(e($!=null),$.mc=j,j.c=$.c,j.i=$.i,j.l=$.l,j.l.ma=$,j.l.width=$.c,j.l.height=$.i,j.a=0,R(j.m,V,_e,xe),!ja($.c,$.i,1,j,null)||(j.ab==1&&j.gc[0].hc==3&&so(j.s)?($.ic=1,V=j.c*j.i,j.Ta=null,j.Ua=0,j.V=i(V),j.Ba=0,j.V==null?(j.a=1,j=0):j=1):($.ic=0,j=Nc(j,$.c)),!j))break t;j=1;break e}$.mc=null,j=0}else j=xe>=$.c*$.i;$=!j}if($)return null;g.ga.Lc!=1?g.Ga=0:L=z-k}e(g.ga!=null),e(k+L<=z);e:{if(j=(V=g.ga).c,z=V.l.o,V.$a==0){if(_e=g.rc,xe=g.Vc,Me=g.Fa,G=g.P+1+k*j,ee=g.mb,he=g.nb+k*j,e(G<=g.P+g.qc),V.Z!=0)for(e(ol[V.Z]!=null),$=0;$<L;++$)ol[V.Z](_e,xe,Me,G,ee,he,j),_e=ee,xe=he,he+=j,G+=j;else for($=0;$<L;++$)n(ee,he,Me,G,j),_e=ee,xe=he,he+=j,G+=j;g.rc=_e,g.Vc=xe}else{if(e(V.mc!=null),j=k+L,e(($=V.mc)!=null),e(j<=$.i),$.C>=j)j=1;else if(V.ic||be(),V.ic){V=$.V,_e=$.Ba,xe=$.c;var Ce=$.i,fe=(Me=1,G=$.$/xe,ee=$.$%xe,he=$.m,we=$.s,$.$),ge=xe*Ce,Le=xe*j,Re=we.wc,Oe=fe<Le?Zr(we,ee,G):null;e(fe<=ge),e(j<=Ce),e(so(we));t:for(;;){for(;!he.h&&fe<Le;){if(ee&Re||(Oe=Zr(we,ee,G)),e(Oe!=null),se(he),256>(Ce=fs(Oe.G[0],Oe.H[0],he)))V[_e+fe]=Ce,++fe,++ee>=xe&&(ee=0,++G<=j&&!(G%16)&&Ti($,G));else{if(!(280>Ce)){Me=0;break t}Ce=Pi(Ce-256,he);var Je,Ve=fs(Oe.G[4],Oe.H[4],he);if(se(he),!(fe>=(Ve=wa(xe,Ve=Pi(Ve,he)))&&ge-fe>=Ce)){Me=0;break t}for(Je=0;Je<Ce;++Je)V[_e+fe+Je]=V[_e+fe+Je-Ve];for(fe+=Ce,ee+=Ce;ee>=xe;)ee-=xe,++G<=j&&!(G%16)&&Ti($,G);fe<Le&&ee&Re&&(Oe=Zr(we,ee,G))}e(he.h==K(he))}Ti($,G>j?j:G);break t}!Me||he.h&&fe<ge?(Me=0,$.a=he.h?5:3):$.$=fe,j=Me}else j=Li($,$.V,$.Ba,$.c,$.i,j,Iu);if(!j){L=0;break e}}k+L>=z&&(g.Cc=1),L=1}if(!L)return null;if(g.Cc&&((L=g.ga)!=null&&(L.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+k*D}function C(g,j,k,L,D,z){for(;0<D--;){var $,V=g,G=j+(k?1:0),ee=g,he=j+(k?0:3);for($=0;$<L;++$){var we=ee[he+4*$];we!=255&&(we*=32897,V[G+4*$+0]=V[G+4*$+0]*we>>23,V[G+4*$+1]=V[G+4*$+1]*we>>23,V[G+4*$+2]=V[G+4*$+2]*we>>23)}j+=z}}function I(g,j,k,L,D){for(;0<L--;){var z;for(z=0;z<k;++z){var $=g[j+2*z+0],V=15&(ee=g[j+2*z+1]),G=4369*V,ee=(240&ee|ee>>4)*G>>16;g[j+2*z+0]=(240&$|$>>4)*G>>16&240|(15&$|$<<4)*G>>16>>4&15,g[j+2*z+1]=240&ee|V}j+=D}}function re(g,j,k,L,D,z,$,V){var G,ee,he=255;for(ee=0;ee<D;++ee){for(G=0;G<L;++G){var we=g[j+G];z[$+4*G]=we,he&=we}j+=k,$+=V}return he!=255}function ue(g,j,k,L,D){var z;for(z=0;z<D;++z)k[L+z]=g[j+z]>>8}function be(){ci=C,mr=I,pr=re,Wr=ue}function ke(g,j,k){A[g]=function(L,D,z,$,V,G,ee,he,we,_e,xe,Me,Ce,fe,ge,Le,Re){var Oe,Je=Re-1>>1,Ve=V[G+0]|ee[he+0]<<16,lt=we[_e+0]|xe[Me+0]<<16;e(L!=null);var We=3*Ve+lt+131074>>2;for(j(L[D+0],255&We,We>>16,Ce,fe),z!=null&&(We=3*lt+Ve+131074>>2,j(z[$+0],255&We,We>>16,ge,Le)),Oe=1;Oe<=Je;++Oe){var Jt=V[G+Oe]|ee[he+Oe]<<16,sr=we[_e+Oe]|xe[Me+Oe]<<16,Gt=Ve+Jt+lt+sr+524296,Ft=Gt+2*(Jt+lt)>>3;We=Ft+Ve>>1,Ve=(Gt=Gt+2*(Ve+sr)>>3)+Jt>>1,j(L[D+2*Oe-1],255&We,We>>16,Ce,fe+(2*Oe-1)*k),j(L[D+2*Oe-0],255&Ve,Ve>>16,Ce,fe+(2*Oe-0)*k),z!=null&&(We=Gt+lt>>1,Ve=Ft+sr>>1,j(z[$+2*Oe-1],255&We,We>>16,ge,Le+(2*Oe-1)*k),j(z[$+2*Oe+0],255&Ve,Ve>>16,ge,Le+(2*Oe+0)*k)),Ve=Jt,lt=sr}1&Re||(We=3*Ve+lt+131074>>2,j(L[D+Re-1],255&We,We>>16,Ce,fe+(Re-1)*k),z!=null&&(We=3*lt+Ve+131074>>2,j(z[$+Re-1],255&We,We>>16,ge,Le+(Re-1)*k)))}}function De(){di[Cg]=D8,di[Ng]=lS,di[nS]=F8,di[kg]=cS,di[Eg]=uS,di[Ny]=dS,di[sS]=I8,di[ky]=lS,di[Ey]=cS,di[Pg]=uS,di[Py]=dS}function Xe(g){return g&~z8?0>g?0:255:g>>hS}function at(g,j){return Xe((19077*g>>8)+(26149*j>>8)-14234)}function _t(g,j,k){return Xe((19077*g>>8)-(6419*j>>8)-(13320*k>>8)+8708)}function bt(g,j){return Xe((19077*g>>8)+(33050*j>>8)-17685)}function qt(g,j,k,L,D){L[D+0]=at(g,k),L[D+1]=_t(g,j,k),L[D+2]=bt(g,j)}function Pr(g,j,k,L,D){L[D+0]=bt(g,j),L[D+1]=_t(g,j,k),L[D+2]=at(g,k)}function Dr(g,j,k,L,D){var z=_t(g,j,k);j=z<<3&224|bt(g,j)>>3,L[D+0]=248&at(g,k)|z>>5,L[D+1]=j}function en(g,j,k,L,D){var z=240&bt(g,j)|15;L[D+0]=240&at(g,k)|_t(g,j,k)>>4,L[D+1]=z}function Dn(g,j,k,L,D){L[D+0]=255,qt(g,j,k,L,D+1)}function gn(g,j,k,L,D){Pr(g,j,k,L,D),L[D+3]=255}function Ri(g,j,k,L,D){qt(g,j,k,L,D),L[D+3]=255}function Fs(g,j){return 0>g?0:g>j?j:g}function Na(g,j,k){A[g]=function(L,D,z,$,V,G,ee,he,we){for(var _e=he+(-2&we)*k;he!=_e;)j(L[D+0],z[$+0],V[G+0],ee,he),j(L[D+1],z[$+0],V[G+0],ee,he+k),D+=2,++$,++G,he+=2*k;1&we&&j(L[D+0],z[$+0],V[G+0],ee,he)}}function xg(g,j,k){return k==0?g==0?j==0?6:5:j==0?4:0:k}function Ff(g,j,k,L,D){switch(g>>>30){case 3:co(j,k,L,D,0);break;case 2:Vr(j,k,L,D);break;case 1:Jn(j,k,L,D)}}function If(g,j){var k,L,D=j.M,z=j.Nb,$=g.oc,V=g.pc+40,G=g.oc,ee=g.pc+584,he=g.oc,we=g.pc+600;for(k=0;16>k;++k)$[V+32*k-1]=129;for(k=0;8>k;++k)G[ee+32*k-1]=129,he[we+32*k-1]=129;for(0<D?$[V-1-32]=G[ee-1-32]=he[we-1-32]=129:(s($,V-32-1,127,21),s(G,ee-32-1,127,9),s(he,we-32-1,127,9)),L=0;L<g.za;++L){var _e=j.ya[j.aa+L];if(0<L){for(k=-1;16>k;++k)n($,V+32*k-4,$,V+32*k+12,4);for(k=-1;8>k;++k)n(G,ee+32*k-4,G,ee+32*k+4,4),n(he,we+32*k-4,he,we+32*k+4,4)}var xe=g.Gd,Me=g.Hd+L,Ce=_e.ad,fe=_e.Hc;if(0<D&&(n($,V-32,xe[Me].y,0,16),n(G,ee-32,xe[Me].f,0,8),n(he,we-32,xe[Me].ea,0,8)),_e.Za){var ge=$,Le=V-32+16;for(0<D&&(L>=g.za-1?s(ge,Le,xe[Me].y[15],4):n(ge,Le,xe[Me+1].y,0,4)),k=0;4>k;k++)ge[Le+128+k]=ge[Le+256+k]=ge[Le+384+k]=ge[Le+0+k];for(k=0;16>k;++k,fe<<=2)ge=$,Le=V+mS[k],Di[_e.Ob[k]](ge,Le),Ff(fe,Ce,16*+k,ge,Le)}else if(ge=xg(L,D,_e.Ob[0]),al[ge]($,V),fe!=0)for(k=0;16>k;++k,fe<<=2)Ff(fe,Ce,16*+k,$,V+mS[k]);for(k=_e.Gc,ge=xg(L,D,_e.Dd),ho[ge](G,ee),ho[ge](he,we),fe=Ce,ge=G,Le=ee,255&(_e=k>>0)&&(170&_e?Uf(fe,256,ge,Le):oi(fe,256,ge,Le)),_e=he,fe=we,255&(k>>=8)&&(170&k?Uf(Ce,320,_e,fe):oi(Ce,320,_e,fe)),D<g.Ub-1&&(n(xe[Me].y,0,$,V+480,16),n(xe[Me].f,0,G,ee+224,8),n(xe[Me].ea,0,he,we+224,8)),k=8*z*g.B,xe=g.sa,Me=g.ta+16*L+16*z*g.R,Ce=g.qa,_e=g.ra+8*L+k,fe=g.Ha,ge=g.Ia+8*L+k,k=0;16>k;++k)n(xe,Me+k*g.R,$,V+32*k,16);for(k=0;8>k;++k)n(Ce,_e+k*g.B,G,ee+32*k,8),n(fe,ge+k*g.B,he,we+32*k,8)}}function Ju(g,j,k,L,D,z,$,V,G){var ee=[0],he=[0],we=0,_e=G!=null?G.kd:0,xe=G??new Of;if(g==null||12>k)return 7;xe.data=g,xe.w=j,xe.ha=k,j=[j],k=[k],xe.gb=[xe.gb];e:{var Me=j,Ce=k,fe=xe.gb;if(e(g!=null),e(Ce!=null),e(fe!=null),fe[0]=0,12<=Ce[0]&&!r(g,Me[0],"RIFF")){if(r(g,Me[0]+8,"WEBP")){fe=3;break e}var ge=Ee(g,Me[0]+4);if(12>ge||4294967286<ge){fe=3;break e}if(_e&&ge>Ce[0]-8){fe=7;break e}fe[0]=ge,Me[0]+=12,Ce[0]-=12}fe=0}if(fe!=0)return fe;for(ge=0<xe.gb[0],k=k[0];;){e:{var Le=g;Ce=j,fe=k;var Re=ee,Oe=he,Je=Me=[0];if((We=we=[we])[0]=0,8>fe[0])fe=7;else{if(!r(Le,Ce[0],"VP8X")){if(Ee(Le,Ce[0]+4)!=10){fe=3;break e}if(18>fe[0]){fe=7;break e}var Ve=Ee(Le,Ce[0]+8),lt=1+Ae(Le,Ce[0]+12);if(2147483648<=lt*(Le=1+Ae(Le,Ce[0]+15))){fe=3;break e}Je!=null&&(Je[0]=Ve),Re!=null&&(Re[0]=lt),Oe!=null&&(Oe[0]=Le),Ce[0]+=18,fe[0]-=18,We[0]=1}fe=0}}if(we=we[0],Me=Me[0],fe!=0)return fe;if(Ce=!!(2&Me),!ge&&we)return 3;if(z!=null&&(z[0]=!!(16&Me)),$!=null&&($[0]=Ce),V!=null&&(V[0]=0),$=ee[0],Me=he[0],we&&Ce&&G==null){fe=0;break}if(4>k){fe=7;break}if(ge&&we||!ge&&!we&&!r(g,j[0],"ALPH")){k=[k],xe.na=[xe.na],xe.P=[xe.P],xe.Sa=[xe.Sa];e:{Ve=g,fe=j,ge=k;var We=xe.gb;Re=xe.na,Oe=xe.P,Je=xe.Sa,lt=22,e(Ve!=null),e(ge!=null),Le=fe[0];var Jt=ge[0];for(e(Re!=null),e(Je!=null),Re[0]=null,Oe[0]=null,Je[0]=0;;){if(fe[0]=Le,ge[0]=Jt,8>Jt){fe=7;break e}var sr=Ee(Ve,Le+4);if(4294967286<sr){fe=3;break e}var Gt=8+sr+1&-2;if(lt+=Gt,0<We&&lt>We){fe=3;break e}if(!r(Ve,Le,"VP8 ")||!r(Ve,Le,"VP8L")){fe=0;break e}if(Jt[0]<Gt){fe=7;break e}r(Ve,Le,"ALPH")||(Re[0]=Ve,Oe[0]=Le+8,Je[0]=sr),Le+=Gt,Jt-=Gt}}if(k=k[0],xe.na=xe.na[0],xe.P=xe.P[0],xe.Sa=xe.Sa[0],fe!=0)break}k=[k],xe.Ja=[xe.Ja],xe.xa=[xe.xa];e:if(We=g,fe=j,ge=k,Re=xe.gb[0],Oe=xe.Ja,Je=xe.xa,Ve=fe[0],Le=!r(We,Ve,"VP8 "),lt=!r(We,Ve,"VP8L"),e(We!=null),e(ge!=null),e(Oe!=null),e(Je!=null),8>ge[0])fe=7;else{if(Le||lt){if(We=Ee(We,Ve+4),12<=Re&&We>Re-12){fe=3;break e}if(_e&&We>ge[0]-8){fe=7;break e}Oe[0]=We,fe[0]+=8,ge[0]-=8,Je[0]=lt}else Je[0]=5<=ge[0]&&We[Ve+0]==47&&!(We[Ve+4]>>5),Oe[0]=ge[0];fe=0}if(k=k[0],xe.Ja=xe.Ja[0],xe.xa=xe.xa[0],j=j[0],fe!=0)break;if(4294967286<xe.Ja)return 3;if(V==null||Ce||(V[0]=xe.xa?2:1),$=[$],Me=[Me],xe.xa){if(5>k){fe=7;break}V=$,_e=Me,Ce=z,g==null||5>k?g=0:5<=k&&g[j+0]==47&&!(g[j+4]>>5)?(ge=[0],We=[0],Re=[0],R(Oe=new M,g,j,k),dt(Oe,ge,We,Re)?(V!=null&&(V[0]=ge[0]),_e!=null&&(_e[0]=We[0]),Ce!=null&&(Ce[0]=Re[0]),g=1):g=0):g=0}else{if(10>k){fe=7;break}V=Me,g==null||10>k||!rg(g,j+3,k-3)?g=0:(_e=g[j+0]|g[j+1]<<8|g[j+2]<<16,Ce=16383&(g[j+7]<<8|g[j+6]),g=16383&(g[j+9]<<8|g[j+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=xe.Ja||!Ce||!g?g=0:($&&($[0]=Ce),V&&(V[0]=g),g=1))}if(!g||($=$[0],Me=Me[0],we&&(ee[0]!=$||he[0]!=Me)))return 3;G!=null&&(G[0]=xe,G.offset=j-G.w,e(4294967286>j-G.w),e(G.offset==G.ha-k));break}return fe==0||fe==7&&we&&G==null?(z!=null&&(z[0]|=xe.na!=null&&0<xe.na.length),L!=null&&(L[0]=$),D!=null&&(D[0]=Me),0):fe}function zf(g,j,k){var L=j.width,D=j.height,z=0,$=0,V=L,G=D;if(j.Da=g!=null&&0<g.Da,j.Da&&(V=g.cd,G=g.bd,z=g.v,$=g.j,11>k||(z&=-2,$&=-2),0>z||0>$||0>=V||0>=G||z+V>L||$+G>D))return 0;if(j.v=z,j.j=$,j.va=z+V,j.o=$+G,j.U=V,j.T=G,j.da=g!=null&&0<g.da,j.da){if(!it(V,G,k=[g.ib],z=[g.hb]))return 0;j.ib=k[0],j.hb=z[0]}return j.ob=g!=null&&g.ob,j.Kb=g==null||!g.Sd,j.da&&(j.ob=j.ib<3*L/4&&j.hb<3*D/4,j.Kb=0),1}function $f(g){if(g==null)return 2;if(11>g.S){var j=g.f.RGBA;j.fb+=(g.height-1)*j.A,j.A=-j.A}else j=g.f.kb,g=g.height,j.O+=(g-1)*j.fa,j.fa=-j.fa,j.N+=(g-1>>1)*j.Ab,j.Ab=-j.Ab,j.W+=(g-1>>1)*j.Db,j.Db=-j.Db,j.F!=null&&(j.J+=(g-1)*j.lb,j.lb=-j.lb);return 0}function Zu(g,j,k,L){if(L==null||0>=g||0>=j)return 2;if(k!=null){if(k.Da){var D=k.cd,z=k.bd,$=-2&k.v,V=-2&k.j;if(0>$||0>V||0>=D||0>=z||$+D>g||V+z>j)return 2;g=D,j=z}if(k.da){if(!it(g,j,D=[k.ib],z=[k.hb]))return 2;g=D[0],j=z[0]}}L.width=g,L.height=j;e:{var G=L.width,ee=L.height;if(g=L.S,0>=G||0>=ee||!(g>=Cg&&13>g))g=2;else{if(0>=L.Rd&&L.sd==null){$=z=D=j=0;var he=(V=G*pS[g])*ee;if(11>g||(z=(ee+1)/2*(j=(G+1)/2),g==12&&($=(D=G)*ee)),(ee=i(he+2*z+$))==null){g=1;break e}L.sd=ee,11>g?((G=L.f.RGBA).eb=ee,G.fb=0,G.A=V,G.size=he):((G=L.f.kb).y=ee,G.O=0,G.fa=V,G.Fd=he,G.f=ee,G.N=0+he,G.Ab=j,G.Cd=z,G.ea=ee,G.W=0+he+z,G.Db=j,G.Ed=z,g==12&&(G.F=ee,G.J=0+he+2*z),G.Tc=$,G.lb=D)}if(j=1,D=L.S,z=L.width,$=L.height,D>=Cg&&13>D)if(11>D)g=L.f.RGBA,j&=(V=Math.abs(g.A))*($-1)+z<=g.size,j&=V>=z*pS[D],j&=g.eb!=null;else{g=L.f.kb,V=(z+1)/2,he=($+1)/2,G=Math.abs(g.fa),ee=Math.abs(g.Ab);var we=Math.abs(g.Db),_e=Math.abs(g.lb),xe=_e*($-1)+z;j&=G*($-1)+z<=g.Fd,j&=ee*(he-1)+V<=g.Cd,j=(j&=we*(he-1)+V<=g.Ed)&G>=z&ee>=V&we>=V,j&=g.y!=null,j&=g.f!=null,j&=g.ea!=null,D==12&&(j&=_e>=z,j&=xe<=g.Tc,j&=g.F!=null)}else j=0;g=j?0:2}}return g!=0||k!=null&&k.fd&&(g=$f(L)),g}var Cn=64,ed=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],td=24,rd=32,Bf=8,ps=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ze("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(g){return g},A.Predictor2=function(g,j,k){return j[k+0]},A.Predictor3=function(g,j,k){return j[k+1]},A.Predictor4=function(g,j,k){return j[k-1]},A.Predictor5=function(g,j,k){return Ue(Ue(g,j[k+1]),j[k+0])},A.Predictor6=function(g,j,k){return Ue(g,j[k-1])},A.Predictor7=function(g,j,k){return Ue(g,j[k+0])},A.Predictor8=function(g,j,k){return Ue(j[k-1],j[k+0])},A.Predictor9=function(g,j,k){return Ue(j[k+0],j[k+1])},A.Predictor10=function(g,j,k){return Ue(Ue(g,j[k-1]),Ue(j[k+0],j[k+1]))},A.Predictor11=function(g,j,k){var L=j[k+0];return 0>=yt(L>>24&255,g>>24&255,(j=j[k-1])>>24&255)+yt(L>>16&255,g>>16&255,j>>16&255)+yt(L>>8&255,g>>8&255,j>>8&255)+yt(255&L,255&g,255&j)?L:g},A.Predictor12=function(g,j,k){var L=j[k+0];return(nt((g>>24&255)+(L>>24&255)-((j=j[k-1])>>24&255))<<24|nt((g>>16&255)+(L>>16&255)-(j>>16&255))<<16|nt((g>>8&255)+(L>>8&255)-(j>>8&255))<<8|nt((255&g)+(255&L)-(255&j)))>>>0},A.Predictor13=function(g,j,k){var L=j[k-1];return(pt((g=Ue(g,j[k+0]))>>24&255,L>>24&255)<<24|pt(g>>16&255,L>>16&255)<<16|pt(g>>8&255,L>>8&255)<<8|pt(g>>0&255,L>>0&255))>>>0};var Sy=A.PredictorAdd0;A.PredictorAdd1=jt,ze("Predictor2","PredictorAdd2"),ze("Predictor3","PredictorAdd3"),ze("Predictor4","PredictorAdd4"),ze("Predictor5","PredictorAdd5"),ze("Predictor6","PredictorAdd6"),ze("Predictor7","PredictorAdd7"),ze("Predictor8","PredictorAdd8"),ze("Predictor9","PredictorAdd9"),ze("Predictor10","PredictorAdd10"),ze("Predictor11","PredictorAdd11"),ze("Predictor12","PredictorAdd12"),ze("Predictor13","PredictorAdd13");var qf=A.PredictorAdd2;Pt("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),Pt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var yg,ai=A.ColorIndexInverseTransform,nd=A.MapARGB,bg=A.VP8LColorIndexInverseTransformAlpha,wg=A.MapAlpha,rl=A.VP8LPredictorsAdd=[];rl.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var Tc,gs,Qn,nl,oo,lo,sd,co,Vr,Uf,Jn,oi,id,_g,Vf,Lc,Oc,sl,Mc,ad,Rc,il,Wf,li,ci,mr,pr,Wr,ln=i(511),uo=i(2041),Hf=i(225),od=i(767),jg=0,Cy=uo,Sg=Hf,Is=od,ui=ln,Cg=0,Ng=1,nS=2,kg=3,Eg=4,Ny=5,sS=6,ky=7,Ey=8,Pg=9,Py=10,_8=[2,3,7],j8=[3,3,11],iS=[280,256,256,256,40],S8=[0,1,1,1,0],C8=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],N8=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],k8=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],E8=8,Ay=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ty=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Gf=null,P8=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],A8=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],aS=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],T8=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],L8=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],O8=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],M8=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],al=[],Di=[],ho=[],R8=1,oS=2,ol=[],di=[];ke("UpsampleRgbLinePair",qt,3),ke("UpsampleBgrLinePair",Pr,3),ke("UpsampleRgbaLinePair",Ri,4),ke("UpsampleBgraLinePair",gn,4),ke("UpsampleArgbLinePair",Dn,4),ke("UpsampleRgba4444LinePair",en,2),ke("UpsampleRgb565LinePair",Dr,2);var D8=A.UpsampleRgbLinePair,F8=A.UpsampleBgrLinePair,lS=A.UpsampleRgbaLinePair,cS=A.UpsampleBgraLinePair,uS=A.UpsampleArgbLinePair,dS=A.UpsampleRgba4444LinePair,I8=A.UpsampleRgb565LinePair,Ag=16,Tg=1<<Ag-1,Yf=-227,Ly=482,hS=6,z8=(256<<hS)-1,fS=0,$8=i(256),B8=i(256),q8=i(256),U8=i(256),V8=i(Ly-Yf),W8=i(Ly-Yf);Na("YuvToRgbRow",qt,3),Na("YuvToBgrRow",Pr,3),Na("YuvToRgbaRow",Ri,4),Na("YuvToBgraRow",gn,4),Na("YuvToArgbRow",Dn,4),Na("YuvToRgba4444Row",en,2),Na("YuvToRgb565Row",Dr,2);var mS=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Lg=[0,2,8],H8=[8,7,6,4,4,2,2,2,1,1,1,1],G8=1;this.WebPDecodeRGBA=function(g,j,k,L,D){var z=Ng,$=new Ku,V=new Rr;$.ba=V,V.S=z,V.width=[V.width],V.height=[V.height];var G=V.width,ee=V.height,he=new Jr;if(he==null||g==null)var we=2;else e(he!=null),we=Ju(g,j,k,he.width,he.height,he.Pd,he.Qd,he.format,null);if(we!=0?G=0:(G!=null&&(G[0]=he.width[0]),ee!=null&&(ee[0]=he.height[0]),G=1),G){V.width=V.width[0],V.height=V.height[0],L!=null&&(L[0]=V.width),D!=null&&(D[0]=V.height);e:{if(L=new Uu,(D=new Of).data=g,D.w=j,D.ha=k,D.kd=1,j=[0],e(D!=null),((g=Ju(D.data,D.w,D.ha,null,null,null,j,null,D))==0||g==7)&&j[0]&&(g=4),(j=g)==0){if(e($!=null),L.data=D.data,L.w=D.w+D.offset,L.ha=D.ha-D.offset,L.put=ya,L.ac=Sn,L.bc=ba,L.ma=$,D.xa){if((g=ii())==null){$=1;break e}if(function(_e,xe){var Me=[0],Ce=[0],fe=[0];t:for(;;){if(_e==null)return 0;if(xe==null)return _e.a=2,0;if(_e.l=xe,_e.a=0,R(_e.m,xe.data,xe.w,xe.ha),!dt(_e.m,Me,Ce,fe)){_e.a=3;break t}if(_e.xb=oS,xe.width=Me[0],xe.height=Ce[0],!ja(Me[0],Ce[0],1,_e,null))break t;return 1}return e(_e.a!=0),0}(g,L)){if(L=(j=Zu(L.width,L.height,$.Oa,$.ba))==0){t:{L=g;r:for(;;){if(L==null){L=0;break t}if(e(L.s.yc!=null),e(L.s.Ya!=null),e(0<L.s.Wb),e((k=L.l)!=null),e((D=k.ma)!=null),L.xb!=0){if(L.ca=D.ba,L.tb=D.tb,e(L.ca!=null),!zf(D.Oa,k,kg)){L.a=2;break r}if(!Nc(L,k.width)||k.da)break r;if((k.da||Ge(L.ca.S))&&be(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&be()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!$e(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!Li(L,L.V,L.Ba,L.c,L.i,k.o,Fu))break r;D.Dc=L.Ma,L=1;break t}e(L.a!=0),L=0}L=!L}L&&(j=g.a)}else j=g.a}else{if((g=new iy)==null){$=1;break e}if(g.Fa=D.na,g.P=D.P,g.qc=D.Sa,ng(g,L)){if((j=Zu(L.width,L.height,$.Oa,$.ba))==0){if(g.Aa=0,k=$.Oa,e((D=g)!=null),k!=null){if(0<(G=0>(G=k.Md)?0:100<G?255:255*G/100)){for(ee=he=0;4>ee;++ee)12>(we=D.pb[ee]).lc&&(we.ia=G*H8[0>we.lc?0:we.lc]>>3),he|=we.ia;he&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=k.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}ay(g,L)||(j=g.a)}}else j=g.a}j==0&&$.Oa!=null&&$.Oa.fd&&(j=$f($.ba))}$=j}z=$!=0?null:11>z?V.f.RGBA.eb:V.f.kb.y}else z=null;return z};var pS=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(A,F){for(var Y="",T=0;T<4;T++)Y+=String.fromCharCode(A[F++]);return Y}function d(A,F){return(A[F+0]<<0|A[F+1]<<8|A[F+2]<<16)>>>0}function h(A,F){return(A[F+0]<<0|A[F+1]<<8|A[F+2]<<16|A[F+3]<<24)>>>0}new c;var f=[0],m=[0],p=[],v=new c,b=t,x=function(A,F){var Y={},T=0,O=!1,U=0,q=0;if(Y.frames=[],!function(W,K,ne,se){for(var le=0;le<se;le++)if(W[K+le]!=ne.charCodeAt(le))return!0;return!1}(A,F,"RIFF",4)){for(h(A,F+=4),F+=8;F<A.length;){var Z=u(A,F),H=h(A,F+=4);F+=4;var Q=H+(1&H);switch(Z){case"VP8 ":case"VP8L":Y.frames[T]===void 0&&(Y.frames[T]={}),(X=Y.frames[T]).src_off=O?q:F-8,X.src_size=U+H+8,T++,O&&(O=!1,U=0,q=0);break;case"VP8X":(X=Y.header={}).feature_flags=A[F];var R=F+4;X.canvas_width=1+d(A,R),R+=3,X.canvas_height=1+d(A,R),R+=3;break;case"ALPH":O=!0,U=Q+8,q=F-8;break;case"ANIM":(X=Y.header).bgcolor=h(A,F),R=F+4,X.loop_count=(ie=A)[(M=R)+0]<<0|ie[M+1]<<8,R+=2;break;case"ANMF":var B,X;(X=Y.frames[T]={}).offset_x=2*d(A,F),F+=3,X.offset_y=2*d(A,F),F+=3,X.width=1+d(A,F),F+=3,X.height=1+d(A,F),F+=3,X.duration=d(A,F),F+=3,B=A[F++],X.dispose=1&B,X.blend=B>>1&1}Z!="ANMF"&&(F+=Q)}var ie,M;return Y}}(b,0);x.response=b,x.rgbaoutput=!0,x.dataurl=!1;var w=x.header?x.header:null,_=x.frames?x.frames:null;if(w){w.loop_counter=w.loop_count,f=[w.canvas_height],m=[w.canvas_width];for(var S=0;S<_.length&&_[S].blend!=0;S++);}var N=_[0],E=v.WebPDecodeRGBA(b,N.src_off,N.src_size,m,f);N.rgba=E,N.imgwidth=m[0],N.imgheight=f[0];for(var P=0;P<m[0]*f[0]*4;P++)p[P]=E[P];return this.width=m,this.height=f,this.data=p,this}(function(t){var e=function(){return typeof h5=="function"},r=function(f,m,p,v){var b=4,x=a;switch(v){case t.image_compression.FAST:b=1,x=i;break;case t.image_compression.MEDIUM:b=6,x=l;break;case t.image_compression.SLOW:b=9,x=c}f=n(f,m,p,x);var w=h5(f,{level:b});return t.__addimage__.arrayBufferToBinaryString(w)},n=function(f,m,p,v){for(var b,x,w,_=f.length/m,S=new Uint8Array(f.length+_),N=d(),E=0;E<_;E+=1){if(w=E*m,b=f.subarray(w,w+m),v)S.set(v(b,p,x),w+E);else{for(var P,A=N.length,F=[];P<A;P+=1)F[P]=N[P](b,p,x);var Y=h(F.concat());S.set(F[Y],w+E)}x=b}return S},s=function(f){var m=Array.apply([],f);return m.unshift(0),m},i=function(f,m){var p,v=[],b=f.length;v[0]=1;for(var x=0;x<b;x+=1)p=f[x-m]||0,v[x+1]=f[x]-p+256&255;return v},a=function(f,m,p){var v,b=[],x=f.length;b[0]=2;for(var w=0;w<x;w+=1)v=p&&p[w]||0,b[w+1]=f[w]-v+256&255;return b},l=function(f,m,p){var v,b,x=[],w=f.length;x[0]=3;for(var _=0;_<w;_+=1)v=f[_-m]||0,b=p&&p[_]||0,x[_+1]=f[_]+256-(v+b>>>1)&255;return x},c=function(f,m,p){var v,b,x,w,_=[],S=f.length;_[0]=4;for(var N=0;N<S;N+=1)v=f[N-m]||0,b=p&&p[N]||0,x=p&&p[N-m]||0,w=u(v,b,x),_[N+1]=f[N]-w+256&255;return _},u=function(f,m,p){if(f===m&&m===p)return f;var v=Math.abs(m-p),b=Math.abs(f-p),x=Math.abs(f+m-p-p);return v<=b&&v<=x?f:b<=x?m:p},d=function(){return[s,i,a,l,c]},h=function(f){var m=f.map(function(p){return p.reduce(function(v,b){return v+Math.abs(b)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(f,m,p,v){var b,x,w,_,S,N,E,P,A,F,Y,T,O,U,q,Z=this.decode.FLATE_DECODE,H="";if(this.__addimage__.isArrayBuffer(f)&&(f=new Uint8Array(f)),this.__addimage__.isArrayBufferView(f)){if(f=(w=new fte(f)).imgData,x=w.bits,b=w.colorSpace,S=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){A=(P=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,Y=new Uint8Array(A*w.colors),F=new Uint8Array(A);var Q,R=w.pixelBitlength-w.bits;for(U=0,q=0;U<A;U++){for(O=P[U],Q=0;Q<R;)Y[q++]=O>>>Q&255,Q+=w.bits;F[U]=O>>>Q&255}}if(w.bits===16){A=(P=new Uint32Array(w.decodePixels().buffer)).length,Y=new Uint8Array(A*(32/w.pixelBitlength)*w.colors),F=new Uint8Array(A*(32/w.pixelBitlength)),T=w.colors>1,U=0,q=0;for(var B=0;U<A;)O=P[U++],Y[q++]=O>>>0&255,T&&(Y[q++]=O>>>16&255,O=P[U++],Y[q++]=O>>>0&255),F[B++]=O>>>16&255;x=8}v!==t.image_compression.NONE&&e()?(f=r(Y,w.width*w.colors,w.colors,v),E=r(F,w.width,1,v)):(f=Y,E=F,Z=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,N=w.palette,w.transparency.indexed)){var X=w.transparency.indexed,ie=0;for(U=0,A=X.length;U<A;++U)ie+=X[U];if((ie/=255)===A-1&&X.indexOf(0)!==-1)_=[X.indexOf(0)];else if(ie!==A){for(P=w.decodePixels(),F=new Uint8Array(P.length),U=0,A=P.length;U<A;U++)F[U]=X[P[U]];E=r(F,w.width,1)}}var M=function(W){var K;switch(W){case t.image_compression.FAST:K=11;break;case t.image_compression.MEDIUM:K=13;break;case t.image_compression.SLOW:K=14;break;default:K=12}return K}(v);return Z===this.decode.FLATE_DECODE&&(H="/Predictor "+M+" "),H+="/Colors "+S+" /BitsPerComponent "+x+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),(E&&this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),{alias:p,data:f,index:m,filter:Z,decodeParameters:H,transparency:_,palette:N,sMask:E,predictor:M,width:w.width,height:w.height,bitsPerComponent:x,colorSpace:b}}}})(ht.API),function(t){t.processGIF89A=function(e,r,n,s){var i=new mte(e),a=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:a,height:l},d=new ob(100).encode(u,100);return t.processJPEG.call(this,d,r,n,s)},t.processGIF87A=t.processGIF89A}(ht.API),Bi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Bi.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){fr.log("bit decode error:"+r)}},Bi.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[a+4*l]=c.blue,this.data[a+4*l+1]=c.green,this.data[a+4*l+2]=c.red,this.data[a+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Bi.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*s*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[a]=u.blue,this.data[a+1]=u.green,this.data[a+2]=u.red,this.data[a+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[a+4]=u.blue,this.data[a+4+1]=u.green,this.data[a+4+2]=u.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},Bi.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var a=this.palette[s];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Bi.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,u=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=a,this.data[d+3]=u}this.pos+=t}},Bi.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(a&e)/e*255|0,c=(a>>5&r)/r*255|0,u=(a>>11)/e*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Bi.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*r;this.data[a]=i,this.data[a+1]=s,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},Bi.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=a}},Bi.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var i=new Bi(e,!1),a=i.width,l=i.height,c={data:i.getData(),width:a,height:l},u=new ob(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(ht.API),v4.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var i=new v4(e),a=i.width,l=i.height,c={data:i.getData(),width:a,height:l},u=new ob(100).encode(c,100);return t.processJPEG.call(this,u,r,n,s)}}(ht.API),ht.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,i=new Uint8Array(s/4*3),a=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],h=n[u+1],f=n[u+2],m=n[u+3];i[l++]=d,i[l++]=h,i[l++]=f,a[c++]=m}var p=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:p,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ht.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sd=ht.API,Z0=Sd.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,h=e.doKerning!==!1,f=0,m=t.length,p=0,v=l[0]||c,b=[];for(r=0;r<m;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?b.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+a*(1e3/i)||0)/1e3):(f=h&&or(u[n])==="object"&&!isNaN(parseInt(u[n][p],10))?u[n][p]/d:0,b.push((l[n]||v)/c+f)),p=n;return b},f4=Sd.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Sd.processArabic&&(t=Sd.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:Z0.apply(this,arguments).reduce(function(i,a){return i+a},0)},m4=function(t,e,r,n){for(var s=[],i=0,a=t.length,l=0;i!==a&&l+e[i]<r;)l+=e[i],i++;s.push(t.slice(0,i));var c=i;for(l=0;i!==a;)l+e[i]>n&&(s.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&s.push(t.slice(c,i)),s},p4=function(t,e,r){r||(r={});var n,s,i,a,l,c,u,d=[],h=[d],f=r.textIndent||0,m=0,p=0,v=t.split(" "),b=Z0.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),w=[];v.map(function(S){(S=S.split(/\s*\n/)).length>1?w=w.concat(S.map(function(N,E){return(E&&N.length?`
`:"")+N})):w.push(S[0])}),v=w,c=f4.apply(this,[x,r])}for(i=0,a=v.length;i<a;i++){var _=0;if(n=v[i],c&&n[0]==`
`&&(n=n.substr(1),_=1),f+m+(p=(s=Z0.apply(this,[n,r])).reduce(function(S,N){return S+N},0))>e||_){if(p>e){for(l=m4.apply(this,[n,s,e-(f+m),e]),d.push(l.shift()),d=[l.pop()];l.length;)h.push([l.shift()]);p=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,N){return S+N},0)}else d=[n];h.push(d),f=p+c,m=b}else d.push(n),f+=m+p,m=b}return u=c?function(S,N){return(N?x:"")+S.join(" ")}:function(S){return S.join(" ")},h.map(u)},Sd.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(p4.apply(this,[n[l],a,i]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},s=0;s<e.length;s++)r[e[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=e[s];var i=function(h){return"0x"+parseInt(h,10).toString(16)},a=t.__fontmetrics__.compress=function(h){var f,m,p,v,b=["{"];for(var x in h){if(f=h[x],isNaN(parseInt(x,10))?m="'"+x+"'":(x=parseInt(x,10),m=(m=i(x).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof f=="number")f<0?(p=i(f).slice(3),v="-"):(p=i(f).slice(2),v=""),p=v+p.slice(0,-1)+n[p.slice(-1)];else{if(or(f)!=="object")throw new Error("Don't know what to do with value type "+or(f)+".");p=a(f)}b.push(m+p)}return b.push("}"),b.join("")},l=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,m,p,v,b={},x=1,w=b,_=[],S="",N="",E=h.length-1,P=1;P<E;P+=1)(v=h[P])=="'"?f?(p=f.join(""),f=void 0):f=[]:f?f.push(v):v=="{"?(_.push([w,p]),w={},p=void 0):v=="}"?((m=_.pop())[0][m[1]]=w,p=void 0,w=m[0]):v=="-"?x=-1:p===void 0?r.hasOwnProperty(v)?(S+=r[v],p=parseInt(S,16)*x,x=1,S=""):S+=v:r.hasOwnProperty(v)?(N+=r[v],w[p]=parseInt(N,16)*x,x=1,p=void 0,N=""):N+=v;return b},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var f=h.font,m=d.Unicode[f.postScriptName];m&&(f.metadata.Unicode={},f.metadata.Unicode.widths=m.widths,f.metadata.Unicode.kerning=m.kerning);var p=u.Unicode[f.postScriptName];p&&(f.metadata.Unicode.encoding=p,f.encoding=p.codePages[0])}])}(ht.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(a,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(qm(l)),a.metadata=t.API.TTFFont.open(l),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(s,n)}}])}(ht),function(t){function e(){return(mt.canvg?Promise.resolve(mt.canvg):sc(()=>import("./index.es-B_R7N1x4.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}ht.API.addSvgAsImage=function(r,n,s,i,a,l,c,u){if(isNaN(n)||isNaN(s))throw fr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw fr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=a;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(p){return p.fromString(h,r,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(f)}).then(function(){m.addImage(d.toDataURL("image/jpeg",1),n,s,i,a,c,u)})}}(),ht.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},ht.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(a),c=[],u=0,d=0,h=0;function f(p,v){var b,x=!1;for(b=0;b<p.length;b+=1)p[b]===v&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(h=0;h<m;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(or(t)==="object"){for(s in t)if(i=t[s],f(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&f(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,v=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?v.push("/"+p+" /"+r[p].value):v.push("/"+p+" "+r[p].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+a.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+a+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(ht.API),function(t){var e=t.API,r=e.pdfEscape16=function(i,a){for(var l,c=a.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],h=0,f=i.length;h<f;++h){if(l=a.metadata.characterToGlyph(i.charCodeAt(h)),a.metadata.glyIdsUsed.push(l),a.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(a.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(i){var a,l,c,u,d,h,f;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,f=(l=Object.keys(i).sort(function(m,p){return m-p})).length;h<f;h++)a=l[h],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(u=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),c.push("<"+a+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(a){var l=a.font,c=a.out,u=a.newObject,d=a.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",p=0;p<f.length;p++)m+=String.fromCharCode(f[p]);var v=u();d({data:m,addLength1:!0,objectId:v}),c("endobj");var b=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var x=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Pd(l.fontName)),c("/FontFile2 "+v+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var w=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Pd(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+t.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+b+" 0 R"),c("/BaseFont /"+Pd(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+w+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(a){var l=a.font,c=a.out,u=a.newObject,d=a.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,f="",m=0;m<h.length;m++)f+=String.fromCharCode(h[m]);var p=u();d({data:f,addLength1:!0,objectId:p}),c("endobj");var v=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var b=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+p+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Pd(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Pd(l.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var a,l=i.text||"",c=i.x,u=i.y,d=i.options||{},h=i.mutex||{},f=h.pdfEscape,m=h.activeFontKey,p=h.fonts,v=m,b="",x=0,w="",_=p[v].encoding;if(p[v].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:h};for(w=l,v=m,Array.isArray(l)&&(w=l[0]),x=0;x<w.length;x+=1)p[v].metadata.hasOwnProperty("cmap")&&(a=p[v].metadata.cmap.unicode.codeMap[w[x].charCodeAt(0)]),a||w[x].charCodeAt(0)<256&&p[v].metadata.hasOwnProperty("Unicode")?b+=w[x]:b+="";var S="";return parseInt(v.slice(1))<14||_==="WinAnsiEncoding"?S=f(b,v).split("").map(function(N){return N.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(S=r(b,p[v])),h.isHex=!0,{text:S,x:c,y:u,options:d,mutex:h}};e.events.push(["postProcessText",function(i){var a=i.text||"",l=[],c={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var u=0;for(u=0;u<a.length;u+=1)Array.isArray(a[u])&&a[u].length===3?l.push([s(Object.assign({},c,{text:a[u][0]})).text,a[u][1],a[u][2]]):l.push(s(Object.assign({},c,{text:a[u]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:a})).text}])}(ht),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(ht.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,i,a,l,c,u,d,h=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,_=0;this.__bidiEngine__={};var S=function(T){var O=T.charCodeAt(),U=O>>8,q=v[U];return q!==void 0?h[256*q+(255&O)]:U===252||U===253?"AL":x.test(U)?"L":U===8?"R":"N"},N=function(T){for(var O,U=0;U<T.length;U++){if((O=S(T.charAt(U)))==="L")return!1;if(O==="R")return!0}return!1},E=function(T,O,U,q){var Z,H,Q,R,B=O[q];switch(B){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(B="AN");break;case"AL":w=!0,B="R";break;case"WS":B="N";break;case"CS":q<1||q+1>=O.length||(Z=U[q-1])!=="EN"&&Z!=="AN"||(H=O[q+1])!=="EN"&&H!=="AN"?B="N":w&&(H="AN"),B=H===Z?H:"N";break;case"ES":B=(Z=q>0?U[q-1]:"B")==="EN"&&q+1<O.length&&O[q+1]==="EN"?"EN":"N";break;case"ET":if(q>0&&U[q-1]==="EN"){B="EN";break}if(w){B="N";break}for(Q=q+1,R=O.length;Q<R&&O[Q]==="ET";)Q++;B=Q<R&&O[Q]==="EN"?"EN":"N";break;case"NSM":if(a&&!l){for(R=O.length,Q=q+1;Q<R&&O[Q]==="NSM";)Q++;if(Q<R){var X=T[q],ie=X>=1425&&X<=2303||X===64286;if(Z=O[Q],ie&&(Z==="R"||Z==="AL")){B="R";break}}}B=q<1||(Z=O[q-1])==="B"?"N":U[q-1];break;case"B":w=!1,s=!0,B=_;break;case"S":i=!0,B="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":B="N"}return B},P=function(T,O,U){var q=T.split("");return U&&A(q,U,{hiLevel:_}),q.reverse(),O&&O.reverse(),q.join("")},A=function(T,O,U){var q,Z,H,Q,R,B=-1,X=T.length,ie=0,M=[],W=_?m:f,K=[];for(w=!1,s=!1,i=!1,Z=0;Z<X;Z++)K[Z]=S(T[Z]);for(H=0;H<X;H++){if(R=ie,M[H]=E(T,K,M,H),q=240&(ie=W[R][p[M[H]]]),ie&=15,O[H]=Q=W[ie][5],q>0)if(q===16){for(Z=B;Z<H;Z++)O[Z]=1;B=-1}else B=-1;if(W[ie][6])B===-1&&(B=H);else if(B>-1){for(Z=B;Z<H;Z++)O[Z]=Q;B=-1}K[H]==="B"&&(O[H]=0),U.hiLevel|=Q}i&&function(ne,se,le){for(var ye=0;ye<le;ye++)if(ne[ye]==="S"){se[ye]=_;for(var oe=ye-1;oe>=0&&ne[oe]==="WS";oe--)se[oe]=_}}(K,O,X)},F=function(T,O,U,q,Z){if(!(Z.hiLevel<T)){if(T===1&&_===1&&!s)return O.reverse(),void(U&&U.reverse());for(var H,Q,R,B,X=O.length,ie=0;ie<X;){if(q[ie]>=T){for(R=ie+1;R<X&&q[R]>=T;)R++;for(B=ie,Q=R-1;B<Q;B++,Q--)H=O[B],O[B]=O[Q],O[Q]=H,U&&(H=U[B],U[B]=U[Q],U[Q]=H);ie=R}ie++}}},Y=function(T,O,U){var q=T.split(""),Z={hiLevel:_};return U||(U=[]),A(q,U,Z),function(H,Q,R){if(R.hiLevel!==0&&d)for(var B,X=0;X<H.length;X++)Q[X]===1&&(B=b.indexOf(H[X]))>=0&&(H[X]=b[B+1])}(q,U,Z),F(2,q,O,U,Z),F(1,q,O,U,Z),q.join("")};return this.__bidiEngine__.doBidiReorder=function(T,O,U){if(function(Z,H){if(H)for(var Q=0;Q<Z.length;Q++)H[Q]=Q;l===void 0&&(l=N(Z)),u===void 0&&(u=N(Z))}(T,O),a||!c||u)if(a&&c&&l^u)_=l?1:0,T=P(T,O,U);else if(!a&&c&&u)_=l?1:0,T=Y(T,O,U),T=P(T,O);else if(!a||l||c||u){if(a&&!c&&l^u)T=P(T,O),l?(_=0,T=Y(T,O,U)):(_=1,T=Y(T,O,U),T=P(T,O));else if(a&&l&&!c&&u)_=1,T=Y(T,O,U),T=P(T,O);else if(!a&&!c&&l^u){var q=d;l?(_=1,T=Y(T,O,U),_=0,d=!1,T=Y(T,O,U),d=q):(_=0,T=Y(T,O,U),T=P(T,O),_=1,d=!1,T=Y(T,O,U),d=q,T=P(T,O))}}else _=0,T=Y(T,O,U);else _=l?1:0,T=Y(T,O,U);return T},this.__bidiEngine__.setOptions=function(T){T&&(a=T.isInputVisual,c=T.isOutputVisual,l=T.isInputRtl,u=T.isOutputRtl,d=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var a=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(a=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?a.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):a.push([r.doBidiReorder(s[l])]);n.text=a}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(ht),ht.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new fc(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Pte(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new pte(this.contents),this.head=new vte(this),this.name=new _te(this),this.cmap=new c8(this),this.toUnicode={},this.hhea=new xte(this),this.maxp=new jte(this),this.hmtx=new Ste(this),this.post=new bte(this),this.os2=new yte(this),this.loca=new Ete(this),this.glyf=new Cte(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,l,c,u;for(u=[],a=0,l=(c=this.bbox).length;a<l;a++)e=c[a],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,i,a,l;for(a=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=e.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return a*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var xa,fc=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,i,a,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^a)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*a+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,i;for(i=[],n=0,s=e.length;n<s;n++)r=e[n],i.push(this.writeByte(r));return i},t}(),pte=function(){var t;function e(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,i,a,l,c,u,d,h,f,m,p,v;for(v in m=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(m)/c),a=Math.floor(h/c),d=16*m-h,(s=new fc).writeInt(this.scalarType),s.writeShort(m),s.writeShort(h),s.writeShort(a),s.writeShort(d),i=16*m,u=s.pos+i,l=null,p=[],r)for(f=r[v],s.writeString(v),s.writeInt(t(f)),s.writeInt(u),s.writeInt(f.length),p=p.concat(f),v==="head"&&(l=u),u+=f.length;u%4;)p.push(0),u++;return s.write(p),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,i,a;for(r=u8.call(r);r.length%4;)r.push(0);for(i=new fc(r),s=0,n=0,a=r.length;n<a;n=n+=4)s+=i.readUInt32();return 4294967295&s},e}(),gte={}.hasOwnProperty,no=function(t,e){for(var r in e)gte.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};xa=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var vte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new fc).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),x4=function(){function t(e,r){var n,s,i,a,l,c,u,d,h,f,m,p,v,b,x,w,_;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),f=m/2,e.pos+=6,i=function(){var S,N;for(N=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)N.push(e.readUInt16());return N}(),e.pos+=2,v=function(){var S,N;for(N=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)N.push(e.readUInt16());return N}(),u=function(){var S,N;for(N=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)N.push(e.readUInt16());return N}(),d=function(){var S,N;for(N=[],c=S=0;0<=f?S<f:S>f;c=0<=f?++S:--S)N.push(e.readUInt16());return N}(),s=(this.length-e.pos+this.offset)/2,l=function(){var S,N;for(N=[],c=S=0;0<=s?S<s:S>s;c=0<=s?++S:--S)N.push(e.readUInt16());return N}(),c=x=0,_=i.length;x<_;c=++x)for(b=i[c],n=w=p=v[c];p<=b?w<=b:w>=b;n=p<=b?++w:--w)d[c]===0?a=n+u[c]:(a=l[d[c]/2+(n-p)-(f-c)]||0)!==0&&(a+=u[c]),this.codeMap[n]=65535&a}e.pos=h}return t.encode=function(e,r){var n,s,i,a,l,c,u,d,h,f,m,p,v,b,x,w,_,S,N,E,P,A,F,Y,T,O,U,q,Z,H,Q,R,B,X,ie,M,W,K,ne,se,le,ye,oe,ve,Se,Ae;switch(q=new fc,a=Object.keys(e).sort(function(Ee,$e){return Ee-$e}),r){case"macroman":for(v=0,b=function(){var Ee=[];for(p=0;p<256;++p)Ee.push(0);return Ee}(),w={0:0},i={},Z=0,B=a.length;Z<B;Z++)w[oe=e[s=a[Z]]]==null&&(w[oe]=++v),i[s]={old:e[s],new:w[e[s]]},b[s]=w[e[s]];return q.writeUInt16(1),q.writeUInt16(0),q.writeUInt32(12),q.writeUInt16(0),q.writeUInt16(262),q.writeUInt16(0),q.write(b),{charMap:i,subtable:q.data,maxGlyphID:v+1};case"unicode":for(O=[],h=[],_=0,w={},n={},x=u=null,H=0,X=a.length;H<X;H++)w[N=e[s=a[H]]]==null&&(w[N]=++_),n[s]={old:N,new:w[N]},l=w[N]-s,x!=null&&l===u||(x&&h.push(x),O.push(s),u=l),x=s;for(x&&h.push(x),h.push(65535),O.push(65535),Y=2*(F=O.length),A=2*Math.pow(Math.log(F)/Math.LN2,2),f=Math.log(A/2)/Math.LN2,P=2*F-A,c=[],E=[],m=[],p=Q=0,ie=O.length;Q<ie;p=++Q){if(T=O[p],d=h[p],T===65535){c.push(0),E.push(0);break}if(T-(U=n[T].new)>=32768)for(c.push(0),E.push(2*(m.length+F-p)),s=R=T;T<=d?R<=d:R>=d;s=T<=d?++R:--R)m.push(n[s].new);else c.push(U-T),E.push(0)}for(q.writeUInt16(3),q.writeUInt16(1),q.writeUInt32(12),q.writeUInt16(4),q.writeUInt16(16+8*F+2*m.length),q.writeUInt16(0),q.writeUInt16(Y),q.writeUInt16(A),q.writeUInt16(f),q.writeUInt16(P),le=0,M=h.length;le<M;le++)s=h[le],q.writeUInt16(s);for(q.writeUInt16(0),ye=0,W=O.length;ye<W;ye++)s=O[ye],q.writeUInt16(s);for(ve=0,K=c.length;ve<K;ve++)l=c[ve],q.writeUInt16(l);for(Se=0,ne=E.length;Se<ne;Se++)S=E[Se],q.writeUInt16(S);for(Ae=0,se=m.length;Ae<se;Ae++)v=m[Ae],q.writeUInt16(v);return{charMap:n,subtable:q.data,maxGlyphID:_+1}}},t}(),c8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,s,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)n=new x4(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var s,i;return n==null&&(n="macroman"),s=x4.encode(r,n),(i=new fc).writeUInt16(0),i.writeUInt16(1),s.table=i.data.concat(s.subtable),s},e}(),xte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),yte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(r.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(r.readInt());return s}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(r.readInt());return s}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),bte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="post",e.prototype.parse=function(r){var n,s,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var a;for(s=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 196608:break;case 262144:return this.map=(function(){var l,c,u;for(u=[],a=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;a=0<=c?++l:--l)u.push(r.readUInt32());return u}).call(this)}},e}(),wte=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},_te=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="name",e.prototype.parse=function(r){var n,s,i,a,l,c,u,d,h,f,m;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),s=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},a=h=0,f=s.length;h<f;a=++h)i=s[a],r.pos=i.offset,d=r.readString(i.length),l=new wte(d,i),u[m=i.nameID]==null&&(u[m]=[]),u[i.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),jte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),Ste=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,s,i,a,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,h;for(h=[],n=d=0;0<=i?d<i:d>i;n=0<=i?++d:--d)h.push(r.readInt16());return h}(),this.widths=(function(){var d,h,f,m;for(m=[],d=0,h=(f=this.metrics).length;d<h;d++)a=f[d],m.push(a.advance);return m}).call(this),s=this.widths[this.widths.length-1],u=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)u.push(this.widths.push(s));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),u8=[].slice,Cte=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,s,i,a,l,c,u,d,h,f;return r in this.cache?this.cache[r]:(a=this.file.loca,n=this.file.contents,s=a.indexOf(r),(i=a.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+s,l=(c=new fc(n.read(i))).readShort(),d=c.readShort(),f=c.readShort(),u=c.readShort(),h=c.readShort(),this.cache[r]=l===-1?new kte(c,d,f,u,h):new Nte(c,l,d,f,u,h),this.cache[r]))},e.prototype.encode=function(r,n,s){var i,a,l,c,u;for(l=[],a=[],c=0,u=n.length;c<u;c++)i=r[n[c]],a.push(l.length),i&&(l=l.concat(i.encode(s)));return a.push(l.length),{table:l,offsets:a}},e}(),Nte=function(){function t(e,r,n,s,i,a){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),kte=function(){function t(e,r,n,s,i){var a,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;l=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&l;)a.pos+=1&l?4:2,128&l?a.pos+=8:64&l?a.pos+=4:8&l&&(a.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new fc(u8.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),Ete=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return no(e,xa),e.prototype.tag="loca",e.prototype.parse=function(r){var n,s;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,a;for(a=[],s=0,i=this.length;s<i;s+=2)a.push(2*r.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],s=0,i=this.length;s<i;s+=4)a.push(r.readUInt32());return a}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var s=new Uint32Array(this.offsets.length),i=0,a=0,l=0;l<s.length;++l)if(s[l]=i,a<n.length&&n[a]==l){++a,s[l]=i;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(i+=u)}for(var d=new Array(4*s.length),h=0;h<s.length;++h)d[4*h+3]=255&s[h],d[4*h+2]=(65280&s[h])>>8,d[4*h+1]=(16711680&s[h])>>16,d[4*h]=(4278190080&s[h])>>24;return d},e}(),Pte=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,i,a,l,c;for(s={},a=0,l=e.length;a<l;a++)s[i=e[a]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},t.prototype.encode=function(e,r){var n,s,i,a,l,c,u,d,h,f,m,p,v,b,x;for(s in n=c8.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),m={0:0},x=n.charMap)m[(c=x[s]).old]=c.new;for(p in f=n.maxGlyphID,a)p in m||(m[p]=f++);return d=function(w){var _,S;for(_ in S={},w)S[w[_]]=_;return S}(m),h=Object.keys(d).sort(function(w,_){return w-_}),v=function(){var w,_,S;for(S=[],w=0,_=h.length;w<_;w++)l=h[w],S.push(d[l]);return S}(),i=this.font.glyf.encode(a,v,m),u=this.font.loca.encode(i.offsets,v),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},t}();ht.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,i,a;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)a=r[s],i.push("/"+s+" "+e.convert(a));return i.push(">>"),i.join(`
`)}return""+r},e}();const Ate=({imageUrl:t,fileName:e,messageId:r,isTeacher:n,isSaving:s,onSaveAnnotations:i})=>{const a=y.useRef(null),l=y.useRef(null),[c,u]=y.useState(null),[d,h]=y.useState("select"),[f,m]=y.useState("#ff0000"),[p,v]=y.useState(3),[b,x]=y.useState(24),[w,_]=y.useState([]),[S,N]=y.useState(!1),[E,P]=y.useState(null),[A,F]=y.useState({width:800,height:600}),Y=()=>{if(!l.current)return{width:800,height:600};const B=l.current.clientWidth-40,X=window.innerHeight*.6;return window.innerWidth<768?{width:Math.min(B,400),height:Math.min(X,300)}:{width:Math.min(B,800),height:Math.min(X,600)}};y.useEffect(()=>{if(!a.current||!l.current)return;const R=Y();F(R);const B=new Dx(a.current,{width:R.width,height:R.height,backgroundColor:"#ffffff"});Hn.fromURL(t,{crossOrigin:"anonymous"}).then(ie=>{const M=Math.min(R.width/ie.width,R.height/ie.height),W=ie.width*M,K=ie.height*M;B.setDimensions({width:W,height:K}),ie.set({scaleX:M,scaleY:M,selectable:!1,evented:!1}),B.backgroundImage=ie,B.renderAll(),me.success("Image chargée, vous pouvez commencer à annoter !")}).catch(ie=>{console.error("Error loading image:",ie),me.error("Erreur lors du chargement de l'image")}),u(B);const X=()=>{if(B&&B.backgroundImage){const ie=Y(),M=B.backgroundImage,W=Math.min(ie.width/M.width,ie.height/M.height),K=M.width*W,ne=M.height*W;B.setDimensions({width:K,height:ne}),M.set({scaleX:W,scaleY:W}),B.renderAll(),F({width:K,height:ne})}};return window.addEventListener("resize",X),()=>{window.removeEventListener("resize",X),B.dispose()}},[t]),y.useEffect(()=>{if(!c)return;if(c.isDrawingMode=d==="draw"||d==="highlight",c.isDrawingMode){const B=new jp(c);B.color=d==="highlight"?`${f}80`:f,B.width=d==="highlight"?p*2:p,c.freeDrawingBrush=B}const R=B=>{const X=c.getPointer(B.e);if(d==="note")P({x:X.x,y:X.y}),N(!0);else if(d==="text"){const ie=new En("Tapez votre texte...",{left:X.x,top:X.y,fontSize:b,fill:f});c.add(ie),c.setActiveObject(ie)}};return d==="note"||d==="text"?c.on("mouse:down",R):c.off("mouse:down",R),()=>{c.off("mouse:down",R)}},[d,f,p,b,c]);const T=R=>{if(h(R),!!c){if(R==="circle"){const B=new Hs({left:100,top:100,radius:30,fill:"transparent",stroke:f,strokeWidth:2});c.add(B)}else if(R==="rectangle"){const B=new xi({left:100,top:100,width:100,height:60,fill:"transparent",stroke:f,strokeWidth:2});c.add(B)}}},O=()=>{if(!c)return;const R=c.getObjects();R.length>0&&(c.remove(R[R.length-1]),c.renderAll())},U=()=>{c&&(c.clear(),Hn.fromURL(t,{crossOrigin:"anonymous"}).then(R=>{const B=Math.min(A.width/R.width,A.height/R.height);R.set({scaleX:B,scaleY:B,selectable:!1,evented:!1}),c.backgroundImage=R,c.renderAll()}),_([]),me.success("Annotations effacées"))},q=R=>{if(!E)return;const B={id:Date.now().toString(),x:E.x,y:E.y,text:R,author:n?"Professeur":"Élève",timestamp:new Date().toLocaleString()};if(_(X=>[...X,B]),c){const X=new Hs({left:E.x-8,top:E.y-8,radius:8,fill:"#ff6b35",stroke:"#ffffff",strokeWidth:2,selectable:!1,evented:!1});c.add(X)}N(!1),P(null),me.success("Note ajoutée")},Z=async()=>{if(c)try{const R=c.toDataURL({format:"png",quality:1,multiplier:1});await i(R),me.success("Annotations sauvegardées")}catch(R){console.error("Error saving annotations:",R),me.error("Erreur lors de la sauvegarde")}},H=()=>{if(!c)return;const R=c.toDataURL({format:"png",quality:1,multiplier:1}),B=document.createElement("a");B.download=`annotated_${e}`,B.href=R,B.click(),me.success("Image téléchargée")},Q=()=>{if(!c)return;const R=c.toDataURL({format:"png",quality:1,multiplier:1}),B=new ht,X=190,ie=c.height*X/c.width;if(B.addImage(R,"PNG",10,10,X,ie),w.length>0){B.addPage(),B.setFontSize(16),B.text("Notes d'annotation:",10,20);let M=40;B.setFontSize(12),w.forEach((W,K)=>{B.text(`${K+1}. ${W.text}`,10,M),B.text(`   - ${W.author}, ${W.timestamp}`,10,M+5),M+=15})}B.save(`annotated_${e}.pdf`),me.success("PDF téléchargé")};return o.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[o.jsx(Lee,{activeTool:d,activeColor:f,brushSize:p,fontSize:b,onToolChange:T,onColorChange:m,onBrushSizeChange:v,onFontSizeChange:x,onUndo:O,onClear:U,onSave:Z,onDownloadImage:H,onDownloadPDF:Q,isSaving:s}),o.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[o.jsx("div",{ref:l,className:"flex-1 flex items-center justify-center p-4 bg-gray-50 overflow-auto",children:o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("canvas",{ref:a,className:"border border-gray-300 shadow-lg rounded-lg bg-white max-w-full max-h-full",style:{touchAction:"none",width:A.width,height:A.height}})})}),o.jsx(UM,{notes:w,isAddingNote:S,onAddNote:q,onCancelNote:()=>{N(!1),P(null)}})]})]})},Tte=({onCapture:t,disabled:e=!1})=>{const[r,n]=y.useState(!1),[s,i]=y.useState(null),[a,l]=y.useState(!1),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),h=y.useRef(null),f=async()=>{try{const S=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"environment"}});d.current=S,c.current&&(c.current.srcObject=S,c.current.play()),n(!0)}catch(S){console.error("Erreur accès caméra:",S),alert("Impossible d'accéder à la caméra. Vérifiez vos permissions.")}},m=()=>{if(!c.current||!u.current)return;const S=c.current,N=u.current,E=N.getContext("2d");E&&(N.width=S.videoWidth,N.height=S.videoHeight,E.drawImage(S,0,0),N.toBlob(P=>{if(P){const A=URL.createObjectURL(P);i(A)}},"image/jpeg",.8))},p=()=>{var S;(S=h.current)==null||S.click()},v=S=>{var E;const N=(E=S.target.files)==null?void 0:E[0];if(N){const P=URL.createObjectURL(N);i(P),n(!0)}S.target.value=""},b=()=>{u.current&&u.current.toBlob(S=>{if(S){const N=new File([S],`photo_${Date.now()}.jpg`,{type:"image/jpeg"});t(N,!1),_()}},"image/jpeg",.8)},x=()=>{l(!0)},w=async S=>{try{const E=await(await fetch(S)).blob(),P=new File([E],`annotated_photo_${Date.now()}.png`,{type:"image/png"});t(P,!0),l(!1),_()}catch(N){console.error("Error saving annotated image:",N)}},_=()=>{d.current&&(d.current.getTracks().forEach(S=>S.stop()),d.current=null),n(!1),i(null),l(!1)};return a&&s?o.jsx(Br,{open:!0,onOpenChange:()=>l(!1),children:o.jsx(Or,{className:"max-w-[95vw] max-h-[95vh] w-full h-full p-0",children:o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Annoter la photo"}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>l(!1),className:"h-8 w-8 p-0",children:o.jsx(qr,{size:16})})]}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(Ate,{imageUrl:s,fileName:"captured_photo.jpg",messageId:"",isTeacher:!1,isSaving:!1,onSaveAnnotations:w})})]})})}):r?o.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx("video",{ref:c,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),o.jsx("canvas",{ref:u,className:"hidden"}),s&&o.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center",children:o.jsx("img",{src:s,alt:"Captured",className:"max-w-full max-h-full object-contain"})})]}),o.jsxs("div",{className:"bg-black p-4 flex justify-center space-x-4",children:[o.jsx(J,{onClick:_,variant:"outline",size:"lg",className:"bg-red-500 text-white border-red-500 hover:bg-red-600",children:o.jsx(qr,{size:20})}),s?o.jsxs("div",{className:"flex gap-4",children:[o.jsx(J,{onClick:x,size:"lg",className:"bg-purple-500 text-white hover:bg-purple-600",children:o.jsx(T_,{size:20})}),o.jsx(J,{onClick:b,size:"lg",className:"bg-green-500 text-white hover:bg-green-600",children:o.jsx(rc,{size:20})})]}):o.jsxs(o.Fragment,{children:[o.jsx(J,{onClick:p,size:"lg",className:"bg-blue-500 text-white hover:bg-blue-600",children:o.jsx(Ih,{size:20})}),o.jsx(J,{onClick:m,size:"lg",className:"bg-white text-black hover:bg-gray-200 w-16 h-16 rounded-full",children:o.jsx(tc,{size:24})})]})]}),o.jsx("input",{ref:h,type:"file",accept:"image/*",className:"hidden",onChange:v})]}):o.jsx(J,{onClick:f,disabled:e,variant:"outline",size:"sm",className:"p-2",title:"Prendre une photo ou importer depuis la galerie",children:o.jsx(tc,{size:16})})},d8=({isOpen:t,onClose:e,message:r,formationId:n,variant:s="warning",restrictionType:i,currentPlan:a="free"})=>{const l=Mn(),c=()=>{l(`/formation/${n}/pricing`),e()},u=()=>{switch(i){case"message_limit":return o.jsx(Zs,{className:"w-5 h-5 text-blue-500"});case"call_restriction":case"call_day_restriction":return o.jsx(sf,{className:"w-5 h-5 text-green-500"});case"time_limit":return o.jsx(Js,{className:"w-5 h-5 text-orange-500"});default:return s==="error"?o.jsx(O_,{className:"w-5 h-5 text-red-500"}):o.jsx(ix,{className:"w-5 h-5 text-yellow-500"})}},d=()=>{if(a==="free")switch(i){case"message_limit":case"call_restriction":return"Standard";case"call_day_restriction":case"time_limit":return"Premium";default:return"Standard"}return"Premium"},h=()=>{const f=r,m=d();return`${f}

Passez au plan ${m} pour débloquer :
${{Standard:`• Messages illimités
• Appels audio autorisés
• Accès aux exercices`,Premium:`• Tout du plan Standard
• Appels vidéo disponibles
• Temps illimité
• Tous les jours d'appel`}[m]}`};return o.jsx(Br,{open:t,onOpenChange:e,children:o.jsxs(Or,{className:"sm:max-w-md",children:[o.jsxs(hn,{children:[o.jsxs(fn,{className:"flex items-center gap-2",children:[u(),"Restriction d'abonnement"]}),o.jsx(oA,{className:"text-left whitespace-pre-line",children:h()})]}),o.jsxs(aA,{className:"flex-col sm:flex-row gap-2",children:[o.jsx(J,{variant:"outline",onClick:e,className:"w-full sm:w-auto",children:"Plus tard"}),o.jsxs(J,{onClick:c,className:"w-full sm:w-auto bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:[o.jsx(ix,{className:"w-4 h-4 mr-2"}),"Voir les offres"]})]})]})})},h8=({onSendMessage:t,disabled:e=!1,lessonId:r="",formationId:n="",contactName:s="Contact",contactAvatar:i})=>{const[a,l]=y.useState(""),[c,u]=y.useState(!1),[d,h]=y.useState(!1),[f,m]=y.useState({message:""}),p=y.useRef(null),v=Mn(),{user:b}=st(),{startTyping:x,stopTyping:w}=rQ(r,n),{uploadFile:_,isUploading:S}=D1(),{checkPermission:N,incrementMessageCount:E}=Xp(n),P=Z=>{if(!b){v("/auth");return}Z()},A=(Z,H,Q)=>{m({message:Z,restrictionType:H,currentPlan:Q}),h(!0)},F=()=>{if(!a.trim())return;if(!b){v("/auth");return}const Z=N("message");if(!Z.allowed){A(Z.message||"Action non autorisée",Z.restrictionType,Z.currentPlan);return}t(a,"text"),E(),l(""),w()},Y=Z=>{const H=Z.target.value;l(H),H.trim()&&r&&n?x():H.trim()||w()},T=Z=>{l(H=>H+Z),r&&n&&x(),u(!1)},O=async Z=>{var Q;const H=(Q=Z.target.files)==null?void 0:Q[0];H&&!e&&P(async()=>{try{me.loading("Upload du fichier en cours...");const R=await _(H);let B="file";H.type.startsWith("image/")?B="image":H.type.startsWith("video/")?B="video":H.type.startsWith("audio/")&&(B="audio");const X=new File([new Blob],R.fileName,{type:H.type});Object.defineProperty(X,"uploadUrl",{value:R.fileUrl}),t(`Fichier partagé: ${R.fileName}`,B,X),me.success("Fichier envoyé avec succès")}catch(R){console.error("Upload error:",R),me.error("Erreur lors de l'upload")}}),Z.target.value=""},U=async(Z,H=!1)=>{P(async()=>{try{me.loading("Upload de la photo en cours...");const Q=await _(Z),R=Z.type.startsWith("video/")?"video":"image",B=new File([new Blob],Q.fileName,{type:Z.type});Object.defineProperty(B,"uploadUrl",{value:Q.fileUrl}),t(H?`Image annotée: ${Q.fileName}`:`Photo capturée: ${Q.fileName}`,R,B),me.success("Photo envoyée avec succès")}catch(Q){console.error("Upload error:",Q),me.error("Erreur lors de l'upload")}})},q=async Z=>{P(async()=>{try{me.loading("Upload du message vocal...");const H=await _(Z),Q=new File([new Blob],H.fileName,{type:Z.type});Object.defineProperty(Q,"uploadUrl",{value:H.fileUrl}),t("Message vocal","audio",Q),me.success("Message vocal envoyé")}catch(H){console.error("Upload error:",H),me.error("Erreur lors de l'upload")}})};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-[#f0f0f0] border-t border-gray-200 p-2 sm:p-3 fixed bottom-16 left-0 right-0 md:relative md:bottom-0 z-50",children:o.jsxs("div",{className:"flex items-end space-x-2 sm:space-x-3 max-w-full",children:[o.jsx("button",{onClick:()=>P(()=>{var Z;return(Z=p.current)==null?void 0:Z.click()}),disabled:S,className:"p-2 text-gray-500 hover:text-[#25d366] transition-colors rounded-full hover:bg-gray-200 disabled:opacity-50",children:o.jsx(e9,{size:18})}),o.jsx("input",{ref:p,type:"file",className:"hidden",accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt",onChange:O}),o.jsxs("div",{className:"flex-1 flex items-end space-x-1 sm:space-x-2 bg-white rounded-3xl px-3 sm:px-4 py-2 shadow-sm min-h-[40px] sm:min-h-[48px]",children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>u(!c),className:"p-1 text-gray-500 hover:text-[#25d366] transition-colors",children:o.jsx(UP,{size:16,className:"sm:w-[18px] sm:h-[18px]"})}),c&&o.jsx("div",{className:"absolute bottom-12 left-0 z-50",children:o.jsx(nQ,{onEmojiSelect:T,isOpen:c,onToggle:()=>u(!c)})})]}),o.jsx("textarea",{value:a,onChange:Y,onKeyPress:Z=>{Z.key==="Enter"&&!Z.shiftKey&&(Z.preventDefault(),F())},onBlur:()=>{w()},placeholder:"Tapez votre message...",className:"flex-1 bg-transparent outline-none text-sm resize-none max-h-16 sm:max-h-20 py-1 sm:py-2 min-w-0",rows:1,style:{minHeight:"18px",height:"auto"}}),o.jsx(Tte,{onCapture:U,disabled:!1})]}),a.trim()?o.jsx(J,{onClick:F,className:"bg-[#25d366] hover:bg-[#20c75a] p-2 sm:p-3 rounded-full shadow-lg min-w-[40px] h-[40px] sm:min-w-[48px] sm:h-[48px]",size:"icon",children:o.jsx(xc,{size:16,className:"sm:w-[18px] sm:h-[18px]"})}):o.jsx(sQ,{onRecordingComplete:q,disabled:S})]})}),o.jsx(d8,{isOpen:d,onClose:()=>h(!1),message:f.message,formationId:n,variant:"warning",restrictionType:f.restrictionType,currentPlan:f.currentPlan})]})},Np=({url:t,className:e=""})=>{var n,s;if(!t)return o.jsx("div",{className:"w-full aspect-video bg-gray-100 flex items-center justify-center rounded-lg",children:o.jsx("p",{className:"text-gray-500",children:"Aucune vidéo disponible"})});if(t.includes("youtube.com")||t.includes("youtu.be")){let i="";if(t.includes("youtube.com/watch?v=")?i=((n=t.split("v=")[1])==null?void 0:n.split("&")[0])||"":t.includes("youtu.be/")&&(i=((s=t.split("youtu.be/")[1])==null?void 0:s.split("?")[0])||""),i){const a=`https://www.youtube.com/embed/${i}`;return o.jsx("div",{className:`w-full aspect-video ${e}`,children:o.jsx("iframe",{src:a,title:"Vidéo de la leçon",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full rounded-lg"})})}}return o.jsx("div",{className:`w-full aspect-video ${e}`,children:o.jsx("video",{src:t,controls:!0,className:"w-full h-full rounded-lg bg-black",preload:"metadata",children:o.jsx("p",{className:"text-gray-500",children:"Votre navigateur ne supporte pas la lecture de cette vidéo."})})})},Lte=af("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Zj=y.forwardRef(({className:t,variant:e,...r},n)=>o.jsx("div",{ref:n,role:"alert",className:Be(Lte({variant:e}),t),...r}));Zj.displayName="Alert";const Ote=y.forwardRef(({className:t,...e},r)=>o.jsx("h5",{ref:r,className:Be("mb-1 font-medium leading-none tracking-tight",t),...e}));Ote.displayName="AlertTitle";const eS=y.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Be("text-sm [&_p]:leading-relaxed",t),...e}));eS.displayName="AlertDescription";const y4=({imageUrl:t,fileName:e,onImageLoad:r,onError:n})=>{const[s,i]=y.useState(!0),[a,l]=y.useState(null),[c,u]=y.useState(0),d=y.useCallback(()=>{console.log("Attempting to load image:",t),i(!0),l(null);const f=new Image;f.crossOrigin="anonymous",f.onload=()=>{console.log("Image loaded successfully:",f.width,"x",f.height),i(!1),r(f)},f.onerror=p=>{console.error("Image loading failed:",p);const v="Impossible de charger l'image. Vérifiez le format ou la connexion.";l(v),i(!1),n==null||n(v)};let m=t;try{t.startsWith("blob:")||t.startsWith("data:")?m=t:t.startsWith("/")?m=`${window.location.origin}${t}`:(t.startsWith("http"),m=t),console.log("Loading image with URL:",m),f.src=m,setTimeout(()=>{s&&(l("Timeout: L'image met trop de temps à charger"),i(!1))},1e4)}catch(p){console.error("URL processing error:",p),l("URL d'image invalide"),i(!1)}},[t,r,n]),h=()=>{u(f=>f+1),d()};return y.useEffect(()=>{t&&d()},[t,d]),s?o.jsx("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative",children:[o.jsx(nf,{className:"mx-auto mb-4 text-gray-400",size:48}),o.jsx(sN,{className:"absolute top-0 right-0 animate-spin text-blue-500",size:20})]}),o.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Chargement de l'image..."}),o.jsx("p",{className:"text-xs text-gray-500 truncate max-w-xs",children:e})]})}):a?o.jsxs(Zj,{className:"m-4 max-w-md mx-auto",children:[o.jsx(O_,{className:"h-4 w-4"}),o.jsxs(eS,{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:"Erreur de chargement"}),o.jsx("p",{className:"text-sm text-gray-600",children:a}),c>0&&o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Tentatives: ",c]})]}),o.jsx("div",{className:"flex gap-2",children:o.jsxs(J,{variant:"outline",size:"sm",onClick:h,children:[o.jsx(sN,{size:14,className:"mr-1"}),"Réessayer"]})})]})]}):null},Mte=({onSave:t,onDownloadImage:e,onDownloadPDF:r,onClose:n,isSaving:s})=>o.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between shadow-sm",children:[o.jsx("div",{className:"flex-1",children:o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"🎨 Éditeur d'annotation"})}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(J,{onClick:t,disabled:s,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[o.jsx(Fh,{size:16}),s?"Sauvegarde...":"Sauvegarder"]}),o.jsxs(J,{onClick:e,variant:"outline",className:"flex items-center gap-2",children:[o.jsx(Pn,{size:16}),"Image"]}),o.jsxs(J,{onClick:r,variant:"outline",className:"flex items-center gap-2",children:[o.jsx(os,{size:16}),"PDF"]}),n&&o.jsx(J,{onClick:n,variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-gray-100",children:o.jsx(qr,{size:16})})]})]}),Rte=({activeTool:t,activeColor:e,brushSize:r,fontSize:n,onToolChange:s,onColorChange:i,onBrushSizeChange:a,onFontSizeChange:l,onUndo:c,onClear:u,onRotate:d,onCrop:h})=>{const[f,m]=y.useState(null),p=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#000000","#ffffff","#ff8800","#8800ff","#00ff80","#ff0080"],v=b=>{m(f===b?null:b)};return o.jsxs("div",{className:"bg-white border-t border-b shadow-sm",children:[f&&o.jsx("div",{className:"border-b bg-gray-50 px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[f==="text"&&o.jsxs(o.Fragment,{children:[o.jsxs(J,{variant:t==="text"?"default":"outline",size:"sm",onClick:()=>s("text"),className:"flex items-center gap-2",children:[o.jsx(wu,{size:16}),"Ajouter texte"]}),o.jsxs(J,{variant:t==="note"?"default":"outline",size:"sm",onClick:()=>s("note"),className:"flex items-center gap-2",children:[o.jsx(wu,{size:16}),"Ajouter note"]}),o.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium",children:"Taille:"}),o.jsx("input",{type:"range",min:"12",max:"48",value:n,onChange:b=>l(parseInt(b.target.value)),className:"w-20"}),o.jsxs("span",{className:"text-sm w-10 text-center",children:[n,"px"]})]})]}),f==="draw"&&o.jsxs(o.Fragment,{children:[o.jsxs(J,{variant:t==="draw"?"default":"outline",size:"sm",onClick:()=>s("draw"),className:"flex items-center gap-2",children:[o.jsx(cp,{size:16}),"Crayon"]}),o.jsxs(J,{variant:t==="highlight"?"default":"outline",size:"sm",onClick:()=>s("highlight"),className:"flex items-center gap-2 bg-yellow-100 hover:bg-yellow-200",children:[o.jsx(DP,{size:16}),"Surligneur"]}),o.jsxs(J,{variant:t==="select"?"default":"outline",size:"sm",onClick:()=>s("select"),className:"flex items-center gap-2",children:[o.jsx(ox,{size:16}),"Sélection"]}),o.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium",children:"Épaisseur:"}),o.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:b=>a(parseInt(b.target.value)),className:"w-20"}),o.jsxs("span",{className:"text-sm w-10 text-center",children:[r,"px"]})]})]}),f==="shapes"&&o.jsxs(o.Fragment,{children:[o.jsxs(J,{variant:t==="circle"?"default":"outline",size:"sm",onClick:()=>s("circle"),className:"flex items-center gap-2",children:[o.jsx(lp,{size:16}),"Cercle"]}),o.jsxs(J,{variant:t==="rectangle"?"default":"outline",size:"sm",onClick:()=>s("rectangle"),className:"flex items-center gap-2",children:[o.jsx(nc,{size:16}),"Rectangle"]}),o.jsxs(J,{variant:t==="arrow"?"default":"outline",size:"sm",onClick:()=>s("arrow"),className:"flex items-center gap-2",children:[o.jsx(TP,{size:16}),"Flèche"]})]}),f==="actions"&&o.jsxs(o.Fragment,{children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:c,className:"flex items-center gap-2",children:[o.jsx(up,{size:16}),"Annuler"]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:u,className:"flex items-center gap-2 text-red-600 hover:text-red-700",children:[o.jsx(cs,{size:16}),"Effacer"]}),o.jsx(J,{variant:"outline",size:"sm",onClick:d,className:"flex items-center gap-2",children:"Rotation 90°"}),o.jsx(J,{variant:"outline",size:"sm",onClick:h,className:"flex items-center gap-2",children:"Rogner"}),o.jsx(J,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),className:"flex items-center gap-2",children:"Réinitialiser"})]}),f==="colors"&&o.jsx("div",{className:"grid grid-cols-6 gap-2 max-w-xs",children:p.map(b=>o.jsx("button",{className:`w-8 h-8 rounded-lg border-2 transition-all hover:scale-110 ${e===b?"border-gray-800 ring-2 ring-blue-500":"border-gray-300 hover:border-gray-500"}`,style:{backgroundColor:b},onClick:()=>i(b),title:`Couleur ${b}`},b))})]})}),o.jsxs("div",{className:"flex items-center justify-center gap-6 p-4",children:[o.jsxs(J,{variant:"ghost",onClick:()=>v("text"),className:`flex flex-col items-center gap-1 h-auto p-3 transition-all hover:bg-blue-50 ${f==="text"?"bg-blue-100 text-blue-700":""}`,children:[o.jsx("div",{className:"text-xl",children:"🅰️"}),o.jsx("span",{className:"text-xs font-medium",children:"Texte"})]}),o.jsxs(J,{variant:"ghost",onClick:()=>v("draw"),className:`flex flex-col items-center gap-1 h-auto p-3 transition-all hover:bg-blue-50 ${f==="draw"?"bg-blue-100 text-blue-700":""}`,children:[o.jsx("div",{className:"text-xl",children:"✍️"}),o.jsx("span",{className:"text-xs font-medium",children:"Dessin"})]}),o.jsxs(J,{variant:"ghost",onClick:()=>v("shapes"),className:`flex flex-col items-center gap-1 h-auto p-3 transition-all hover:bg-blue-50 ${f==="shapes"?"bg-blue-100 text-blue-700":""}`,children:[o.jsx("div",{className:"text-xl",children:"📐"}),o.jsx("span",{className:"text-xs font-medium",children:"Formes"})]}),o.jsxs(J,{variant:"ghost",onClick:()=>v("colors"),className:`flex flex-col items-center gap-1 h-auto p-3 transition-all hover:bg-blue-50 ${f==="colors"?"bg-blue-100 text-blue-700":""}`,children:[o.jsx("div",{className:"w-6 h-6 rounded border-2 border-gray-300",style:{backgroundColor:e}}),o.jsx("span",{className:"text-xs font-medium",children:"Couleurs"})]}),o.jsxs(J,{variant:"ghost",onClick:()=>v("actions"),className:`flex flex-col items-center gap-1 h-auto p-3 transition-all hover:bg-blue-50 ${f==="actions"?"bg-blue-100 text-blue-700":""}`,children:[o.jsx("div",{className:"text-xl",children:"⚙️"}),o.jsx("span",{className:"text-xs font-medium",children:"Actions"})]})]})]})},Dte=({imageUrl:t,fileName:e,messageId:r,isTeacher:n,isSaving:s,onSaveAnnotations:i,onClose:a})=>{const l=y.useRef(null),c=y.useRef(null),[u,d]=y.useState(null),[h,f]=y.useState("select"),[m,p]=y.useState("#ff0000"),[v,b]=y.useState(3),[x,w]=y.useState(24),[_,S]=y.useState([]),[N,E]=y.useState(!1),[P,A]=y.useState(null),[F,Y]=y.useState({width:800,height:600}),[T,O]=y.useState(!1),[U,q]=y.useState(!1),[Z,H]=y.useState(1),Q=oe=>{var Ee;const ve=((Ee=c.current)==null?void 0:Ee.clientWidth)||window.innerWidth-100,Se=window.innerHeight-300,Ae=Math.min((ve-50)/oe.width,(Se-50)/oe.height,2);return{width:Math.floor(oe.width*Ae),height:Math.floor(oe.height*Ae),scale:Ae}},R=y.useCallback(oe=>{if(!l.current||!c.current)return;const{width:ve,height:Se,scale:Ae}=Q(oe);Y({width:ve,height:Se}),u&&(u.dispose(),d(null));const Ee=new Dx(l.current,{width:ve,height:Se,backgroundColor:"#ffffff"});Ee.on("mouse:wheel",$e=>{const je=$e.e.deltaY;let te=Ee.getZoom();te*=.999**je,te>5&&(te=5),te<.1&&(te=.1),Ee.zoomToPoint(new Ne($e.e.offsetX,$e.e.offsetY),te),H(te),$e.e.preventDefault(),$e.e.stopPropagation()}),Ee.on("mouse:down",$e=>{var Qe,Te,ze,qe;const je=$e.e,te="button"in je&&je.button===1,it=je.ctrlKey;(te||it)&&(Ee.isDragging=!0,Ee.selection=!1,Ee.lastPosX="clientX"in je?je.clientX:((Te=(Qe=je.touches)==null?void 0:Qe[0])==null?void 0:Te.clientX)||0,Ee.lastPosY="clientY"in je?je.clientY:((qe=(ze=je.touches)==null?void 0:ze[0])==null?void 0:qe.clientY)||0)}),Ee.on("mouse:move",$e=>{var je,te,it,Qe;if(Ee.isDragging){const Te=$e.e,ze=Ee.viewportTransform,qe="clientX"in Te?Te.clientX:((te=(je=Te.touches)==null?void 0:je[0])==null?void 0:te.clientX)||0,Ue="clientY"in Te?Te.clientY:((Qe=(it=Te.touches)==null?void 0:it[0])==null?void 0:Qe.clientY)||0;ze[4]+=qe-Ee.lastPosX,ze[5]+=Ue-Ee.lastPosY,Ee.requestRenderAll(),Ee.lastPosX=qe,Ee.lastPosY=Ue}}),Ee.on("mouse:up",()=>{Ee.setViewportTransform(Ee.viewportTransform),Ee.isDragging=!1,Ee.selection=!0}),Hn.fromObject({src:oe.src,scaleX:Ae,scaleY:Ae,selectable:!1,evented:!1}).then($e=>{Ee.backgroundImage=$e,Ee.renderAll(),O(!0),q(!1),me.success("Image chargée! Utilisez Ctrl+molette pour zoomer et Ctrl+glisser pour naviguer 🎨")}).catch($e=>{console.error("Error creating Fabric image:",$e),q(!0),me.error("Erreur lors de la création de l'image")}),d(Ee)},[u]),B=oe=>{q(!0),me.error(oe)};y.useEffect(()=>()=>{u&&(u.dispose(),d(null))},[]),y.useEffect(()=>{if(!u)return;if(u.isDrawingMode=h==="draw"||h==="highlight",u.isDrawingMode){const ve=new jp(u);ve.color=h==="highlight"?`${m}80`:m,ve.width=h==="highlight"?v*2:v,u.freeDrawingBrush=ve}const oe=ve=>{const Se=u.getPointer(ve.e);if(h==="note")A({x:Se.x,y:Se.y}),E(!0);else if(h==="text"){const Ae=new En("Cliquez pour modifier",{left:Se.x,top:Se.y,fontSize:x,fill:m,editable:!0});u.add(Ae),u.setActiveObject(Ae),me.info("Double-cliquez sur le texte pour le modifier")}};return h==="note"||h==="text"?u.on("mouse:down",oe):u.off("mouse:down",oe),()=>{u.off("mouse:down",oe)}},[h,m,v,x,u]);const X=oe=>{if(f(oe),!!u)if(oe==="circle"){const ve=new Hs({left:100,top:100,radius:30,fill:"transparent",stroke:m,strokeWidth:2});u.add(ve)}else if(oe==="rectangle"){const ve=new xi({left:100,top:100,width:100,height:60,fill:"transparent",stroke:m,strokeWidth:2});u.add(ve)}else oe==="crop"&&me.info("Sélectionnez la zone à rogner, puis cliquez sur Actions > Rogner")},ie=()=>{if(!u||!u.backgroundImage)return;const ve=((u.backgroundImage.get("angle")||0)+90)%360;u.backgroundImage.set("angle",ve),u.renderAll(),me.success(`Image rotée de 90° (${ve}°)`)},M=()=>{if(!u)return;const oe=u.getActiveObject();if(!oe){me.info("Veuillez d'abord sélectionner la zone à rogner");return}try{const ve=oe.getBoundingRect(),Se=document.createElement("canvas");Se.width=ve.width,Se.height=ve.height;const Ae=Se.getContext("2d");if(Ae){const Ee=u.getElement();Ae.drawImage(Ee,ve.left,ve.top,ve.width,ve.height,0,0,ve.width,ve.height);const $e=Se.toDataURL(),je=new Image;je.onload=()=>{u.clear(),Hn.fromObject({src:$e,selectable:!1,evented:!1}).then(te=>{u.backgroundImage=te,u.setDimensions({width:ve.width,height:ve.height}),u.renderAll(),me.success("Image rognée avec succès!")})},je.src=$e}}catch(ve){console.error("Error cropping:",ve),me.error("Erreur lors du rognage")}},W=()=>{if(!u)return;const oe=u.getObjects();oe.length>0&&(u.remove(oe[oe.length-1]),u.renderAll(),me.success("Dernière action annulée"))},K=()=>{if(!u)return;u.getObjects().forEach(ve=>u.remove(ve)),S([]),u.renderAll(),me.success("Annotations effacées!")},ne=oe=>{if(!P)return;const ve={id:Date.now().toString(),x:P.x,y:P.y,text:oe,author:n?"Professeur":"Élève",timestamp:new Date().toLocaleString()};if(S(Se=>[...Se,ve]),u){const Se=new Hs({left:P.x-8,top:P.y-8,radius:8,fill:"#ff6b35",stroke:"#ffffff",strokeWidth:2,selectable:!1,evented:!1});u.add(Se)}E(!1),A(null),me.success("Note ajoutée avec succès!")},se=async()=>{if(!u){me.error("Canvas non initialisé");return}try{u.renderAll();const oe=u.toDataURL({format:"png",quality:1,multiplier:2});if(!oe||oe==="data:,")throw new Error("Impossible de générer l'image");await i(oe),me.success("Annotations sauvegardées avec succès! ✅")}catch(oe){console.error("Error saving annotations:",oe),me.error("Erreur lors de la sauvegarde des annotations")}},le=()=>{if(!u){me.error("Canvas non disponible");return}try{u.renderAll();const oe=u.toDataURL({format:"png",quality:1,multiplier:2});if(!oe||oe==="data:,")throw new Error("Impossible de générer l'image");const ve=document.createElement("a");ve.download=`annotated_${e.replace(/\.[^/.]+$/,"")}.png`,ve.href=oe,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),me.success("Image téléchargée avec succès! 📥")}catch(oe){console.error("Error downloading image:",oe),me.error("Erreur lors du téléchargement de l'image")}},ye=()=>{if(!u){me.error("Canvas non disponible");return}try{u.renderAll();const oe=u.toDataURL({format:"png",quality:1,multiplier:1});if(!oe||oe==="data:,")throw new Error("Impossible de générer l'image");const ve=new ht({orientation:u.width>u.height?"landscape":"portrait",unit:"px",format:[u.width,u.height]}),Se=ve.internal.pageSize.getWidth(),Ae=ve.internal.pageSize.getHeight();if(ve.addImage(oe,"PNG",0,0,Se,Ae),_.length>0){ve.addPage(),ve.setFontSize(16),ve.text("Notes d'annotation:",20,30);let Ee=50;ve.setFontSize(12),_.forEach(($e,je)=>{const te=ve.splitTextToSize(`${je+1}. ${$e.text}`,Se-40);ve.text(te,20,Ee),Ee+=te.length*15+5,ve.setFontSize(10),ve.text(`   - ${$e.author}, ${$e.timestamp}`,20,Ee),Ee+=20,ve.setFontSize(12)})}ve.save(`annotated_${e.replace(/\.[^/.]+$/,"")}.pdf`),me.success("PDF téléchargé avec succès! 📄")}catch(oe){console.error("Error downloading PDF:",oe),me.error("Erreur lors du téléchargement du PDF")}};return o.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[o.jsx(Mte,{onSave:se,onDownloadImage:le,onDownloadPDF:ye,onClose:a,isSaving:s}),o.jsx(Rte,{activeTool:h,activeColor:m,brushSize:v,fontSize:x,onToolChange:X,onColorChange:p,onBrushSizeChange:b,onFontSizeChange:w,onUndo:W,onClear:K,onRotate:ie,onCrop:M}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsx("div",{ref:c,className:"flex-1",children:o.jsx(ko,{className:"w-full h-full",children:o.jsx("div",{className:"flex items-center justify-center min-h-full p-4",children:o.jsxs("div",{className:"relative",children:[!T&&!U&&o.jsx(y4,{imageUrl:t,fileName:e,onImageLoad:R,onError:B}),U&&o.jsx("div",{className:"flex items-center justify-center p-8",children:o.jsx(y4,{imageUrl:t,fileName:e,onImageLoad:R,onError:B})}),o.jsx("canvas",{ref:l,className:"border border-gray-300 shadow-xl rounded-lg bg-white cursor-crosshair",style:{display:T?"block":"none",touchAction:"none"}}),T&&o.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 text-white px-2 py-1 rounded text-xs",children:["Zoom: ",Math.round(Z*100),"%"]})]})})})}),N&&o.jsx("div",{className:"w-80 bg-white shadow-2xl border-l",children:o.jsx(UM,{notes:_,isAddingNote:N,onAddNote:ne,onCancelNote:()=>{E(!1),A(null)}})})]})]})},Fte=({isOpen:t,onClose:e,imageUrl:r,fileName:n,messageId:s,isTeacher:i,lessonId:a,formationId:l,onSaveAnnotations:c})=>{const[u,d]=y.useState(!1),[h,f]=y.useState(null),m=vO(a,l),p=async b=>{d(!0);try{console.log("Saving annotations with dataUrl length:",b.length),f(b),c&&await c(b),me.success("Annotations sauvegardées avec succès! ✅")}catch(x){console.error("Error saving annotations:",x),me.error("Erreur lors de la sauvegarde des annotations")}finally{d(!1)}},v=async()=>{if(!h){me.error("Veuillez d'abord sauvegarder vos annotations");return}try{const x=await(await fetch(h)).blob(),w=new File([x],`annotated_${n}`,{type:"image/png"});await m.mutateAsync({content:`📝 Image annotée: ${n}`,messageType:"image",file:w}),me.success("Image annotée envoyée dans la discussion! 💬"),e()}catch(b){console.error("Error sending annotated image:",b),me.error("Erreur lors de l'envoi de l'image annotée")}};return o.jsx(Br,{open:t,onOpenChange:e,children:o.jsx(Or,{className:"max-w-[98vw] max-h-[98vh] w-full h-full p-0 bg-gray-50",children:o.jsxs("div",{className:"flex flex-col h-full relative",children:[h&&o.jsx("div",{className:"absolute top-4 right-4 z-10",children:o.jsxs(J,{onClick:v,disabled:m.isPending,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 shadow-lg",children:[o.jsx(xc,{size:16}),"Envoyer en discussion"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(Dte,{imageUrl:r,fileName:n,messageId:s,isTeacher:i,isSaving:u,onSaveAnnotations:p,onClose:e})})]})})})},Ite=({onSave:t,onSaveAndSendToChat:e,onDownload:r,isSaving:n=!1,disabled:s=!1})=>{const[i,a]=y.useState(!1),l=()=>{t(),a(!1)},c=()=>{e&&e(),a(!1)},u=()=>{r&&r(),a(!1)};return o.jsxs("div",{className:"flex items-center",children:[o.jsxs(J,{onClick:l,disabled:n||s,className:"rounded-r-none border-r-0",size:"sm",children:[o.jsx(Fh,{size:16}),n?"Sauvegarde...":"Sauvegarder"]}),o.jsxs(a5,{open:i,onOpenChange:a,children:[o.jsx(o5,{asChild:!0,children:o.jsx(J,{variant:"default",size:"sm",className:"rounded-l-none px-2",disabled:n||s,children:o.jsx($a,{size:16})})}),o.jsx(Fx,{className:"w-56 p-0",align:"end",children:o.jsxs("div",{className:"py-1",children:[o.jsxs(J,{variant:"ghost",className:"w-full justify-start px-4 py-2 h-auto",onClick:l,disabled:n,children:[o.jsx(Fh,{size:16,className:"mr-2"}),"Sauvegarder uniquement"]}),e&&o.jsxs(J,{variant:"ghost",className:"w-full justify-start px-4 py-2 h-auto",onClick:c,disabled:n,children:[o.jsx(xc,{size:16,className:"mr-2"}),"Envoyer dans le chat"]}),o.jsx(Qc,{className:"my-1"}),r&&o.jsxs(J,{variant:"ghost",className:"w-full justify-start px-4 py-2 h-auto",onClick:u,disabled:n,children:[o.jsx(Pn,{size:16,className:"mr-2"}),"Télécharger sur l'appareil"]})]})})]})]})},zte=({onSave:t,onSaveAndSendToChat:e,onUndo:r,onRedo:n,onClose:s,onDownload:i,canUndo:a,canRedo:l,isSaving:c})=>o.jsxs("div",{className:"bg-background border-b border-border p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(J,{variant:"outline",size:"sm",onClick:r,disabled:!a,title:"Annuler",children:o.jsx(up,{size:16})}),o.jsx(J,{variant:"outline",size:"sm",onClick:n,disabled:!l,title:"Refaire",children:o.jsx($P,{size:16})})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ite,{onSave:t,onSaveAndSendToChat:e,onDownload:i,isSaving:c}),s&&o.jsx(J,{variant:"ghost",size:"sm",onClick:s,title:"Fermer",children:o.jsx(qr,{size:16})})]})]}),f8=y.forwardRef(({imageUrl:t,activeTool:e,className:r,onStartDrawing:n,onDraw:s,onStopDrawing:i,onToolChange:a},l)=>{const[c,u]=y.useState(!0),[d,h]=y.useState(null);y.useEffect(()=>{const m=l;if(!(m!=null&&m.current))return;u(!0),h(null);const p=new Image;p.crossOrigin="anonymous",p.onload=()=>{var b;const v=(b=m.current)==null?void 0:b.getContext("2d");!v||!m.current||(m.current.width=p.width,m.current.height=p.height,v.drawImage(p,0,0),u(!1))},p.onerror=()=>{h("Erreur lors du chargement de l'image"),u(!1)},p.src=t},[t,l]),y.useEffect(()=>{const m=l;if(!(m!=null&&m.current))return;a==null||a(e);const p=N=>{N.preventDefault(),n==null||n(N)},v=N=>{N.preventDefault(),s==null||s(N)},b=N=>{N.preventDefault(),i==null||i()},x=N=>{N.preventDefault(),n==null||n(N)},w=N=>{N.preventDefault(),s==null||s(N)},_=N=>{N.preventDefault(),i==null||i()},S=m.current;return S.addEventListener("mousedown",p),S.addEventListener("mousemove",v),S.addEventListener("mouseup",b),S.addEventListener("mouseleave",b),S.addEventListener("touchstart",x),S.addEventListener("touchmove",w),S.addEventListener("touchend",_),S.addEventListener("touchcancel",_),()=>{S.removeEventListener("mousedown",p),S.removeEventListener("mousemove",v),S.removeEventListener("mouseup",b),S.removeEventListener("mouseleave",b),S.removeEventListener("touchstart",x),S.removeEventListener("touchmove",w),S.removeEventListener("touchend",_),S.removeEventListener("touchcancel",_)}},[e,n,s,i,a,l]);const f=()=>{switch(e){case"pencil":case"highlighter":return"crosshair";case"eraser":return"grab";case"bucket":return"pointer";default:return"default"}};return d?o.jsx("div",{className:Be("flex items-center justify-center bg-muted",r),children:o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-destructive",children:d})})}):o.jsxs("div",{className:Be("flex items-center justify-center bg-muted p-4 overflow-auto",r),children:[c&&o.jsxs("div",{className:"flex items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"ml-2",children:"Chargement..."})]}),o.jsx("canvas",{ref:l,className:Be("max-w-full max-h-full border border-border shadow-lg bg-background",!c&&"block"),style:{cursor:f(),display:c?"none":"block"}})]})});f8.displayName="ImageCanvas";const $te=({brushSize:t,brushColor:e,brushOpacity:r,onBrushSizeChange:n,onBrushColorChange:s,onBrushOpacityChange:i})=>o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsxs(Ke,{className:"text-xs",children:["Taille: ",t,"px"]}),o.jsx(Sx,{value:[t],onValueChange:a=>n(a[0]),min:1,max:50,step:1,className:"mt-2"})]}),o.jsxs("div",{children:[o.jsx(Ke,{className:"text-xs",children:"Couleur"}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsx("input",{type:"color",value:e,onChange:a=>s(a.target.value),className:"w-8 h-8 rounded border border-border cursor-pointer"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:e})]})]}),o.jsxs("div",{children:[o.jsxs(Ke,{className:"text-xs",children:["Opacité: ",Math.round(r*100),"%"]}),o.jsx(Sx,{value:[r],onValueChange:a=>i(a[0]),min:.1,max:1,step:.1,className:"mt-2"})]})]}),Bte=[{id:"select",icon:ox,label:"Sélectionner"},{id:"pencil",icon:cp,label:"Crayon"},{id:"eraser",icon:MP,label:"Gomme"},{id:"highlighter",icon:DP,label:"Surligneur"},{id:"bucket",icon:Jz,label:"Pot de peinture"}],qte=({activeTool:t,onToolChange:e,brushSize:r=5,brushColor:n="#000000",brushOpacity:s=1,onBrushSizeChange:i,onBrushColorChange:a,onBrushOpacityChange:l})=>o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Outils de dessin"}),o.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Bte.map(({id:c,icon:u,label:d})=>o.jsxs(J,{variant:t===c?"default":"outline",size:"sm",onClick:()=>e(c),className:"flex flex-col gap-1 h-16 p-2",children:[o.jsx(u,{size:20}),o.jsx("span",{className:"text-xs",children:d})]},c))}),t!=="select"&&i&&a&&l&&o.jsx($te,{brushSize:r,brushColor:n,brushOpacity:s,onBrushSizeChange:i,onBrushColorChange:a,onBrushOpacityChange:l})]}),Ute=[{id:"rectangle",icon:nc,label:"Rectangle"},{id:"circle",icon:lp,label:"Cercle"},{id:"arrow",icon:TP,label:"Flèche"}],Vte=({activeTool:t,onToolChange:e})=>o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Formes"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ute.map(({id:r,icon:n,label:s})=>o.jsxs(J,{variant:t===r?"default":"outline",size:"sm",onClick:()=>e(r),className:"flex flex-col gap-1 h-16 p-2",children:[o.jsx(n,{size:20}),o.jsx("span",{className:"text-xs",children:s})]},r))})]}),Wte=[{id:"text",icon:wu,label:"Zone de texte"}],Hte=[{id:"bold",icon:wz,label:"Gras"},{id:"italic",icon:Bz,label:"Italique"},{id:"underline",icon:c9,label:"Souligné"}],Gte=[{id:"align-left",icon:yz,label:"Gauche"},{id:"align-center",icon:xz,label:"Centre"},{id:"align-right",icon:bz,label:"Droite"}],Yte=({activeTool:t,onToolChange:e})=>o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Texte"}),o.jsx("div",{className:"grid grid-cols-1 gap-2",children:Wte.map(({id:r,icon:n,label:s})=>o.jsxs(J,{variant:t===r?"default":"outline",size:"sm",onClick:()=>e(r),className:"flex items-center gap-2 justify-start",children:[o.jsx(n,{size:16}),s]},r))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Style"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Hte.map(({id:r,icon:n,label:s})=>o.jsx(J,{variant:t===r?"default":"outline",size:"sm",onClick:()=>e(r),className:"flex flex-col gap-1 h-12",title:s,children:o.jsx(n,{size:16})},r))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Alignement"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Gte.map(({id:r,icon:n,label:s})=>o.jsx(J,{variant:t===r?"default":"outline",size:"sm",onClick:()=>e(r),className:"flex flex-col gap-1 h-12",title:s,children:o.jsx(n,{size:16})},r))})]})]}),Xte=[{id:"rotate-left",icon:n9,label:"Rotation ←"},{id:"rotate-right",icon:BP,label:"Rotation →"},{id:"flip-horizontal",icon:Dz,label:"Miroir ↔"},{id:"flip-vertical",icon:Fz,label:"Miroir ↕"},{id:"crop",icon:Tz,label:"Rogner"},{id:"zoom-in",icon:h9,label:"Zoom +"},{id:"zoom-out",icon:f9,label:"Zoom -"}],Kte=({activeTool:t,onToolChange:e})=>o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"text-sm font-medium mb-3",children:"Outils de transformation"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Xte.map(({id:r,icon:n,label:s})=>o.jsxs(J,{variant:t===r?"default":"outline",size:"sm",onClick:()=>e(r),className:"flex flex-col gap-1 h-16 p-2",children:[o.jsx(n,{size:20}),o.jsx("span",{className:"text-xs",children:s})]},r))})]}),b4={drawing:cp,shapes:nc,text:wu,transform:BP,export:Pn},Qte=({activeMenu:t,activeTool:e,isMobile:r,showDynamicSection:n,onMenuChange:s,onToolChange:i,onCloseDynamicSection:a,brushSize:l,brushColor:c,brushOpacity:u,onBrushSizeChange:d,onBrushColorChange:h,onBrushOpacityChange:f})=>{const m=v=>{i(v)},p=()=>{switch(t){case"drawing":return o.jsx(qte,{activeTool:e,onToolChange:m,brushSize:l,brushColor:c,brushOpacity:u,onBrushSizeChange:d,onBrushColorChange:h,onBrushOpacityChange:f});case"shapes":return o.jsx(Vte,{activeTool:e,onToolChange:m});case"text":return o.jsx(Yte,{activeTool:e,onToolChange:m,canvasRef});case"transform":return o.jsx(Kte,{activeTool:e,onToolChange:m});case"export":return o.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Options d'export"});default:return null}};return r?o.jsxs(o.Fragment,{children:[n&&t&&o.jsx("div",{className:"fixed bottom-16 left-0 right-0 bg-background border-t border-border shadow-lg z-50",children:p()}),o.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t border-border z-40",children:o.jsx("div",{className:"flex justify-around py-2",children:Object.entries(b4).map(([v,b])=>o.jsx(J,{variant:t===v&&n?"default":"ghost",size:"sm",onClick:()=>s(v),className:"flex-col h-12 w-12 p-1",children:o.jsx(b,{size:20})},v))})})]}):o.jsxs("div",{className:"w-80 bg-background border-l border-border flex flex-col",children:[o.jsx("div",{className:"border-b border-border p-4",children:o.jsx("div",{className:"flex gap-2 justify-center",children:Object.entries(b4).map(([v,b])=>o.jsx(J,{variant:t===v?"default":"outline",size:"sm",onClick:()=>s(v),className:"p-2",title:v,children:o.jsx(b,{size:16})},v))})}),o.jsx("div",{className:"flex-1 overflow-auto",children:p()})]})},Jte=({onUndoRedoChange:t})=>{const[e,r]=y.useState([]),[n,s]=y.useState(0),i=y.useCallback(c=>{const u=c.current;if(!u)return;const d=u.getContext("2d");if(!d)return;const h=d.getImageData(0,0,u.width,u.height),f=e.slice(0,n+1);f.push(h),r(f),s(f.length-1),t==null||t(f.length>1,!1)},[e,n,t]),a=y.useCallback(c=>{if(n<=0)return;const u=c.current;if(!u)return;const d=u.getContext("2d");if(!d)return;const h=n-1,f=e[h];d.putImageData(f,0,0),s(h),t==null||t(h>0,h<e.length-1)},[e,n,t]),l=y.useCallback(c=>{if(n>=e.length-1)return;const u=c.current;if(!u)return;const d=u.getContext("2d");if(!d)return;const h=n+1,f=e[h];d.putImageData(f,0,0),s(h),t==null||t(!0,h<e.length-1)},[e,n,t]);return{saveState:i,handleUndo:a,handleRedo:l}},Zte=({brushColor:t,brushSize:e,brushOpacity:r,saveState:n})=>{const[s,i]=y.useState(!1),[a,l]=y.useState("select"),[c,u]=y.useState(!1),[d,h]=y.useState(null),[f,m]=y.useState(null),p=y.useCallback((b,x,w,_="Texte",S=24)=>{const N=b.current;if(!N)return;const E=N.getContext("2d");E&&(n(b),E.font=`${S}px Arial`,E.fillStyle=t,E.textAlign="left",E.textBaseline="top",E.fillText(_,x,w))},[t,n]),v=y.useCallback((b,x,w,_,S,N)=>{const E=b.current;if(!E)return;const P=E.getContext("2d");if(P)switch(P.strokeStyle=t,P.lineWidth=e,P.globalAlpha=r,N){case"rectangle":const A=_-x,F=S-w;P.strokeRect(x,w,A,F);break;case"circle":const Y=Math.sqrt(Math.pow(_-x,2)+Math.pow(S-w,2));P.beginPath(),P.arc(x,w,Y,0,2*Math.PI),P.stroke();break;case"arrow":P.beginPath(),P.moveTo(x,w),P.lineTo(_,S);const T=Math.atan2(S-w,_-x),O=15,U=Math.PI/6;P.lineTo(_-O*Math.cos(T-U),S-O*Math.sin(T-U)),P.moveTo(_,S),P.lineTo(_-O*Math.cos(T+U),S-O*Math.sin(T+U)),P.stroke();break}},[t,e,r]);return{isDrawing:s,setIsDrawing:i,currentTool:a,setCurrentTool:l,isDrawingShape:c,setIsDrawingShape:u,shapeStartPos:d,setShapeStartPos:h,tempCanvas:f,setTempCanvas:m,addText:p,drawShape:v}},w4=(t,e,r,n)=>{const s=(r*n+e)*4;return[t[s],t[s+1],t[s+2],t[s+3]]},ere=(t,e,r,n,s)=>{const i=(r*n+e)*4;t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=255},tre=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null},_4=(t,e)=>t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2],rre=(t,e,r,n)=>{const s=t.canvas,i=t.getImageData(0,0,s.width,s.height),a=i.data,l=w4(a,e,r,s.width),c=tre(n);if(!c||_4(l,c))return;const u=[[Math.floor(e),Math.floor(r)]],d=new Set,h=1e4;let f=0;for(;u.length>0&&f<h;){const[m,p]=u.pop(),v=`${m},${p}`;if(d.has(v)||m<0||m>=s.width||p<0||p>=s.height)continue;d.add(v);const b=w4(a,m,p,s.width);_4(b,l)&&(ere(a,m,p,s.width,c),f++,u.push([m+1,p],[m-1,p],[m,p+1],[m,p-1]))}t.putImageData(i,0,0)},nre=({imageUrl:t,fileName:e,onSave:r,onUndoRedoChange:n})=>{const s=y.useRef(null),[i,a]=y.useState(!1),[l,c]=y.useState(5),[u,d]=y.useState("#000000"),[h,f]=y.useState(1),{saveState:m,handleUndo:p,handleRedo:v}=Jte({onUndoRedoChange:n}),{isDrawing:b,setIsDrawing:x,currentTool:w,setCurrentTool:_,isDrawingShape:S,setIsDrawingShape:N,shapeStartPos:E,setShapeStartPos:P,tempCanvas:A,setTempCanvas:F,addText:Y,drawShape:T}=Zte({brushColor:u,brushSize:l,brushOpacity:h,saveState:R=>m(R)}),O=y.useCallback(async()=>{const R=s.current;if(!R){me.error("Canvas non disponible");return}a(!0);try{const B=R.toDataURL("image/png",1);r&&await r(B),me.success("Image sauvegardée avec succès!")}catch(B){console.error("Error saving image:",B),me.error("Erreur lors de la sauvegarde")}finally{a(!1)}},[r]),U=y.useCallback(R=>{const B=s.current;if(!B)return;const X=B.getContext("2d");if(!X)return;m(s);const ie=X.getImageData(0,0,B.width,B.height);switch(R){case"rotate-left":X.save(),X.translate(B.width/2,B.height/2),X.rotate(-Math.PI/2),X.translate(-B.width/2,-B.height/2),X.putImageData(ie,0,0),X.restore();break;case"rotate-right":X.save(),X.translate(B.width/2,B.height/2),X.rotate(Math.PI/2),X.translate(-B.width/2,-B.height/2),X.putImageData(ie,0,0),X.restore();break;case"flip-horizontal":X.save(),X.scale(-1,1),X.translate(-B.width,0),X.putImageData(ie,0,0),X.restore();break;case"flip-vertical":X.save(),X.scale(1,-1),X.translate(0,-B.height),X.putImageData(ie,0,0),X.restore();break;case"zoom-in":X.save(),X.scale(1.2,1.2),X.putImageData(ie,0,0),X.restore();break;case"zoom-out":X.save(),X.scale(.8,.8),X.putImageData(ie,0,0),X.restore();break}},[m]),q=y.useCallback((R,B)=>{const X=B.getBoundingClientRect(),ie=B.width/X.width,M=B.height/X.height;let W,K;return"touches"in R?(W=R.touches[0].clientX,K=R.touches[0].clientY):(W=R.clientX,K=R.clientY),{x:(W-X.left)*ie,y:(K-X.top)*M}},[]),Z=y.useCallback(R=>{if(w==="select")return;const B=s.current;if(!B)return;const X=B.getContext("2d");if(!X)return;const{x:ie,y:M}=q(R,B);if(["rectangle","circle","arrow"].includes(w)){N(!0),P({x:ie,y:M}),m(s);const W=document.createElement("canvas");W.width=B.width,W.height=B.height;const K=W.getContext("2d");K&&(K.drawImage(B,0,0),F(W));return}if(w==="text"){const W=prompt("Entrez votre texte:")||"Texte";Y(s,ie,M,W,24);return}switch(x(!0),m(s),X.lineCap="round",X.lineJoin="round",w){case"pencil":X.globalCompositeOperation="source-over",X.strokeStyle=u,X.globalAlpha=h,X.lineWidth=l;break;case"eraser":X.globalCompositeOperation="destination-out",X.lineWidth=l*2;break;case"highlighter":X.globalCompositeOperation="source-over",X.strokeStyle=u,X.globalAlpha=.3,X.lineWidth=l*3;break;case"bucket":rre(X,ie,M,u),x(!1);return}X.beginPath(),X.moveTo(ie,M)},[w,l,u,h,m,Y,q]),H=y.useCallback(R=>{const B=s.current;if(!B)return;const X=B.getContext("2d");if(!X)return;const{x:ie,y:M}=q(R,B);if(S&&E&&A){X.clearRect(0,0,B.width,B.height),X.drawImage(A,0,0),T(s,E.x,E.y,ie,M,w);return}!b||w==="select"||w==="bucket"||(X.lineTo(ie,M),X.stroke())},[b,w,S,E,A,T,q]),Q=y.useCallback(()=>{if(S){N(!1),P(null),F(null);return}if(!b)return;const R=s.current;if(!R)return;const B=R.getContext("2d");B&&(x(!1),B.beginPath(),B.globalAlpha=1,B.globalCompositeOperation="source-over")},[b,S]);return{canvasRef:s,handleSave:O,handleUndo:()=>p(s),handleRedo:()=>v(s),saveState:()=>m(s),isSaving:i,applyTransform:U,startDrawing:Z,draw:H,stopDrawing:Q,setCurrentTool:_,setBrushSize:c,setBrushColor:d,setBrushOpacity:f,currentTool:w,brushSize:l,brushColor:u,brushOpacity:h,isDrawing:b,addText:(R,B,X,ie)=>Y(s,R,B,X,ie),drawShape:(R,B,X,ie,M)=>T(s,R,B,X,ie,M)}},sre=({imageUrl:t,fileName:e,onSave:r,onClose:n})=>{const[s,i]=y.useState("drawing"),[a,l]=y.useState("select"),[c,u]=y.useState(!1),[d,h]=y.useState(!1),[f,m]=y.useState(!1),p=hA(),{canvasRef:v,handleSave:b,handleUndo:x,handleRedo:w,isSaving:_,applyTransform:S,startDrawing:N,draw:E,stopDrawing:P,setCurrentTool:A,setBrushSize:F,setBrushColor:Y,setBrushOpacity:T,currentTool:O,brushSize:U,brushColor:q,brushOpacity:Z}=nre({imageUrl:t,fileName:e,onSave:r,onUndoRedoChange:(ie,M)=>{u(ie),h(M)}}),H=()=>{const ie=v.current;if(!ie)return;const M=ie.toDataURL("image/png",1),W=document.createElement("a");W.download=`edited_${e}`,W.href=M,W.click()},Q=async()=>{const ie=v.current;if(ie)try{const M=ie.toDataURL("image/png",1);r&&await r(M);const K=await(await fetch(M)).blob(),ne=new File([K],`edited_${e}`,{type:"image/png"});console.log("Image prête à être envoyée au chat:",ne),H()}catch(M){console.error("Erreur lors de la sauvegarde et envoi:",M)}},R=ie=>{p?s===ie&&f?m(!1):(i(ie),m(!0)):i(ie),ie==="drawing"?l("select"):ie==="shapes"?l("rectangle"):ie==="text"?l("text"):ie==="transform"&&l("rotate-right")},B=ie=>{l(ie),p&&m(!1),(ie.startsWith("rotate-")||ie.startsWith("flip-")||ie.startsWith("zoom-")||ie==="crop")&&(S==null||S(ie)),A(ie)},X=()=>{m(!1)};return o.jsxs("div",{className:"w-screen h-screen overflow-hidden bg-muted flex flex-col",children:[o.jsx(zte,{onSave:b,onSaveAndSendToChat:Q,onUndo:x,onRedo:w,onClose:n,onDownload:H,canUndo:c,canRedo:d,isSaving:_}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(f8,{ref:v,imageUrl:t,activeTool:a,className:"flex-1",onStartDrawing:N,onDraw:E,onStopDrawing:P,onToolChange:A}),o.jsx(Qte,{activeMenu:s,activeTool:a,isMobile:p,showDynamicSection:f,onMenuChange:R,onToolChange:B,onCloseDynamicSection:X,brushSize:U,brushColor:q,brushOpacity:Z,onBrushSizeChange:F,onBrushColorChange:Y,onBrushOpacityChange:T})]})]})},ire=({fileUrl:t,fileName:e,onUpdate:r})=>{const[n,s]=y.useState(!1),i=async a=>{r&&r(a),s(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(J,{variant:"secondary",size:"sm",onClick:()=>s(!0),className:"bg-white/90 hover:bg-white shadow-sm p-1 sm:p-2",title:"Éditer l'image",children:o.jsx(T_,{size:14,className:"sm:w-4 sm:h-4"})}),o.jsx(Br,{open:n,onOpenChange:s,children:o.jsx(Or,{className:"max-w-[98vw] max-h-[98vh] w-full h-full p-0",children:o.jsx(sre,{imageUrl:t,fileName:e,onSave:i,onClose:()=>s(!1)})})})]})},m8=({fileUrl:t,fileName:e,fileType:r,className:n="",fullscreen:s=!1,onClose:i,onUpdate:a,messageId:l,isTeacher:c=!1,lessonId:u,formationId:d})=>{const[h,f]=y.useState(!1),[m,p]=y.useState(!1),[v,b]=y.useState(!1),[x,w]=y.useState(0),[_,S]=y.useState(0),N=(r==null?void 0:r.startsWith("image/"))||/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(e),E=(r==null?void 0:r.startsWith("video/"))||/\.(mp4|webm|ogg|avi|mov)$/i.test(e),P=t.includes("youtube.com")||t.includes("youtu.be"),A=(r==null?void 0:r.startsWith("audio/"))||/\.(mp3|wav|ogg|m4a|webm)$/i.test(e),F=r==="application/pdf"||e.toLowerCase().endsWith(".pdf"),Y=()=>{const Z=document.createElement("a");Z.href=t,Z.download=e,Z.click()},T=()=>{f(!0)},O=()=>{if(!u||!d){console.error("lessonId and formationId are required for annotation");return}p(!0)},U=Z=>{const H=Math.floor(Z/60),Q=Math.floor(Z%60);return`${H}:${Q.toString().padStart(2,"0")}`};return s?o.jsx(Br,{open:!0,onOpenChange:i,children:o.jsx(Or,{className:"max-w-[95vw] max-h-[95vh] p-2",children:o.jsxs("div",{className:"relative",children:[o.jsx(J,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 z-10 bg-black/50 text-white hover:bg-black/70",onClick:i,children:o.jsx(qr,{size:16})}),N&&o.jsx("img",{src:t,alt:e,className:"max-w-full max-h-[90vh] object-contain mx-auto"}),(E||P)&&o.jsx("div",{className:"w-full max-h-[90vh]",children:o.jsx(Np,{url:t,className:"w-full"})})]})})}):o.jsxs(o.Fragment,{children:[N&&o.jsxs("div",{className:"relative group",children:[o.jsx("img",{src:t,alt:e,className:`w-full max-w-xs sm:max-w-sm max-h-48 sm:max-h-64 object-contain rounded-lg ${n}`,loading:"lazy"}),o.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:o.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[o.jsx(J,{variant:"secondary",size:"sm",onClick:T,className:"bg-white/90 hover:bg-white shadow-sm p-1 sm:p-2",title:"Voir en plein écran",children:o.jsx(Wz,{size:14,className:"sm:w-4 sm:h-4"})}),u&&d&&c&&o.jsx(J,{variant:"secondary",size:"sm",onClick:O,className:"bg-white/90 hover:bg-white shadow-sm p-1 sm:p-2",title:"Annoter l'image",children:o.jsx(T_,{size:14,className:"sm:w-4 sm:h-4"})}),a&&o.jsx(ire,{fileUrl:t,fileName:e,onUpdate:a}),o.jsx(J,{variant:"secondary",size:"sm",onClick:Y,className:"bg-white/90 hover:bg-white shadow-sm p-1 sm:p-2",title:"Télécharger",children:o.jsx(Pn,{size:14,className:"sm:w-4 sm:h-4"})})]})})]}),(E||P)&&o.jsxs("div",{className:"relative group max-w-xs sm:max-w-sm",children:[o.jsx(Np,{url:t,className:"w-full rounded-lg"}),o.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row gap-1 sm:gap-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:T,className:"text-xs sm:text-sm",children:[o.jsx(Ga,{size:14,className:"mr-1"}),"Plein écran"]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:Y,className:"text-xs sm:text-sm",children:[o.jsx(Pn,{size:14,className:"mr-1"}),"Télécharger"]})]})]}),A&&o.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-3 sm:p-4 rounded-lg max-w-xs sm:max-w-sm border border-green-200",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx("div",{className:"bg-green-500 p-1.5 sm:p-2 rounded-full text-white",children:o.jsx(i1,{size:14,className:"sm:w-4 sm:h-4"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"font-medium text-xs sm:text-sm text-gray-800 block truncate",children:e}),o.jsx("span",{className:"text-xs text-gray-500",children:"Message vocal"})]})]}),o.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[o.jsxs("audio",{controls:!0,className:"w-full h-6 sm:h-8",style:{height:"24px"},onTimeUpdate:Z=>w(Z.currentTarget.currentTime),onLoadedMetadata:Z=>S(Z.currentTarget.duration),onPlay:()=>b(!0),onPause:()=>b(!1),children:[o.jsx("source",{src:t,type:r}),"Votre navigateur ne supporte pas l'élément audio."]}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[o.jsx("span",{children:U(x)}),o.jsx("span",{children:U(_)})]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:Y,className:"w-full text-xs sm:text-sm",children:[o.jsx(Pn,{size:14,className:"mr-1"}),"Télécharger"]})]})]}),F&&o.jsxs("div",{className:"bg-red-50 p-3 sm:p-4 rounded-lg max-w-xs sm:max-w-sm border border-red-200",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[o.jsx("div",{className:"bg-red-500 p-1.5 sm:p-2 rounded-full text-white text-xs font-bold",children:"PDF"}),o.jsx("span",{className:"font-medium text-xs sm:text-sm truncate",children:e})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>window.open(t,"_blank"),className:"flex-1 text-xs sm:text-sm",children:[o.jsx(Ga,{size:14,className:"mr-1"}),"Ouvrir"]}),o.jsx(J,{variant:"outline",size:"sm",onClick:Y,className:"sm:w-auto",children:o.jsx(Pn,{size:14})})]})]}),!N&&!E&&!P&&!A&&!F&&o.jsxs("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg max-w-xs sm:max-w-sm border",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 sm:mb-3",children:[o.jsx("div",{className:"bg-gray-500 p-1.5 sm:p-2 rounded-full text-white text-xs font-bold",children:"FILE"}),o.jsx("span",{className:"font-medium text-xs sm:text-sm truncate",children:e})]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:Y,className:"w-full text-xs sm:text-sm",children:[o.jsx(Pn,{size:14,className:"mr-1"}),"Télécharger"]})]}),h&&o.jsx(m8,{fileUrl:t,fileName:e,fileType:r,fullscreen:!0,onClose:()=>f(!1)}),m&&u&&d&&o.jsx(Fte,{isOpen:m,onClose:()=>p(!1),imageUrl:t,fileName:e,messageId:l||"",isTeacher:c,lessonId:u,formationId:d})]})},are=({fileUrl:t,fileName:e,fileType:r,messageId:n,isTeacher:s=!1,lessonId:i,formationId:a})=>{const l=c=>{console.log("Image updated:",c)};return o.jsx(m8,{fileUrl:t,fileName:e,fileType:r,messageId:n,isTeacher:s,lessonId:i,formationId:a,onUpdate:l})},ore=({profile:t})=>{const e=n=>{if(!n)return"Utilisateur";const s=n.first_name||"",i=n.last_name||"";return`${s} ${i}`.trim()||n.username||"Utilisateur"},r=t==null?void 0:t.is_teacher;return o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[o.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${r?"bg-blue-500":"bg-[#25d366]"}`,children:o.jsx("span",{className:"text-white text-xs",children:r?"👨‍🏫":"👨‍🎓"})}),o.jsxs("span",{className:`text-xs font-medium ${r?"text-blue-600":"text-[#25d366]"}`,children:[e(t),r&&o.jsx("span",{className:"ml-1 text-xs",children:"(Professeur)"})]})]})},p8=()=>{const t=br();return Vt({mutationFn:async({messageId:e,userId:r,lessonId:n,formationId:s,isValid:i,rejectReason:a})=>{console.log("Validating exercise:",{messageId:e,isValid:i,rejectReason:a});try{const{data:l,error:c}=await ae.rpc("validate_exercise_submission",{p_message_id:e,p_user_id:r,p_is_valid:i,p_reject_reason:a||null});if(c)throw console.error("Supabase RPC error:",c),new Error(`Erreur de validation: ${c.message}`);return console.log("Exercise validation completed successfully"),l}catch(l){throw console.error("Error in validation mutation:",l),l}},onSuccess:(e,r)=>{[["student-messages",r.lessonId,r.formationId],["teacher-messages",r.lessonId,r.formationId],["teacher-student-messages",r.formationId,r.userId,r.lessonId],["teacher-discussions-with-unread",r.formationId],["lesson-unlocking"],["unread-messages-by-level",r.formationId]].forEach(s=>{t.invalidateQueries({queryKey:s}),t.refetchQueries({queryKey:s})}),console.log("Queries invalidated and refetched after exercise validation"),me.success(r.isValid?"Exercice validé avec succès !":"Exercice rejeté")},onError:e=>{console.error("Erreur lors de la validation:",e);const r=(e==null?void 0:e.message)||"Erreur inconnue lors de la validation";me.error(`Erreur: ${r}`)}})},lre=({message:t})=>{const e=p8(),[r,n]=y.useState(!1),[s,i]=y.useState(""),a=async l=>{if(!t.lesson_id||!t.formation_id){console.error("Missing lesson_id or formation_id"),me.error("Informations manquantes pour valider l'exercice");return}if(!l&&!s.trim()){n(!0);return}try{await e.mutateAsync({messageId:t.id,userId:t.sender_id,lessonId:t.lesson_id,formationId:t.formation_id,isValid:l,rejectReason:l?void 0:s}),l||(n(!1),i(""))}catch(c){console.error("Error validating exercise:",c)}};return o.jsx("div",{className:"space-y-2 mt-2",children:r?o.jsxs("div",{className:"space-y-2",children:[o.jsx(jr,{placeholder:"Raison du rejet...",value:s,onChange:l=>i(l.target.value),className:"text-xs",rows:2}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{onClick:()=>a(!1),disabled:e.isPending||!s.trim(),size:"sm",className:"bg-red-500 hover:bg-red-600 text-white",children:e.isPending?"Rejet...":"Confirmer rejet"}),o.jsx(J,{onClick:()=>{n(!1),i("")},variant:"outline",size:"sm",children:"Annuler"})]})]}):o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{onClick:()=>a(!0),disabled:e.isPending,size:"sm",className:"bg-green-500 hover:bg-green-600 text-white",children:[o.jsx(vc,{size:12,className:"mr-1"}),e.isPending?"Validation...":"Valider"]}),o.jsxs(J,{onClick:()=>a(!1),disabled:e.isPending,size:"sm",className:"bg-red-500 hover:bg-red-600 text-white",children:[o.jsx(Dh,{size:12,className:"mr-1"}),"Rejeter"]})]})})},cre=({status:t})=>o.jsxs("div",{className:`flex items-center space-x-1 mt-2 text-xs ${t==="approved"?"text-green-600":"text-red-600"}`,children:[t==="approved"?o.jsx(vc,{size:12}):o.jsx(Dh,{size:12}),o.jsx("span",{children:t==="approved"?"Validé":"Refusé"})]}),ure=({fileName:t,fileType:e,isNew:r=!1,context:n="shared"})=>{const s=()=>e!=null&&e.startsWith("image/")?o.jsx(nf,{size:16}):e!=null&&e.startsWith("video/")?o.jsx(Xo,{size:16}):e!=null&&e.startsWith("audio/")?o.jsx(i1,{size:16}):o.jsx(os,{size:16}),i=()=>{switch(n){case"shared":return"Fichier partagé";case"submitted":return"Exercice soumis";case"annotated":return"Image annotée";default:return"Fichier"}},a=()=>{switch(n){case"shared":return"bg-blue-100 text-blue-700 border-blue-200";case"submitted":return"bg-green-100 text-green-700 border-green-200";case"annotated":return"bg-purple-100 text-purple-700 border-purple-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded border ${a()}`,children:[s(),o.jsx("span",{children:i()})]}),r&&o.jsx("span",{className:"bg-red-500 text-white px-1 py-0.5 rounded text-xs font-bold",children:"Nouveau"})]})},dre=({message:t,isTeacher:e})=>{const{user:r}=st(),n=c=>new Date(c).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),s=t.sender_id===(r==null?void 0:r.id),i=t.is_exercise_submission===!0,a=new Date().getTime()-new Date(t.created_at).getTime()<5*60*1e3,l=()=>i?"submitted":t.content.includes("annotée")?"annotated":"shared";return o.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:o.jsxs("div",{className:`rounded-lg shadow-sm max-w-xs p-3 relative ${s?"bg-[#dcf8c6]":"bg-white"}`,children:[!s&&o.jsx(ore,{profile:t.profiles}),t.file_url&&t.file_name&&o.jsx("div",{className:"mb-2",children:o.jsx(ure,{fileName:t.file_name,fileType:t.file_type,isNew:a,context:l()})}),o.jsx("p",{className:"text-sm text-gray-800 mb-2",children:t.content}),t.file_url&&t.file_name&&o.jsx("div",{className:"mt-2",children:o.jsx(are,{fileUrl:t.file_url,fileName:t.file_name,fileType:t.file_type,messageId:t.id,isTeacher:e,lessonId:t.lesson_id,formationId:t.formation_id})}),e&&i&&!t.exercise_status&&o.jsx(lre,{message:t}),i&&t.exercise_status&&o.jsx(cre,{status:t.exercise_status}),o.jsx("div",{className:"text-xs text-gray-500 mt-1 text-right",children:n(t.created_at)}),o.jsx("div",{className:`absolute ${s?"right-0":"left-0"} top-0 w-0 h-0 border-l-[8px] border-r-[8px] border-b-[8px] border-b-transparent transform ${s?"border-l-[#dcf8c6] border-r-transparent translate-x-2":"border-l-transparent border-r-white -translate-x-2"}`})]})})},g8=({message:t,isTeacher:e})=>t.message_type==="system"?o.jsx("div",{className:"text-center",children:o.jsx("span",{className:"bg-[#dcf8c6] text-gray-700 px-3 py-2 rounded-lg text-sm shadow-sm",children:t.content})}):o.jsx(dre,{message:t,isTeacher:e}),hre=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async({lessonId:r,formationId:n,exerciseId:s,content:i,file:a})=>{if(!(e!=null&&e.id))throw new Error("Utilisateur non authentifié");let l=null,c=null,u=null;if(a){console.log("Uploading exercise file:",a.name,a.type);const m=a.name.split(".").pop(),p=`${e.id}/${r}/${s}/${Date.now()}.${m}`,{data:v,error:b}=await ae.storage.from("students_exercises_submission_files").upload(p,a);if(b)throw console.error("Error uploading exercise file:",b),b;const{data:{publicUrl:x}}=ae.storage.from("students_exercises_submission_files").getPublicUrl(p);l=x,c=a.name,u=a.type,console.log("Exercise file uploaded successfully:",{fileUrl:l,fileName:c,fileType:u})}console.log("Submitting exercise via lesson_messages:",{lessonId:r,formationId:n,exerciseId:s,content:i});const{data:d,error:h}=await ae.from("lesson_messages").insert({lesson_id:r,formation_id:n,sender_id:e.id,content:i,message_type:l?"file":"text",file_url:l,file_type:u,file_name:c,is_exercise_submission:!0,exercise_status:null,exercise_id:s}).select().single();if(h)throw console.error("Error submitting exercise:",h),h;const{error:f}=await ae.from("user_lesson_progress").upsert({user_id:e.id,lesson_id:r,status:"in_progress",exercise_completed:!1});return f&&console.error("Error updating lesson progress:",f),console.log("Exercise submitted:",d),d},onSuccess:r=>{t.invalidateQueries({queryKey:["student-messages",r.lesson_id,r.formation_id]}),t.invalidateQueries({queryKey:["teacher-messages",r.lesson_id,r.formation_id]}),t.invalidateQueries({queryKey:["lesson-unlocking"]}),me.success("Exercice soumis avec succès !")},onError:r=>{console.error("Erreur lors de la soumission:",r),me.error("Erreur lors de la soumission de l'exercice")}})},fre=({isOpen:t,onClose:e,imageUrl:r,fileName:n})=>{const s=()=>{const i=document.createElement("a");i.href=r,i.download=n,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return o.jsx(Br,{open:t,onOpenChange:e,children:o.jsxs(Or,{className:"max-w-4xl max-h-[90vh] p-0",children:[o.jsx(hn,{className:"p-6 pb-0",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(fn,{className:"text-lg font-semibold",children:n}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:s,className:"flex items-center space-x-2",children:[o.jsx(Pn,{size:16}),o.jsx("span",{children:"Télécharger"})]}),o.jsx(J,{variant:"ghost",size:"sm",onClick:e,className:"p-2",children:o.jsx(qr,{size:16})})]})]})}),o.jsx("div",{className:"p-6 pt-4",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("img",{src:r,alt:n,className:"max-w-full max-h-[70vh] object-contain rounded-lg"})})})]})})},mre=({file:t,showDownload:e=!0})=>{var l;const[r,n]=y.useState(!1),s=t.file_url.split("/").pop()||"Fichier",i=c=>{const u=document.createElement("a");u.href=c,u.download=s,u.target="_blank",document.body.appendChild(u),u.click(),document.body.removeChild(u)},a=c=>c.startsWith("image/")?o.jsx(nf,{size:14,className:"text-primary"}):c.startsWith("video/")?o.jsx(Xo,{size:14,className:"text-destructive"}):c.startsWith("audio/")?o.jsx(A_,{size:14,className:"text-purple-500"}):c==="application/pdf"?o.jsx(os,{size:14,className:"text-destructive"}):o.jsx(os,{size:14,className:"text-muted-foreground"});return t.file_type.startsWith("image/")?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-card border border-border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>n(!0),children:[o.jsx("img",{src:t.file_url,alt:s,className:"w-full h-40 object-cover",onError:c=>{const u=c.target;u.style.display="none"}}),o.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:o.jsxs(J,{variant:"secondary",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:[o.jsx(Ga,{size:16,className:"mr-1"}),"Voir"]})})]}),o.jsx("div",{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[a(t.file_type),o.jsx("span",{className:"text-sm font-medium text-foreground truncate",children:s})]}),e&&o.jsx(J,{variant:"ghost",size:"sm",onClick:c=>{c.stopPropagation(),i(t.file_url)},className:"p-1 h-7 w-7 flex-shrink-0",children:o.jsx(Pn,{size:14})})]})})]}),o.jsx(fre,{isOpen:r,onClose:()=>n(!1),imageUrl:t.file_url,fileName:s})]}):t.file_type.startsWith("video/")?o.jsxs("div",{className:"bg-card border border-border rounded-lg overflow-hidden shadow-sm",children:[o.jsx("video",{src:t.file_url,className:"w-full h-40 object-cover",controls:!0,preload:"metadata"}),o.jsx("div",{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[a(t.file_type),o.jsx("span",{className:"text-sm font-medium text-foreground truncate",children:s})]}),e&&o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>i(t.file_url),className:"p-1 h-7 w-7 flex-shrink-0",children:o.jsx(Pn,{size:14})})]})})]}):t.file_type==="application/pdf"?o.jsxs("div",{className:"bg-card border border-border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"relative group bg-muted h-40 flex items-center justify-center",children:[o.jsxs("div",{className:"text-center",children:[o.jsx(os,{size:40,className:"text-destructive mb-2 mx-auto"}),o.jsx("p",{className:"text-sm font-medium text-foreground",children:"Document PDF"}),o.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:s})]}),o.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:o.jsxs(J,{variant:"secondary",size:"sm",onClick:c=>{c.stopPropagation(),window.open(t.file_url,"_blank")},className:"opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx(Ga,{size:16,className:"mr-1"}),"Ouvrir le PDF"]})})]}),o.jsx("div",{className:"p-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[a(t.file_type),o.jsx("span",{className:"text-sm font-medium text-foreground truncate",children:s})]}),e&&o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>i(t.file_url),className:"p-1 h-7 w-7 flex-shrink-0",children:o.jsx(Pn,{size:14})})]})})]}):o.jsx("div",{className:"bg-card border border-border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[a(t.file_type),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("a",{href:t.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-primary hover:underline truncate block",children:s}),o.jsx("p",{className:"text-xs text-muted-foreground",children:((l=t.file_type.split("/")[1])==null?void 0:l.toUpperCase())||"Fichier"})]})]}),e&&o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>i(t.file_url),className:"p-2 h-8 w-8 flex-shrink-0",children:o.jsx(Pn,{size:14})})]})})},pre=({exercise:t,children:e})=>o.jsx("div",{className:"flex justify-start mb-4",children:o.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg shadow-sm max-w-md p-4 relative",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[o.jsx("div",{className:"w-8 h-8 bg-primary rounded-full text-primary-foreground text-sm flex items-center justify-center",children:o.jsx($o,{size:16})}),o.jsx("span",{className:"text-sm font-medium text-primary",children:"Exercice"})]}),o.jsx("h4",{className:"font-semibold text-foreground mb-2",children:t.title}),t.description&&o.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t.description}),t.content&&o.jsx("div",{className:"bg-secondary p-3 rounded border mb-3",children:o.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:t.content})}),t.files&&t.files.length>0&&o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsx("h5",{className:"text-sm font-semibold text-foreground",children:"Fichiers joints :"}),o.jsx("div",{className:"grid grid-cols-1 gap-3",children:t.files.filter((r,n,s)=>n===s.findIndex(i=>i.file_url===r.file_url)).map((r,n)=>o.jsx(mre,{file:r},r.id||`${r.file_url}-${n}`))})]}),e,o.jsx("div",{className:"absolute left-0 top-0 w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-primary/5 border-b-[8px] border-b-transparent transform -translate-x-2"})]})}),gre=({onCapture:t,disabled:e=!1})=>{const[r,n]=y.useState(!1),[s,i]=y.useState(null),a=y.useRef(null),l=y.useRef(null),c=y.useRef(null),u=async()=>{try{const m=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"environment"}});c.current=m,a.current&&(a.current.srcObject=m,a.current.play()),n(!0)}catch(m){console.error("Erreur accès caméra:",m),alert("Impossible d'accéder à la caméra. Vérifiez vos permissions.")}},d=()=>{if(!a.current||!l.current)return;const m=a.current,p=l.current,v=p.getContext("2d");v&&(p.width=m.videoWidth,p.height=m.videoHeight,v.drawImage(m,0,0),p.toBlob(b=>{if(b){const x=URL.createObjectURL(b);i(x)}},"image/jpeg",.8))},h=()=>{l.current&&l.current.toBlob(m=>{if(m){const p=new File([m],`photo_${Date.now()}.jpg`,{type:"image/jpeg"});t(p),f()}},"image/jpeg",.8)},f=()=>{c.current&&(c.current.getTracks().forEach(m=>m.stop()),c.current=null),n(!1),i(null)};return r?o.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx("video",{ref:a,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),o.jsx("canvas",{ref:l,className:"hidden"}),s&&o.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center",children:o.jsx("img",{src:s,alt:"Captured",className:"max-w-full max-h-full object-contain"})})]}),o.jsxs("div",{className:"bg-black p-4 flex justify-center space-x-4",children:[o.jsx(J,{onClick:f,variant:"outline",size:"lg",className:"bg-red-500 text-white border-red-500 hover:bg-red-600",children:o.jsx(qr,{size:20})}),s?o.jsx(J,{onClick:h,size:"lg",className:"bg-green-500 text-white hover:bg-green-600",children:o.jsx(rc,{size:20})}):o.jsx(J,{onClick:d,size:"lg",className:"bg-white text-black hover:bg-gray-200 w-16 h-16 rounded-full",children:o.jsx(tc,{size:24})})]})]}):o.jsx(J,{onClick:u,disabled:e,variant:"outline",size:"sm",className:"p-2",title:"Prendre une photo",children:o.jsx(tc,{size:16})})},vre=({onRecordingComplete:t,disabled:e=!1})=>{const[r,n]=y.useState(!1),[s,i]=y.useState(null),[a,l]=y.useState(null),[c,u]=y.useState(!1),[d,h]=y.useState(0),f=y.useRef(null),m=y.useRef(null),p=y.useRef(null),v=y.useRef([]),b=async()=>{try{const E=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),P=new MediaRecorder(E,{mimeType:"audio/webm;codecs=opus"});f.current=P,v.current=[],P.ondataavailable=A=>{A.data.size>0&&v.current.push(A.data)},P.onstop=()=>{const A=new Blob(v.current,{type:"audio/webm"});i(A),l(URL.createObjectURL(A)),E.getTracks().forEach(F=>F.stop())},P.start(100),n(!0),h(0),p.current=setInterval(()=>{h(A=>A+1)},1e3)}catch(E){console.error("Erreur accès microphone:",E),alert("Impossible d'accéder au microphone. Vérifiez vos permissions.")}},x=()=>{f.current&&r&&(f.current.stop(),n(!1),p.current&&(clearInterval(p.current),p.current=null))},w=()=>{!a||!m.current||(c?(m.current.pause(),u(!1)):(m.current.play(),u(!0)))},_=()=>{i(null),l(null),u(!1),h(0)},S=()=>{if(s){const E=new File([s],`audio_${Date.now()}.webm`,{type:"audio/webm"});t(E),_()}},N=E=>{const P=Math.floor(E/60),A=E%60;return`${P}:${A.toString().padStart(2,"0")}`};return s?o.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg p-2",children:[o.jsx("audio",{ref:m,src:a||void 0,onEnded:()=>u(!1),className:"hidden"}),o.jsx(J,{onClick:w,variant:"outline",size:"sm",className:"p-2",children:c?o.jsx(yw,{size:16}):o.jsx(oa,{size:16})}),o.jsx("span",{className:"text-sm text-gray-600 min-w-[40px]",children:N(d)}),o.jsx(J,{onClick:_,variant:"outline",size:"sm",className:"p-2 text-red-500 hover:text-red-700",children:o.jsx(cs,{size:16})}),o.jsx(J,{onClick:S,variant:"outline",size:"sm",className:"p-2 text-green-500 hover:text-green-700",children:o.jsx(xc,{size:16})})]}):o.jsxs("div",{className:"flex items-center space-x-2",children:[r&&o.jsx("span",{className:"text-sm text-red-500 animate-pulse min-w-[40px]",children:N(d)}),o.jsx(J,{onClick:r?x:b,disabled:e,variant:"outline",size:"sm",className:`p-2 ${r?"bg-red-500 text-white hover:bg-red-600":""}`,title:r?"Arrêter l'enregistrement":"Enregistrer un message vocal",children:r?o.jsx(nc,{size:16}):o.jsx(ax,{size:16})})]})},xre=({onSubmit:t,onCancel:e,isSubmitting:r,exerciseTitle:n,showSubmissionOptions:s=!0})=>{const[i,a]=y.useState(""),[l,c]=y.useState(null),u=y.useRef(null),d=p=>{var b;const v=(b=p.target.files)==null?void 0:b[0];v&&c(v)},h=p=>{c(p),a(`Photo capturée pour l'exercice: ${n}`)},f=p=>{c(p),a(`Message vocal pour l'exercice: ${n}`)},m=()=>{t(i,l||void 0)};return o.jsxs("div",{className:"mt-4 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Votre réponse"}),o.jsx("textarea",{value:i,onChange:p=>a(p.target.value),placeholder:"Tapez votre réponse ici...",className:"w-full p-2 border border-gray-300 rounded-md text-sm resize-none",rows:3})]}),s&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ajouter un fichier ou un média"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{ref:u,type:"file",onChange:d,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png"}),o.jsxs(J,{type:"button",variant:"outline",size:"sm",onClick:()=>{var p;return(p=u.current)==null?void 0:p.click()},children:[o.jsx(Ih,{size:16,className:"mr-1"}),"Fichier"]}),o.jsx(gre,{onCapture:h,disabled:r}),o.jsx(vre,{onRecordingComplete:f,disabled:r})]}),l&&o.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Fichier sélectionné: ",l.name]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{onClick:m,disabled:r||!i.trim()&&!l,size:"sm",className:"bg-green-500 hover:bg-green-600",children:[o.jsx(xc,{size:16,className:"mr-1"}),r?"Envoi...":"Soumettre"]}),o.jsx(J,{onClick:e,variant:"outline",size:"sm",children:"Annuler"})]})]})},yre=({exerciseTitle:t})=>o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full text-white text-sm flex items-center justify-center",children:"✓"}),o.jsx("span",{className:"text-sm font-medium text-green-700",children:"Exercice soumis"})]}),o.jsxs("p",{className:"text-sm text-green-600",children:['Votre soumission pour "',t,'" a été envoyée et est en attente de validation. La prochaine leçon sera automatiquement déverrouillée une fois validé.']})]}),bre=({exercise:t,lessonId:e,formationId:r,isSubmitted:n=!1,onSubmissionComplete:s,showSubmissionOptions:i=!0})=>{const[a,l]=y.useState(!1),c=hre(),u=async(d,h)=>{if(!(!d.trim()&&!h))try{await c.mutateAsync({lessonId:e,formationId:r,exerciseId:t.id,content:d||`Soumission de l'exercice: ${t.title}`,file:h}),l(!1),s==null||s()}catch(f){console.error("Error submitting exercise:",f)}};return n?o.jsx(yre,{exerciseTitle:t.title}):o.jsxs(pre,{exercise:t,children:[!a&&o.jsx(J,{onClick:()=>l(!0),size:"sm",className:"bg-blue-500 hover:bg-blue-600",children:"Rendre l'exercice"}),a&&o.jsx(xre,{onSubmit:u,onCancel:()=>l(!1),isSubmitting:c.isPending,exerciseTitle:t.title,showSubmissionOptions:i})]})},wre=t=>Nt({queryKey:["exercise-with-files",t],queryFn:async()=>{if(!t)return null;const{data:e,error:r}=await ae.from("exercises").select("*").eq("id",t).single();if(r)throw console.error("Erreur lors de la récupération de l'exercice:",r),r;const{data:n,error:s}=await ae.from("exercise_files").select("id, file_url, file_type").eq("exercise_id",t);return s&&console.error("Erreur lors de la récupération des fichiers:",s),{id:e.id,title:e.title,description:e.description,content:e.content,files:n||[]}},enabled:!!t}),_re=({exercise:t,lessonId:e,formationId:r,isSubmitted:n=!1,showSubmissionOptions:s=!0,isTeacherView:i=!1})=>{const{data:a}=wre(t.id),l=(u,d)=>{const h=document.createElement("a");h.href=u,h.download=d||"fichier",h.target="_blank",document.body.appendChild(h),h.click(),document.body.removeChild(h)};if(i)return o.jsx("div",{className:"flex justify-start mb-4",children:o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg shadow-sm max-w-xs p-4 relative",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full text-white text-sm flex items-center justify-center",children:o.jsx($o,{size:16})}),o.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Exercice"})]}),o.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:t.title}),t.description&&o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t.description}),t.content&&o.jsx("div",{className:"bg-white p-3 rounded border mb-3",children:o.jsx("p",{className:"text-sm text-gray-800",children:t.content})}),(a==null?void 0:a.files)&&a.files.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Fichiers :"}),a.files.map((u,d)=>o.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded border",children:[o.jsx(xw,{size:14,className:"text-gray-500"}),o.jsx("a",{href:u.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex-1 truncate",children:u.file_url.split("/").pop()||"Fichier"}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>l(u.file_url,u.file_url.split("/").pop()),className:"p-1 h-6 w-6",children:o.jsx(Pn,{size:12})})]},u.id||d))]}),o.jsx("div",{className:"absolute left-0 top-0 w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-blue-50 border-b-[8px] border-b-transparent transform -translate-x-2"})]})});const c=a?{...t,files:a.files}:t;return o.jsx(bre,{exercise:c,lessonId:e,formationId:r,isSubmitted:n,showSubmissionOptions:s})},j4=({content:t,exercise:e,lessonId:r,formationId:n,isTeacherView:s=!1})=>o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"text-center",children:o.jsx("span",{className:"bg-[#dcf8c6] text-gray-700 px-3 py-2 rounded-lg text-sm shadow-sm",children:t})}),e&&o.jsx(_re,{exercise:e,lessonId:r,formationId:n,isTeacherView:s,showSubmissionOptions:!s})]}),jre=({show:t,onComplete:e})=>{const[r,n]=y.useState(!1);return y.useEffect(()=>{if(t){n(!0);const s=setTimeout(()=>{n(!1),e==null||e()},3e3);return()=>clearTimeout(s)}},[t,e]),r?o.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50 flex items-center justify-center",children:[o.jsxs("div",{className:"absolute inset-0",children:[[...Array(20)].map((s,i)=>o.jsx("div",{className:"absolute w-2 h-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full animate-bounce",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${1+Math.random()}s`}},i)),[...Array(15)].map((s,i)=>o.jsx("div",{className:"absolute w-3 h-3 text-yellow-400 animate-ping",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`},children:"⭐"},`star-${i}`))]}),o.jsxs("div",{className:"bg-green-500 text-white px-8 py-4 rounded-lg shadow-lg animate-bounce text-center",children:[o.jsx("div",{className:"text-2xl font-bold mb-2",children:"🎉 Félicitations ! 🎉"}),o.jsx("p",{className:"text-lg",children:"Leçon terminée avec succès !"})]})]}):null},v8=({userName:t,isTeacher:e})=>o.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-100 rounded-lg mb-2",children:[o.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${e?"bg-blue-500":"bg-[#25d366]"}`,children:o.jsx("span",{className:"text-white text-xs",children:e?"👨‍🏫":"👨‍🎓"})}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsxs("span",{className:"text-sm text-gray-600",children:[t," ",e?"(Professeur)":""," est en train d'écrire"]}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),o.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),o.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})]}),Sre=()=>{const t=br();return Vt({mutationFn:async e=>{console.log("📋 Starting evaluation submission:",e);const{data:r,error:n}=await ae.from("interview_evaluations").select(`
          *,
          teachers (
            id,
            user_id
          )
        `).eq("id",e.evaluationId).single();if(n)throw console.error("❌ Error fetching evaluation:",n),new Error("Erreur lors de la récupération de l'évaluation: "+n.message);if(!r)throw new Error("Évaluation introuvable");console.log("✅ Evaluation found:",r);const{error:s}=await ae.from("interview_evaluations").update({is_satisfied:e.isSatisfied,satisfaction_rating:e.isSatisfied?e.rating:null,teacher_rating:e.isSatisfied?e.rating:null,wants_same_teacher:e.wantsSameTeacher,responded_at:new Date().toISOString()}).eq("id",e.evaluationId);if(s)throw console.error("❌ Error updating evaluation:",s),new Error("Erreur lors de la mise à jour: "+s.message);if(console.log("✅ Evaluation updated successfully"),e.isSatisfied&&r.teacher_id){console.log("💰 Processing teacher payment for satisfied evaluation");try{const{data:i,error:a}=await ae.from("teacher_pricing_rules").select("*").eq("teacher_id",r.teacher_id).eq("formation_id",r.formation_id).eq("is_active",!0).single();if(a&&a.code!=="PGRST116"){console.warn("⚠️ No specific pricing rule found for teacher/formation, trying general rule");const{data:l,error:c}=await ae.from("teacher_pricing_rules").select("*").eq("teacher_id",r.teacher_id).is("formation_id",null).eq("is_active",!0).single();if(c&&c.code!=="PGRST116")throw console.error("❌ No pricing rule found for teacher:",c),new Error("Aucune règle de tarification trouvée pour ce professeur");l&&l.entretien_satisfait_price>0&&(console.log("✅ Using general pricing rule:",l),await S4(r.teacher_id,l.entretien_satisfait_price,r.id))}else i&&i.entretien_satisfait_price>0&&(console.log("✅ Pricing rule found:",i),await S4(r.teacher_id,i.entretien_satisfait_price,r.id))}catch(i){console.error("❌ Error processing teacher payment:",i),me.warning("Évaluation enregistrée mais erreur lors du paiement du professeur")}}return r},onSuccess:()=>{console.log("🎉 Evaluation submitted successfully"),me.success("Merci pour votre évaluation! 🙏"),t.invalidateQueries({queryKey:["student-evaluations"]}),t.invalidateQueries({queryKey:["teacher-wallet"]}),t.invalidateQueries({queryKey:["teacher-transactions"]})},onError:e=>{console.error("❌ Error submitting evaluation:",e),me.error("Erreur lors de l'envoi de l'évaluation: "+e.message)}})};async function S4(t,e,r){console.log(`💳 Processing payment: ${e}€ for teacher ${t}`);const{error:n}=await ae.rpc("process_teacher_payment",{p_teacher_id:t,p_transaction_type:"interview_payment",p_amount:e,p_reference_id:r,p_description:`Paiement entretien satisfait - Évaluation ${r}`});if(n)throw console.error("❌ Error calling process_teacher_payment:",n),new Error("Erreur lors du traitement du paiement: "+n.message);console.log("💰 Payment processing completed successfully")}const Cre=({evaluationId:t,teacherName:e,expiresAt:r})=>{const[n,s]=y.useState(!1),[i,a]=y.useState(null),[l,c]=y.useState(0),[u,d]=y.useState(null),[h,f]=y.useState(!1),m=Sre(),p=new Date(r).getTime()-new Date().getTime(),v=Math.floor(p/(1e3*60*60)),b=async()=>{if(i===null){me.error("Veuillez indiquer si vous êtes satisfait");return}if(i&&l===0){me.error("Veuillez noter votre professeur");return}if(u===null){me.error("Veuillez indiquer si vous souhaitez avoir à nouveau ce professeur");return}try{await m.mutateAsync({evaluationId:t,isSatisfied:i,rating:i?l:void 0,wantsSameTeacher:u}),f(!0)}catch{}};return h?o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full text-white text-sm flex items-center justify-center",children:"✓"}),o.jsx("span",{className:"text-sm font-medium text-green-700",children:"Évaluation envoyée"})]}),o.jsxs("p",{className:"text-sm text-green-600",children:["Merci pour votre évaluation de l'entretien avec ",e,"."]})]}):o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:o.jsxs(Gd,{open:n,onOpenChange:s,children:[o.jsx(Yd,{asChild:!0,children:o.jsxs(J,{variant:"ghost",className:"w-full flex items-center justify-between p-0 h-auto text-left hover:bg-orange-100",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-full text-white text-sm flex items-center justify-center",children:o.jsx(P_,{size:18})}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-orange-700 block",children:"Évaluation d'entretien requise"}),o.jsxs("span",{className:"text-xs text-orange-600",children:["Entretien avec ",e," - ",v,"h restantes"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Urgent"}),n?o.jsx(Kc,{size:16}):o.jsx($a,{size:16})]})]})}),o.jsxs(Xd,{className:"mt-4 space-y-4",children:[o.jsxs("h4",{className:"font-semibold text-gray-800",children:["Comment s'est passé votre entretien avec ",e," ?"]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"1. Êtes-vous satisfait de cet entretien ?"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(J,{variant:i===!0?"default":"outline",size:"sm",onClick:()=>a(!0),className:`flex items-center gap-1 ${i===!0?"bg-orange-500 hover:bg-orange-600 text-white":"border-orange-200 text-orange-700 hover:bg-orange-50"}`,children:[o.jsx(l9,{size:14}),"Oui"]}),o.jsxs(J,{variant:i===!1?"default":"outline",size:"sm",onClick:()=>a(!1),className:`flex items-center gap-1 ${i===!1?"bg-orange-500 hover:bg-orange-600 text-white":"border-orange-200 text-orange-700 hover:bg-orange-50"}`,children:[o.jsx(o9,{size:14}),"Non"]})]})]}),i===!0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"2. Notez ce professeur"}),o.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(x=>o.jsx("button",{onClick:()=>c(x),className:`p-1 ${x<=l?"text-orange-500":"text-gray-300"} hover:text-orange-400`,children:o.jsx(yc,{size:20,fill:x<=l?"currentColor":"none"})},x))}),l>0&&o.jsxs("p",{className:"text-xs text-gray-500",children:[l===1&&"Très décevant",l===2&&"Décevant",l===3&&"Correct",l===4&&"Bien",l===5&&"Excellent"]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"3. Souhaitez-vous avoir à nouveau ce professeur pour un futur entretien ?"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(J,{variant:u===!0?"default":"outline",size:"sm",onClick:()=>d(!0),className:`${u===!0?"bg-orange-500 hover:bg-orange-600 text-white":"border-orange-200 text-orange-700 hover:bg-orange-50"}`,children:"Oui"}),o.jsx(J,{variant:u===!1?"default":"outline",size:"sm",onClick:()=>d(!1),className:`${u===!1?"bg-orange-500 hover:bg-orange-600 text-white":"border-orange-200 text-orange-700 hover:bg-orange-50"}`,children:"Non"})]})]}),o.jsx("div",{className:"flex gap-2 pt-2",children:o.jsx(J,{onClick:b,disabled:m.isPending,className:"bg-orange-500 hover:bg-orange-600 text-white",children:m.isPending?"Envoi...":"Envoyer l'évaluation"})}),o.jsxs("div",{className:"text-xs text-gray-500",children:["⏰ Vous avez ",v,"h pour répondre. Passé ce délai, nous considérerons que vous êtes satisfait."]})]})]})})},tS=(t,e)=>{const r=br(),{user:n}=st(),s=y.useRef(null),[i,a]=y.useState(!1),[l,c]=y.useState("disconnected"),u=y.useRef(),d=y.useRef(0),h=5,f=()=>{u.current&&clearTimeout(u.current),s.current&&(console.log("🧹 Cleaning up realtime channel"),ae.removeChannel(s.current),s.current=null),a(!1),c("disconnected")},m=()=>{if(!t||!e||!n){console.log("❌ Missing required data for realtime messages:",{lessonId:t,formationId:e,userId:n==null?void 0:n.id});return}f(),c("connecting");const v=`lesson-messages-${t}-${e}`;console.log("🔄 Setting up realtime subscription for:",v),s.current=ae.channel(v).on("postgres_changes",{event:"INSERT",schema:"public",table:"lesson_messages",filter:`lesson_id=eq.${t}`},b=>{console.log("📨 New message received via realtime:",b),[["student-messages",t,e],["teacher-messages",t,e],["teacher-discussions-with-unread",e],["teacher-student-messages",e,b.new.sender_id,t],["teacher-student-messages",e,b.new.receiver_id,t]].forEach(w=>{r.invalidateQueries({queryKey:w})}),b.new.sender_id!==n.id&&console.log("🔔 New message from another user")}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lesson_messages",filter:`lesson_id=eq.${t}`},b=>{console.log("📝 Message updated via realtime:",b),[["student-messages",t,e],["teacher-messages",t,e],["teacher-discussions-with-unread",e],["teacher-student-messages",e,b.new.sender_id,t],["teacher-student-messages",e,b.new.receiver_id,t]].forEach(w=>{r.invalidateQueries({queryKey:w})})}).subscribe(b=>{switch(console.log("📡 Realtime subscription status:",b,"for lesson:",t),b){case"SUBSCRIBED":a(!0),c("connected"),d.current=0,console.log("✅ Realtime connection established for lesson:",t);break;case"CHANNEL_ERROR":a(!1),c("error"),console.error("❌ Realtime connection error for lesson:",t),p();break;case"TIMED_OUT":a(!1),c("error"),console.error("⏰ Realtime connection timed out for lesson:",t),p();break;case"CLOSED":a(!1),c("disconnected"),console.warn("🔒 Realtime connection closed for lesson:",t),p();break;default:c("connecting");break}})},p=()=>{if(d.current>=h){console.error("🚨 Max reconnection attempts reached for realtime"),c("error");return}const v=Math.min(1e3*Math.pow(2,d.current),3e4);d.current++,console.log(`🔄 Attempting to reconnect realtime (attempt ${d.current}/${h}) in ${v}ms`),u.current=setTimeout(()=>{m()},v)};return y.useEffect(()=>{m();const v=setInterval(()=>{s.current&&i&&s.current.send({type:"broadcast",event:"heartbeat",payload:{timestamp:Date.now()}}).catch(b=>{console.error("💓 Heartbeat failed:",b),l==="connected"&&(c("error"),p())})},3e4);return()=>{clearInterval(v),f()}},[t,e,n==null?void 0:n.id,r]),{isSubscribed:i,connectionStatus:l,reconnectAttempts:d.current,maxReconnectAttempts:h}},rS=(t,e)=>{const{user:r}=st(),[n,s]=y.useState([]),i=y.useRef(null),a=y.useRef(!1);return y.useEffect(()=>{if(!t||!e||!r){console.log("Missing required data for typing listener:",{lessonId:t,formationId:e,user:!!r});return}const l=`typing-${t}-${e}`;return console.log("Setting up typing listener for channel:",l),i.current&&(console.log("Cleaning up existing typing listener channel"),ae.removeChannel(i.current),i.current=null,a.current=!1),i.current=ae.channel(l).on("broadcast",{event:"typing_start"},c=>{const u=c.payload;if(console.log("Received typing_start event:",u),u.user_id===r.id){console.log("Ignoring own typing indicator");return}if(u.lesson_id!==t||u.formation_id!==e){console.log("Typing event for different lesson/formation, ignoring");return}console.log("User started typing:",u.user_name,"is_teacher:",u.is_teacher),s(d=>{const f=[...d.filter(m=>m.user_id!==u.user_id),{user_id:u.user_id,user_name:u.user_name,is_teacher:u.is_teacher}];return console.log("Updated typing users list:",f),f})}).on("broadcast",{event:"typing_stop"},c=>{const{user_id:u,lesson_id:d,formation_id:h}=c.payload;if(console.log("Received typing_stop event:",{user_id:u,lesson_id:d,formation_id:h}),d!==t||h!==e){console.log("Stop typing event for different lesson/formation, ignoring");return}console.log("User stopped typing:",u),s(f=>{const m=f.filter(p=>p.user_id!==u);return console.log("Updated typing users list after stop:",m),m})}).subscribe(c=>{console.log("Typing listener channel subscription status:",c),a.current=c==="SUBSCRIBED",c==="SUBSCRIBED"?console.log("✅ Typing listener ready for lesson:",t):c==="CHANNEL_ERROR"&&console.error("❌ Typing listener error for lesson:",t)}),()=>{console.log("Cleaning up typing listener for lesson:",t),s([]),i.current&&ae.removeChannel(i.current),i.current=null,a.current=!1}},[t,e,r==null?void 0:r.id]),n},Nre=()=>{const{user:t}=st();return Nt({queryKey:["student-evaluations",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id))return[];const{data:e,error:r}=await ae.from("interview_evaluations").select(`
          *,
          teachers (
            profiles (
              first_name,
              last_name,
              username
            )
          )
        `).eq("student_id",t.id).is("responded_at",null).gt("expires_at",new Date().toISOString());if(r)throw console.error("Error fetching student evaluations:",r),r;return e||[]},enabled:!!(t!=null&&t.id),refetchInterval:1e4})},kre=({messages:t,exercises:e,lesson:r,formationId:n,isTeacherView:s=!1,studentName:i,onValidateExercise:a})=>{const l=y.useRef(null);st();const[c,u]=y.useState(!1),{data:d=!1}=gO(n),h=rS(r.id.toString(),n);tS(r.id.toString(),n);const{data:f=[]}=Nre();y.useEffect(()=>{var p;(p=l.current)==null||p.scrollIntoView({behavior:"smooth"})},[t,h]);const m=p=>e.find(v=>v.id===p);return console.log("MessageList render - messages count:",(t==null?void 0:t.length)||0),console.log("Typing users:",h),console.log("Pending evaluations:",f),console.log("Is teacher in this formation:",d),o.jsxs("div",{className:"flex-1 p-4 space-y-4 custom-scrollbar overflow-y-auto",children:[o.jsx(jre,{show:c,onComplete:()=>u(!1)}),o.jsx("div",{className:"text-center",children:o.jsx("span",{className:"bg-[#dcf8c6] text-gray-700 px-3 py-2 rounded-lg text-sm shadow-sm",children:s?`Discussion avec ${i}`:`Bienvenue dans la leçon: ${r.title}`})}),t&&t.length>0?t.map(p=>{if(p.is_system_message&&p.exercise_id){const v=m(p.exercise_id);return o.jsx("div",{className:"message-appear",children:o.jsx(j4,{content:p.content,exercise:v,lessonId:r.id.toString(),formationId:n,isTeacherView:s})},p.id)}return p.is_system_message?o.jsx("div",{className:"message-appear",children:o.jsx(j4,{content:p.content,lessonId:r.id.toString(),formationId:n,isTeacherView:s})},p.id):o.jsx("div",{className:"message-appear",children:o.jsx(g8,{message:p,isTeacher:d,onValidateExercise:a})},p.id)}):o.jsx("div",{className:"text-center text-gray-500 py-8",children:o.jsx("p",{children:"Aucun message pour le moment"})}),!s&&f.map(p=>{var v;return o.jsx(Cre,{evaluationId:p.id,teacherName:(v=p.teachers)!=null&&v.profiles&&(`${p.teachers.profiles.first_name||""} ${p.teachers.profiles.last_name||""}`.trim()||p.teachers.profiles.username)||"Professeur",expiresAt:p.expires_at},p.id)}),h.map(p=>o.jsx(v8,{userName:p.user_name,isTeacher:p.is_teacher},p.user_id)),o.jsx("div",{ref:l})]})},C4=({message:t,onUpgrade:e,variant:r="warning"})=>o.jsxs(Zj,{className:`border-l-4 ${r==="error"?"border-l-destructive bg-destructive/5":"border-l-orange-500 bg-orange-50"}`,children:[o.jsx(O_,{className:`h-4 w-4 ${r==="error"?"text-destructive":"text-orange-500"}`}),o.jsxs(eS,{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",children:t}),e&&o.jsxs(J,{variant:"outline",size:"sm",onClick:e,className:"ml-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white border-0 hover:from-purple-600 hover:to-pink-600",children:[o.jsx(ix,{size:14,className:"mr-1"}),"Mettre à niveau"]})]})]}),Ere=({src:t,formationId:e,timeRemainingToday:r,dailyTimeLimit:n,isLimitReached:s,canPlay:i,sessionTime:a,onUpgrade:l,onPlayStateChange:c,className:u=""})=>{const d=Mn(),[h,f]=y.useState(!1),[m,p]=y.useState(!1);return y.useEffect(()=>{s&&h&&(f(!1),c==null||c(!1))},[s,h,c]),s?o.jsx("div",{className:`relative bg-black ${u}`,children:o.jsxs("div",{className:"aspect-video flex flex-col items-center justify-center text-white p-8",children:[o.jsx(Js,{size:48,className:"mb-4 opacity-60"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Limite de temps atteinte"}),o.jsx("p",{className:"text-sm opacity-80 text-center mb-4",children:"Vous avez utilisé tout votre temps quotidien pour cette formation."}),o.jsx(C4,{message:"Revenez demain ou passez à un plan supérieur pour continuer.",onUpgrade:()=>d(`/formation/${e}/pricing`),variant:"warning"})]})}):o.jsxs("div",{className:`relative ${u}`,children:[r!==null&&n!==null&&o.jsx("div",{className:"absolute top-2 left-2 right-2 z-20 pointer-events-none",children:o.jsxs("div",{className:"bg-black/80 backdrop-blur-sm rounded-lg p-2 shadow-lg border border-white/10",children:[o.jsxs("div",{className:"flex items-center justify-between text-white text-xs",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Js,{className:"w-3 h-3 text-blue-400"}),o.jsxs("span",{className:"font-medium",children:["Temps restant: ",o.jsxs("span",{className:"text-blue-300",children:[r,"min"]})]})]}),o.jsxs("div",{className:"text-white/70",children:["Session: ",a]})]}),o.jsx("div",{className:"mt-1",children:o.jsx("div",{className:"w-full bg-white/20 rounded-full h-1",children:o.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${r<=5?"bg-red-400":r<=15?"bg-orange-400":"bg-blue-400"}`,style:{width:`${Math.max(0,r/n*100)}%`}})})}),r<=5&&r>0&&o.jsxs("div",{className:"flex items-center gap-1 mt-1 text-orange-300 text-xs animate-pulse",children:[o.jsx("span",{children:"⚠️"}),o.jsxs("span",{className:"font-medium",children:["Plus que ",r,"min !"]})]})]})}),m&&o.jsx("div",{className:"absolute inset-0 bg-black/80 flex items-center justify-center z-30",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[o.jsx(C4,{message:"Vous avez atteint votre limite de temps quotidienne.",onUpgrade:l,variant:"error"}),o.jsx(J,{variant:"ghost",onClick:()=>p(!1),className:"mt-4 w-full",children:"Fermer"})]})}),o.jsx(Np,{url:t,className:"w-full"})]})},Pre=({lesson:t,formation:e,onBack:r})=>{const n=Mn(),{user:s,loading:i}=st(),[a,l]=y.useState(!1),c=y.useRef(null),u=y.useRef(null),{data:d=[],isLoading:h}=XK(t.id.toString(),e.id),{data:f=[]}=QK(t.id.toString()),{data:m}=xO(e.id),p=vO(t.id.toString(),e.id),v=jj(),{isSubscribed:b,connectionStatus:x,reconnectAttempts:w,maxReconnectAttempts:_}=tS(t.id.toString(),e.id),S=rS(t.id.toString(),e.id),{initiateCall:N}=yO(e.id),{incomingCalls:E,acceptCall:P,rejectCall:A,isTeacher:F}=tQ(e.id),Y=eQ({formationId:e.id,lessonId:t.id.toString(),isActive:!0}),T=ZK(e.id,a,()=>{}),O=()=>{var R;(R=c.current)==null||R.scrollIntoView({behavior:"smooth",block:"start"})},U=()=>{var R;(R=u.current)==null||R.scrollIntoView({behavior:"smooth",block:"end"})};y.useEffect(()=>{!i&&!s&&n("/auth")},[s,i,n]),y.useEffect(()=>{if(d.length>0&&(m==null?void 0:m.role)==="teacher"&&s){const R=d.filter(B=>!B.is_read&&B.sender_id!==s.id);R.length>0&&v.mutate({lessonId:t.id.toString(),formationId:e.id,studentId:R[0].sender_id})}},[d,m,t.id,e.id,v,s]);const q=(R,B="text",X)=>{if(!s){n("/auth");return}p.mutate({content:R,messageType:B,file:X,isExerciseSubmission:B==="file"||B==="image"})},Z=async R=>{if(!s){n("/auth");return}(m==null?void 0:m.role)==="student"?await N(R,"",t.id.toString())&&me.info(`Appel ${R==="video"?"vidéo":"audio"} envoyé aux professeurs`):me.info("Fonctionnalité d'appel disponible pour les élèves")};if(i)return o.jsx("div",{className:"min-h-screen bg-[#e5ddd5] flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Vérification..."}),o.jsx("p",{className:"text-gray-600",children:"Connexion en cours"})]})});if(!s)return null;if(h)return o.jsx("div",{className:"min-h-screen bg-[#e5ddd5] flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Chargement..."}),o.jsx("p",{className:"text-gray-600",children:"Récupération des messages"})]})});const H=()=>{switch(x){case"connected":return"🟢";case"connecting":return"🟡";case"error":return"🔴";default:return"⚪"}},Q=()=>{switch(x){case"connected":return"Temps réel actif";case"connecting":return"Connexion...";case"error":return`Erreur (${w}/${_})`;default:return"Déconnecté"}};return o.jsxs("div",{className:"min-h-screen bg-[#e5ddd5] flex flex-col relative",children:[F&&E.map(R=>o.jsxs("div",{className:"fixed top-20 right-4 bg-white border rounded-lg shadow-lg p-4 z-50",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold",children:"Appel entrant"}),o.jsx("span",{className:"text-sm text-gray-500",children:R.call_type==="video"?"📹":"📞"})]}),o.jsxs("p",{className:"text-sm mb-3",children:[R.caller_name," vous appelle"]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{size:"sm",onClick:()=>P(R.id),className:"bg-green-500 hover:bg-green-600",children:"Accepter"}),o.jsx(J,{size:"sm",variant:"outline",onClick:()=>A(R.id),children:"Rejeter"})]})]},R.id)),o.jsx("div",{className:"bg-[#25d366] text-white p-3 sm:p-4 sticky top-0 md:top-16 z-40",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[o.jsx("button",{onClick:r,className:"mr-2 sm:mr-3 p-2 hover:bg-white/10 rounded-full transition-colors flex-shrink-0",children:o.jsx(Za,{size:18,className:"sm:w-5 sm:h-5"})}),o.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-white/20 rounded-full flex items-center justify-center mr-2 sm:mr-3 flex-shrink-0",children:o.jsx("span",{className:"text-white font-bold text-xs sm:text-sm",children:"📚"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h1",{className:"font-semibold text-sm sm:text-base md:text-lg truncate",children:t.title}),o.jsxs("p",{className:"text-xs sm:text-sm text-white/80 truncate",children:["Formation: ",e.title]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 text-xs text-white/60",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[H()," ",Q()]}),o.jsxs("span",{className:"flex items-center gap-1",children:["⏱ Session: ",Y.sessionTime]}),S.length>0&&o.jsxs("span",{children:["• ",S.length," en train d'écrire"]})]})]})]}),(m==null?void 0:m.role)==="student"&&o.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>Z("video"),className:"p-2 hover:bg-white/10 rounded-full text-white",title:"Appel vidéo",children:o.jsx(Xo,{size:18,className:"sm:w-5 sm:h-5"})}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>Z("audio"),className:"p-2 hover:bg-white/10 rounded-full text-white",title:"Appel audio",children:o.jsx(sf,{size:18,className:"sm:w-5 sm:h-5"})})]})]})}),o.jsx(d8,{isOpen:T.showAlert,onClose:T.hideAlert,message:T.alertMessage,formationId:e.id,variant:T.alertVariant}),t.video_url&&o.jsx("div",{ref:c,className:"bg-black",children:o.jsx(Ere,{src:t.video_url,formationId:e.id,timeRemainingToday:Y.timeRemainingToday,dailyTimeLimit:Y.dailyTimeLimit,isLimitReached:Y.isLimitReached,canPlay:Y.canContinue,sessionTime:Y.sessionTime,onUpgrade:()=>n(`/formation/${e.id}/pricing`),onPlayStateChange:l,className:"w-full"})}),o.jsx(X_,{onScrollToVideo:O,onScrollToMessages:U}),o.jsx("div",{ref:u,className:"flex-1 flex flex-col min-h-0",children:o.jsx(kre,{messages:d,exercises:f,lesson:t,formationId:e.id.toString(),isTeacherView:!1,isTeacher:(m==null?void 0:m.role)==="teacher",onValidateExercise:()=>{}})}),o.jsx("div",{className:"bg-background border-t p-2 sm:p-4",children:o.jsx(h8,{onSendMessage:q,disabled:p.isPending,lessonId:t.id.toString(),formationId:e.id})})]})},Are=t=>{const{user:e}=st();return Nt({queryKey:["teacher-discussions-with-unread",t,e==null?void 0:e.id],queryFn:async()=>{if(!t||!(e!=null&&e.id))return[];console.log("Fetching teacher discussions with unread counts for formation:",t);const{data:r}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",t).maybeSingle();if(!r)return console.error("User is not a teacher in this formation"),[];const{data:n,error:s}=await ae.from("enrollment_requests").select("user_id").eq("formation_id",t).eq("status","approved");if(s)return console.error("Error fetching enrollments:",s),[];if(!n||n.length===0)return console.log("No enrolled students found for formation:",t),[];const i=n.map(b=>b.user_id);console.log("Enrolled student IDs:",i);const{data:a,error:l}=await ae.from("lesson_messages").select(`
          sender_id,
          receiver_id,
          lesson_id,
          created_at,
          content
        `).eq("formation_id",t).or(`sender_id.in.(${i.join(",")}),receiver_id.in.(${i.join(",")})`).order("created_at",{ascending:!1});if(l)return console.error("Error fetching discussions:",l),[];if(console.log("Found discussions:",(a==null?void 0:a.length)||0),!a||a.length===0)return console.log("No discussions found"),[];const c=[...new Set(a.map(b=>b.lesson_id))],{data:u}=await ae.from("lessons").select("id, title").in("id",c),d=new Map((u==null?void 0:u.map(b=>[b.id,b]))||[]),h=new Map;a.forEach(b=>{const x=i.includes(b.sender_id)?b.sender_id:b.receiver_id;if(!x)return;const w=`${x}-${b.lesson_id}`;if(!h.has(w)){const _=d.get(b.lesson_id);h.set(w,{student_id:x,lesson_id:b.lesson_id,lesson_title:(_==null?void 0:_.title)||"Leçon inconnue",last_message_time:b.created_at,last_message_content:b.content})}});const f=Array.from(new Set(Array.from(h.values()).map(b=>b.student_id))),{data:m}=await ae.from("profiles").select("id, first_name, last_name, username, avatar_url").in("id",f),p=[];for(const b of h.values()){const{data:x}=await ae.rpc("get_unread_messages_count",{p_formation_id:t,p_lesson_id:b.lesson_id,p_student_id:b.student_id,p_teacher_id:e.id}),w=m==null?void 0:m.find(_=>_.id===b.student_id);p.push({student_id:b.student_id,lesson_id:b.lesson_id,lesson_title:b.lesson_title,student_profile:w||null,unread_count:x||0,last_message_time:b.last_message_time,last_message_content:b.last_message_content})}const v=p.sort((b,x)=>b.unread_count!==x.unread_count?x.unread_count-b.unread_count:new Date(x.last_message_time).getTime()-new Date(b.last_message_time).getTime());return console.log("Final sorted discussions:",v),v},enabled:!!t&&!!(e!=null&&e.id),refetchInterval:3e3})},x8=(t,e,r)=>(st(),Nt({queryKey:["active-interview",t,e,r],queryFn:async()=>{const{data:n,error:s}=await ae.from("active_interviews").select(`
          *,
          teacher:teachers(
            id,
            user_id,
            profiles:user_id(
              first_name,
              last_name,
              username
            )
          )
        `).eq("lesson_id",t).eq("formation_id",e).eq("student_id",r).eq("is_active",!0).maybeSingle();return s?(console.error("Error fetching active interview:",s),null):n},enabled:!!t&&!!e&&!!r,refetchInterval:5e3})),Tre=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async({lessonId:r,formationId:n,studentId:s})=>{if(!(e!=null&&e.id))throw new Error("Utilisateur non authentifié");const{data:i,error:a}=await ae.from("teachers").select(`
          id, 
          user_id,
          teacher_formations!inner(
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",n).single();if(a||!i)throw console.error("Teacher verification error:",a),new Error("Vous n'êtes pas autorisé à démarrer un entretien pour cette formation");const{data:l,error:c}=await ae.from("profiles").select("id, first_name, last_name").eq("id",s).single();if(c||!l)throw console.error("Student verification error:",c),new Error("Étudiant introuvable");const{data:u,error:d}=await ae.from("lessons").select("id, title, level_id").eq("id",r).single();if(d||!u)throw console.error("Lesson verification error:",d),new Error("Leçon introuvable");const{data:h,error:f}=await ae.from("formations").select("id, title").eq("id",n).single();if(f||!h)throw console.error("Formation verification error:",f),new Error("Formation introuvable");console.log("Starting interview with verified data:",{teacher_id:i.id,student_id:s,lesson_id:r,formation_id:n,studentName:`${l.first_name} ${l.last_name}`,lessonTitle:u.title,formationTitle:h.title});const{data:m,error:p}=await ae.from("active_interviews").insert({teacher_id:i.id,student_id:s,lesson_id:r,formation_id:n,is_active:!0,started_at:new Date().toISOString()}).select().single();if(p)throw console.error("Error starting interview:",p),p.code==="23503"?new Error("Erreur de relation : un des identifiants fournis est invalide"):p.code==="23505"?new Error("Un entretien est déjà en cours pour cette leçon"):new Error(`Erreur lors du démarrage de l'entretien: ${p.message}`);return m},onSuccess:r=>{t.invalidateQueries({queryKey:["active-interview",r.lesson_id,r.formation_id,r.student_id]}),me.success("Entretien démarré avec succès! 🎉")},onError:r=>{console.error("Interview start error:",r),me.error(r.message)}})},Lre=()=>{const t=br();return Vt({mutationFn:async({lessonId:e,formationId:r,studentId:n,teacherId:s})=>{try{const{data:i,error:a}=await ae.from("active_interviews").select().eq("teacher_id",s).eq("student_id",n).eq("lesson_id",e).eq("formation_id",r).eq("is_active",!0).order("created_at",{ascending:!1});if(a)throw console.error("Error fetching interview sessions:",a),new Error(`Erreur lors de la récupération de l'entretien: ${a.message}`);if(!i||i.length===0)throw new Error("Aucun entretien actif trouvé");const l=i[0];console.log("Ending interview session:",l.id);const{data:c,error:u}=await ae.from("active_interviews").update({is_active:!1,ended_at:new Date().toISOString()}).eq("id",l.id).select().single();if(u||!c)throw console.error("Error ending interview session:",u),new Error(`Erreur lors de la fin de l'entretien: ${u==null?void 0:u.message}`);if(i.length>1){const v=i.slice(1).map(b=>b.id);console.log("Closing additional sessions:",v),await ae.from("active_interviews").update({is_active:!1,ended_at:new Date().toISOString()}).in("id",v)}const d=new Date;d.setHours(d.getHours()+24);const{data:h,error:f}=await ae.from("interview_evaluations").insert({student_id:n,teacher_id:s,lesson_id:e,formation_id:r,interview_session_id:c.id,expires_at:d.toISOString()}).select().single();if(f)throw console.error("Error creating evaluation:",f),new Error(`Erreur lors de la création de l'évaluation: ${f.message}`);const m="4c32c988-3b19-4eca-87cb-0e0595fd7fbb",{error:p}=await ae.from("lesson_messages").insert({lesson_id:e,formation_id:r,sender_id:m,receiver_id:n,content:`🎯 Entretien terminé avec votre professeur.

📋 Une enquête de satisfaction vous a été envoyée. Votre avis nous aide à améliorer nos services.

⏰ Vous avez 24h pour répondre. Passé ce délai, nous considérerons que vous êtes satisfait de cet entretien.`,message_type:"system",is_system_message:!0});return p&&console.warn("Error sending evaluation message:",p),h}catch(i){throw console.error("End interview error:",i),i}},onSuccess:e=>{t.invalidateQueries({queryKey:["active-interview"]}),me.success("Entretien terminé avec succès! 🎉"),me.info("L'enquête de satisfaction a été envoyée à l'élève")},onError:e=>{console.error("Interview end error:",e),me.error(e.message)}})},Ore=({formationId:t,onSelectDiscussion:e})=>{const{data:r=[],isLoading:n,error:s}=Are(t),i=jj(),a=d=>{if(!d)return"Étudiant inconnu";const h=d.first_name||"",f=d.last_name||"";return`${h} ${f}`.trim()||d.username||"Étudiant"},l=d=>{const h=new Date(d),m=new Date().getTime()-h.getTime(),p=Math.floor(m/(1e3*60*60)),v=Math.floor(p/24);return v>0?`${v}j`:p>0?`${p}h`:`${Math.floor(m/6e4)}min`},c=d=>{i.mutate({formationId:t,lessonId:d.lesson_id,studentId:d.student_id}),e(d.student_id,d.lesson_id,a(d.student_profile),d.lesson_title,d.student_profile)},u=({discussion:d})=>{var m;const{data:h}=x8(d.lesson_id,t,d.student_id);if(!h)return null;const f=(m=h.instructor)!=null&&m.profiles&&(`${h.instructor.profiles.first_name||""} ${h.instructor.profiles.last_name||""}`.trim()||h.instructor.profiles.username)||"Professeur";return o.jsxs("div",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full flex items-center gap-1 mt-1",children:[o.jsx(pa,{size:12}),o.jsxs("span",{children:["🟢 Professeur ",f," en entretien"]})]})};return n?o.jsx("div",{className:"flex justify-center items-center py-8",children:o.jsx("div",{className:"text-gray-500",children:"Chargement des discussions..."})}):s?o.jsx("div",{className:"flex justify-center items-center py-8",children:o.jsx("div",{className:"text-red-500",children:"Erreur lors du chargement"})}):o.jsx("div",{className:"divide-y divide-gray-100",children:r.length>0?r.map(d=>{var h;return o.jsxs("div",{className:`flex items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors ${d.unread_count>0?"bg-blue-50":"bg-white"}`,onClick:()=>c(d),children:[o.jsxs("div",{className:"relative mr-3",children:[o.jsx("div",{className:"w-12 h-12 bg-[#25d366] rounded-full flex items-center justify-center overflow-hidden",children:(h=d.student_profile)!=null&&h.avatar_url?o.jsx("img",{src:d.student_profile.avatar_url,alt:a(d.student_profile),className:"w-full h-full object-cover"}):o.jsx(Ya,{size:20,className:"text-white"})}),d.unread_count>0&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:d.unread_count>9?"9+":d.unread_count})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("h3",{className:`truncate ${d.unread_count>0?"font-semibold text-gray-900":"font-medium text-gray-900"}`,children:a(d.student_profile)}),o.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0 flex items-center",children:[o.jsx(Js,{size:12,className:"mr-1"}),l(d.last_message_time)]})]}),o.jsxs("p",{className:"text-sm text-blue-600 font-medium mb-1",children:["📖 ",d.lesson_title]}),o.jsx("p",{className:`text-sm truncate ${d.unread_count>0?"text-gray-800":"text-gray-600"}`,children:d.last_message_content}),o.jsx(u,{discussion:d})]}),o.jsx("div",{className:"ml-2 flex items-center space-x-2",children:o.jsx(Zs,{size:16,className:d.unread_count>0?"text-[#25d366]":"text-gray-400"})})]},`${d.student_id}-${d.lesson_id}`)}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Zs,{size:48,className:"mx-auto text-gray-300 mb-4"}),o.jsx("p",{className:"text-gray-500 mb-2",children:"Aucune discussion"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Les discussions apparaîtront ici quand les étudiants enverront des messages"})]})})},Mre=({formation:t,student:e,lesson:r,isSubscribed:n,typingUsersCount:s,onBack:i,onOpenStudio:a})=>{var h,f,m;const l=((h=e.profiles)==null?void 0:h.first_name)||((f=e.profiles)==null?void 0:f.username)||"Étudiant",{initiateCall:c}=yO(t.id),u=async()=>{try{await c("video",e.user_id,r.id)||me.error("Impossible de démarrer l'appel vidéo")}catch(p){console.error("Erreur lors de l'appel vidéo:",p),me.error("Erreur lors de l'appel vidéo")}},d=async()=>{try{await c("audio",e.user_id,r.id)||me.error("Impossible de démarrer l'appel audio")}catch(p){console.error("Erreur lors de l'appel audio:",p),me.error("Erreur lors de l'appel audio")}};return o.jsx("div",{className:"bg-white border-b p-4 shadow-sm",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:i,className:"lg:hidden",children:o.jsx(Za,{size:20})}),o.jsxs("div",{className:"flex items-center gap-3",children:[(m=e.profiles)!=null&&m.avatar_url?o.jsx("img",{src:e.profiles.avatar_url,alt:l,className:"w-10 h-10 rounded-full object-cover"}):o.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:o.jsx("span",{className:"text-sm font-medium text-blue-600",children:l.charAt(0).toUpperCase()})}),o.jsxs("div",{children:[o.jsx("h2",{className:"font-semibold text-gray-900",children:l}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx("span",{children:r.title}),o.jsxs("div",{className:"flex items-center gap-1",children:[n?o.jsx(d9,{size:14,className:"text-green-500"}):o.jsx(u9,{size:14,className:"text-red-500"}),o.jsx("span",{className:n?"text-green-600":"text-red-600",children:n?"Connecté":"Déconnecté"})]})]}),s>0&&o.jsxs("div",{className:"flex items-center gap-1 text-sm text-blue-600",children:[o.jsx(pa,{size:14}),o.jsxs("span",{children:[l," est en train d'écrire..."]})]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(J,{variant:"ghost",size:"sm",className:"text-blue-600 hover:bg-blue-50",onClick:a,title:"Studio d'enseignement",children:o.jsx(Xz,{size:20})}),o.jsx(J,{variant:"ghost",size:"sm",className:"text-green-600 hover:bg-green-50",onClick:u,title:"Appel vidéo",children:o.jsx(Xo,{size:20})}),o.jsx(J,{variant:"ghost",size:"sm",className:"text-green-600 hover:bg-green-50",onClick:d,title:"Appel vocal",children:o.jsx(sf,{size:20})})]})]})})},Rre=({lessonId:t,formationId:e,studentId:r,studentName:n})=>{var N,E,P,A;const{user:s}=st(),[i,a]=y.useState(!1),[l,c]=y.useState("start"),{data:u,isLoading:d,error:h}=x8(t,e,r),f=Tre(),m=Lre();h&&console.error("Error fetching interview data:",h);const p=((N=u==null?void 0:u.teacher)==null?void 0:N.user_id)===(s==null?void 0:s.id),v=u&&!p;console.log("InterviewToggleButton Debug:",{userId:s==null?void 0:s.id,activeInterview:u,isCurrentUserInInterview:p,isInterviewActiveByOther:v,lessonId:t,formationId:e,studentId:r,fetchError:h==null?void 0:h.message});const b=async()=>{if(!(s!=null&&s.id)){me.error("Utilisateur non authentifié");return}try{console.log("Tentative de démarrage d'entretien..."),await f.mutateAsync({lessonId:t,formationId:e,studentId:r}),a(!1)}catch(F){console.error("Error starting interview:",F)}},x=async()=>{if(!(s!=null&&s.id)||!(u!=null&&u.teacher_id)){me.error("Utilisateur non authentifié ou entretien introuvable");return}try{console.log("Tentative de fin d'entretien..."),await m.mutateAsync({lessonId:t,formationId:e,studentId:r,teacherId:u.teacher_id}),a(!1)}catch(F){console.error("Error ending interview:",F)}},w=F=>{c(F),a(!0)};if(h&&!d)return o.jsx("div",{className:"fixed right-4 top-1/2 transform -translate-y-1/2 z-50",children:o.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 max-w-xs",children:[o.jsxs("div",{className:"flex items-center gap-2 text-red-800 text-sm",children:[o.jsx(sx,{size:16}),o.jsx("span",{className:"font-medium",children:"Erreur de chargement"})]}),o.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Impossible de vérifier le statut de l'entretien"})]})});const _=p,S=f.isPending||m.isPending||d;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"fixed right-4 top-1/2 transform -translate-y-1/2 z-50",children:[v?o.jsxs("div",{className:"bg-orange-100 border border-orange-300 rounded-lg p-3 max-w-xs mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-orange-800 text-sm",children:[o.jsx(pa,{size:16}),o.jsx("span",{className:"font-medium",children:"🟢 Entretien en cours"})]}),o.jsx("p",{className:"text-xs text-orange-600 mt-1",children:(E=u==null?void 0:u.teacher)!=null&&E.profiles?`Avec ${u.teacher.profiles.first_name||""} ${u.teacher.profiles.last_name||""}`.trim()||u.teacher.profiles.username||"un professeur":"avec un autre professeur"})]}):null,o.jsx(J,{onClick:()=>w(_?"end":"start"),disabled:S||v&&!p,className:`
            shadow-lg hover:shadow-xl transition-all duration-200 rounded-full w-14 h-14 p-0 flex items-center justify-center
            ${_?"bg-red-500 hover:bg-red-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}
            ${v&&!p?"opacity-50 cursor-not-allowed":""}
          `,size:"lg",title:_?"Terminer l'entretien":"Commencer l'entretien",children:S?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):_?o.jsx(r9,{size:20}):o.jsx(oa,{size:20})})]}),o.jsx(Br,{open:i,onOpenChange:a,children:o.jsxs(Or,{className:"max-w-md",children:[o.jsx(hn,{children:o.jsxs(fn,{className:"flex items-center gap-2",children:[o.jsx(vc,{className:"text-green-500",size:20}),l==="start"?"Commencer l'entretien":"Terminer l'entretien"]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-gray-600",children:l==="start"?`Êtes-vous sûr de vouloir commencer un entretien avec ${n} ?`:"Êtes-vous sûr de vouloir terminer cet entretien ?"}),o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-sm text-blue-800",children:[o.jsx("p",{className:"font-medium mb-1",children:"📋 Ce qui va se passer :"}),o.jsx("ul",{className:"list-disc list-inside space-y-1",children:l==="start"?o.jsxs(o.Fragment,{children:[o.jsx("li",{children:"L'entretien sera marqué comme actif"}),o.jsx("li",{children:"Un indicateur sera visible pour les autres professeurs"}),o.jsx("li",{children:"Vous pourrez communiquer en privé avec l'élève"})]}):o.jsxs(o.Fragment,{children:[o.jsx("li",{children:"L'entretien sera marqué comme terminé"}),o.jsx("li",{children:"Une enquête de satisfaction sera envoyée à l'élève"}),o.jsx("li",{children:"Vous serez rémunéré selon les règles de tarification"}),o.jsx("li",{children:"Si l'élève ne répond pas sous 24h, la satisfaction sera implicite"})]})})]}),(f.error||m.error)&&o.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-sm text-red-800 border border-red-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(sx,{size:16}),o.jsx("span",{className:"font-medium",children:"Erreur détectée :"})]}),o.jsx("p",{className:"mt-1",children:((P=f.error)==null?void 0:P.message)||((A=m.error)==null?void 0:A.message)})]}),o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(J,{variant:"outline",onClick:()=>a(!1),disabled:S,children:"Annuler"}),o.jsx(J,{onClick:l==="start"?b:x,disabled:S,className:l==="start"?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600",children:S?"Traitement...":l==="start"?"Commencer l'entretien":"Terminer l'entretien"})]})]})]})})]})},Dre=()=>{const[t,e]=y.useState([{id:"scene-1",name:"Scène principale",elements:[],isActive:!0}]),[r,n]=y.useState("scene-1"),s=y.useCallback(h=>{const f={id:`scene-${Date.now()}`,name:h,elements:[],isActive:!1};return e(m=>[...m,f]),f.id},[]),i=y.useCallback(h=>{var f;e(m=>m.filter(p=>p.id!==h)),r===h&&n(((f=t[0])==null?void 0:f.id)||"")},[r,t]),a=y.useCallback(h=>{e(f=>f.map(m=>({...m,isActive:m.id===h}))),n(h)},[]),l=y.useCallback((h,f)=>{const m={...f,id:`element-${Date.now()}`};return e(p=>p.map(v=>v.id===h?{...v,elements:[...v.elements,m]}:v)),m.id},[]),c=y.useCallback((h,f,m)=>{e(p=>p.map(v=>v.id===h?{...v,elements:v.elements.map(b=>b.id===f?{...b,...m}:b)}:v))},[]),u=y.useCallback((h,f)=>{e(m=>m.map(p=>p.id===h?{...p,elements:p.elements.filter(v=>v.id!==f)}:p))},[]),d=t.find(h=>h.id===r);return{scenes:t,activeScene:d,activeSceneId:r,createScene:s,deleteScene:i,switchToScene:a,addElementToScene:l,updateElement:c,removeElement:u}},Fre=()=>{const[t,e]=y.useState([]),[r,n]=y.useState(!1),[s,i]=y.useState(!1),a=y.useRef(null),l=y.useCallback(async()=>{try{const m=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),p={id:"camera-main",type:"camera",stream:m,isActive:!0};return e(v=>[...v.filter(b=>b.id!=="camera-main"),p]),n(!0),i(!0),a.current&&(a.current.srcObject=m),m}catch(m){throw console.error("Erreur lors de l'accès à la caméra:",m),m}},[]),c=y.useCallback(()=>{const m=t.find(p=>p.id==="camera-main");m!=null&&m.stream&&m.stream.getTracks().forEach(p=>p.stop()),e(p=>p.filter(v=>v.id!=="camera-main")),n(!1),i(!1),a.current&&(a.current.srcObject=null)},[t]),u=y.useCallback(async()=>{r?c():await l()},[r,l,c]),d=y.useCallback(()=>{const m=t.find(p=>p.id==="camera-main");if(m!=null&&m.stream){const p=m.stream.getAudioTracks()[0];p&&(p.enabled=!s,i(!s))}},[t,s]),h=y.useCallback(async()=>{try{const m=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}),p={id:"screen-share",type:"screen",stream:m,isActive:!0};return e(v=>[...v.filter(b=>b.id!=="screen-share"),p]),m}catch(m){throw console.error("Erreur lors du partage d'écran:",m),m}},[]),f=y.useCallback(()=>{const m=t.find(p=>p.id==="screen-share");m!=null&&m.stream&&m.stream.getTracks().forEach(p=>p.stop()),e(p=>p.filter(v=>v.id!=="screen-share"))},[t]);return{mediaStreams:t,cameraEnabled:r,micEnabled:s,videoRef:a,toggleCamera:u,toggleMic:d,startScreenShare:h,stopScreenShare:f}},Ire=(t,e)=>{const[r,n]=y.useState([]),[s,i]=y.useState(!1),a=y.useCallback(async f=>{i(!0);try{n(m=>m.map(p=>p.id===f?{...p,status:"accepted"}:p)),me.success("Soumission acceptée et affichée")}catch(m){console.error("Erreur lors de l'acceptation:",m),me.error("Erreur lors de l'acceptation de la soumission")}finally{i(!1)}},[]),l=y.useCallback(async f=>{i(!0);try{n(m=>m.map(p=>p.id===f?{...p,status:"rejected"}:p)),me.info("Soumission rejetée")}catch(m){console.error("Erreur lors du rejet:",m),me.error("Erreur lors du rejet de la soumission")}finally{i(!1)}},[]),c=y.useCallback(()=>{n([])},[]),u=y.useCallback(f=>{const m={...f,id:`submission-${Date.now()}`,submittedAt:new Date,status:"pending"};n(p=>[...p,m]),me.info(`Nouvelle soumission de ${f.studentName}`)},[]),d=r.filter(f=>f.status==="pending"),h=r.filter(f=>f.status==="accepted");return{submissions:r,pendingSubmissions:d,acceptedSubmissions:h,isLoading:s,acceptSubmission:a,rejectSubmission:l,clearSubmissions:c,addSubmission:u}},zre=t=>{const{user:e}=st(),[r,n]=y.useState(null),[s,i]=y.useState(!1),a=y.useCallback(async h=>{if(!e)return me.error("Vous devez être connecté pour démarrer une session"),!1;try{const{data:f,error:m}=await ae.from("call_sessions").insert({caller_id:e.id,receiver_id:null,formation_id:t,lesson_id:h,call_type:"video",status:"active",started_at:new Date().toISOString()}).select().single();return m?(console.error("Erreur lors de la création de la session:",m),me.error("Impossible de démarrer la session en direct"),!1):(n({id:f.id,teacherId:f.caller_id,formationId:f.formation_id,lessonId:f.lesson_id,status:f.status,startedAt:f.started_at?new Date(f.started_at):void 0}),i(!0),await l(f.id,t,h),me.success("Session en direct démarrée !"),!0)}catch(f){return console.error("Erreur lors du démarrage de la session:",f),me.error("Erreur lors du démarrage de la session"),!1}},[e,t]),l=async(h,f,m)=>{try{const{data:p,error:v}=await ae.from("enrollment_requests").select(`
          user_id,
          profiles!inner(
            id,
            first_name,
            last_name,
            username
          )
        `).eq("formation_id",f).eq("status","approved");if(v){console.error("Erreur récupération élèves:",v);return}if(p&&p.length>0){const b=p.map(x=>({title:"Cours en direct disponible",message:"Votre professeur a commencé une session en direct. Rejoignez maintenant !",type:"live_session",user_id:x.user_id,created_at:new Date().toISOString()}));await ae.from("notifications").insert(b)}}catch(p){console.error("Erreur lors de la notification des élèves:",p)}},c=y.useCallback(async()=>{if(r)try{await ae.from("call_sessions").update({status:"ended",ended_at:new Date().toISOString()}).eq("id",r.id),i(!1),n(null),me.info("Session en direct terminée")}catch(h){console.error("Erreur lors de la fin de la session:",h)}},[r]),u=y.useCallback(async(h,f,m)=>h==="video"?await a(m):(me.info("Fonctionnalité d'appel audio à implémenter avec le nouveau système"),!1),[a]),d=y.useCallback(async()=>{await c()},[c]);return{currentSession:r,isSessionActive:s,startLiveSession:a,endLiveSession:c,initiateCall:u,isCallActive:s,currentCall:r,endCall:d}},$re=({scenes:t,activeSceneId:e,onSceneSelect:r,onCreateScene:n,onDeleteScene:s})=>{var h,f;const[i,a]=y.useState(!1),[l,c]=y.useState(""),u=()=>{l.trim()&&(n(l.trim()),c(""),a(!1))},d=m=>{m.key==="Enter"?u():m.key==="Escape"&&(a(!1),c(""))};return o.jsxs("div",{className:"space-y-2",children:[t.map((m,p)=>o.jsxs("div",{className:`
            flex items-center space-x-2 p-2 rounded cursor-pointer transition-colors
            ${m.id===e?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-200"}
          `,onClick:()=>r(m.id),children:[o.jsx("div",{className:"w-8 h-6 bg-gray-900 rounded border flex items-center justify-center text-xs",children:p+1}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:m.name}),o.jsxs("div",{className:"text-xs opacity-75",children:[m.elements.length," élément",m.elements.length!==1?"s":""]})]}),m.id===e&&o.jsx(Ga,{size:14,className:"text-green-400"}),s&&t.length>1&&o.jsx(J,{variant:"ghost",size:"sm",onClick:v=>{v.stopPropagation(),s(m.id)},className:"p-1 h-auto text-red-400 hover:text-red-300 hover:bg-red-900/30",children:o.jsx(cs,{size:12})})]},m.id)),i?o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(Ye,{value:l,onChange:m=>c(m.target.value),onKeyDown:d,placeholder:"Nom de la scène",className:"flex-1 bg-gray-700 border-gray-600 text-white text-sm",autoFocus:!0}),o.jsx(J,{size:"sm",onClick:u,disabled:!l.trim(),className:"px-2",children:"✓"}),o.jsx(J,{variant:"outline",size:"sm",onClick:()=>{a(!1),c("")},className:"px-2",children:"✕"})]}):o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>a(!0),className:"w-full flex items-center space-x-2 text-gray-300 border-gray-600 hover:bg-gray-700",children:[o.jsx(ls,{size:14}),o.jsx("span",{children:"Nouvelle scène"})]}),e&&o.jsxs("div",{className:"mt-4 p-2 bg-gray-700 rounded",children:[o.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Aperçu"}),o.jsxs("div",{className:"w-full h-16 bg-black rounded relative border",children:[(h=t.find(m=>m.id===e))==null?void 0:h.elements.map((m,p)=>o.jsx("div",{className:"absolute bg-blue-500 opacity-50 border border-blue-300",style:{left:`${m.position.x/800*100}%`,top:`${m.position.y/600*100}%`,width:`${m.size.width/800*100}%`,height:`${m.size.height/600*100}%`,minWidth:"4px",minHeight:"4px"},title:`${m.type} - ${m.visible?"Visible":"Masqué"}`},m.id)),((f=t.find(m=>m.id===e))==null?void 0:f.elements.length)===0&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 text-xs",children:"Vide"})]})]})]})},Bre=({className:t=""})=>{const e=y.useRef(null),[r,n]=y.useState(!1),[s,i]=y.useState("pen"),[a,l]=y.useState("#ffffff"),[c,u]=y.useState(3),[d,h]=y.useState([]),[f,m]=y.useState(-1);y.useEffect(()=>{const E=e.current;if(!E)return;const P=E.getContext("2d");P&&(E.width=E.offsetWidth,E.height=E.offsetHeight,P.fillStyle="#1f2937",P.fillRect(0,0,E.width,E.height),p(P))},[]);const p=E=>{const P=e.current;if(!P)return;const A=E.getImageData(0,0,P.width,P.height),F=d.slice(0,f+1);F.push(A),F.length>20?F.shift():m(f+1),h(F)},v=E=>{const P=e.current,A=P==null?void 0:P.getContext("2d");if(!P||!A)return;n(!0);const F=P.getBoundingClientRect(),Y=E.clientX-F.left,T=E.clientY-F.top;A.beginPath(),A.moveTo(Y,T),s==="pen"?(A.globalCompositeOperation="source-over",A.strokeStyle=a,A.lineWidth=c,A.lineCap="round"):s==="eraser"&&(A.globalCompositeOperation="destination-out",A.lineWidth=c*2,A.lineCap="round")},b=E=>{if(!r)return;const P=e.current,A=P==null?void 0:P.getContext("2d");if(!P||!A)return;const F=P.getBoundingClientRect(),Y=E.clientX-F.left,T=E.clientY-F.top;(s==="pen"||s==="eraser")&&(A.lineTo(Y,T),A.stroke())},x=()=>{if(!r)return;n(!1);const E=e.current,P=E==null?void 0:E.getContext("2d");P&&p(P)},w=()=>{if(f>0){const E=e.current,P=E==null?void 0:E.getContext("2d");if(!E||!P)return;m(f-1);const A=d[f-1];P.putImageData(A,0,0)}},_=()=>{if(f<d.length-1){const E=e.current,P=E==null?void 0:E.getContext("2d");if(!E||!P)return;m(f+1);const A=d[f+1];P.putImageData(A,0,0)}},S=()=>{const E=e.current,P=E==null?void 0:E.getContext("2d");!E||!P||(P.fillStyle="#1f2937",P.fillRect(0,0,E.width,E.height),p(P))},N=["#ffffff","#000000","#ef4444","#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4"];return o.jsxs("div",{className:`w-full h-full bg-gray-800 rounded ${t}`,children:[o.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-700 rounded-t",children:[o.jsx(J,{variant:s==="pen"?"default":"outline",size:"sm",onClick:()=>i("pen"),className:"p-1",children:o.jsx(t9,{size:14})}),o.jsx(J,{variant:s==="eraser"?"default":"outline",size:"sm",onClick:()=>i("eraser"),className:"p-1",children:o.jsx(MP,{size:14})}),o.jsx(J,{variant:s==="line"?"default":"outline",size:"sm",onClick:()=>i("line"),className:"p-1",children:o.jsx(Yz,{size:14})}),o.jsx(J,{variant:s==="rectangle"?"default":"outline",size:"sm",onClick:()=>i("rectangle"),className:"p-1",children:o.jsx(nc,{size:14})}),o.jsx(J,{variant:s==="circle"?"default":"outline",size:"sm",onClick:()=>i("circle"),className:"p-1",children:o.jsx(lp,{size:14})}),o.jsx("div",{className:"w-px h-4 bg-gray-500"}),o.jsx(J,{variant:"outline",size:"sm",onClick:w,disabled:f<=0,className:"p-1",children:o.jsx(up,{size:14})}),o.jsx(J,{variant:"outline",size:"sm",onClick:_,disabled:f>=d.length-1,className:"p-1",children:o.jsx($P,{size:14})}),o.jsx(J,{variant:"outline",size:"sm",onClick:S,className:"p-1 text-red-400 hover:text-red-300",children:o.jsx(cs,{size:14})}),o.jsx("div",{className:"w-px h-4 bg-gray-500"}),o.jsx("div",{className:"flex space-x-1",children:N.map(E=>o.jsx("button",{className:`w-6 h-6 rounded border-2 ${a===E?"border-white":"border-gray-500"}`,style:{backgroundColor:E},onClick:()=>l(E)},E))}),o.jsx("div",{className:"w-px h-4 bg-gray-500"}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{className:"text-xs text-gray-300",children:"Taille:"}),o.jsx("input",{type:"range",min:"1",max:"20",value:c,onChange:E=>u(Number(E.target.value)),className:"w-16"}),o.jsx("span",{className:"text-xs text-gray-300 w-6",children:c})]})]}),o.jsx("canvas",{ref:e,className:"w-full h-full cursor-crosshair",style:{height:"calc(100% - 48px)"},onMouseDown:v,onMouseMove:b,onMouseUp:x,onMouseLeave:x})]})},qre=({className:t=""})=>{const[e,r]=y.useState(""),[n,s]=y.useState(null),[i,a]=y.useState(!1);y.useEffect(()=>{if(!e.trim())return;const m=setTimeout(()=>{l()},3e4);return()=>clearTimeout(m)},[e]);const l=async()=>{if(e.trim()){a(!0);try{await new Promise(m=>setTimeout(m,500)),s(new Date)}catch(m){console.error("Erreur lors de la sauvegarde automatique:",m)}finally{a(!1)}}},c=async()=>{if(!e.trim()){me.error("Aucune note à sauvegarder");return}try{await l(),me.success("Notes sauvegardées !")}catch{me.error("Erreur lors de la sauvegarde")}},u=async()=>{if(!e.trim()){me.error("Aucune note à copier");return}try{await navigator.clipboard.writeText(e),me.success("Notes copiées dans le presse-papiers !")}catch{me.error("Erreur lors de la copie")}},d=m=>m.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),h=()=>new Date().toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),f=()=>{const m=`[${h()}] `,p=document.querySelector("textarea");if(p){const v=p.selectionStart,b=p.selectionEnd,x=e.substring(0,v)+m+e.substring(b);r(x),setTimeout(()=>{p.selectionStart=p.selectionEnd=v+m.length,p.focus()},0)}else r(e+m)};return o.jsxs("div",{className:`w-full h-full bg-gray-800 rounded flex flex-col ${t}`,children:[o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-t",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(os,{size:16,className:"text-blue-400"}),o.jsx("span",{className:"text-sm font-medium text-white",children:"Notes de cours"}),i&&o.jsx("div",{className:"text-xs text-yellow-400",children:"Sauvegarde..."})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(J,{variant:"outline",size:"sm",onClick:f,className:"p-1 text-xs",title:"Insérer un horodatage",children:o.jsx(Js,{size:12})}),o.jsx(J,{variant:"outline",size:"sm",onClick:u,className:"p-1",title:"Copier les notes",children:o.jsx(Az,{size:12})}),o.jsx(J,{variant:"outline",size:"sm",onClick:c,className:"p-1",title:"Sauvegarder",children:o.jsx(Fh,{size:12})})]})]}),o.jsx("div",{className:"flex-1 p-3",children:o.jsx(jr,{value:e,onChange:m=>r(m.target.value),placeholder:`Tapez vos notes ici...

Conseils :
• Utilisez le bouton horloge pour insérer l'heure actuelle
• Vos notes sont sauvegardées automatiquement
• Utilisez Ctrl+S pour sauvegarder manuellement`,className:"w-full h-full resize-none bg-gray-900 border-gray-600 text-white text-sm",style:{minHeight:"200px"}})}),o.jsxs("div",{className:"p-2 bg-gray-700 rounded-b text-xs text-gray-400 flex justify-between items-center",children:[o.jsxs("div",{children:[e.length," caractère",e.length!==1?"s":""]}),n&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Dernière sauvegarde:"}),o.jsx("span",{className:"text-green-400",children:d(n)})]})]})]})},Ure=({submissions:t,onAccept:e,onReject:r})=>{const n=a=>a.startsWith("image/")?o.jsx(nf,{size:16,className:"text-blue-400"}):o.jsx(os,{size:16,className:"text-red-400"}),s=a=>"0 B",i=a=>{const c=new Date().getTime()-a.getTime(),u=Math.floor(c/6e4);return u<1?"À l'instant":u<60?`Il y a ${u} min`:`Il y a ${Math.floor(u/60)}h${u%60}min`};return t.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-400",children:[o.jsx("div",{className:"text-4xl mb-2",children:"📁"}),o.jsx("div",{className:"text-sm",children:"Aucune soumission en attente"}),o.jsx("div",{className:"text-xs mt-1",children:"Les fichiers des élèves apparaîtront ici"})]}):o.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:t.map(a=>o.jsx(Mt,{className:"bg-gray-700 border-gray-600",children:o.jsxs(Rt,{className:"p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-xs text-white font-bold",children:a.studentName.charAt(0).toUpperCase()}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-white",children:a.studentName}),o.jsx("div",{className:"text-xs text-gray-400",children:i(a.submittedAt)})]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(J,{variant:"outline",size:"sm",onClick:()=>e(a.id),className:"p-1 text-green-400 hover:text-green-300 hover:bg-green-900/30",title:"Accepter et afficher",children:o.jsx(rc,{size:14})}),o.jsx(J,{variant:"outline",size:"sm",onClick:()=>r(a.id),className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-900/30",title:"Rejeter",children:o.jsx(qr,{size:14})})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[n(a.fileType),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm text-white truncate",children:a.fileName}),o.jsxs("div",{className:"text-xs text-gray-400",children:[a.fileType," • ",s()]})]})]}),a.fileType.startsWith("image/")&&o.jsx("div",{className:"mt-2",children:o.jsx("img",{src:a.fileUrl,alt:a.fileName,className:"w-full h-20 object-cover rounded border border-gray-600"})}),o.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-600",children:[o.jsxs(J,{variant:"ghost",size:"sm",className:"text-xs text-gray-400 hover:text-gray-300",onClick:()=>window.open(a.fileUrl,"_blank"),children:[o.jsx(Ga,{size:12,className:"mr-1"}),"Aperçu"]}),o.jsxs(J,{variant:"ghost",size:"sm",className:"text-xs text-gray-400 hover:text-gray-300",onClick:()=>{const l=document.createElement("a");l.href=a.fileUrl,l.download=a.fileName,l.click()},children:[o.jsx(Pn,{size:12,className:"mr-1"}),"Télécharger"]})]})]})},a.id))})},Vre=({element:t,onUpdate:e,onRemove:r,isSelected:n,onSelect:s,children:i})=>{const[a,l]=y.useState(!1),[c,u]=y.useState(!1),[d,h]=y.useState({x:0,y:0}),f=y.useRef(null),m=y.useCallback(w=>{(w.target===f.current||w.target.closest(".drag-handle"))&&(w.preventDefault(),l(!0),h({x:w.clientX-t.position.x,y:w.clientY-t.position.y}),s==null||s())},[t.position,s]),p=y.useCallback(w=>{if(a){const _={x:Math.max(0,w.clientX-d.x),y:Math.max(0,w.clientY-d.y)};e({position:_})}},[a,d,e]),v=y.useCallback(()=>{l(!1),u(!1)},[]),b=y.useCallback(w=>{w.preventDefault(),w.stopPropagation(),u(!0),s==null||s()},[s]),x=y.useCallback(w=>{if(c&&f.current){const _=f.current.getBoundingClientRect(),S={width:Math.max(100,w.clientX-_.left),height:Math.max(100,w.clientY-_.top)};e({size:S})}},[c,e]);return Fe.useEffect(()=>(a&&(document.addEventListener("mousemove",p),document.addEventListener("mouseup",v)),c&&(document.addEventListener("mousemove",x),document.addEventListener("mouseup",v)),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",v)}),[a,c,p,x,v]),o.jsxs("div",{ref:f,className:`absolute border-2 transition-all duration-200 ${n?"border-blue-500 shadow-lg shadow-blue-500/25":"border-gray-500 hover:border-gray-400"} ${a?"cursor-grabbing":"cursor-grab"}`,style:{left:t.position.x,top:t.position.y,width:t.size.width,height:t.size.height,display:t.visible?"block":"none"},onMouseDown:m,children:[n&&o.jsxs("div",{className:"absolute -top-8 left-0 flex items-center space-x-1 bg-gray-800 px-2 py-1 rounded text-xs",children:[o.jsx("div",{className:"drag-handle cursor-move text-gray-300 hover:text-white",children:o.jsx(Qz,{size:12})}),o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>e({visible:!t.visible}),className:"p-1 h-auto text-gray-300 hover:text-white",children:t.visible?o.jsx(Ga,{size:12}):o.jsx(N_,{size:12})}),o.jsx(J,{variant:"ghost",size:"sm",onClick:r,className:"p-1 h-auto text-red-400 hover:text-red-300",children:o.jsx(qr,{size:12})})]}),o.jsx("div",{className:"w-full h-full overflow-hidden",children:i}),n&&o.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-blue-500 cursor-nw-resize",onMouseDown:b})]})},Wre=({formationId:t,lessonId:e,lesson:r,onClose:n})=>{const[s,i]=y.useState(!1),[a,l]=y.useState(!1),[c,u]=y.useState(null),{scenes:d,activeScene:h,switchToScene:f,createScene:m,addElementToScene:p,updateElement:v,removeElement:b}=Dre(),{cameraEnabled:x,micEnabled:w,videoRef:_,toggleCamera:S,toggleMic:N,startScreenShare:E}=Fre(),{pendingSubmissions:P,acceptSubmission:A,rejectSubmission:F}=Ire(),{startLiveSession:Y,endLiveSession:T}=zre(t),O=async()=>{i(!0),await Y(e)||i(!1)},U=async()=>{i(!1),await T()},q=Z=>{h&&p(h.id,{type:Z,position:{x:100,y:100},size:{width:300,height:200},visible:!0})};return o.jsxs("div",{className:"h-screen bg-gray-900 text-white flex flex-col",children:[o.jsxs("div",{className:"bg-gray-800 p-4 flex items-center justify-between border-b border-gray-700",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("h1",{className:"text-xl font-bold",children:"Studio d'Enseignement"}),o.jsx("span",{className:"text-sm text-gray-300",children:r.title})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(J,{variant:s?"destructive":"default",size:"sm",onClick:s?U:O,className:"flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 text-white",children:[s?o.jsx(nc,{size:16}):o.jsx(oa,{size:16}),o.jsxs("span",{children:[s?"Arrêter":"Commencer"," le Direct"]})]}),o.jsx(J,{variant:"outline",size:"sm",onClick:()=>l(!a),className:"bg-blue-500 hover:bg-blue-600 text-white",children:o.jsx(L_,{size:16})}),o.jsx(J,{variant:"outline",size:"sm",onClick:n,className:"bg-blue-500 hover:bg-blue-600 text-white",children:"Fermer"})]})]}),o.jsxs("div",{className:"flex-1 flex",children:[o.jsxs("div",{className:"w-80 bg-gray-800 border-r border-gray-700 flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-gray-700",children:[o.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Contrôles Média"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(J,{variant:x?"default":"outline",size:"sm",onClick:S,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white",children:[x?o.jsx(tc,{size:16}):o.jsx(Sz,{size:16}),"Caméra"]}),o.jsxs(J,{variant:w?"default":"outline",size:"sm",onClick:N,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white",children:[w?o.jsx(ax,{size:16}):o.jsx(Gz,{size:16}),"Micro"]}),o.jsx(J,{variant:"outline",size:"sm",onClick:E,className:"bg-blue-500 hover:bg-blue-600 text-white",children:o.jsx(Kz,{size:16})})]})]}),o.jsxs("div",{className:"p-4 border-b border-gray-700",children:[o.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Scènes"}),o.jsx($re,{scenes:d,activeSceneId:(h==null?void 0:h.id)||"",onSceneSelect:f,onCreateScene:m})]}),o.jsxs("div",{className:"p-4 border-b border-gray-700",children:[o.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Ajouter un élément"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>q("camera"),className:"text-xs bg-blue-500 hover:bg-blue-600 text-white",children:[o.jsx(tc,{size:14,className:"mr-1"}),"Caméra"]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>q("whiteboard"),className:"text-xs bg-blue-500 hover:bg-blue-600 text-white",children:[o.jsx(ls,{size:14,className:"mr-1"}),"Tableau"]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>q("notes"),className:"text-xs bg-blue-500 hover:bg-blue-600 text-white",children:[o.jsx(ls,{size:14,className:"mr-1"}),"Notes"]}),o.jsxs(J,{variant:"outline",size:"sm",onClick:()=>q("document"),className:"text-xs bg-blue-500 hover:bg-blue-600 text-white",children:[o.jsx(ls,{size:14,className:"mr-1"}),"Document"]})]})]}),o.jsxs("div",{className:"flex-1 p-4",children:[o.jsxs("h3",{className:"text-sm font-semibold mb-3",children:["Soumissions des élèves (",P.length,")"]}),o.jsx(Ure,{submissions:P,onAccept:A,onReject:F})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col",children:[o.jsx("div",{className:"flex-1 bg-black relative overflow-hidden",children:o.jsxs("div",{className:"absolute inset-4 border-2 border-gray-600 rounded",children:[s&&o.jsx("div",{className:"absolute top-2 right-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold",children:"🔴 EN DIRECT"}),h==null?void 0:h.elements.map(Z=>o.jsxs(Vre,{element:Z,isSelected:c===Z.id,onSelect:()=>u(Z.id),onUpdate:H=>v(h.id,Z.id,H),onRemove:()=>b(h.id,Z.id),children:[Z.type==="camera"&&x&&o.jsx("video",{ref:_,autoPlay:!0,muted:!0,className:"w-full h-full object-cover rounded"}),Z.type==="whiteboard"&&o.jsx(Bre,{}),Z.type==="notes"&&o.jsx(qre,{}),Z.type==="document"&&o.jsx("div",{className:"w-full h-full bg-white text-black p-2 rounded",children:o.jsx("div",{className:"text-sm",children:"Document partagé"})})]},Z.id)),(!(h!=null&&h.elements)||h.elements.length===0)&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-4xl mb-4",children:"🎬"}),o.jsx("div",{children:"Ajoutez des éléments à votre scène"}),o.jsx("div",{className:"text-sm mt-2",children:"Cliquez sur les boutons à gauche pour ajouter des éléments"})]})}),o.jsx("div",{className:"absolute inset-0 -z-10",onClick:()=>u(null)})]})}),o.jsx("div",{className:"bg-gray-800 p-2 border-t border-gray-700",children:o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("span",{children:["Scène: ",(h==null?void 0:h.name)||"Aucune"]}),o.jsx("span",{children:"Résolution: 1920x1080"}),o.jsx("span",{children:"FPS: 30"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${s?"bg-red-500":"bg-gray-500"}`}),o.jsx("span",{children:s?"Streaming actif":"Hors ligne"})]})]})})]})]})]})},Hre=(t,e,r)=>{const{user:n}=st();return Nt({queryKey:["teacher-student-messages",t,e,r,n==null?void 0:n.id],queryFn:async()=>{if(!t||!e||!(n!=null&&n.id))return[];console.log("Fetching teacher-student messages for:",{formationId:t,studentId:e,lessonId:r,teacherId:n.id});const{data:s}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",n.id).eq("teacher_formations.formation_id",t).single();if(!s)return console.error("User is not a teacher for this formation"),[];let i=ae.from("lesson_messages").select(`
          *,
          profiles!sender_id(
            id,
            first_name,
            last_name,
            username,
            avatar_url,
            is_teacher
          )
        `).eq("formation_id",t).or(`sender_id.eq.${e},receiver_id.eq.${e},is_system_message.eq.true`);r&&(i=i.eq("lesson_id",r),console.log("Filtering messages by lesson_id:",r));const{data:a,error:l}=await i.order("created_at",{ascending:!0});return l?(console.error("Error fetching teacher-student messages:",l),[]):(console.log("Teacher-student messages found:",(a==null?void 0:a.length)||0),a||[])},enabled:!!t&&!!e&&!!(n!=null&&n.id),refetchInterval:!1})},Gre=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async({formationId:r,studentId:n,lessonId:s,content:i,messageType:a="text",fileUrl:l,fileType:c,fileName:u})=>{if(!(e!=null&&e.id))throw new Error("User not authenticated");if(!s)throw new Error("lesson_id is required");console.log("Sending teacher-student message:",{formationId:r,studentId:n,lessonId:s,content:i,messageType:a});const{data:d}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",r).single();if(!d)throw new Error("User is not a teacher for this formation");const h={lesson_id:s,formation_id:r,sender_id:e.id,receiver_id:n,content:i,message_type:a};l&&(h.file_url=l),c&&(h.file_type=c),u&&(h.file_name=u);const{data:f,error:m}=await ae.from("lesson_messages").insert(h).select().single();if(m)throw console.error("Error sending teacher-student message:",m),m;return console.log("Teacher-student message sent:",f),f},onSuccess:r=>{t.invalidateQueries({queryKey:["teacher-student-messages",r.formation_id,r.receiver_id]}),t.invalidateQueries({queryKey:["teacher-discussions-with-unread",r.formation_id]}),t.invalidateQueries({queryKey:["student-messages",r.lesson_id,r.formation_id]})}})},Yre=({formation:t,student:e,lesson:r,onBack:n})=>{var S,N,E;const s=y.useRef(null),i=y.useRef(null),a=y.useRef(null);st();const[l,c]=y.useState(!1),{data:u=[],isLoading:d}=Hre(t.id,e.user_id,r.id),{isSubscribed:h}=tS(r.id,t.id),f=rS(r.id,t.id),m=Gre(),p=p8(),v=jj();y.useEffect(()=>{var P;(P=s.current)==null||P.scrollIntoView({behavior:"smooth"}),u.length>0&&v.mutate({formationId:t.id,lessonId:r.id,studentId:e.user_id})},[u,t.id,r.id,e.user_id]),y.useEffect(()=>{console.log("TeacherStudentChat Debug:",{lessonId:r.id,formationId:t.id,studentId:e.user_id,messagesCount:u.length,isRealtimeSubscribed:h,typingUsersCount:f.length})},[r.id,t.id,e.user_id,u.length,h,f.length]);const b=(P,A="text",F)=>{e.user_id&&r.id&&m.mutate({formationId:t.id,studentId:e.user_id,lessonId:r.id,content:P,messageType:A,fileUrl:F==null?void 0:F.fileUrl,fileType:F==null?void 0:F.fileType,fileName:F==null?void 0:F.fileName})},x=async(P,A,F)=>{try{await p.mutateAsync({messageId:P,userId:e.user_id,lessonId:r.id,formationId:t.id,isValid:A,rejectReason:F})}catch(Y){console.error("Error validating exercise:",Y)}},w=()=>{var P;(P=i.current)==null||P.scrollIntoView({behavior:"smooth",block:"start"})},_=()=>{var P;(P=a.current)==null||P.scrollIntoView({behavior:"smooth",block:"end"})};return d?o.jsx("div",{className:"min-h-screen bg-[#e5ddd5] flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:"Chargement..."}),o.jsx("p",{className:"text-gray-600",children:"Récupération des messages"})]})}):l?o.jsx(Wre,{formationId:t.id,lessonId:r.id,lesson:r,onClose:()=>c(!1)}):o.jsxs("div",{className:"min-h-screen bg-[#e5ddd5] flex flex-col pb-24 md:pb-4 md:pt-16 relative",children:[o.jsx(Mre,{formation:t,student:e,lesson:r,isSubscribed:h,typingUsersCount:f.length,onBack:n,onOpenStudio:()=>c(!0)}),o.jsx("div",{ref:i,className:"bg-black",children:o.jsx(Np,{url:`https://example.com/lesson-${r.id}.mp4`,className:"w-full aspect-video"})}),o.jsx("div",{className:"relative -mt-3 -mb-3 z-20 flex justify-center",children:o.jsx(X_,{onScrollToVideo:w,onScrollToMessages:_})}),o.jsxs("div",{ref:a,className:"flex-1 p-4 space-y-4 custom-scrollbar overflow-y-auto",children:[o.jsx("div",{className:"text-center",children:o.jsxs("span",{className:"bg-[#dcf8c6] text-gray-700 px-3 py-2 rounded-lg text-sm shadow-sm",children:["Discussion avec ",((S=e.profiles)==null?void 0:S.first_name)||"Étudiant"," - ",r.title]})}),u&&u.length>0?u.map(P=>o.jsx("div",{className:"message-appear",children:o.jsx(g8,{message:P,isTeacher:!0,onValidateExercise:(A,F)=>x(A,F)})},P.id)):o.jsx("div",{className:"text-center text-gray-500 py-8",children:o.jsx("p",{children:"Aucun message pour le moment"})}),f.map(P=>o.jsx(v8,{userName:P.user_name,isTeacher:P.is_teacher},P.user_id)),o.jsx("div",{ref:s})]}),o.jsx(Rre,{lessonId:r.id,formationId:t.id,studentId:e.user_id,studentName:((N=e.profiles)==null?void 0:N.first_name)||((E=e.profiles)==null?void 0:E.username)||"Étudiant"}),o.jsx(h8,{onSendMessage:b,disabled:m.isPending,lessonId:r.id,formationId:t.id})]})},Xre=t=>{const{user:e}=st();return Nt({queryKey:["unread-messages-badge",t,e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return 0;const{data:r}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            formation_id
          )
        `).eq("user_id",e.id).eq("teacher_formations.formation_id",t).single();if(!r)return 0;const{data:n,error:s}=await ae.from("lesson_messages").select("id",{count:"exact"}).eq("formation_id",t).not("read_by_teachers","cs",`{${e.id}}`).neq("sender_id",e.id);return s?(console.error("Error counting unread messages:",s),0):(n==null?void 0:n.length)||0},enabled:!!(e!=null&&e.id)&&!!t,refetchInterval:1e4})},y8=({formation:t,onBack:e})=>{const[r,n]=y.useState(null),[s,i]=y.useState(!1),{data:a=0}=Xre(t.id),l=(c,u,d,h,f)=>{n({studentId:c,lessonId:u,studentName:d,lessonTitle:h,studentProfile:f})};return r?o.jsx(Yre,{formation:t,student:{id:r.studentId,user_id:r.studentId,profiles:r.studentProfile},lesson:{id:r.lessonId,title:r.lessonTitle},onBack:()=>n(null)}):o.jsxs("div",{className:"min-h-screen bg-[#e5ddd5] pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{className:"bg-[#25d366] text-white sticky top-0 md:top-16 z-40",children:o.jsxs("div",{className:"flex items-center p-4",children:[o.jsx("button",{onClick:e,className:"mr-3 p-2 hover:bg-white/10 rounded-full transition-colors",children:o.jsx(Za,{size:20})}),o.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3",children:o.jsx("span",{className:"text-white font-bold text-sm",children:"👨‍🏫"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:"font-semibold text-lg",children:t.title}),o.jsx("p",{className:"text-sm text-white/80",children:"Vue Professeur • Discussions par leçon"})]}),a>0&&o.jsx(yr,{variant:"destructive",className:"ml-2",children:a>99?"99+":a})]})}),o.jsxs("div",{className:"bg-white p-4 border-b border-gray-200",children:[o.jsx("div",{className:"flex space-x-3",children:o.jsxs("button",{onClick:()=>i(!s),className:"flex items-center space-x-2 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:[o.jsx(oa,{size:16}),o.jsx("span",{children:"Aperçu Formation"})]})}),s&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Aperçu de la formation"}),o.jsx(Np,{url:""})]})]}),o.jsxs("div",{className:"bg-blue-50 p-4 border-b border-blue-200",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Zs,{size:16,className:"text-blue-600"}),o.jsx("h3",{className:"font-semibold text-blue-800",children:"Discussions organisées par leçon"}),a>0&&o.jsxs(yr,{variant:"destructive",className:"text-xs",children:[a," non lu",a>1?"s":""]})]}),o.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[o.jsx("p",{children:"• Les discussions avec messages non lus apparaissent en priorité"}),o.jsx("p",{children:"• Les badges rouges indiquent le nombre de messages non lus"}),o.jsx("p",{children:"• Cliquez sur une discussion pour la marquer comme lue automatiquement"})]})]}),o.jsx(Ore,{formationId:t.id,onSelectDiscussion:l})]})},Kre=({title:t,subtitle:e})=>o.jsx("div",{className:"bg-white shadow-sm sticky top-0 md:top-16 z-30",children:o.jsxs("div",{className:"p-4",children:[o.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:t}),o.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:e})]})}),Qre=({formation:t,isTeacherSection:e=!1,onClick:r})=>o.jsxs("div",{onClick:()=>r(t),className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer overflow-hidden",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-full h-32 sm:h-48 bg-gradient-to-br from-[#25d366]/10 to-[#20c75a]/10 flex items-center justify-center",children:t.image_url||t.thumbnail_url?o.jsx("img",{src:t.image_url||t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover"}):o.jsx(oa,{size:32,className:"text-[#25d366] sm:w-10 sm:h-10"})}),o.jsx("div",{className:"absolute top-2 right-2 bg-black/50 text-white px-2 py-1 rounded text-xs",children:e?`${t.students} élèves`:`${t.progress||0}% complété`}),e&&o.jsx("div",{className:"absolute top-2 left-2 bg-[#25d366] text-white px-2 py-1 rounded text-xs",children:"👨‍🏫 Professeur"})]}),o.jsxs("div",{className:"p-3 sm:p-4",children:[o.jsx("h3",{className:"font-semibold text-base sm:text-lg mb-2 line-clamp-2",children:t.title}),o.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Par ",t.author||"Auteur inconnu"]}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(pa,{size:14}),o.jsxs("span",{className:"text-xs sm:text-sm",children:[t.students," étudiants"]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(yc,{size:14,className:"text-yellow-400 fill-current"}),o.jsx("span",{className:"text-xs sm:text-sm",children:t.rating})]})]}),!e&&t.progress!==void 0&&o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-[#25d366] h-2 rounded-full transition-all duration-300",style:{width:`${t.progress}%`}})})]})]}),N4=({title:t,icon:e,formations:r,isTeacherSection:n,onFormationClick:s,emptyMessage:i,debugInfo:a})=>{const l=e==="student"?k_:WP;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsx(l,{size:20,className:"text-[#25d366]"}),o.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:t})]}),r.length>0?o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(c=>o.jsx(Qre,{formation:{...c,author:c.profiles&&(`${c.profiles.first_name||""} ${c.profiles.last_name||""}`.trim()||c.profiles.username)||"Auteur inconnu",students:c.students_count||0,rating:c.rating||0},isTeacherSection:n,onClick:s},`${n?"teacher":"student"}-${c.id}`))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-gray-500",children:i}),a&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a})]})]})},Jre=t=>{const{user:e}=st();return Nt({queryKey:["lesson-unlocking",t,e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return[];console.log("Fetching lesson unlocking status for formation:",t);const{data:r,error:n}=await ae.from("user_lesson_progress").select(`
          lesson_id,
          status,
          exercise_completed,
          completed_at,
          lessons!inner(
            id,
            title,
            level_id,
            order_index,
            levels!inner(
              formation_id
            )
          )
        `).eq("user_id",e.id).eq("lessons.levels.formation_id",t);return n?(console.error("Error fetching user lesson progress:",n),[]):(console.log("User lesson progress:",r),r||[])},enabled:!!(e!=null&&e.id)&&!!t})},Zre=t=>{const{user:e}=st();return Nt({queryKey:["unread-messages-by-level",t,e==null?void 0:e.id],queryFn:async()=>{if(!(e!=null&&e.id)||!t)return{};const{data:r}=await ae.from("teachers").select("id").eq("user_id",e.id).maybeSingle(),{data:n}=await ae.from("enrollment_requests").select("id").eq("user_id",e.id).eq("formation_id",t).eq("status","approved").maybeSingle();if(!r&&!n)return{};const{data:s}=await ae.from("levels").select(`
          id,
          title,
          lessons (
            id,
            title
          )
        `).eq("formation_id",t).order("order_index",{ascending:!0});if(!s)return{};const i={};for(const a of s){let l=0;const c={};if(a.lessons)for(const u of a.lessons){let d=0;if(r){const{count:h}=await ae.from("lesson_messages").select("*",{count:"exact",head:!0}).eq("formation_id",t).eq("lesson_id",u.id).not("read_by_teachers","cs",`{${e.id}}`).neq("sender_id",e.id);d=h||0}else if(n){const{count:h}=await ae.from("lesson_messages").select("*",{count:"exact",head:!0}).eq("formation_id",t).eq("lesson_id",u.id).eq("receiver_id",e.id).eq("is_read",!1).eq("is_system_message",!0);d=h||0}c[u.id]=d,l+=d}i[a.id]={level:l,lessons:c}}return i},enabled:!!(e!=null&&e.id)&&!!t,refetchInterval:1e4})},ene=({levels:t,formationId:e,onLessonClick:r})=>{const[n,s]=y.useState([]),{data:i=[]}=Jre(e),{data:a={}}=Zre(e),l=p=>{s(v=>v.includes(p)?v.filter(b=>b!==p):[...v,p])},c=p=>i.some(v=>v.lesson_id===p.toString()),u=p=>{const v=i.find(b=>b.lesson_id===p.toString());return v?v.status:"locked"},d=p=>{switch(u(p)){case"completed":return o.jsx(rc,{size:16,className:"text-green-500"});case"not_started":case"in_progress":case"awaiting_review":return o.jsx(Js,{size:16,className:"text-blue-500"});default:return o.jsx(IP,{size:16,className:"text-gray-400"})}},h=p=>{var v;return((v=a[p.toString()])==null?void 0:v.level)||0},f=(p,v)=>{var b;return((b=a[p.toString()])==null?void 0:b.lessons[v.toString()])||0},m=[...t].sort((p,v)=>p.order_index-v.order_index);return o.jsx("div",{className:"space-y-2 bg-[#e5ddd5] p-4",children:m.map(p=>{const v=p.lessons?[...p.lessons].sort((b,x)=>b.order_index-x.order_index):[];return o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#f0f0f0] hover:bg-[#e8e8e8] cursor-pointer border-b border-gray-200",onClick:()=>l(p.id.toString()),children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[n.includes(p.id.toString())?o.jsx($a,{size:20,className:"text-[#25d366]"}):o.jsx(OP,{size:20,className:"text-[#25d366]"}),o.jsx("div",{className:"w-10 h-10 bg-[#25d366] rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold text-sm",children:"📚"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:p.title}),o.jsxs("p",{className:"text-sm text-gray-500",children:[v.length||0," leçon",v.length!==1?"s":""]})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:h(p.id)>0&&o.jsx(yr,{variant:"destructive",className:"bg-red-500 text-white rounded-full px-2 py-1 text-xs font-bold min-w-[20px] h-5 flex items-center justify-center",children:h(p.id)>99?"99+":h(p.id)})})]}),n.includes(p.id.toString())&&o.jsx("div",{className:"bg-white",children:v.map((b,x)=>o.jsxs("div",{className:`flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors cursor-pointer
                      ${x!==v.length-1?"border-b border-gray-100":""}
                      ${c(b.id)?"":"opacity-60"}
                    `,onClick:()=>c(b.id)&&r(b),children:[o.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:d(b.id)}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:`font-medium truncate ${c(b.id)?"text-gray-800":"text-gray-500"}`,children:b.title}),o.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[f(p.id,b.id)>0&&o.jsx(yr,{variant:"destructive",className:"bg-red-500 text-white rounded-full px-2 py-1 text-xs font-bold min-w-[20px] h-5 flex items-center justify-center",children:f(p.id,b.id)>99?"99+":f(p.id,b.id)}),f(p.id,b.id)>0&&o.jsx(Zs,{size:14,className:"text-red-500"})]})]}),o.jsxs("div",{className:"flex items-center justify-between mt-1",children:[o.jsx("p",{className:"text-xs text-gray-500 truncate",children:u(b.id)==="completed"?"✅ Terminée":u(b.id)==="in_progress"?"⏳ En cours":u(b.id)==="awaiting_review"?"⏳ En attente":c(b.id)?"📖 Disponible":"🔒 Verrouillée"}),o.jsx("span",{className:"text-xs text-gray-400",children:f(p.id,b.id)>0?"Nouveau":""})]})]})]}),o.jsx(J,{variant:c(b.id)?"default":"secondary",size:"sm",disabled:!c(b.id),className:`ml-3 ${c(b.id)?"bg-[#25d366] hover:bg-[#20c55a] text-white":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,onClick:w=>{w.stopPropagation(),c(b.id)&&r(b)},children:c(b.id)?o.jsxs(o.Fragment,{children:[o.jsx(oa,{size:14,className:"mr-1"}),"Ouvrir"]}):"🔒 Verrouillé"})]},b.id))})]},p.id)})})},tne=({formation:t,onBack:e,onLessonClick:r})=>{const{data:n}=xO(t.id.toString());return y.useEffect(()=>{window.location.hash==="#pricing"&&setTimeout(()=>{const s=document.getElementById("pricing");s&&s.scrollIntoView({behavior:"smooth"})},100)},[]),(n==null?void 0:n.role)==="teacher"?o.jsx(y8,{formation:{id:t.id.toString(),title:t.title,author:t.author},onBack:e}):o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{className:"bg-[#25d366] text-white sticky top-0 md:top-16 z-40 shadow-md",children:o.jsxs("div",{className:"flex items-center p-4",children:[o.jsx("button",{onClick:e,className:"mr-3 p-2 hover:bg-white/20 rounded-full transition-colors",children:o.jsx(Za,{size:20,className:"text-white"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:"font-bold text-lg text-white mb-1",children:t.title}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-green-100",children:[t.rating&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(yc,{size:14,className:"text-yellow-300 mr-1"}),o.jsx("span",{children:t.rating})]}),t.students_count&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(pa,{size:14,className:"mr-1"}),o.jsxs("span",{children:[t.students_count," étudiants"]})]}),t.duration_hours&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Js,{size:14,className:"mr-1"}),o.jsxs("span",{children:[t.duration_hours,"h"]})]})]})]})]})}),t.description&&o.jsx("div",{className:"bg-white p-4 mb-2 shadow-sm",children:o.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:t.description})}),o.jsx(ene,{levels:t.levels,formationId:t.id.toString(),onLessonClick:r})]})},k4=({message:t,subtitle:e})=>o.jsx("div",{className:"min-h-screen bg-gray-50 pb-24 md:pt-16 md:pb-4 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",children:t}),e&&o.jsx("p",{className:"text-gray-600",children:e})]})}),rne=()=>Nt({queryKey:["formations"],queryFn:async()=>{console.log("Fetching formations...");const{data:t,error:e}=await ae.from("formations").select(`
          *,
          profiles:author_id (
            id,
            first_name,
            last_name,
            username
          )
        `);if(e)throw console.error("Error fetching formations:",e),e;return console.log("Formations fetched:",t),t||[]}}),b8=t=>Nt({queryKey:["user-enrollments",t],queryFn:async()=>{if(!t)return console.log("No user ID provided for enrollments"),[];console.log("Fetching user enrollments for:",t);try{const{data:e,error:r}=await ae.from("enrollment_requests").select("formation_id, created_at, status").eq("user_id",t).eq("status","approved");if(r)throw console.error("Error fetching enrollment requests:",r),r;if(console.log("Enrollment requests found:",e),!e||e.length===0)return console.log("No approved enrollments found for user:",t),[];const n=e.map(l=>l.formation_id),{data:s,error:i}=await ae.from("formations").select(`
            *,
            profiles:author_id (
              id,
              first_name,
              last_name,
              username
            ),
            levels (
              *,
              lessons (
                *,
                exercises!exercises_lesson_id_fkey (
                  id,
                  title,
                  description,
                  content,
                  type
                )
              )
            )
          `).in("id",n).eq("is_active",!0);if(i)throw console.error("Error fetching formations details:",i),i;console.log("Formations details fetched:",s);const a=e.map(l=>{const c=s==null?void 0:s.find(u=>u.id===l.formation_id);return{...l,formations:c}}).filter(l=>l.formations);return console.log("Final enriched enrollments:",a),a}catch(e){return console.error("Complete error in useUserEnrollments:",e),[]}},enabled:!!t,retry:3,retryDelay:1e3}),nne=t=>Nt({queryKey:["teacher-formations",t],queryFn:async()=>{if(!t)return[];const{data:e,error:r}=await ae.from("teachers").select(`
          id,
          teacher_formations!inner (
            assigned_at,
            formations (
              *,
              profiles:author_id (
                first_name,
                last_name,
                username
              )
            )
          )
        `).eq("user_id",t);return r?(console.error("Error fetching teacher formations:",r),[]):!e||!Array.isArray(e)?[]:e.flatMap(n=>{var s;return((s=n.teacher_formations)==null?void 0:s.map(i=>({...i.formations,isTeacher:!0,assigned_at:i.assigned_at,students_count:0})))||[]})},enabled:!!t}),sne=()=>{const[t,e]=y.useState(null),[r,n]=y.useState(null),{user:s,loading:i}=st(),a=Mn(),{data:l,isLoading:c}=rne(),{data:u,isLoading:d,error:h}=b8(s==null?void 0:s.id),{data:f,isLoading:m}=nne(s==null?void 0:s.id);if(y.useEffect(()=>{(async()=>{if(console.log("=== DEBUG COURS PAGE ==="),console.log("User:",s),console.log("User ID:",s==null?void 0:s.id),console.log("User enrollments loading:",d),console.log("User enrollments data:",u),console.log("User enrollments error:",h),console.log("Teacher formations:",f),s!=null&&s.id){console.log("Testing Supabase connection...");try{const w=await ae.from("enrollment_requests").select("*").eq("user_id",s.id).limit(1);console.log("Direct Supabase test result:",w)}catch(w){console.error("Direct Supabase test error:",w)}}console.log("========================")})()},[s,u,d,h,f]),y.useEffect(()=>{if(!i&&!s){a("/auth");return}},[s,i,a]),i)return o.jsx(k4,{message:"Vérification de la connexion...",subtitle:"Veuillez patienter"});if(!s)return null;if(r)return o.jsx(Pre,{lesson:r,formation:t,onBack:()=>n(null)});if(t&&t.isTeacher)return o.jsx(y8,{formation:t,onBack:()=>e(null)});if(t)return o.jsx(tne,{formation:t,onBack:()=>e(null),onLessonClick:n});if(c||d||m)return o.jsx(k4,{message:"Chargement...",subtitle:"Récupération de vos formations"});const v=(u==null?void 0:u.map(x=>{const w=x.formations;return w?{...w,progress:0,isTeacher:!1}:null}).filter(Boolean))||[];console.log("Student formations processed:",v);const b=`User ID: ${s==null?void 0:s.id} | Enrollments: ${(u==null?void 0:u.length)||0} | Error: ${h?"YES - "+h.message:"NO"} | Loading: ${d}`;return o.jsxs("div",{className:"bg-gray-50 pt-16 pb-24 md:pb-4",children:[o.jsx(Kre,{title:"Mes Formations",subtitle:"Continuez votre apprentissage"}),o.jsxs("div",{className:"p-4 space-y-6 pt-16",children:[o.jsx(N4,{title:"Mes cours suivis",icon:"student",formations:v,isTeacherSection:!1,onFormationClick:e,emptyMessage:"Vous n'êtes inscrit à aucune formation",debugInfo:b}),f&&f.length>0&&o.jsx(N4,{title:"Espace enseignant",icon:"teacher",formations:f,isTeacherSection:!0,onFormationClick:e})]})]})},ine="4c32c988-3b19-4eca-87cb-0e0595fd7fbb",ane=()=>{const{user:t}=st();return Nt({queryKey:["conversations",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id))return[];console.log("Fetching conversations for user:",t.id);const[e,r,n]=await Promise.all([ae.from("teachers").select(`
            id,
            teacher_formations!inner (
              formation_id,
              formations (
                id,
                title,
                description
              )
            )
          `).eq("user_id",t.id),ae.from("enrollment_requests").select(`
            formation_id,
            formations:formation_id (
              id,
              title,
              description,
              profiles:author_id (
                first_name,
                last_name,
                username
              )
            )
          `).eq("user_id",t.id).eq("status","approved"),ae.from("story_conversations").select(`
            id,
            story_id,
            participant1_id,
            participant2_id,
            last_message_at,
            user_stories:story_id (
              content_text,
              media_url,
              content_type
            )
          `).or(`participant1_id.eq.${t.id},participant2_id.eq.${t.id}`).order("last_message_at",{ascending:!1})]),s=[];if(e.data)for(const i of e.data)for(const a of i.teacher_formations)a.formations&&s.push({id:`teacher-${a.formations.id}`,name:`${a.formations.title} - Groupe`,lastMessage:"Formation dont vous êtes professeur",timestamp:"Aujourd'hui",unread:0,avatar:"👨‍🏫",online:!1,type:"formation_teacher",formationId:a.formations.id});if(r.data){for(const i of r.data)if(i.formations){const a=i.formations.profiles?`${i.formations.profiles.first_name||""} ${i.formations.profiles.last_name||""}`.trim()||i.formations.profiles.username:"Professeur";s.push({id:`student-${i.formations.id}`,name:`${i.formations.title}`,lastMessage:`Formation avec ${a}`,timestamp:"Aujourd'hui",unread:0,avatar:"📚",online:!1,type:"formation_student",formationId:i.formations.id})}}if(n.data){const i=n.data.flatMap(f=>[f.participant1_id,f.participant2_id]),a=[...new Set(i)],{data:l}=await ae.from("profiles").select("id, first_name, last_name, username, avatar_url").in("id",a),c=new Map;l&&l.forEach(f=>{c.set(f.id,f)});const u=n.data.map(f=>f.id),{data:d}=await ae.from("story_messages").select("conversation_id, content, created_at").in("conversation_id",u).order("created_at",{ascending:!1}),h=new Map;d&&d.forEach(f=>{h.has(f.conversation_id)||h.set(f.conversation_id,[]),h.get(f.conversation_id).push(f)});for(const f of n.data){const m=f.participant1_id===t.id?f.participant2_id:f.participant1_id;if(m===ine)continue;const p=c.get(m),v=p&&(`${p.first_name||""} ${p.last_name||""}`.trim()||p.username)||"Utilisateur";let b="Réponse à une story";const x=h.get(f.id);if(x&&x.length>0){const w=x[0];b=w.content.substring(0,50)+(w.content.length>50?"...":"")}else if(f.user_stories){const w=f.user_stories;w.content_type==="text"&&w.content_text?b=`Story: ${w.content_text.substring(0,30)}...`:b="Story partagée"}s.push({id:`story-${f.id}`,name:v,lastMessage:b,timestamp:new Date(f.last_message_at).toLocaleDateString(),unread:0,avatar:(p==null?void 0:p.avatar_url)||"💬",online:!1,type:"story_conversation",conversationId:f.id})}}return console.log("Fetched conversations:",s),s},enabled:!!(t!=null&&t.id)})},w8=()=>{const{user:t}=st(),e=br(),{data:r=[],isLoading:n}=Nt({queryKey:["notifications",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id))return[];const{data:a,error:l}=await ae.from("notifications").select("*").or(`user_id.eq.${t.id},is_for_all_admins.eq.true`).order("created_at",{ascending:!1});return l?(console.error("Error fetching notifications:",l),[]):a?await Promise.all(a.map(async u=>{if(u.enrollment_id&&u.is_for_all_admins)try{const{data:d,error:h}=await ae.from("enrollment_requests").select("user_id, formation_id").eq("id",u.enrollment_id).single();if(!h&&d){const{data:f,error:m}=await ae.from("profiles").select("id, first_name, last_name, email, username, phone, avatar_url").eq("id",d.user_id).single(),{data:p,error:v}=await ae.from("formations").select("title, image_url").eq("id",d.formation_id).single();return{...u,user_info:m?null:f,formation_info:v?null:p}}}catch(d){console.error("Error fetching enrollment details:",d)}if(u.type==="plan_change_request"&&u.user_id&&u.formation_id)try{const{data:d,error:h}=await ae.from("profiles").select("id, first_name, last_name, email, username, phone, avatar_url").eq("id",u.user_id).single(),{data:f,error:m}=await ae.from("formations").select("title, image_url").eq("id",u.formation_id).single();return{...u,user_info:h?null:d,formation_info:m?null:f}}catch(d){console.error("Error fetching plan change details:",d)}return u})):[]},enabled:!!(t!=null&&t.id)}),s=Vt({mutationFn:async({enrollmentId:a,action:l,reason:c})=>{console.log("Handling enrollment:",{enrollmentId:a,action:l,reason:c});const u={status:l,updated_at:new Date().toISOString()};l==="rejected"&&c&&(u.rejected_reason=c);const{error:d}=await ae.from("enrollment_requests").update(u).eq("id",a);if(d)throw console.error("Error updating enrollment:",d),d;return console.log("Enrollment updated successfully"),{success:!0}},onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]}),e.invalidateQueries({queryKey:["enrollment-requests"]}),e.invalidateQueries({queryKey:["admin-enrollment-requests"]}),me.success("Demande d'inscription traitée avec succès")},onError:a=>{console.error("Error handling enrollment:",a),me.error("Erreur lors du traitement de la demande")}}),i=Vt({mutationFn:async a=>{const{error:l}=await ae.from("notifications").update({is_read:!0}).eq("id",a);if(l)throw l},onSuccess:()=>{e.invalidateQueries({queryKey:["notifications"]})}});return{notifications:r,isLoading:n,handleEnrollment:s.mutate,isHandlingEnrollment:s.isPending,markAsRead:i.mutate}},one=({enrollment:t,onApprove:e,isUpdating:r})=>{var b,x,w,_,S,N,E;const[n,s]=y.useState(""),[i,a]=y.useState(!1),[l,c]=y.useState(t.plan_type||"free"),u=()=>{switch(t.status){case"approved":return o.jsx(yr,{className:"bg-green-100 text-green-800 border-green-200",children:"Approuvé"});case"rejected":return o.jsx(yr,{className:"bg-red-100 text-red-800 border-red-200",children:"Rejeté"});default:return o.jsx(yr,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"En attente"})}},d=P=>{switch(P){case"free":return"Gratuit";case"standard":return"Standard";case"premium":return"Premium";default:return"Gratuit"}},h=P=>{switch(P){case"free":return"bg-gray-100 text-gray-800 border-gray-200";case"standard":return"bg-blue-100 text-blue-800 border-blue-200";case"premium":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},f=()=>{e({enrollmentId:t.id,status:"approved",rejectedReason:void 0,planType:l,userId:t.user_id,formationId:t.formation_id})},m=()=>{n.trim()&&e({enrollmentId:t.id,status:"rejected",rejectedReason:n})},p=()=>{console.log("Voir les détails de la demande:",t.id)},v=()=>{a(!0)};return o.jsxs(Mt,{className:"w-full shadow-sm hover:shadow-md transition-shadow",children:[o.jsx(er,{className:"pb-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(ur,{className:"text-lg flex items-center gap-2",children:[o.jsx(Js,{size:18}),"Demande d'inscription"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[u(),o.jsxs(J,{variant:"outline",size:"sm",onClick:p,className:"flex items-center gap-1",children:[o.jsx(Ga,{size:14}),"Voir"]})]})]})}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[o.jsxs(Uh,{className:"h-12 w-12",children:[o.jsx(Vh,{src:((b=t.profiles)==null?void 0:b.avatar_url)||"",alt:((x=t.profiles)==null?void 0:x.username)||"User"}),o.jsx(Wh,{children:o.jsx(Ya,{size:20})})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-semibold",children:(w=t.profiles)!=null&&w.first_name&&((_=t.profiles)!=null&&_.last_name)?`${t.profiles.first_name} ${t.profiles.last_name}`:((S=t.profiles)==null?void 0:S.username)||"Utilisateur inconnu"}),o.jsx("p",{className:"text-sm text-gray-600",children:(N=t.profiles)==null?void 0:N.email}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Demande créée le ",new Date(t.created_at).toLocaleDateString("fr-FR")]})]})]}),o.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-blue-900",children:"Formation demandée"}),o.jsx("p",{className:"text-sm text-blue-700",children:((E=t.formations)==null?void 0:E.title)||"Formation inconnue"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Plan demandé par l'étudiant:"}),o.jsx(yr,{className:h(t.plan_type||"free"),children:d(t.plan_type||"free")})]}),t.status==="pending"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Plan à approuver (Admin):"}),o.jsxs(Ka,{value:l,onValueChange:P=>c(P),children:[o.jsx(ua,{className:"w-full",children:o.jsx(Qa,{})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"free",children:"Gratuit"}),o.jsx(Ut,{value:"standard",children:"Standard"}),o.jsx(Ut,{value:"premium",children:"Premium"})]})]}),l!==t.plan_type&&o.jsx("p",{className:"text-xs text-orange-600",children:"⚠️ Vous approuvez un plan différent de celui demandé par l'étudiant"})]}),t.status==="approved"&&o.jsx("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:o.jsxs("p",{className:"text-sm text-green-800",children:[o.jsx("strong",{children:"Plan approuvé:"})," ",d(t.plan_type||"free")]})})]}),i&&t.status==="pending"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Raison du rejet:"}),o.jsx("textarea",{value:n,onChange:P=>s(P.target.value),className:"w-full p-3 border border-gray-300 rounded-md text-sm resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Expliquez pourquoi la demande est rejetée...",required:!0})]}),t.status==="pending"&&o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsxs(J,{onClick:f,disabled:r,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[o.jsx(vc,{size:16,className:"mr-2"}),r?"Approbation...":"Approuver"]}),i?o.jsxs(J,{onClick:m,disabled:r||!n.trim(),variant:"destructive",className:"flex-1",children:[o.jsx(Dh,{size:16,className:"mr-2"}),r?"Rejet...":"Confirmer le rejet"]}):o.jsxs(J,{onClick:v,disabled:r,variant:"destructive",className:"flex-1",children:[o.jsx(Dh,{size:16,className:"mr-2"}),"Rejeter"]})]})]})]})},lne=({notification:t})=>{const{handleEnrollment:e,isHandlingEnrollment:r}=w8();if(!t.user_info||!t.formation_info)return null;const n={id:t.enrollment_id,user_id:t.user_info.id,formation_id:"",status:"pending",created_at:t.created_at,profiles:{id:t.user_info.id,first_name:t.user_info.first_name,last_name:t.user_info.last_name,username:t.user_info.username,avatar_url:t.user_info.avatar_url,email:t.user_info.email},formations:{title:t.formation_info.title,image_url:t.formation_info.image_url}};return o.jsxs("div",{className:"relative mb-4",children:[o.jsx(one,{enrollment:n,onApprove:({enrollmentId:s,status:i,rejectedReason:a})=>{e({enrollmentId:s,action:i,reason:a})},isUpdating:r}),!t.is_read&&o.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 bg-blue-500 rounded-full"})]})},cne=({notification:t})=>{const e=s=>{switch(s){case"enrollment_request":case"enrollment":return o.jsx(uu,{size:16,className:"text-blue-600"});case"system":return o.jsx(uu,{size:16,className:"text-green-600"});default:return o.jsx(uu,{size:16,className:"text-purple-600"})}},r=s=>{switch(s){case"enrollment_request":case"enrollment":return"bg-blue-100";case"system":return"bg-green-100";default:return"bg-purple-100"}},n=tO(new Date(t.created_at),{addSuffix:!0,locale:Fm});return o.jsx("div",{className:`bg-white rounded-lg p-4 border ${t.is_read?"":"border-l-4 border-l-blue-500"}`,children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:`w-10 h-10 ${r(t.type)} rounded-full flex items-center justify-center`,children:e(t.type)}),o.jsx("div",{className:"flex-1",children:o.jsx("div",{className:"flex items-start justify-between",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-medium text-gray-900",children:t.title}),o.jsx("p",{className:"text-gray-600 text-sm mt-1",children:t.message}),o.jsxs("p",{className:"text-xs text-gray-400 mt-2 flex items-center",children:[o.jsx(Js,{size:12,className:"mr-1"}),n]})]})})}),!t.is_read&&o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})})},une=({notification:t})=>{var f,m;const[e,r]=y.useState(t.requested_plan_type),[n,s]=y.useState(!1),[i,a]=y.useState(""),l=br(),c=Vt({mutationFn:async({action:p,planType:v,reason:b})=>{var w,_;const{data:{user:x}}=await ae.auth.getUser();if(!x)throw new Error("Non authentifié");if(p==="approved"&&v){const{error:S}=await ae.from("enrollment_requests").update({plan_type:v}).eq("user_id",t.user_id).eq("formation_id",t.formation_id);if(S)throw S;const{error:N}=await ae.from("user_subscriptions").update({plan_type:v}).eq("user_id",t.user_id).eq("formation_id",t.formation_id);if(N)throw N;const{error:E}=await ae.from("notifications").update({is_read:!0,subscription_approved_by:x.id,subscription_plan_changed_by:x.id}).eq("id",t.id);if(E)throw E;const{error:P}=await ae.from("notifications").insert({user_id:t.user_id,formation_id:t.formation_id,type:"plan_change_approved",title:"Changement de plan approuvé 🎉",message:`Votre demande de changement de plan a été acceptée. Vous êtes maintenant abonné au plan "${v}" pour la formation "${((w=t.formation_info)==null?void 0:w.title)||"cette formation"}".`,is_read:!1});if(P)throw P}else if(p==="rejected"){const{error:S}=await ae.from("notifications").update({is_read:!0,message:t.message+`

❌ REJETÉE : ${b||"Aucune raison spécifiée"}`}).eq("id",t.id);if(S)throw S;const{error:N}=await ae.from("notifications").insert({user_id:t.user_id,formation_id:t.formation_id,type:"plan_change_rejected",title:"Changement de plan rejeté",message:`Votre demande de changement de plan pour la formation "${((_=t.formation_info)==null?void 0:_.title)||"cette formation"}" a été rejetée.${b?`

Raison : ${b}`:""}`,is_read:!1});if(N)throw N}return{success:!0}},onSuccess:()=>{l.invalidateQueries({queryKey:["notifications"]}),l.invalidateQueries({queryKey:["user-subscription"]}),me.success("Demande de changement traitée avec succès")},onError:p=>{console.error("Erreur lors du traitement:",p),me.error("Erreur lors du traitement de la demande")}}),u=p=>{switch(p){case"free":return"Gratuit";case"standard":return"Standard";case"premium":return"Premium";default:return p}},d=p=>{switch(p){case"free":return"bg-green-100 text-green-800";case"standard":return"bg-blue-100 text-blue-800";case"premium":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},h=t.user_info?`${t.user_info.first_name||""} ${t.user_info.last_name||""}`.trim():"Utilisateur inconnu";return o.jsxs(Mt,{className:"border-2 border-orange-200 bg-orange-50",children:[o.jsx(er,{className:"pb-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(ur,{className:"text-lg font-semibold text-orange-800 flex items-center gap-2",children:[o.jsx(P_,{className:"w-5 h-5"}),"Demande de changement de plan"]}),o.jsx(yr,{className:d(t.requested_plan_type),children:u(t.requested_plan_type)})]})}),o.jsxs(Rt,{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-white rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Ya,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:h}),((f=t.user_info)==null?void 0:f.phone)&&o.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[o.jsx(sf,{className:"w-3 h-3"}),t.user_info.phone]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx($o,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:((m=t.formation_info)==null?void 0:m.title)||"Formation"}),o.jsx("p",{className:"text-sm text-gray-600",children:new Date(t.created_at).toLocaleDateString("fr-FR")})]})]})]}),o.jsx("div",{className:"p-4 bg-white rounded-lg",children:o.jsx("p",{className:"text-sm whitespace-pre-line",children:t.message})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{htmlFor:"plan-selector",children:"Plan à approuver :"}),o.jsxs(Ka,{value:e,onValueChange:r,children:[o.jsx(ua,{children:o.jsx(Qa,{})}),o.jsxs(da,{children:[o.jsx(Ut,{value:"free",children:"Gratuit"}),o.jsx(Ut,{value:"standard",children:"Standard"}),o.jsx(Ut,{value:"premium",children:"Premium"})]})]})]}),n&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ke,{htmlFor:"rejection-reason",children:"Justification du rejet :"}),o.jsx(jr,{id:"rejection-reason",value:i,onChange:p=>a(p.target.value),placeholder:"Expliquez pourquoi cette demande est rejetée...",rows:3})]}),o.jsx("div",{className:"flex gap-3 pt-4",children:n?o.jsxs(o.Fragment,{children:[o.jsx(J,{onClick:()=>c.mutate({action:"rejected",reason:i}),disabled:c.isPending,variant:"destructive",className:"flex-1",children:"Confirmer le rejet"}),o.jsx(J,{onClick:()=>{s(!1),a("")},variant:"outline",className:"flex-1",children:"Annuler"})]}):o.jsxs(o.Fragment,{children:[o.jsxs(J,{onClick:()=>c.mutate({action:"approved",planType:e}),disabled:c.isPending,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[o.jsx(vc,{className:"w-4 h-4 mr-2"}),"Approuver"]}),o.jsxs(J,{onClick:()=>s(!0),variant:"destructive",className:"flex-1",children:[o.jsx(Dh,{className:"w-4 h-4 mr-2"}),"Rejeter"]})]})})]})]})},dne=({notification:t})=>{const{profile:e}=st(),r=(e==null?void 0:e.role)==="admin",n=t.type==="enrollment_request"&&t.enrollment_id&&t.is_for_all_admins&&r;return t.type==="plan_change_request"&&t.user_id&&t.formation_id&&t.requested_plan_type&&r&&t.user_info&&t.formation_info?o.jsx(une,{notification:{...t,user_id:t.user_id,formation_id:t.formation_id,requested_plan_type:t.requested_plan_type}}):n&&t.user_info&&t.formation_info?o.jsx(lne,{notification:t}):o.jsx(cne,{notification:t})},hne=()=>{const{user:t}=st();return Nt({queryKey:["stories"],queryFn:async()=>{console.log("Fetching stories...");const{data:e,error:r}=await ae.from("user_stories").select(`
          *,
          profiles!user_stories_user_id_fkey (
            id,
            first_name,
            last_name,
            username,
            avatar_url
          ),
          story_views (
            viewer_id,
            viewed_at
          )
        `).eq("is_active",!0).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});return r?(console.error("Error fetching stories:",r),[]):(console.log("Stories fetched successfully:",e),(e||[]).filter(n=>n.profiles).map(n=>({...n,profiles:n.profiles})))},enabled:!!t})},fne=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async({content_type:r,content_text:n,media_url:s,background_color:i="#25d366"})=>{if(!(e!=null&&e.id))throw new Error("User not authenticated");const{data:a,error:l}=await ae.from("user_stories").insert({user_id:e.id,content_type:r,content_text:n,media_url:s,background_color:i}).select().single();if(l)throw l;return a},onSuccess:()=>{t.invalidateQueries({queryKey:["stories"]})}})},mne=()=>{const t=br(),{user:e}=st();return Vt({mutationFn:async r=>{if(!(e!=null&&e.id))throw new Error("User not authenticated");const{error:n}=await ae.from("story_views").insert({story_id:r,viewer_id:e.id});if(n&&!n.message.includes("duplicate key"))throw n},onSuccess:()=>{t.invalidateQueries({queryKey:["stories"]})}})},pne=({stories:t,currentStoryIndex:e,onClose:r,onNext:n,onPrevious:s})=>{var A,F,Y,T,O,U,q,Z;const[i,a]=y.useState(0),[l,c]=y.useState(!1),[u,d]=y.useState(""),[h,f]=y.useState(!1),[m,p]=y.useState(!1),v=mne(),{user:b}=st(),x=t[e];y.useEffect(()=>{x!=null&&x.id&&v.mutate(x.id)},[x==null?void 0:x.id,v]),y.useEffect(()=>{if(l)return;a(0);const H=setInterval(()=>{a(Q=>Q>=100?(n(),0):Q+1)},100);return()=>clearInterval(H)},[e,n,l]);const w=H=>{const Q=new Date,R=new Date(H),B=Math.floor((Q.getTime()-R.getTime())/(1e3*60*60));return B<1?"il y a quelques minutes":B===1?"il y a 1 heure":`il y a ${B}h`},_=()=>{e<t.length-1?n():r()},S=()=>{e>0&&s()},N=()=>{c(!0),setTimeout(()=>c(!1),200)},E=async()=>{if(!(!u.trim()||!(b!=null&&b.id)||!(x!=null&&x.id)||m)){p(!0);try{const{data:H}=await ae.from("story_conversations").select("id").eq("story_id",x.id).or(`and(participant1_id.eq.${b.id},participant2_id.eq.${x.user_id}),and(participant1_id.eq.${x.user_id},participant2_id.eq.${b.id})`).maybeSingle();let Q=H==null?void 0:H.id;if(!Q){const{data:X,error:ie}=await ae.from("story_conversations").insert({story_id:x.id,participant1_id:b.id,participant2_id:x.user_id,last_message_at:new Date().toISOString()}).select("id").single();if(ie)throw ie;Q=X.id}let R="";x.content_type==="text"&&x.content_text?R=x.content_text.substring(0,100):x.content_type==="image"?R="📸 Photo partagée":x.content_type==="video"&&(R="🎥 Vidéo partagée");const{error:B}=await ae.from("story_messages").insert({conversation_id:Q,sender_id:b.id,content:u,story_reference:R});if(B)throw B;await ae.from("story_conversations").update({last_message_at:new Date().toISOString()}).eq("id",Q),me.success("Réponse envoyée!"),d(""),f(!1)}catch(H){console.error("Error sending reply:",H),me.error("Erreur lors de l'envoi de la réponse")}finally{p(!1)}}},P=H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),E())};return o.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute top-4 left-4 right-4 flex space-x-1 z-20",children:t.map((H,Q)=>o.jsx("div",{className:"flex-1 h-0.5 bg-white/30 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-100",style:{width:Q<e?"100%":Q===e?`${i}%`:"0%"}})},Q))}),o.jsxs("div",{className:"absolute top-12 left-4 right-4 flex items-center justify-between text-white z-20",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs(Uh,{className:"w-8 h-8 border-2 border-white",children:[o.jsx(Vh,{src:(A=x.profiles)==null?void 0:A.avatar_url}),o.jsx(Wh,{className:"bg-gray-600 text-white text-xs",children:((Y=(F=x.profiles)==null?void 0:F.first_name)==null?void 0:Y[0])||((O=(T=x.profiles)==null?void 0:T.username)==null?void 0:O[0])||"U"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-sm",children:((U=x.profiles)==null?void 0:U.first_name)||((q=x.profiles)==null?void 0:q.username)||"Utilisateur"}),o.jsx("p",{className:"text-xs text-white/70",children:w(x.created_at)})]})]}),o.jsx(J,{variant:"ghost",size:"icon",onClick:r,className:"text-white hover:bg-white/20 w-8 h-8",children:o.jsx(qr,{size:20})})]}),o.jsx("div",{className:"absolute left-0 top-0 w-1/3 h-full cursor-pointer z-10",onClick:S}),o.jsx("div",{className:"absolute right-0 top-0 w-1/3 h-full cursor-pointer z-10",onClick:_}),o.jsx("div",{className:"absolute left-1/3 top-0 w-1/3 h-full cursor-pointer z-10",onMouseDown:N}),o.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[x.content_type==="text"&&o.jsx("div",{className:"max-w-xs mx-auto p-6 rounded-2xl text-center shadow-lg",style:{backgroundColor:x.background_color||"#25d366"},children:o.jsx("p",{className:"text-white text-lg font-medium leading-relaxed",children:x.content_text})}),x.content_type==="image"&&o.jsx("img",{src:x.media_url,alt:"Story content",className:"max-w-full max-h-full object-contain rounded-lg"}),x.content_type==="video"&&o.jsx("video",{src:x.media_url,className:"max-w-full max-h-full object-contain rounded-lg",autoPlay:!0,muted:!0,loop:!0})]}),o.jsx("div",{className:"absolute bottom-4 sm:bottom-6 left-4 right-4 z-30",children:h?o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 bg-white/10 backdrop-blur-sm rounded-full px-3 sm:px-4 py-2 sm:py-3",children:[o.jsx(Ye,{value:u,onChange:H=>d(H.target.value),onKeyPress:P,placeholder:"Répondre à cette story...",className:"flex-1 bg-transparent border-none text-white placeholder-white/70 focus:ring-0 text-sm sm:text-base",autoFocus:!0,disabled:m}),o.jsx(J,{onClick:E,disabled:!u.trim()||m,variant:"ghost",size:"sm",className:"text-white hover:bg-white/20 px-2 sm:px-3 py-1 sm:py-2",children:m?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):o.jsx(xc,{size:16})})]}):o.jsxs(J,{onClick:()=>f(!0),variant:"ghost",className:"w-full text-white border border-white/30 hover:bg-white/10 rounded-full py-2 sm:py-3 text-sm sm:text-base",children:["Répondre à ",((Z=x.profiles)==null?void 0:Z.first_name)||"cette story","..."]})}),e>0&&o.jsx(J,{variant:"ghost",size:"icon",onClick:S,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:bg-white/20 w-10 h-10 z-20",children:o.jsx(kz,{size:24})}),e<t.length-1&&o.jsx(J,{variant:"ghost",size:"icon",onClick:_,className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:bg-white/20 w-10 h-10 z-20",children:o.jsx(OP,{size:24})})]})},gne=({isOpen:t,onClose:e})=>{const[r,n]=y.useState("text"),[s,i]=y.useState(""),[a,l]=y.useState("#25d366"),[c,u]=y.useState(null),[d,h]=y.useState(!1),{user:f}=st(),m=fne(),p=["#25d366","#128C7E","#075E54","#34B7F1","#9C27B0","#E91E63","#F44336","#FF9800","#4CAF50","#2196F3"],v=async x=>{if(!f)return null;const w=x.name.split(".").pop(),_=`${f.id}/${Date.now()}.${w}`,{data:S,error:N}=await ae.storage.from("story-media").upload(_,x);if(N)throw N;const{data:E}=ae.storage.from("story-media").getPublicUrl(_);return E.publicUrl},b=async()=>{try{h(!0);let x=null;c&&(x=await v(c)),await m.mutateAsync({content_type:r,content_text:r==="text"?s:void 0,media_url:x,background_color:r==="text"?a:void 0}),e(),i(""),u(null),n("text")}catch(x){console.error("Error creating story:",x)}finally{h(!1)}};return t?o.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-xl font-semibold",children:"Créer un statut"}),o.jsx(J,{variant:"ghost",size:"icon",onClick:e,children:o.jsx(qr,{size:20})})]}),o.jsxs("div",{className:"flex space-x-2 mb-4",children:[o.jsxs(J,{variant:r==="text"?"default":"outline",size:"sm",onClick:()=>n("text"),children:[o.jsx(wu,{size:16,className:"mr-1"}),"Texte"]}),o.jsxs(J,{variant:r==="image"?"default":"outline",size:"sm",onClick:()=>n("image"),children:[o.jsx(tc,{size:16,className:"mr-1"}),"Image"]}),o.jsxs(J,{variant:r==="video"?"default":"outline",size:"sm",onClick:()=>n("video"),children:[o.jsx(tc,{size:16,className:"mr-1"}),"Vidéo"]})]}),r==="text"&&o.jsxs(o.Fragment,{children:[o.jsx(jr,{placeholder:"Écrivez votre statut...",value:s,onChange:x=>i(x.target.value),className:"mb-4",rows:4}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-medium mb-2",children:"Couleur de fond :"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(x=>o.jsx("button",{className:`w-8 h-8 rounded-full border-2 ${a===x?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:x},onClick:()=>l(x)},x))})]}),o.jsx("div",{className:"w-full h-32 rounded-lg flex items-center justify-center mb-4",style:{backgroundColor:a},children:o.jsx("p",{className:"text-white text-center px-4",children:s||"Votre texte apparaîtra ici..."})})]}),(r==="image"||r==="video")&&o.jsxs("div",{className:"mb-4",children:[o.jsx(Ye,{type:"file",accept:r==="image"?"image/*":"video/*",onChange:x=>{var w;return u(((w=x.target.files)==null?void 0:w[0])||null)},className:"mb-2"}),c&&o.jsxs("p",{className:"text-sm text-gray-600",children:["Fichier sélectionné : ",c.name]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(J,{variant:"outline",onClick:e,className:"flex-1",children:"Annuler"}),o.jsx(J,{onClick:b,className:"flex-1",disabled:d||r==="text"&&!s||(r==="image"||r==="video")&&!c,children:d?"Publication...":"Publier"})]})]})}):null},vne=()=>{var w,_,S;const{data:t=[],isLoading:e,error:r}=hne(),{user:n}=st(),[s,i]=y.useState([]),[a,l]=y.useState(0),[c,u]=y.useState(!1),d=Fe.useMemo(()=>{const N={};return t.forEach(E=>{var A;if(!E.profiles)return;const P=E.user_id;N[P]||(N[P]={user:E.profiles,stories:[],hasViewed:!1}),N[P].stories.push(E),(A=E.story_views)!=null&&A.some(F=>F.viewer_id===(n==null?void 0:n.id))&&(N[P].hasViewed=!0)}),Object.values(N)},[t,n==null?void 0:n.id]),h=t.filter(N=>N.user_id===(n==null?void 0:n.id)),f=N=>{if(!N)return"Utilisateur";const E=N.first_name||"",P=N.last_name||"";return`${E} ${P}`.trim()||N.username||"Utilisateur"},m=(N,E=0)=>{i(N),l(E)},p=()=>{h.length>0?m(h):u(!0)},v=()=>{var N;if(a<s.length-1)l(a+1);else{const E=(N=s[0])==null?void 0:N.user_id,P=d.findIndex(A=>A.user.id===E);if(P<d.length-1){const A=d[P+1];i(A.stories),l(0)}else i([]),l(0)}},b=()=>{var N;if(a>0)l(a-1);else{const E=(N=s[0])==null?void 0:N.user_id,P=d.findIndex(A=>A.user.id===E);if(P>0){const A=d[P-1];i(A.stories),l(A.stories.length-1)}}},x=()=>{i([]),l(0)};return e?o.jsx("div",{className:"flex space-x-3 p-4 overflow-x-auto",children:[...Array(5)].map((N,E)=>o.jsxs("div",{className:"flex-shrink-0",children:[o.jsx("div",{className:"w-14 h-14 bg-gray-200 rounded-full animate-pulse mb-2"}),o.jsx("div",{className:"w-12 h-3 bg-gray-200 rounded animate-pulse mx-auto"})]},E))}):r?(console.error("Error loading stories:",r),o.jsx("div",{className:"p-4 text-center text-red-500",children:"Erreur lors du chargement des statuts"})):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex space-x-3 p-4 overflow-x-auto bg-white border-b",children:[o.jsxs("div",{className:"flex-shrink-0 text-center",children:[o.jsxs("button",{onClick:p,className:"relative",children:[o.jsx("div",{className:`w-14 h-14 rounded-full p-0.5 ${h.length>0?"bg-[#25d366]":"bg-gray-300"}`,children:o.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-white p-0.5",children:(w=n==null?void 0:n.user_metadata)!=null&&w.avatar_url?o.jsx("img",{src:n.user_metadata.avatar_url,alt:"Mon statut",className:"w-full h-full object-cover rounded-full"}):o.jsx("div",{className:"w-full h-full bg-gray-200 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-gray-600 font-semibold text-xs",children:((S=(_=n==null?void 0:n.user_metadata)==null?void 0:_.first_name)==null?void 0:S.charAt(0))||"M"})})})}),h.length===0&&o.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-5 h-5 bg-[#25d366] rounded-full flex items-center justify-center border-2 border-white",children:o.jsx(ls,{size:10,className:"text-white"})})]}),o.jsx("p",{className:"text-xs mt-1 text-center text-gray-600 max-w-[56px] truncate",children:h.length>0?"Mon statut":"Ajouter"})]}),d.map(N=>o.jsxs("div",{className:"flex-shrink-0 text-center",children:[o.jsx("button",{onClick:()=>m(N.stories),className:"relative",children:o.jsx("div",{className:`w-14 h-14 rounded-full p-0.5 ${N.hasViewed?"bg-gray-300":"bg-[#25d366]"}`,children:o.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-white p-0.5",children:N.user.avatar_url?o.jsx("img",{src:N.user.avatar_url,alt:f(N.user),className:"w-full h-full object-cover rounded-full"}):o.jsx("div",{className:"w-full h-full bg-gray-200 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-gray-600 font-semibold text-xs",children:f(N.user).charAt(0)})})})})}),o.jsx("p",{className:"text-xs mt-1 text-center text-gray-600 max-w-[56px] truncate",children:f(N.user).split(" ")[0]})]},N.user.id))]}),s.length>0&&o.jsx(pne,{stories:s,currentStoryIndex:a,onClose:x,onNext:v,onPrevious:b}),c&&o.jsx(gne,{isOpen:c,onClose:()=>u(!1)})]})},xne=t=>{const e={};return t.forEach(r=>{const n=new Date(r.created_at);if(!KL(n)){console.warn("Invalid date found:",r.created_at);const i="Messages récents";e[i]||(e[i]=[]),e[i].push(r);return}let s="";zX(n)?s="Aujourd'hui":BX(n)?s="Hier":FX(n)?s=z2(n,"EEEE",{locale:Fm}):IX(n)?s=z2(n,"d MMMM",{locale:Fm}):s=z2(n,"d MMMM yyyy",{locale:Fm}),e[s]||(e[s]=[]),e[s].push(r)}),e},yne=()=>{const{data:t=[],isLoading:e,error:r}=ane(),{notifications:n=[],isLoading:s}=w8(),{user:i}=st(),a=Mn(),[l,c]=y.useState("conversations"),u=f=>{a(`/formation/${f.formationId}`)},d=n.filter(f=>!f.is_read).length,h=xne(t);return e||s?o.jsx("div",{className:"min-h-screen bg-white pb-16 md:pt-16 md:pb-0",children:o.jsx("div",{className:"flex justify-center items-center py-12",children:o.jsx("div",{className:"text-gray-500",children:"Chargement..."})})}):r?o.jsx("div",{className:"min-h-screen bg-white pb-16 md:pt-16 md:pb-0",children:o.jsx("div",{className:"flex justify-center items-center py-12",children:o.jsx("div",{className:"text-red-500",children:"Erreur lors du chargement"})})}):o.jsxs("div",{className:"min-h-screen bg-white pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{className:"bg-edu-whatsapp-green text-white p-4 sticky top-0 md:top-16",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h1",{className:"text-xl font-semibold",children:"Messages & Notifications"}),o.jsx("button",{className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:o.jsx(Lz,{size:20})})]})}),o.jsx(vne,{}),o.jsx("div",{className:"bg-gray-50",children:o.jsxs(RL,{value:l,onValueChange:c,className:"w-full",children:[o.jsxs(yj,{className:"grid w-full grid-cols-2 bg-gray-50",children:[o.jsx(pp,{value:"conversations",className:"flex items-center space-x-2",children:o.jsx("span",{children:"Conversations"})}),o.jsxs(pp,{value:"notifications",className:"flex items-center space-x-2",children:[o.jsx(uu,{size:16}),o.jsx("span",{children:"Notifications"}),d>0&&o.jsx(yr,{variant:"destructive",className:"h-5 w-5 flex items-center justify-center p-0 text-xs",children:d>99?"99+":d})]})]}),o.jsxs(gp,{value:"conversations",className:"mt-0",children:[o.jsx("div",{className:"p-4 bg-gray-50",children:o.jsxs("div",{className:"relative",children:[o.jsx(bu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),o.jsx("input",{type:"text",placeholder:"Rechercher dans les conversations...",className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-edu-primary focus:border-transparent"})]})}),o.jsx("div",{className:"divide-y divide-gray-100",children:Object.keys(h).length>0?Object.entries(h).map(([f,m])=>o.jsxs("div",{children:[o.jsx("div",{className:"sticky top-0 bg-gray-100 px-4 py-2 text-sm font-medium text-gray-600 border-b border-gray-200",children:f}),m.map(p=>o.jsxs("div",{className:"flex items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>u(p),children:[o.jsxs("div",{className:"relative mr-3",children:[o.jsx("div",{className:"w-12 h-12 bg-edu-primary rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold",children:p.avatar})}),p.online&&o.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("h3",{className:"font-medium text-gray-900 truncate",children:p.name}),o.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:p.timestamp})]}),o.jsx("p",{className:"text-sm text-gray-600 truncate",children:p.lastMessage})]}),p.unread>0&&o.jsx("div",{className:"ml-2 bg-edu-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:p.unread})]},p.id))]},f)):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-gray-500 mb-2",children:"Aucune conversation"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Inscrivez-vous à une formation ou créez-en une pour commencer à échanger"})]})})]}),o.jsx(gp,{value:"notifications",className:"mt-0",children:o.jsx("div",{className:"p-4",children:i?n.length===0?o.jsxs("div",{className:"bg-white rounded-lg p-8 border text-center",children:[o.jsx(uu,{size:48,className:"mx-auto text-gray-400 mb-4"}),o.jsx("p",{className:"text-gray-600 font-medium mb-2",children:"Aucune notification"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Vous serez notifié ici des nouvelles activités"})]}):o.jsx("div",{className:"space-y-4",children:n.map(f=>o.jsx(dne,{notification:f},f.id))}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx(uu,{size:48,className:"mx-auto text-gray-400 mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Connectez-vous pour voir vos notifications"})]})})})]})})]})},bne=t=>Nt({queryKey:["user-stats",t],queryFn:async()=>{if(!t)return null;const{data:e}=await ae.from("enrollment_requests").select(`
          formations (
            id,
            levels (
              lessons (
                id,
                user_lesson_progress (
                  status
                )
              )
            )
          )
        `).eq("user_id",t).eq("status","approved");let r=0,n=0;e==null||e.forEach(l=>{var u,d;const c=l.formations;if(c){let h=!0;(u=c.levels)==null||u.forEach(f=>{var m;(m=f.lessons)==null||m.forEach(p=>{var b;const v=(b=p.user_lesson_progress)==null?void 0:b[0];(v==null?void 0:v.status)==="completed"?n++:h=!1})}),h&&((d=c.levels)==null?void 0:d.length)>0&&r++}});const s=Math.round(n*.5),{data:i}=await ae.from("lesson_messages").select("id").eq("sender_id",t).eq("is_exercise_submission",!0).eq("exercise_status","approved"),a=(i==null?void 0:i.length)||0;return{completedFormations:r,learningHours:s,validatedExercises:a,badges:0}},enabled:!!t}),wne=({profile:t,user:e,getInitials:r,getDisplayName:n})=>{const s=Mn();return o.jsx("div",{className:"bg-white shadow-sm",children:o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-edu-primary to-edu-secondary rounded-full flex items-center justify-center",children:t!=null&&t.avatar_url?o.jsx("img",{src:t.avatar_url,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):o.jsx("span",{className:"text-white text-2xl font-bold",children:r()})}),o.jsx("button",{onClick:()=>s("/complete-profile"),className:"absolute bottom-0 right-0 bg-edu-primary text-white p-1 rounded-full",children:o.jsx(Pu,{size:12})})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n()}),o.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.email}),o.jsxs("p",{className:"text-sm text-edu-primary mt-1",children:[t!=null&&t.is_teacher?"Enseignant":"Étudiant"," actif depuis ",new Date((e==null?void 0:e.created_at)||"").toLocaleDateString("fr-FR",{year:"numeric",month:"long"})]}),(t==null?void 0:t.role)==="admin"&&o.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 mt-1",children:[o.jsx(zp,{size:12,className:"mr-1"}),"Administrateur"]})]})]})})})},_ne=({stats:t})=>o.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:t.map((e,r)=>o.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[o.jsx("div",{className:"text-2xl font-bold text-edu-primary mb-1",children:e.value}),o.jsx("div",{className:"text-sm text-gray-600",children:e.label})]},r))}),jne=({enrollments:t})=>!t||t.length===0?null:o.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border mb-6",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Progression actuelle"}),o.jsx("div",{className:"space-y-3",children:t.slice(0,3).map(e=>{const r=e.formations,n=Math.floor(Math.random()*100);return o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[o.jsx("span",{className:"truncate",children:(r==null?void 0:r.title)||"Formation"}),o.jsxs("span",{children:[n,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-edu-primary h-2 rounded-full transition-all duration-300",style:{width:`${n}%`}})})]},e.formation_id)})})]}),Sne=({menuItems:t})=>o.jsx("div",{className:"bg-white rounded-lg shadow-sm border divide-y divide-gray-100",children:t.map((e,r)=>{const n=e.icon;return o.jsxs("button",{onClick:e.action,className:`w-full flex items-center p-4 hover:bg-gray-50 transition-colors ${e.label==="Administration"?"bg-red-50 hover:bg-red-100":""}`,children:[o.jsx(n,{size:20,className:`mr-3 ${e.label==="Administration"?"text-red-600":"text-gray-500"}`}),o.jsx("span",{className:`flex-1 text-left ${e.label==="Administration"?"text-red-600 font-medium":""}`,children:e.label})]},r)})}),Cne=t=>Nt({queryKey:["teacher-wallet",t],queryFn:async()=>{if(!t)return null;const{data:e,error:r}=await ae.from("teacher_wallets").select("*").eq("teacher_id",t).single();if(r&&r.code!=="PGRST116")throw console.error("Error fetching teacher wallet:",r),r;return e},enabled:!!t}),Nne=t=>Nt({queryKey:["teacher-transactions",t],queryFn:async()=>{if(!t)return[];const{data:e,error:r}=await ae.from("teacher_transactions").select("*").eq("teacher_id",t).order("created_at",{ascending:!1}).limit(10);if(r)throw console.error("Error fetching teacher transactions:",r),r;return e||[]},enabled:!!t}),kne=({teacherId:t})=>{var i,a;const{data:e,isLoading:r}=Cne(t),{data:n,isLoading:s}=Nne(t);return r?o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center gap-2",children:[o.jsx(x2,{size:20}),"Portefeuille Enseignant"]})}),o.jsx(Rt,{children:o.jsx("p",{className:"text-gray-500",children:"Chargement..."})})]}):e?o.jsxs("div",{className:"space-y-4",children:[o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center gap-2",children:[o.jsx(x2,{size:20}),"Portefeuille Enseignant"]})}),o.jsx(Rt,{children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-600 mb-2",children:[o.jsx(Mz,{size:20}),o.jsx("span",{className:"font-semibold",children:"Solde Actuel"})]}),o.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[((i=e.balance)==null?void 0:i.toFixed(2))||"0.00","€"]})]}),o.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600 mb-2",children:[o.jsx(VP,{size:20}),o.jsx("span",{className:"font-semibold",children:"Total Gagné"})]}),o.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[((a=e.total_earned)==null?void 0:a.toFixed(2))||"0.00","€"]})]})]})})]}),o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center gap-2",children:[o.jsx(Js,{size:20}),"Transactions Récentes"]})}),o.jsx(Rt,{children:s?o.jsx("p",{className:"text-gray-500",children:"Chargement des transactions..."}):n&&n.length>0?o.jsx("div",{className:"space-y-3",children:n.map(l=>o.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"font-medium",children:[l.transaction_type==="interview_payment"&&"💬 Entretien",l.transaction_type==="exercise_validation"&&"✅ Exercice validé",l.transaction_type==="withdrawal"&&"💳 Retrait"]}),o.jsx("p",{className:"text-sm text-gray-600",children:l.description}),o.jsx("p",{className:"text-xs text-gray-500",children:new Date(l.created_at).toLocaleDateString("fr-FR")})]}),o.jsxs("div",{className:`font-bold ${l.amount>=0?"text-green-600":"text-red-600"}`,children:[l.amount>=0?"+":"",l.amount,"€"]})]},l.id))}):o.jsx("p",{className:"text-gray-500",children:"Aucune transaction trouvée"})})]})]}):o.jsxs(Mt,{children:[o.jsx(er,{children:o.jsxs(ur,{className:"flex items-center gap-2",children:[o.jsx(x2,{size:20}),"Portefeuille Enseignant"]})}),o.jsx(Rt,{children:o.jsx("p",{className:"text-gray-500",children:"Aucun portefeuille trouvé"})})]})},Ene=()=>{const{user:t,profile:e,logout:r}=st(),n=Mn(),{data:s}=b8(t==null?void 0:t.id),{data:i}=bne(t==null?void 0:t.id),a=[{label:"Formations complétées",value:(i==null?void 0:i.completedFormations)||0},{label:"Heures d'apprentissage",value:(i==null?void 0:i.learningHours)||0},{label:"Exercices validés",value:(i==null?void 0:i.validatedExercises)||0},{label:"Badges obtenus",value:(i==null?void 0:i.badges)||0}],l=[{icon:L_,label:"Paramètres",action:()=>n("/complete-profile")},{icon:$o,label:"Mes formations",action:()=>n("/cours")},{icon:LP,label:"Badges et récompenses",action:()=>{}},{icon:uu,label:"Notifications",action:()=>{}},{icon:Ez,label:"Aide et support",action:()=>{}}];(e==null?void 0:e.role)==="admin"&&l.push({icon:zp,label:"Administration",action:()=>n("/admin")});const c=async()=>{await r(),n("/auth")},u=()=>e!=null&&e.first_name&&(e!=null&&e.last_name)?`${e.first_name.charAt(0)}${e.last_name.charAt(0)}`.toUpperCase():e!=null&&e.username?e.username.charAt(0).toUpperCase():t!=null&&t.email?t.email.charAt(0).toUpperCase():"U",d=()=>e!=null&&e.first_name&&(e!=null&&e.last_name)?`${e.first_name} ${e.last_name}`:e!=null&&e.username?e.username:(t==null?void 0:t.email)||"Utilisateur";return o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx(wne,{profile:e,user:t,getInitials:u,getDisplayName:d}),o.jsxs("div",{className:"p-4",children:[o.jsx(_ne,{stats:a}),o.jsx(jne,{enrollments:s}),(e==null?void 0:e.is_teacher)&&(t==null?void 0:t.id)&&o.jsx("div",{className:"mt-6",children:o.jsx(kne,{teacherId:t.id})}),o.jsx(Sne,{menuItems:l}),o.jsx("div",{className:"mt-6",children:o.jsxs(J,{onClick:c,variant:"outline",className:"w-full border-red-200 text-red-600 hover:bg-red-50",children:[o.jsx(Uz,{size:16,className:"mr-2"}),"Se déconnecter"]})})]})]})},Pne=()=>{const{currentView:t}=bj(),e=()=>{switch(t){case"home":return o.jsx(ok,{});case"shop":return o.jsx(YK,{});case"cours":return o.jsx(sne,{});case"messages":return o.jsx(yne,{});case"profil":return o.jsx(Ene,{});default:return o.jsx(ok,{})}};return o.jsx("div",{className:"h-full w-full overflow-y-auto pb-24",children:e()})},Cd=()=>{const t=ma(),{setCurrentView:e}=bj();return y.useEffect(()=>{const r=t.pathname;r==="/"||r==="/home"?e("home"):r==="/shop"?e("shop"):r==="/cours"?e("cours"):r==="/messages"?e("messages"):r==="/profil"&&e("profil")},[t.pathname,e]),o.jsxs("div",{className:"h-screen w-full flex flex-col overflow-y-auto",children:[o.jsx("div",{className:"flex-1",children:o.jsx(Pne,{})}),o.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-lg",children:o.jsx(aY,{})})]})},Ane=()=>{const{formationId:t}=n1(),e=Mn();return t?o.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pt-16 md:pb-0",children:[o.jsx("div",{className:"bg-[#25d366] text-white sticky top-0 md:top-16 z-40 shadow-md",children:o.jsxs("div",{className:"flex items-center p-4",children:[o.jsx(J,{variant:"ghost",size:"sm",onClick:()=>e(-1),className:"mr-3 p-2 hover:bg-white/20 rounded-full text-white",children:o.jsx(Za,{size:20})}),o.jsxs("div",{children:[o.jsx("h1",{className:"font-bold text-lg text-white",children:"Options d'abonnement"}),o.jsx("p",{className:"text-sm text-green-100",children:"Choisissez l'offre qui vous convient"})]})]})}),o.jsx("div",{className:"p-4",children:o.jsx(uA,{formationId:t})})]}):(e("/cours"),null)},Tne=new kI;function Lne(){return o.jsx(LI,{client:Tne,children:o.jsx(mq,{children:o.jsxs(iY,{children:[o.jsx(fz,{}),o.jsx(rI,{children:o.jsx("div",{className:"App",children:o.jsxs(L7,{children:[o.jsx(es,{path:"/formation/:formationId",element:o.jsx(BU,{})}),o.jsx(es,{path:"/profile/:profileId",element:o.jsx(qU,{})}),o.jsx(es,{path:"/lesson/:lessonId",element:o.jsx(UU,{})}),o.jsx(es,{path:"/auth",element:o.jsx(XU,{})}),o.jsx(es,{path:"/admin",element:o.jsx(tY,{})}),o.jsx(es,{path:"/complete-profile",element:o.jsx(rY,{})}),o.jsx(es,{path:"/formation/:formationId/pricing",element:o.jsx(Ane,{})}),o.jsx(es,{path:"/",element:o.jsx(Cd,{})}),o.jsx(es,{path:"/home",element:o.jsx(Cd,{})}),o.jsx(es,{path:"/shop",element:o.jsx(Cd,{})}),o.jsx(es,{path:"/cours",element:o.jsx(Cd,{})}),o.jsx(es,{path:"/messages",element:o.jsx(Cd,{})}),o.jsx(es,{path:"/profil",element:o.jsx(Cd,{})}),o.jsx(es,{path:"*",element:o.jsx(nY,{})})]})})})]})})})}lb.createRoot(document.getElementById("root")).render(o.jsx(Fe.StrictMode,{children:o.jsx(Lne,{})}));export{or as _,_i as c,I4 as g};
